/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __reflectGet = Reflect.get;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __superGet = (cls, obj, key) => __reflectGet(__getProtoOf(cls), key, obj);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian56 = require("obsidian");

// src/fields/fieldManagers/InputField.ts
var import_obsidian10 = require("obsidian");

// src/modals/fields/InputModal.ts
var import_obsidian4 = require("obsidian");

// src/commands/insertValues.ts
var import_obsidian2 = require("obsidian");

// src/commands/insertFrontmatterWithFields.ts
var import_obsidian = require("obsidian");
function insertFrontmatterWithFields(plugin, fileOrFilePath, fields) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrFilePath instanceof import_obsidian.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = yield plugin.app.vault.read(file);
    const frontmatter = "---\n" + Object.entries(fields).map(([fieldName, value]) => `${fieldName}: ${value}`).join("\n") + "\n---\n";
    yield plugin.app.vault.modify(file, frontmatter + content);
    const editor = (_a = plugin.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView)) == null ? void 0 : _a.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/commands/insertValues.ts
function insertValues(plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after = true, asList = false, asComment = false) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian2.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian2.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    if (inFrontmatter && lineNumber == -2 && !frontmatter) {
      const fields = { fieldName: value };
      yield insertFrontmatterWithFields(plugin, file, fields);
    } else {
      const result = yield plugin.app.vault.read(file);
      let newContent = [];
      const targetLineNumber = inFrontmatter && lineNumber == -2 && frontmatter ? frontmatter.position.end.line : lineNumber;
      result.split("\n").forEach((line, _lineNumber) => {
        if (_lineNumber == targetLineNumber) {
          if (after)
            newContent.push(line);
          const newLine = `${!inFrontmatter && asComment ? ">" : ""}${!inFrontmatter && asList ? "- " : ""}${fieldName}${inFrontmatter ? ":" : "::"} ${value}`;
          newContent.push(newLine);
          if (!after)
            newContent.push(line);
        } else {
          newContent.push(line);
        }
      });
      yield plugin.app.vault.modify(file, newContent.join("\n"));
      const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView)) == null ? void 0 : _b.editor;
      if (editor) {
        const lineNumber2 = editor.getCursor().line;
        editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber2).length });
      }
    }
  });
}

// src/commands/replaceValues.ts
var import_obsidian3 = require("obsidian");

// src/types/lookupTypes.ts
var BuiltinSummarizing = /* @__PURE__ */ ((BuiltinSummarizing2) => {
  BuiltinSummarizing2["Sum"] = "Sum";
  BuiltinSummarizing2["Count"] = "Count";
  BuiltinSummarizing2["CountAll"] = "CountAll";
  BuiltinSummarizing2["Average"] = "Average";
  BuiltinSummarizing2["Max"] = "Max";
  BuiltinSummarizing2["Min"] = "Min";
  return BuiltinSummarizing2;
})(BuiltinSummarizing || {});
var BuiltinSummarizingFunctionDescription = {
  "Sum": "Returns the sum of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Count": "Counts all pages matching the query where <{{summarizedFieldName}}> is non empty",
  "CountAll": "Counts all pages matching the query (including empty fields)",
  "Average": "Returns the average value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Max": "Returns the maximum value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Min": "Returns the minimum value of <{{summarizedFieldName}}> fields in the pages matching the query"
};
var BuiltinSummarizingFunction = {
  "Sum": 'const i=0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum',
  "CountAll": "return pages.length",
  "Count": 'return pages.filter(p => !!p["{{summarizedFieldName}}"]).length',
  "Average": 'const i=0.0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum / pages.length',
  "Max": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"] >= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]',
  "Min": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"]!==null && p["{{summarizedFieldName}}"] <= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]'
};
var Type = /* @__PURE__ */ ((Type3) => {
  Type3["LinksList"] = "LinksList";
  Type3["LinksBulletList"] = "LinksBulletList";
  Type3["BuiltinSummarizing"] = "BuiltinSummarizing";
  Type3["CustomList"] = "CustomList";
  Type3["CustomBulletList"] = "CustomBulletList";
  Type3["CustomSummarizing"] = "CustomSummarizing";
  return Type3;
})(Type || {});
var ShortDescription = {
  "LinksList": "Inline list of links",
  "LinksBulletList": "Bullet list of links",
  "BuiltinSummarizing": "",
  "CustomList": "Inline list of customized links",
  "CustomBulletList": "Bullet list of customized links",
  "CustomSummarizing": "Custom summarizing function"
};
var Description = {
  "LinksList": "List of related links displayed inline",
  "LinksBulletList": "List of related links displayed below the field",
  "BuiltinSummarizing": "Built-in summarizing function",
  "CustomList": "Custom list rendering function displayed inline",
  "CustomBulletList": "Custom list rendering function displayed below the field",
  "CustomSummarizing": "Custom summarizing function"
};
var OptionLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Built-in summarize function:",
  "CustomList": "Query's results' list's rendering function:",
  "CustomBulletList": "Query's results' list's rendering function:",
  "CustomSummarizing": "Query's results' list's summarizing function:"
};
var OptionSubLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": `function(page) { return <function using "page">; }`,
  "CustomBulletList": `function(page) { return <function using "page">; }`,
  "CustomSummarizing": `function(page) { return <function using "page">; }`
};
var Helper = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomBulletList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomSummarizing": 'Javascript string, the "pages" (dataview pages type) variable is available\nexample: \nconst initialValue = 0;\nconst sumWithInitial = pages.reduce(\n    (previousValue, currentValue) => previousValue + currentValue,\n    initialValue\n);\nreturn `${sumWithInitial}`\n'
};
var Default = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Count" /* Count */,
  "CustomList": "page.file.name",
  "CustomBulletList": "page.file.name",
  "CustomSummarizing": "return pages.length"
};
var bulletListLookupTypes = [
  "LinksBulletList" /* LinksBulletList */,
  "CustomBulletList" /* CustomBulletList */
];

// src/utils/list.ts
function getListBounds(plugin, file, parent) {
  var _a;
  const listItems = ((_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.listItems) || [];
  return getListBoundsFromListItemCacheList(listItems, parent);
}
function getListBoundsFromListItemCacheList(listItems, parent) {
  const subParentsLines = [-parent - 1];
  let start2 = parent;
  let end2 = -1;
  let outOfList = false;
  listItems.sort((a, b) => a.position.start.line - b.position.start.line).forEach((listItem) => {
    if (subParentsLines.includes(listItem.parent) && !outOfList) {
      subParentsLines.push(listItem.position.start.line);
      if (start2 > listItem.position.start.line)
        start2 = listItem.position.start.line;
      if (end2 <= listItem.position.end.line) {
        if (listItem.position.end.line == listItem.position.start.line) {
          end2 = listItem.position.end.line;
        } else {
          end2 = listItem.position.start.line;
          outOfList = true;
        }
      }
    }
  });
  if (end2 >= 0) {
    return { start: start2, end: end2 };
  }
  return;
}

// src/utils/parser.ts
var fieldComponents = ["inQuote", "inList", "startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => `(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<startStyle>[_\\*~\`]*)(?<attribute>${attribute})(?<endStyle>[_\\*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)`;
var fullLineRegex = new RegExp(`^${genericFieldRegex}::\\s*(?<values>.*)?`, "u");
var inSentenceRegexBrackets = new RegExp(`\\[${genericFieldRegex}::\\s*(?<values>[^\\]]+)?\\]`, "gu");
var inSentenceRegexPar = new RegExp(`\\(${genericFieldRegex}::\\s*(?<values>[^\\)]+)?\\)`, "gu");
var encodeLink = (value) => {
  return value ? value.replace(/\[\[/g, "\u{1F527}\u{1F400}").replace(/\]\]/g, "\u{1F413}\u{1F54C}") : value;
};
var decodeLink = (value) => {
  return value ? value.replace(/🔧🐀/gu, "[[").replace(/🐓🕌/gu, "]]") : value;
};
var frontMatterLineField = (line) => {
  const frontMatterRegex = new RegExp(new RegExp("(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*[^\\s])(?<beforeSeparatorSpacer>\\s*):(?<afterSeparatorSpacer>\\s*)(?<values>.*)", "u"));
  const fR = line.match(frontMatterRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    return attribute;
  }
};
var getLineFields = (line) => {
  const fields = [];
  const fR = line.match(fullLineRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    fields.push({ attribute, values, index: 0, length: line.length });
  } else {
    const sRBk = encodeLink(line).matchAll(inSentenceRegexBrackets);
    let next = sRBk.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBk.next();
    }
    const sRBc = encodeLink(line).matchAll(inSentenceRegexPar);
    next = sRBc.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBc.next();
    }
  }
  fields.sort((a, b) => {
    if (a.index < b.index)
      return -1;
    if (a.index > b.index)
      return 1;
    return 0;
  });
  return fields;
};

// src/commands/replaceValues.ts
var LocationWrapper = {
  "fullLine": { start: "", end: "" },
  "brackets": { start: "[", end: "]" },
  "parenthesis": { start: "(", end: ")" }
};
var matchInlineFields = (regex, line, attribute, input, location = "fullLine") => {
  const sR = line.matchAll(regex);
  let next = sR.next();
  const newFields = [];
  while (!next.done) {
    const match = next.value;
    if (match.groups && Object.keys(match.groups).every((j) => fieldComponents.includes(j))) {
      const { inList, inQuote, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = match.groups;
      const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
      const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
      const start2 = LocationWrapper[location].start;
      const end2 = LocationWrapper[location].end;
      newFields.push({
        oldField: match[0],
        newField: `${inQuote || ""}${start2}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}${end2}`
      });
    }
    next = sR.next();
  }
  return newFields;
};
function replaceValues(plugin, fileOrFilePath, attribute, input, previousItemsCount = 0) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian3.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian3.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const skippedLines = [];
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const newContent = content.map((line, i) => {
      var _a2;
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`^${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const encodedInput = encodeLink(input);
        let encodedLine = encodeLink(line);
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodedLine.match(fullLineRegex2);
        if ((fR == null ? void 0 : fR.groups) && Object.keys(fR.groups).every((j) => fieldComponents.includes(j))) {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((f) => f.name === attribute);
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */) {
            const bounds = getListBounds(plugin, file, i);
            if (bounds) {
              const { start: start3, end: end3 } = bounds;
              for (let j = start3 + 1; j < start3 + previousItemsCount + 1 && j < end3 + 1; j++) {
                skippedLines.push(j);
              }
            }
          }
          const { inList, inQuote, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = fR.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",").sort() : [];
          let newValue;
          let hiddenValue = "";
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */ && bulletListLookupTypes.includes(field == null ? void 0 : field.options.outputType)) {
            newValue = inputArray.length == 1 ? "\n- " + inputArray[0] : `${inputArray.length > 0 ? "\n" : ""}${inputArray.map((item) => "- " + item).join("\n")}`;
            hiddenValue = `<div hidden id="${field.name}_values">${input}</div>`;
          } else {
            newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          }
          return `${inQuote || ""}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${hiddenValue + newValue}`;
        } else {
          const newFields = [];
          const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
          const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
          newFields.push(...matchInlineFields(inSentenceRegexBrackets2, encodedLine, attribute, encodedInput, "brackets" /* brackets */));
          newFields.push(...matchInlineFields(inSentenceRegexPar2, encodedLine, attribute, encodedInput, "parenthesis" /* parenthesis */));
          newFields.forEach((field) => {
            const fieldRegex = new RegExp(field.oldField.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "u");
            encodedLine = encodedLine.replace(fieldRegex, field.newField);
          });
          return decodeLink(encodedLine);
        }
      }
    });
    yield plugin.app.vault.modify(file, newContent.filter((line, i) => !skippedLines.includes(i)).join("\n"));
    const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView)) == null ? void 0 : _b.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/modals/fields/InputModal.ts
var InputModal = class extends import_obsidian4.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.templateValues = {};
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv();
    if (this.field.options.template) {
      const templateFieldRegex = new RegExp(`\\{\\{(?<field>[^\\}]+?)\\}\\}`, "gu");
      const tF = this.field.options.template.matchAll(templateFieldRegex);
      let next = tF.next();
      while (!next.done) {
        if (next.value.groups) {
          const value = next.value.groups.field;
          const [name, optionsString] = value.split(new RegExp(":(.*)", "s")).map((v) => v.trim());
          this.templateValues[name] = "";
          if (optionsString) {
            const options = JSON.parse(optionsString);
            this.buildTemplateSelectItem(inputDiv, name, options);
          } else {
            this.buildTemplateInputItem(inputDiv, name);
          }
        }
        next = tF.next();
      }
      this.buildResultPreview(inputDiv);
      this.buildSaveBtn(inputDiv);
    } else {
      this.buildInputEl(inputDiv);
    }
  }
  renderValue() {
    let renderedString = this.field.options.template.slice();
    Object.keys(this.templateValues).forEach((k) => {
      const fieldRegex = new RegExp(`\\{\\{${k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")}(:[^\\}]*)?\\}\\}`, "u");
      renderedString = renderedString.replace(fieldRegex, this.templateValues[k]);
    });
    this.renderedValue.setValue(renderedString);
  }
  buildTemplateInputItem(inputDiv, name) {
    inputDiv.createDiv({ text: name, cls: "metadata-menu-input-label" });
    const inputEl = new import_obsidian4.TextComponent(inputDiv);
    inputEl.setPlaceholder(`Enter a value for ${name}`);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    inputEl.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildTemplateSelectItem(inputDiv, name, options) {
    inputDiv.createDiv({ text: name, cls: "metadata-menu-input-label" });
    const selectEl = new import_obsidian4.DropdownComponent(inputDiv);
    selectEl.addOption("", "--select--");
    options.forEach((o) => selectEl.addOption(o, o));
    selectEl.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildResultPreview(inputDiv) {
    inputDiv.createEl("hr");
    inputDiv.createDiv({ text: "Result preview", cls: "metadata-menu-input-label" });
    const renderedValueContainer = inputDiv.createDiv();
    this.renderedValue = new import_obsidian4.TextAreaComponent(renderedValueContainer);
    this.renderedValue.inputEl.addClass("metadata-menu-prompt-input");
    this.renderedValue.inputEl.rows = 3;
    this.renderedValue.setValue(this.value);
  }
  buildSaveBtn(inputDiv) {
    inputDiv.createEl("hr");
    const saveBtnContainer = inputDiv.createDiv({ cls: "metadata-menu-textarea-buttons" });
    const saveBtn = saveBtnContainer.createEl("button");
    (0, import_obsidian4.setIcon)(saveBtn, "checkmark");
    saveBtn.onclick = () => __async(this, null, function* () {
      let inputValue = this.renderedValue.getValue();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    });
  }
  buildInputEl(inputDiv) {
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const inputEl = new import_obsidian4.TextComponent(form);
    inputEl.inputEl.focus();
    inputEl.setValue(`${this.value}`);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    });
  }
};

// src/fields/FieldManager.ts
var import_obsidian9 = require("obsidian");

// src/modals/insertFieldSuggestModal.ts
var import_obsidian6 = require("obsidian");

// src/modals/addNewFieldModal.ts
var import_obsidian5 = require("obsidian");
var addNewFieldModal = class extends import_obsidian5.Modal {
  constructor(plugin, lineNumber, file, inFrontmatter, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.lineNumber = lineNumber;
    this.file = file;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const addNewFieldContainer = this.contentEl.createDiv();
    const nameInputContainer = addNewFieldContainer.createDiv({ cls: "metadata-menu-prompt-container" });
    nameInputContainer.setText("Field Name: ");
    const nameInputEl = new import_obsidian5.TextComponent(nameInputContainer);
    nameInputEl.inputEl.addClass("metadata-menu-prompt-input");
    nameInputEl.setPlaceholder("Field name");
    const valueInputContainer = addNewFieldContainer.createDiv({ cls: "metadata-menu-prompt-container" });
    valueInputContainer.setText("Field value: ");
    const valueInputEl = new import_obsidian5.TextComponent(valueInputContainer);
    valueInputEl.inputEl.addClass("metadata-menu-prompt-input");
    valueInputEl.setPlaceholder("Field value");
    const footerButtons = this.contentEl.createDiv({
      cls: "metadata-menu-textarea-buttons"
    });
    const saveButton = new import_obsidian5.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      yield this.plugin.fileTaskManager.pushTask(() => {
        insertValues(this.plugin, this.file, nameInputEl.getValue(), valueInputEl.getValue(), this.lineNumber, this.inFrontmatter, this.after);
      });
      this.close();
    }));
    const cancelButton = new import_obsidian5.ExtraButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/modals/insertFieldSuggestModal.ts
var InsertFieldSuggestModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(plugin, file, lineNumber, inFrontmatter, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
  }
  getItems() {
    var _a;
    return [{ actionLabel: "++New++" }].concat(((_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.map((field) => {
      return { actionLabel: field.name, type: field.type };
    })) || []);
  }
  getItemText(item) {
    return item.actionLabel;
  }
  renderSuggestion(item, el) {
    el.addClass("metadata-menu-command-suggest-item");
    const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
    item.item.type ? (0, import_obsidian6.setIcon)(iconContainer, FieldIcon[item.item.type]) : (0, import_obsidian6.setIcon)(iconContainer, "plus-with-circle");
    el.createDiv({ text: item.item.actionLabel, cls: "metadata-menu-command-suggest-action-label" });
    el.createDiv({ cls: "metadata-menu-command-suggest-spacer" });
    if (item.item.type) {
      const typeContainer = el.createEl("div");
      typeContainer.setAttr("class", `metadata-menu-setting-item-info-type ${FieldTypeTagClass[item.item.type]}`);
      typeContainer.setText(item.item.type);
    }
  }
  onChooseItem(item, evt) {
    var _a;
    if (item.actionLabel === "++New++") {
      const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.inFrontmatter, this.after);
      newFieldModal.open();
      this.close();
    } else {
      const field = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field2) => field2.name === item.actionLabel);
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.createAndOpenFieldModal(this.file, item.actionLabel, "", this.lineNumber, this.inFrontmatter, this.after, false, false);
      }
    }
  }
};

// src/settings/FieldSettingsModal.ts
var import_obsidian8 = require("obsidian");

// src/settings/FieldSetting.ts
var import_obsidian7 = require("obsidian");
var FieldSetting = class extends import_obsidian7.Setting {
  constructor(containerEl, field, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.field = field;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
  }
  setTextContentWithname() {
    const manager = new FieldManager[this.field.type](this.plugin, this.field);
    this.infoEl.textContent = "";
    this.infoEl.addClass("metadata-menu-setting-item");
    this.fieldNameContainer = this.infoEl.createEl("div", "metadata-menu-setting-item-name");
    this.fieldNameContainer.setText(this.field.name);
    this.typeContainer = this.infoEl.createEl("div");
    this.typeContainer.setAttr("class", `metadata-menu-setting-item-info-type ${FieldTypeTagClass[this.field.type]}`);
    this.typeContainer.setText(this.field.type);
    this.fieldOptionsContainer = this.infoEl.createEl("div");
    this.fieldOptionsContainer.setText(`${manager.getOptionsStr()}`);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.plugin, this.containerEl, this, this.field);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(plugin, notePath) {
    return __async(this, null, function* () {
      let values = [];
      const file = plugin.app.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian7.TFile && file.extension == "md") {
        const result = yield plugin.app.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian8.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, field) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialField = new Field_default();
    if (field) {
      this.new = false;
      this.field = field;
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.field = new Field_default();
      this.field.id = newId.toString();
      this.initialField.id = newId.toString();
    }
    ;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu-field-setting-modal");
      if (this.field.name == "") {
        this.titleEl.setText(`Add a field and define options`);
      } else {
        this.titleEl.setText(`Manage settings options for ${this.field.name}`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.field, this.initialField);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.field, this.plugin);
    }
    ;
  }
  createnameInputContainer(parentNode) {
    const fieldNameContainerLabel = parentNode.createDiv();
    fieldNameContainerLabel.setText(`Field Name:`);
    const input = new import_obsidian8.TextComponent(parentNode);
    const name = this.field.name;
    input.setValue(name);
    input.setPlaceholder("Name of the field");
    input.onChange((value) => {
      this.field.name = value;
      this.titleEl.setText(`Manage predefined options for ${this.field.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    return input;
  }
  createTypeSelectorContainer(parentNode) {
    const typeSelectorContainerLabel = parentNode.createDiv();
    typeSelectorContainerLabel.setText(`Field type:`);
    const select = new import_obsidian8.DropdownComponent(parentNode);
    Object.keys(FieldTypeLabelMapping).forEach((f) => select.addOption(f, FieldTypeTooltip[f]));
    if (this.field.type) {
      select.setValue(this.field.type);
    }
    select.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.namePromptComponent.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({ cls: "metadata-menu-prompt-div" });
      const mainDiv = div.createDiv({ cls: "metadata-menu-prompt-form" });
      const nameContainer = mainDiv.createDiv();
      this.namePromptComponent = this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const typeSelectContainer = mainDiv.createDiv();
      this.fieldOptionsContainer = mainDiv.createDiv();
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian8.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
      this.createTypeSelectorContainer(typeSelectContainer);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.namePromptComponent, this.namePromptComponent.inputEl) && this.fieldManager.validateOptions();
  }
  createSaveButton(b) {
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      let error = !this.validateFields();
      if (error) {
        new import_obsidian8.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.saved = true;
      const currentExistingField = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
      if (currentExistingField) {
        Field_default.copyProperty(currentExistingField, this.field);
      } else {
        this.plugin.initialProperties.push(this.field);
      }
      ;
      Field_default.copyProperty(this.initialField, this.field);
      if (this.parentSetting)
        Field_default.copyProperty(this.parentSetting.field, this.field);
      (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
      this.plugin.saveSettings();
      this.close();
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialField.name != "") {
        Object.assign(this.field, this.initialField);
      }
      ;
      this.close();
    });
    return b;
  }
  static setValidationError(textInput, insertAfter, message) {
    var _a;
    textInput.inputEl.addClass("is-invalid");
    if (message && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      let mDiv = textInput.inputEl.parentElement.querySelector(".invalid-feedback");
      if (!mDiv) {
        mDiv = createDiv({ cls: "invalid-feedback" });
      }
      mDiv.innerText = message;
      mDiv.insertAfter(insertAfter);
    }
  }
  static removeValidationError(textInput) {
    var _a;
    if (textInput.inputEl.hasClass("is-invalid") && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      textInput.inputEl.removeClass("is-invalid");
      textInput.inputEl.parentElement.removeChild(textInput.inputEl.parentElement.lastElementChild);
    }
    ;
  }
};

// src/fields/FieldManager.ts
var FieldManager2 = class {
  constructor(plugin, field, type) {
    this.plugin = plugin;
    this.field = field;
    this.type = type;
    this.showModalOption = true;
    if (field.type !== type)
      throw Error(`This field is not of type ${type}`);
  }
  static buildMarkDownLink(plugin, file, path, alias) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, alias);
    }
    return "";
  }
  validateName(textInput, insertAfter) {
    let error = false;
    if (/^[#>-]/.test(this.field.name)) {
      FieldSettingsModal.setValidationError(textInput, insertAfter, "Field name cannot start with #, >, -");
      error = true;
    }
    ;
    if (this.field.name == "") {
      FieldSettingsModal.setValidationError(textInput, insertAfter, "Field name can not be Empty");
      error = true;
    }
    ;
    return !error;
  }
  validateValue(value) {
    return true;
  }
  static replaceValues(plugin, path, fieldName, value) {
    return __async(this, null, function* () {
      const file = plugin.app.vault.getAbstractFileByPath(path);
      if (file instanceof import_obsidian9.TFile && file.extension == "md") {
        yield plugin.fileTaskManager.pushTask(() => {
          replaceValues(plugin, file, fieldName, value);
        });
      }
    });
  }
  static isMenu(location) {
    return location.addItem !== void 0;
  }
  static isSuggest(location) {
    return location.getItems !== void 0;
  }
  static isInsertFieldCommand(location) {
    return location === "InsertFieldCommand";
  }
  static isFieldOptions(location) {
    return location.addOption !== void 0;
  }
  static createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after, asList, asComment) {
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
    } else {
      const fieldManager = FieldManager2.createDefault(plugin, fieldName);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
    }
  }
  static openFieldModal(plugin, file, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    var _a;
    if (!fieldName) {
      const modal = new InsertFieldSuggestModal(plugin, file, lineNumber, inFrontmatter, after);
      modal.open();
    } else {
      const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
      if (field)
        this.createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after, asList, asComment);
    }
  }
  static createDefault(plugin, name) {
    const field = Field_default.createDefault(name);
    return new FieldManager[field.type](plugin, field);
  }
  static stringToBoolean(value) {
    let toBooleanValue = false;
    if (isBoolean(value)) {
      toBooleanValue = value;
    } else if (/true/i.test(value) || /1/.test(value)) {
      toBooleanValue = true;
    } else if (/false/i.test(value) || /0/.test(value)) {
      toBooleanValue = false;
    }
    ;
    return toBooleanValue;
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let valueText;
    if (dvApi) {
      switch (dvApi.page(file.path)[fieldName]) {
        case void 0:
          valueText = "";
          break;
        case null:
          valueText = "";
          break;
        case false:
          valueText = "false";
          break;
        case 0:
          valueText = "0";
          break;
        default:
          valueText = dvApi.page(file.path)[fieldName];
      }
    } else {
      valueText = "";
    }
    container.createDiv({ text: valueText });
  }
};

// src/fields/fieldManagers/InputField.ts
var InputField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Input" /* Input */);
  }
  getOptionsStr() {
    return this.field.options.template;
  }
  addFieldOption(name, value, file, location) {
    const modal = new InputModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    const iconName = FieldIcon["Input" /* Input */];
    const action = () => modal.open();
    if (InputField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (InputField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: iconName
      });
    } else if (InputField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Input" /* Input */], action, `Update ${name}'s value`);
    }
  }
  createSettingContainer(parentContainer, plugin) {
    const templateContainer = parentContainer.createDiv();
    templateContainer.createEl("span", { text: "Template", cls: "metadata-menu-field-option" });
    const templateValue = new import_obsidian10.TextAreaComponent(templateContainer);
    templateValue.inputEl.cols = 50;
    templateValue.inputEl.rows = 4;
    templateValue.setValue(this.field.options.template || "");
    templateValue.onChange((value) => {
      this.field.options.template = value;
    });
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new InputModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const inputContainer = document.createElement("div");
    const input = document.createElement("input");
    input.setAttr("class", "metadata-menu-dv-input");
    inputContainer.appendChild(input);
    input.value = p[this.field.name];
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const button = document.createElement("button");
    (0, import_obsidian10.setIcon)(button, FieldIcon["Input" /* Input */]);
    button.setAttr("class", "metadata-menu-dv-field-button");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      button.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        button.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        button.hide();
        spacer.show();
      };
    }
    const validateIcon = document.createElement("button");
    (0, import_obsidian10.setIcon)(validateIcon, "checkmark");
    validateIcon.setAttr("class", "metadata-menu-dv-field-button");
    validateIcon.onclick = (e) => {
      InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
      fieldContainer.removeChild(inputContainer);
    };
    inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
    const cancelIcon = document.createElement("button");
    cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
    (0, import_obsidian10.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(button);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(spacer);
    };
    inputContainer.appendChild(cancelIcon);
    input.focus();
    input.onkeydown = (e) => {
      if (e.key === "Enter") {
        InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
        fieldContainer.removeChild(inputContainer);
      }
      if (e.key === "Escape") {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(button);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(spacer);
      }
    };
    button.onclick = (e) => {
      if (this.field.options.template) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian10.TFile && file.extension === "md") {
          const inputModal = new InputModal(this.plugin, file, this.field, p[this.field.name]);
          inputModal.open();
        }
      } else {
        fieldContainer.removeChild(fieldValue);
        fieldContainer.removeChild(button);
        fieldContainer.removeChild(spacer);
        fieldContainer.appendChild(inputContainer);
        input.focus();
      }
    };
    fieldContainer.appendChild(button);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(spacer);
  }
};

// src/modals/fields/BooleanModal.ts
var import_obsidian11 = require("obsidian");
var BooleanModal = class extends import_obsidian11.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.field = field;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({
      cls: "metadata-menu-toggler"
    });
    this.buildToggleEl(inputDiv);
  }
  buildToggleEl(inputDiv) {
    const toggleEl = new import_obsidian11.ToggleComponent(inputDiv);
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian11.ButtonComponent(footer);
    toggleEl.setValue(this.value);
    toggleEl.onChange((value) => {
      this.value = value;
      saveButton.buttonEl.focus();
    });
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, value);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, value, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    }));
  }
};

// src/fields/fieldManagers/BooleanField.ts
var BooleanField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Boolean" /* Boolean */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    const bValue = BooleanField.stringToBoolean(value);
    const iconName = FieldIcon["Boolean" /* Boolean */];
    const action = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, (!bValue).toString());
      });
    });
    if (BooleanField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`<${name}> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (BooleanField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span><b>${name}</b> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}</span>`,
        action,
        icon: iconName
      });
    } else if (BooleanField.isFieldOptions(location)) {
      location.addOption(bValue ? "x-square" : "check-square", action, bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705");
    }
    ;
  }
  getOptionsStr() {
    return "";
  }
  createSettingContainer(parentContainer, plugin) {
  }
  validateValue(value) {
    try {
      const bValue = BooleanField.stringToBoolean(value);
      return isBoolean(bValue);
    } catch (error) {
      return false;
    }
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const bValue = BooleanField.stringToBoolean(value || "false");
    const fieldModal = new BooleanModal(this.plugin, file, this.field, bValue, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Set value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
    checkbox.checked = p[this.field.name];
    fieldContainer.appendChild(checkbox);
    checkbox.onchange = (value) => {
      BooleanField.replaceValues(this.plugin, p.file.path, this.field.name, checkbox.checked.toString());
    };
  }
};

// src/fields/fieldManagers/NumberField.ts
var import_obsidian13 = require("obsidian");

// src/modals/fields/NumberModal.ts
var import_obsidian12 = require("obsidian");
var NumberModal = class extends import_obsidian12.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv();
    this.buildInputEl(inputDiv);
  }
  decrement(inputEl) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      inputEl.setValue((parseFloat(inputEl.getValue()) - fStep).toString());
    } else {
      inputEl.setValue((parseFloat(inputEl.getValue()) - 1).toString());
    }
  }
  increment(inputEl) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      inputEl.setValue((parseFloat(inputEl.getValue()) + fStep).toString());
    } else {
      inputEl.setValue((parseFloat(inputEl.getValue()) + 1).toString());
    }
  }
  toggleButtonsState(minusBtn, plusBtn, inputEl) {
    minusBtn.setDisabled(!this.fieldManager.canDecrement(inputEl.getValue()));
    plusBtn.setDisabled(!this.fieldManager.canIncrement(inputEl.getValue()));
    if (this.fieldManager.canDecrement(inputEl.getValue())) {
      minusBtn.setCta();
    } else {
      minusBtn.removeCta();
    }
    if (this.fieldManager.canIncrement(inputEl.getValue())) {
      plusBtn.setCta();
    } else {
      plusBtn.removeCta();
    }
  }
  buildInputEl(inputDiv) {
    const { step } = this.field.options;
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const fieldContainer = form.createEl("div", { cls: "metadata-menu-modal-value-with-btn" });
    const inputEl = new import_obsidian12.TextComponent(fieldContainer);
    inputEl.inputEl.focus();
    inputEl.setValue(`${this.value}`);
    const minusBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    minusBtn.setButtonText(`- ${!!step ? step : 1}`);
    minusBtn.setDisabled(!this.fieldManager.canDecrement(inputEl.getValue()));
    const plusBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    plusBtn.setButtonText(`+ ${!!step ? step : 1}`);
    plusBtn.setDisabled(!this.fieldManager.canIncrement(inputEl.getValue()));
    const errorField = form.createEl("div", { cls: "metadata-menu-modal-value-with-btn-error-field" });
    errorField.hide();
    const footer = form.createEl("div", { cls: "metadata-menu-value-grid-footer" });
    const validateBtn = new import_obsidian12.ButtonComponent(footer);
    validateBtn.setIcon("checkmark");
    const cancelBtn = new import_obsidian12.ButtonComponent(footer);
    cancelBtn.setIcon("cross");
    this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    inputEl.onChange(() => {
      inputEl.inputEl.removeClass("is-invalid");
      errorField.hide();
      errorField.setText("");
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    plusBtn.onClick((e) => {
      e.preventDefault();
      this.increment(inputEl);
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    minusBtn.onClick((e) => {
      e.preventDefault();
      this.decrement(inputEl);
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    cancelBtn.onClick((e) => {
      e.preventDefault();
      this.close();
    });
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (!this.fieldManager.validateValue(inputValue)) {
        const { min: min2, max: max2 } = this.field.options;
        errorField.show();
        errorField.setText(`value must be numeric${min2 ? " and >= " + min2 : ""} ${max2 ? " and <= " + max2 : ""}`);
        inputEl.inputEl.setAttr("class", "is-invalid");
        return;
      }
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    });
  }
};

// src/fields/fieldManagers/NumberField.ts
var NumberField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Number" /* Number */);
  }
  getOptionsStr() {
    const options = [];
    Object.keys(this.field.options).forEach((k) => {
      if (this.field.options[k])
        options.push(`${k}: ${this.field.options[k]}`);
    });
    return options.join(" | ");
  }
  canDecrement(value) {
    const { step, min: min2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMin = parseFloat(min2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMin) && (!isNaN(fStep) && (parseFloat(value) - fStep < fMin || parseFloat(value) - 1 < fMin)));
  }
  canIncrement(value) {
    const { step, max: max2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMax = parseFloat(max2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMax) && (!isNaN(fStep) && (parseFloat(value) + fStep > fMax || parseFloat(value) + 1 > fMax)));
  }
  validateValue(value) {
    const { min: min2, max: max2 } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fValue = parseFloat(value);
    return !isNaN(fValue) && (isNaN(fMin) || fValue >= fMin) && (isNaN(fMax) || fValue <= fMax);
  }
  addFieldOption(name, value, file, location) {
    const modal = new NumberModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    const { min: min2, max: max2, step } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fStep = parseFloat(step);
    const fValue = parseFloat(value);
    const canDecrease = !isNaN(fMin) && fValue - fStep >= fMin;
    const canIncrease = !isNaN(fMax) && fValue + fStep <= fMax;
    const action = () => modal.open();
    const decrease = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, (fValue - fStep).toString());
      });
    });
    const increase = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, (fValue + fStep).toString());
      });
    });
    if (NumberField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Number" /* Number */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
      if (fStep) {
        if (canDecrease)
          location.addItem((item) => {
            item.setIcon("minus-square");
            item.setTitle(`<${name}> \u2198\uFE0F ${fValue - fStep}`);
            item.onClick(decrease);
            item.setSection("metadata-menu.fields");
          });
        if (canIncrease)
          location.addItem((item) => {
            item.setIcon("plus-square");
            item.setTitle(`<${name}> \u2197\uFE0F ${fValue + fStep}`);
            item.onClick(increase);
            item.setSection("metadata-menu.fields");
          });
      }
    } else if (NumberField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Number" /* Number */]
      });
    } else if (NumberField.isFieldOptions(location)) {
      if (step) {
        if (canDecrease) {
          location.addOption("minus-square", decrease, `Decrease ${name} by ${step}`);
        }
        if (canIncrease) {
          location.addOption("plus-square", increase, `Increase ${name} by ${step}`);
        }
      }
      location.addOption(FieldIcon["Number" /* Number */], action, `Update ${name}'s value`);
    }
    ;
  }
  createNumberContainer(parentContainer) {
    const numberStepValueContainer = parentContainer.createDiv();
    numberStepValueContainer.createEl("span", { text: "Step (optional)", cls: "metadata-menu-field-option" });
    this.numberStepValue = new import_obsidian13.TextComponent(numberStepValueContainer);
    this.numberStepValue.setValue(this.field.options.step || "");
    const numberMinValueContainer = parentContainer.createDiv();
    numberMinValueContainer.createEl("span", { text: "Min value (optional)", cls: "metadata-menu-field-option" });
    this.numberMinValue = new import_obsidian13.TextComponent(numberMinValueContainer);
    this.numberMinValue.setValue(this.field.options.min || "");
    const numberMaxValueContainer = parentContainer.createDiv();
    numberMaxValueContainer.createEl("span", { text: "Max value (optional)", cls: "metadata-menu-field-option" });
    this.numberMaxValue = new import_obsidian13.TextComponent(numberMaxValueContainer);
    this.numberMaxValue.setValue(this.field.options.max || "");
    this.numberStepValue.onChange((value) => {
      this.field.options.step = value;
      FieldSettingsModal.removeValidationError(this.numberStepValue);
    });
    this.numberMinValue.onChange((value) => {
      this.field.options.min = value;
      FieldSettingsModal.removeValidationError(this.numberMinValue);
    });
    this.numberMaxValue.onChange((value) => {
      this.field.options.max = value;
      FieldSettingsModal.removeValidationError(this.numberMaxValue);
    });
  }
  createSettingContainer(parentContainer, plugin) {
    this.numberValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createNumberContainer(this.numberValidatorField);
    this.numberValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  validateOptions() {
    let error = false;
    if (this.field.options.step && isNaN(parseFloat(this.field.options.step))) {
      FieldSettingsModal.setValidationError(this.numberStepValue, this.numberStepValue.inputEl, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.min && isNaN(parseFloat(this.field.options.min))) {
      FieldSettingsModal.setValidationError(this.numberMinValue, this.numberMinValue.inputEl, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.max && isNaN(parseFloat(this.field.options.max))) {
      FieldSettingsModal.setValidationError(this.numberMaxValue, this.numberMaxValue.inputEl, "Values must be numeric.");
      error = true;
    }
    return !error;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new NumberModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  toggleDvButtons(decrementBtn, incrementBtn, value) {
    if (this.canDecrement(value)) {
      decrementBtn.removeClass("disabled");
    } else {
      decrementBtn.addClass("disabled");
    }
    if (this.canIncrement(value)) {
      incrementBtn.removeClass("disabled");
    } else {
      incrementBtn.addClass("disabled");
      ;
    }
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const inputContainer = document.createElement("div");
    const input = document.createElement("input");
    input.setAttr("class", "metadata-menu-dv-input");
    inputContainer.appendChild(input);
    input.value = p[this.field.name];
    const tripleSpacer = document.createElement("div");
    tripleSpacer.setAttr("class", "metadata-menu-dv-field-triple-spacer");
    const editButton = document.createElement("button");
    (0, import_obsidian13.setIcon)(editButton, FieldIcon["Number" /* Number */]);
    editButton.setAttr("class", "metadata-menu-dv-field-button");
    const decrementButton = document.createElement("button");
    (0, import_obsidian13.setIcon)(decrementButton, "left-arrow");
    decrementButton.setAttr("class", "metadata-menu-dv-field-button");
    const incrementButton = document.createElement("button");
    (0, import_obsidian13.setIcon)(incrementButton, "right-arrow");
    incrementButton.setAttr("class", "metadata-menu-dv-field-button");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      editButton.hide();
      decrementButton.hide();
      incrementButton.hide();
      tripleSpacer.show();
      fieldContainer.onmouseover = () => {
        editButton.show();
        decrementButton.show();
        incrementButton.show();
        tripleSpacer.hide();
      };
      fieldContainer.onmouseout = () => {
        editButton.hide();
        decrementButton.hide();
        incrementButton.hide();
        tripleSpacer.show();
      };
    }
    const validateIcon = document.createElement("a");
    (0, import_obsidian13.setIcon)(validateIcon, "checkmark");
    validateIcon.setAttr("class", "metadata-menu-dv-field-button");
    validateIcon.onclick = () => __async(this, null, function* () {
      if (this.validateValue(input.value)) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, input.value);
          });
          this.toggleDvButtons(decrementButton, incrementButton, input.value);
        }
        fieldContainer.removeChild(inputContainer);
      }
    });
    inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
    const cancelIcon = document.createElement("a");
    cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
    (0, import_obsidian13.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(decrementButton);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(editButton);
      fieldContainer.appendChild(incrementButton);
      fieldContainer.appendChild(tripleSpacer);
    };
    inputContainer.appendChild(cancelIcon);
    input.focus();
    input.onkeyup = (e) => {
      if (!this.validateValue(input.value)) {
        input.addClass("is-invalid");
        validateIcon.addClass("disabled");
      } else {
        input.removeClass("is-invalid");
        validateIcon.removeClass("disabled");
      }
    };
    input.onkeydown = (e) => __async(this, null, function* () {
      if (e.key === "Enter") {
        if (this.validateValue(input.value)) {
          const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
          if (file instanceof import_obsidian13.TFile && file.extension == "md") {
            yield this.plugin.fileTaskManager.pushTask(() => {
              replaceValues(this.plugin, file, this.field.name, input.value);
            });
            this.toggleDvButtons(decrementButton, incrementButton, input.value);
          }
          fieldContainer.removeChild(inputContainer);
        }
      }
      if (e.key === "Escape") {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(decrementButton);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(editButton);
        fieldContainer.appendChild(incrementButton);
        fieldContainer.appendChild(tripleSpacer);
      }
    });
    editButton.onclick = () => {
      fieldContainer.removeChild(fieldValue);
      fieldContainer.removeChild(editButton);
      fieldContainer.removeChild(decrementButton);
      fieldContainer.removeChild(incrementButton);
      fieldContainer.removeChild(tripleSpacer);
      fieldContainer.appendChild(inputContainer);
      input.focus();
    };
    decrementButton.onclick = () => __async(this, null, function* () {
      if (this.canDecrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] - fStep : p[this.field.name] - 1).toString();
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, newValue);
          });
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    incrementButton.onclick = () => __async(this, null, function* () {
      if (this.canIncrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] + fStep : p[this.field.name] + 1).toString();
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, newValue);
          });
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    fieldContainer.appendChild(decrementButton);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(editButton);
    fieldContainer.appendChild(incrementButton);
    fieldContainer.appendChild(tripleSpacer);
    this.toggleDvButtons(decrementButton, incrementButton, p[this.field.name]);
  }
};

// src/fields/fieldManagers/SelectField.ts
var import_obsidian19 = require("obsidian");

// src/modals/fields/SelectModal.ts
var import_obsidian14 = require("obsidian");

// src/types/selectValuesSourceTypes.ts
var Type2 = /* @__PURE__ */ ((Type3) => {
  Type3["ValuesList"] = "ValuesList";
  Type3["ValuesListNotePath"] = "ValuesListNotePath";
  Type3["ValuesFromDVQuery"] = "ValuesFromDVQuery";
  return Type3;
})(Type2 || {});
var Key = {
  "ValuesList": "valuesList",
  "ValuesListNotePath": "valuesListNotePath",
  "ValuesFromDVQuery": "valuesFromDVQuery"
};
var typeDisplay = {
  "ValuesList": "Values defined in these settings",
  "ValuesListNotePath": "Values from a note",
  "ValuesFromDVQuery": "Values returned from a dataview query"
};

// src/modals/fields/SelectModal.ts
var ValueSuggestModal = class extends import_obsidian14.SuggestModal {
  constructor(plugin, file, value, field, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(ValueSuggestModal.prototype, this, "onOpen").call(this);
      const inputContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-input-container" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-actions" });
      buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-actions-spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-info" });
      infoContainer.setText("Shift+Enter to save");
      this.addButton = new import_obsidian14.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => this.addNewValueToSettings());
      this.addButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      const cancelButton = new import_obsidian14.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
      cancelButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      cancelButton.setTooltip("Cancel");
      const clearButton = new import_obsidian14.ButtonComponent(buttonContainer);
      clearButton.setIcon("eraser");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      clearButton.buttonEl.addClass("danger");
      clearButton.setTooltip("Clear the field value");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      var _a, _b;
      const newValue = this.inputEl.value;
      const fileClassName = (_b = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field) => field.name === this.field.name)) == null ? void 0 : _b.fileClassName;
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian14.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian14.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.saveItem(newValue);
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    if (value === this.value)
      el.addClass("metadata-menu-value-selected");
  }
  saveItem(item) {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, item.toString());
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, item.toString(), this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  onChooseSuggestion(item, evt) {
    return __async(this, null, function* () {
      this.saveItem(item);
    });
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var import_obsidian18 = require("obsidian");

// src/suggester/FileSuggester.ts
var import_obsidian17 = require("obsidian");

// src/suggester/suggest.ts
var import_obsidian15 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  var rect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (isHTMLElement(element) && includeScale) {
    var offsetHeight = element.offsetHeight;
    var offsetWidth = element.offsetWidth;
    if (offsetWidth > 0) {
      scaleX = round(rect.width) / offsetWidth || 1;
    }
    if (offsetHeight > 0) {
      scaleY = round(rect.height) / offsetHeight || 1;
    }
  }
  return {
    width: rect.width / scaleX,
    height: rect.height / scaleY,
    top: rect.top / scaleY,
    right: rect.right / scaleX,
    bottom: rect.bottom / scaleY,
    left: rect.left / scaleX,
    x: rect.left / scaleX,
    y: rect.top / scaleY
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : element.document) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return element.assignedSlot || element.parentNode || (isShadowRoot(element) ? element.host : null) || getDocumentElement(element);
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || getComputedStyle(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = navigator.userAgent.toLowerCase().indexOf("firefox") !== -1;
  var isIE = navigator.userAgent.indexOf("Trident") !== -1;
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options = _ref2.options;
  var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (true) {
    if (!isHTMLElement(arrowElement)) {
      console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', "To use an SVG arrow, wrap it in an HTMLElement that will be used as", "the arrow."].join(" "));
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    if (true) {
      console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', "element."].join(" "));
    }
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref) {
  var x = _ref.x, y = _ref.y;
  var win = window;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : offsetParent[heightProp];
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : offsetParent[widthProp];
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  if (true) {
    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || "";
    if (adaptive && ["transform", "top", "right", "bottom", "left"].some(function(property) {
      return transitionProperty.indexOf(property) >= 0;
    })) {
      console.warn(["Popper: Detected CSS transitions on at least one of the following", 'CSS properties: "transform", "top", "right", "bottom", "left".', "\n\n", 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', "for smooth transitions, or remove these properties from the CSS", "transition declaration on the popper element if only transitioning", "opacity or background-color for example.", "\n\n", "We recommend using the popper element as a wrapper around an inner", "element that can have any CSS property transitioned for animations."].join(" "));
    }
  }
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options = _ref.options;
  var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : updatedList.concat(listScrollParents(getParentNode(target)));
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element) {
  var rect = getBoundingClientRect(element);
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
    if (true) {
      console.error(["Popper: The `allowedAutoPlacements` option did not allow any", "placements. Ensure the `placement` option matches the variation", "of the allowed placements.", 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(" "));
    }
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options = _ref2.options, name = _ref2.name;
  var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/format.js
function format(str) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }
  return [].concat(args).reduce(function(p, c) {
    return p.replace(/%s/, c);
  }, str);
}

// node_modules/@popperjs/core/lib/utils/validateModifiers.js
var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
var VALID_PROPERTIES = ["name", "enabled", "phase", "fn", "effect", "requires", "options"];
function validateModifiers(modifiers) {
  modifiers.forEach(function(modifier) {
    [].concat(Object.keys(modifier), VALID_PROPERTIES).filter(function(value, index, self) {
      return self.indexOf(value) === index;
    }).forEach(function(key) {
      switch (key) {
        case "name":
          if (typeof modifier.name !== "string") {
            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', '"' + String(modifier.name) + '"'));
          }
          break;
        case "enabled":
          if (typeof modifier.enabled !== "boolean") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', '"' + String(modifier.enabled) + '"'));
          }
          break;
        case "phase":
          if (modifierPhases.indexOf(modifier.phase) < 0) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(", "), '"' + String(modifier.phase) + '"'));
          }
          break;
        case "fn":
          if (typeof modifier.fn !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "effect":
          if (modifier.effect != null && typeof modifier.effect !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "requires":
          if (modifier.requires != null && !Array.isArray(modifier.requires)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', '"' + String(modifier.requires) + '"'));
          }
          break;
        case "requiresIfExists":
          if (!Array.isArray(modifier.requiresIfExists)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', '"' + String(modifier.requiresIfExists) + '"'));
          }
          break;
        case "options":
        case "data":
          break;
        default:
          console.error('PopperJS: an invalid property has been provided to the "' + modifier.name + '" modifier, valid properties are ' + VALID_PROPERTIES.map(function(s) {
            return '"' + s + '"';
          }).join(", ") + '; but "' + key + '" was provided.');
      }
      modifier.requires && modifier.requires.forEach(function(requirement) {
        if (modifiers.find(function(mod) {
          return mod.name === requirement;
        }) == null) {
          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
        }
      });
    });
  });
}

// node_modules/@popperjs/core/lib/utils/uniqueBy.js
function uniqueBy(arr, fn2) {
  var identifiers = /* @__PURE__ */ new Set();
  return arr.filter(function(item) {
    var identifier = fn2(item);
    if (!identifiers.has(identifier)) {
      identifiers.add(identifier);
      return true;
    }
  });
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var INVALID_ELEMENT_ERROR = "Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.";
var INFINITE_LOOP_ERROR = "Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.";
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options) {
    if (options === void 0) {
      options = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options2 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options2);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        if (true) {
          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function(_ref) {
            var name = _ref.name;
            return name;
          });
          validateModifiers(modifiers);
          if (getBasePlacement(state.options.placement) === auto) {
            var flipModifier = state.orderedModifiers.find(function(_ref2) {
              var name = _ref2.name;
              return name === "flip";
            });
            if (!flipModifier) {
              console.error(['Popper: "auto" placements require the "flip" modifier be', "present and enabled to work."].join(" "));
            }
          }
          var _getComputedStyle = getComputedStyle(popper2), marginTop = _getComputedStyle.marginTop, marginRight = _getComputedStyle.marginRight, marginBottom = _getComputedStyle.marginBottom, marginLeft = _getComputedStyle.marginLeft;
          if ([marginTop, marginRight, marginBottom, marginLeft].some(function(margin) {
            return parseFloat(margin);
          })) {
            console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', "between the popper and its reference element or boundary.", "To replicate margin, use the `offset` modifier, as well as", "the `padding` option in the `preventOverflow` and `flip`", "modifiers."].join(" "));
          }
        }
        runModifierEffects();
        return instance.update();
      },
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          if (true) {
            console.error(INVALID_ELEMENT_ERROR);
          }
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        var __debug_loops__ = 0;
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (true) {
            __debug_loops__ += 1;
            if (__debug_loops__ > 100) {
              console.error(INFINITE_LOOP_ERROR);
              break;
            }
          }
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      if (true) {
        console.error(INVALID_ELEMENT_ERROR);
      }
      return instance;
    }
    instance.setOptions(options).then(function(state2) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref3) {
        var name = _ref3.name, _ref3$options = _ref3.options, options2 = _ref3$options === void 0 ? {} : _ref3$options, effect4 = _ref3.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options2
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggester/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on("click", ".suggestion-item", this.onSuggestionClick.bind(this));
    containerEl.on("mousemove", ".suggestion-item", this.onSuggestionMouseover.bind(this));
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(selectedIndex, this.suggestions.length);
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(inputEl) {
    this.inputEl = inputEl;
    this.scope = new import_obsidian15.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on("mousedown", ".suggestion-container", (event) => {
      event.preventDefault();
    });
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/utils/fileUtils.ts
var import_obsidian16 = require("obsidian");
function resolve_tfolder(plugin, folder_str) {
  folder_str = (0, import_obsidian16.normalizePath)(folder_str);
  const folder = plugin.app.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new Error(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian16.TFolder)) {
    throw new Error(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function get_tfiles_from_folder(plugin, folder_str) {
  const folder = resolve_tfolder(plugin, folder_str);
  const files = [];
  import_obsidian16.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian16.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.basename.localeCompare(b.basename);
  });
  return files;
}

// src/suggester/FileSuggester.ts
var FileSuggest = class extends TextInputSuggest {
  constructor(inputEl, plugin, folder) {
    super(inputEl);
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
    this.plugin = plugin;
  }
  getSuggestions(input_str) {
    const all_files = [];
    try {
      all_files.push(...get_tfiles_from_folder(this.plugin, this.folder));
    } catch (error) {
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian17.TFile && file.extension === "md" && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var AbstractListBasedField = class extends FieldManager2 {
  constructor(plugin, field, type) {
    super(plugin, field, type);
  }
  setValueListText(header) {
    header.setText(`Preset options: ${Object.values(this.field.options.valuesList).join(", ")}`);
  }
  createListNotePathContainer(parentNode, plugin) {
    const valuesListNotePathContainer = parentNode.createDiv({});
    const listNoteContainerLabel = valuesListNotePathContainer.createDiv({ cls: "metadata-menu-setting-fileClass-search" });
    listNoteContainerLabel.setText(`Path of the note containing the values:`);
    const input = new import_obsidian18.TextComponent(valuesListNotePathContainer);
    new FileSuggest(input.inputEl, plugin, "/");
    const listNotePath = this.field.options.valuesListNotePath;
    input.setValue(listNotePath || "");
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.field.options.valuesListNotePath = value);
    return valuesListNotePathContainer;
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.field.options.valuesList) {
      if (key !== _key) {
        newValues[_key] = this.field.options.valuesList[_key];
      }
      ;
    }
    ;
    this.field.options.valuesList = newValues;
  }
  createValuesListContainer(parentContainer) {
    const presetValuesFields = parentContainer.createDiv();
    const valuesList = presetValuesFields.createDiv();
    const valuesListHeader = valuesList.createDiv({ cls: "metadata-menu-field-option" });
    valuesListHeader.createEl("h2");
    valuesListHeader.setText(`Preset options: ${Object.values(this.field.options.valuesList).join(", ")}`);
    const valuesListBody = valuesList.createDiv();
    Object.keys(this.field.options.valuesList).forEach((key) => {
      this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, valuesListHeader, key));
    });
    this.createAddButton(valuesList, valuesListBody, valuesListHeader);
    return presetValuesFields;
  }
  createValueContainer(parentNode, header, key) {
    const values = this.field.options.valuesList || {};
    const presetValue = values[key];
    const valueContainer = parentNode.createDiv({
      cls: "metadata-menu-prompt-container"
    });
    const input = new import_obsidian18.TextComponent(valueContainer);
    this.valuesPromptComponents.push(input);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.field.options.valuesList[key] = value;
      this.setValueListText(header);
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian18.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      this.setValueListText(header);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.field.options)[0]) {
      const valueUpgradeButton = new import_obsidian18.ButtonComponent(valueContainer);
      (0, import_obsidian18.setIcon)(valueUpgradeButton.buttonEl, "up-chevron-glyph");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = values[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(values).filter((k) => values[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            values[upperKey] = thisValue;
            input.setValue(upperValue);
            values[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  validateValue(value) {
    return true;
  }
  getOptionsStr() {
    switch (this.field.options.sourceType) {
      case "ValuesList" /* ValuesList */:
        return Object.values(this.field.options.valuesList).join(", ");
      case "ValuesListNotePath" /* ValuesListNotePath */:
        return this.field.options.valuesListNotePath;
      case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
        return this.field.options.valuesFromDVQuery;
      default:
        return "";
    }
  }
  getOptionsList(dvFile = void 0) {
    var _a;
    let values = [];
    if (Array.isArray(this.field.options)) {
      values = this.field.options;
    } else if (!this.field.options.sourceType) {
      values = Object.values(this.field.options);
    } else {
      switch (this.field.options.sourceType) {
        case "ValuesList" /* ValuesList */:
          values = Object.values(this.field.options.valuesList);
          break;
        case "ValuesListNotePath" /* ValuesListNotePath */:
          values = this.plugin.fieldIndex.valuesListNotePathValues.get(this.field.options.valuesListNotePath) || [];
          break;
        case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
          {
            const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
            if (dvApi) {
              values = new Function("dv", "current", `return ${this.field.options.valuesFromDVQuery}`)(dvApi, dvFile);
            } else {
              values = [];
            }
          }
          break;
        default:
          values = [];
          break;
      }
    }
    return values;
  }
  validateOptions() {
    let error = false;
    this.valuesPromptComponents.forEach((input) => {
      var _a, _b;
      if (/[,]/gu.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot contain a comma");
        error = true;
      }
      ;
      if (input.inputEl.value == "" && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values can't be null.");
        error = true;
      }
      ;
    });
    return !error;
  }
  createAddButton(valuesList, valuesListBody, valuesListHeader) {
    const valuesListFooter = valuesList.createDiv();
    const addValue = valuesListFooter.createEl("button");
    addValue.type = "button";
    addValue.textContent = "Add";
    addValue.onClickEvent((evt) => __async(this, null, function* () {
      evt.preventDefault;
      let newKeyNumber = 1;
      Object.keys(this.field.options.valuesList).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKeyNumber) {
          newKeyNumber = parseInt(key) + 1;
        }
        ;
      });
      const newKey = newKeyNumber.toString();
      this.field.options.valuesList[newKey] = "";
      this.createValueContainer(valuesListBody, valuesListHeader, newKey);
    }));
    valuesList.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  createValuesFromDVQueryContainer(parentContainer) {
    const valuesFromDVQueryContainer = parentContainer.createDiv({});
    valuesFromDVQueryContainer.createEl("span", { text: "Dataview function", cls: "metadata-menu-field-option" });
    valuesFromDVQueryContainer.createEl("span", { text: "Dataview query returning a list of string (<dv> object is available)", cls: "metadata-menu-field-option-subtext" });
    const valuesFromDVQuery = new import_obsidian18.TextAreaComponent(valuesFromDVQueryContainer);
    valuesFromDVQuery.inputEl.cols = 65;
    valuesFromDVQuery.inputEl.rows = 8;
    valuesFromDVQuery.setPlaceholder("ex: dv.pages('#student').map(p => p.name)");
    valuesFromDVQuery.setValue(this.field.options.valuesFromDVQuery || "");
    valuesFromDVQuery.onChange((value) => {
      this.field.options.valuesFromDVQuery = value;
    });
    return valuesFromDVQueryContainer;
  }
  displaySelectedTypeContainer(optionContainers, value) {
    Object.keys(optionContainers).forEach((key) => {
      if (key === value) {
        optionContainers[key].show();
      } else {
        optionContainers[key].hide();
      }
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    const sourceTypeContainer = parentContainer.createDiv();
    sourceTypeContainer.createDiv({ text: "Select the source of values for this field", cls: "metadata-menu-field-option" });
    const sourceType = new import_obsidian18.DropdownComponent(sourceTypeContainer);
    if (!this.field.options.sourceType) {
      if (typeof this.field.options === "object" && Object.keys(this.field.options).every((key) => !isNaN(parseInt(key)))) {
        const valuesList = {};
        Object.keys(this.field.options).forEach((key) => valuesList[key] = this.field.options[key]);
        this.field.options = {};
        this.field.options.valuesList = valuesList;
      } else {
        this.field.options = {};
      }
      this.field.options.sourceType = "ValuesList" /* ValuesList */;
      this.field.options.valuesListNotePath = "";
      this.field.options.valuesFromDVQuery = "";
    }
    Object.keys(Type2).forEach((option) => sourceType.addOption(option, typeDisplay[option]));
    sourceType.setValue(this.field.options.sourceType || "ValuesList" /* ValuesList */);
    const valuesListNotePathContainer = this.createListNotePathContainer(parentContainer, plugin);
    const presetValuesFieldsContainer = this.createValuesListContainer(parentContainer);
    const valuesFromDVQueryContainer = this.createValuesFromDVQueryContainer(parentContainer);
    const valuesContainers = {
      "ValuesList": presetValuesFieldsContainer,
      "ValuesListNotePath": valuesListNotePathContainer,
      "ValuesFromDVQuery": valuesFromDVQueryContainer
    };
    sourceType.onChange((value) => {
      this.field.options.sourceType = value;
      this.displaySelectedTypeContainer(valuesContainers, value);
    });
    this.displaySelectedTypeContainer(valuesContainers, this.field.options.sourceType);
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const fieldValue = dv.el("span", p[this.field.name]);
    fieldContainer.appendChild(fieldValue);
  }
};

// src/fields/fieldManagers/SelectField.ts
var SelectField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Select" /* Select */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new ValueSuggestModal(this.plugin, file, value, this.field);
    modal.titleEl.setText("Select value");
    const action = () => modal.open();
    if (SelectField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["Select" /* Select */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (SelectField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Select" /* Select */]
      });
    } else if (SelectField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Multi" /* Multi */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const valueContainer = document.createElement("div");
    ;
    const valueLabel = dv.el("span", p[this.field.name] || "");
    valueContainer.appendChild(valueLabel);
    const dropDownButton = document.createElement("button");
    (0, import_obsidian19.setIcon)(dropDownButton, "down-chevron-glyph");
    dropDownButton.addClass("metadata-menu-dv-field-button");
    valueContainer.appendChild(dropDownButton);
    const selectContainer = document.createElement("div");
    const select = document.createElement("select");
    select.setAttr("class", "metadata-menu-dv-select");
    selectContainer.appendChild(select);
    const dismissBtn = document.createElement("button");
    (0, import_obsidian19.setIcon)(dismissBtn, "cross");
    dismissBtn.addClass("metadata-menu-dv-field-button");
    selectContainer.appendChild(dismissBtn);
    const nullOption = new Option("--select--", void 0);
    select.add(nullOption);
    const values = this.getOptionsList();
    values.forEach((v) => {
      const value = new Option(v, v);
      if (p[this.field.name] === v || p[this.field.name] && Object.keys(p[this.field.name]).includes("path") && `[[${p[this.field.name].path.replace(".md", "")}]]` === v) {
        value.selected = true;
      }
      select.add(value);
      select.onchange = () => __async(this, null, function* () {
        let newValue = "";
        if (select.value !== void 0) {
          newValue = select.value;
        }
        fieldContainer.removeChild(selectContainer);
        fieldContainer.appendChild(valueContainer);
        SelectField.replaceValues(this.plugin, p.file.path, this.field.name, newValue);
      });
    });
    dropDownButton.onclick = () => {
      fieldContainer.removeChild(valueContainer);
      fieldContainer.appendChild(selectContainer);
    };
    dismissBtn.onclick = () => {
      fieldContainer.removeChild(selectContainer);
      fieldContainer.appendChild(valueContainer);
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      fieldContainer.appendChild(valueContainer);
    } else {
      fieldContainer.appendChild(selectContainer);
    }
  }
};

// src/fields/fieldManagers/CycleField.ts
var import_obsidian20 = require("obsidian");
var CycleField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Cycle" /* Cycle */);
    this.valuesPromptComponents = [];
    this.showModalOption = false;
  }
  nextOption(value) {
    let nextOption;
    const values = this.getOptionsList();
    if (values.indexOf(value) === -1) {
      nextOption = values[0] || "";
    } else {
      nextOption = values[(values.indexOf(value) + 1) % values.length];
    }
    return nextOption;
  }
  getRawOptionFromDuration(duration2) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let matchedValue = void 0;
    if (dvApi && dvApi.value.isDuration(duration2)) {
      this.getOptionsList().forEach((option) => {
        const dvOption = dvApi.duration(option);
        if (Object.keys(duration2.values).every((j) => !duration2.values[j] && !dvOption.values[j] || duration2.values[j] === dvOption.values[j])) {
          matchedValue = option;
        }
      });
    }
    return matchedValue;
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let valueText;
    if (dvApi) {
      switch (dvApi.page(file.path)[fieldName]) {
        case void 0:
          valueText = "";
          break;
        case null:
          valueText = "";
          break;
        case false:
          valueText = "false";
          break;
        case 0:
          valueText = "0";
          break;
        default:
          valueText = dvApi.page(file.path)[fieldName];
      }
    } else {
      valueText = "";
    }
    container.createDiv({ text: this.getRawOptionFromDuration(valueText) || valueText });
  }
  addFieldOption(name, value, file, location) {
    let matchedValue = this.getRawOptionFromDuration(value) || value;
    const iconName = FieldIcon["Cycle" /* Cycle */];
    const action = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, this.nextOption(matchedValue).toString());
      });
    });
    if (CycleField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`${name} : ${matchedValue} \u25B7 ${this.nextOption(matchedValue)}`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (CycleField.isSuggest(location)) {
      location.options.push({
        id: `${name}_${matchedValue}_${this.nextOption(matchedValue)}`,
        actionLabel: `<span><b>${name}</b> : ${matchedValue} \u25B7 ${this.nextOption(matchedValue)}</span>`,
        action,
        icon: iconName
      });
    } else if (CycleField.isFieldOptions(location)) {
      location.addOption(iconName, action, `${matchedValue} \u25B7 ${this.nextOption(matchedValue)}`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const nextOption = this.nextOption(p[this.field.name]);
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const button = document.createElement("button");
    (0, import_obsidian20.setIcon)(button, FieldIcon["Cycle" /* Cycle */]);
    button.setAttr("class", "metadata-menu-dv-field-button");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      button.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        button.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        button.hide();
        spacer.show();
      };
    }
    button.onclick = (e) => {
      var _a2;
      CycleField.replaceValues(this.plugin, p.file.path, this.field.name, nextOption);
      if (!((_a2 = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a2.alwaysOn)) {
        button.hide();
        spacer.show();
      }
    };
    fieldContainer.appendChild(button);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(spacer);
  }
};

// src/fields/fieldManagers/MultiField.ts
var import_obsidian24 = require("obsidian");

// src/modals/fields/MultiSelectModal.ts
var import_obsidian23 = require("obsidian");

// src/fields/fieldManagers/FileField.ts
var import_obsidian22 = require("obsidian");

// src/modals/fields/SingleFileModal.ts
var import_obsidian21 = require("obsidian");
var FileFuzzySuggester = class extends import_obsidian21.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      if (dvApi.value.isLink(initialValueObject)) {
        const file2 = this.plugin.app.vault.getAbstractFileByPath(initialValueObject.path);
        if (file2 instanceof import_obsidian21.TFile)
          this.selectedFile = file2;
      }
    }
  }
  getItems() {
    const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
      return a.basename < b.basename ? -1 : 1;
    };
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file).sort(sortingMethod);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  renderSuggestion(value, el) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "metadata-menu-suggester-item-with-alias" });
      const label = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-label" });
      label.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path)));
      const filePath = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-filepath" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("metadata-menu-value-suggester-value-container");
    const spacer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-value-container-spacer" });
    el.appendChild(spacer);
    if (((_b = this.selectedFile) == null ? void 0 : _b.path) === value.item.path) {
      el.addClass("metadata-menu-value-selected");
      const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
      (0, import_obsidian21.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
      var _a;
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      let alias = void 0;
      if (dvApi && this.field.options.customRendering) {
        alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(item.path));
      }
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, FileField.buildMarkDownLink(this.plugin, this.file, item.basename, alias));
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, FileField.buildMarkDownLink(this.plugin, this.file, item.basename, alias), this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
};

// src/fields/fieldManagers/FileField.ts
var FileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "File" /* File */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian22.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  addFieldOption(name, value, file, location) {
    const modal = new FileFuzzySuggester(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select value");
    const action = () => modal.open();
    if (FileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (FileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["File" /* File */]
      });
    } else if (FileField.isFieldOptions(location)) {
      location.addOption(FieldIcon["File" /* File */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const value = dvApi.page(file.path)[fieldName];
      if (dvApi.value.isLink(value)) {
        const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
        link.onclick = () => {
          this.plugin.app.workspace.openLinkText(value.path, file.path, true);
          onClicked();
        };
      } else {
        container.createDiv({ text: value });
      }
    }
    container.createDiv();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const searchBtn = document.createElement("button");
    (0, import_obsidian22.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    searchBtn.addClass("metadata-menu-dv-field-button");
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian22.TFile && file.extension == "md") {
      fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(searchBtn);
    fieldContainer.appendChild(spacer);
  }
  createFileContainer(parentContainer) {
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Dataview Query (optional)", cls: "metadata-menu-field-option" });
    this.dvQueryString = new import_obsidian22.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingContainer = parentContainer.createDiv();
    customeRenderingContainer.createEl("span", { text: "Alias", cls: "metadata-menu-field-option" });
    customeRenderingContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "metadata-menu-field-option-subtext" });
    customeRenderingContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customRendering = new import_obsidian22.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
    const customSortingContainer = parentContainer.createDiv();
    customSortingContainer.createEl("span", { text: "Sorting order", cls: "metadata-menu-field-option" });
    customSortingContainer.createEl("span", { text: "Personalise the sorting order of your links with a instruction taking 2 files (a, b) and returning -1, 0 or 1", cls: "metadata-menu-field-option-subtext" });
    customSortingContainer.createEl("code", {
      text: `(a: TFile, b: TFile): number`
    });
    const customSorting = new import_obsidian22.TextAreaComponent(customSortingContainer);
    customSorting.inputEl.cols = 50;
    customSorting.inputEl.rows = 4;
    customSorting.setValue(this.field.options.customSorting || "");
    customSorting.setPlaceholder("Javascript instruction, (a: TFile, b: TFile): number\nexample 1 (alphabetical order): a.basename < b.basename ? 1 : -1 \nexample 2 (creation time newer to older): b.stat.ctime - b.stat.ctime");
    customSorting.onChange((value) => {
      this.field.options.customSorting = value;
      FieldSettingsModal.removeValidationError(customSorting);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.fileValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createFileContainer(this.fileValidatorField);
    this.fileValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    return true;
  }
};

// src/modals/fields/MultiSelectModal.ts
var MultiSuggestModal = class extends import_obsidian23.SuggestModal {
  constructor(plugin, file, field, initialOptions, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    if (initialOptions) {
      if (Array.isArray(initialOptions)) {
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        if (dvApi && initialOptions.some((o) => dvApi.value.isLink(o))) {
          this.selectedOptions = initialOptions.map((item) => {
            if (dvApi.value.isLink(item)) {
              return FileField.buildMarkDownLink(this.plugin, this.file, item.path);
            } else {
              return item.toString();
            }
          });
        }
        this.selectedOptions = initialOptions.map((item) => item.toString());
      } else if (initialOptions.toString().startsWith("[[")) {
        this.selectedOptions = initialOptions.split(",").map((item) => item.trim());
      } else {
        this.selectedOptions = initialOptions.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
      }
    } else {
      this.selectedOptions = [];
    }
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(MultiSuggestModal.prototype, this, "onOpen").call(this);
      this.containerEl.onkeydown = (e) => __async(this, null, function* () {
        if (e.key == "Enter" && e.altKey) {
          yield this.replaceValues();
          this.close();
        }
      });
      const updateSettingsInfoContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-notice-container" });
      const notice = updateSettingsInfoContainer.createDiv({ cls: "metadata-menu-value-suggester-notice-label" });
      updateSettingsInfoContainer.createDiv({ cls: "metadata-menu-value-suggester-notice-spacer" });
      updateSettingsInfoContainer.hide();
      this.containerEl.find(".prompt").prepend(updateSettingsInfoContainer);
      const inputContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-input-container" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-actions" });
      buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-actions-spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-info" });
      infoContainer.setText("Alt+Enter to save");
      this.addButton = new import_obsidian23.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => __async(this, null, function* () {
        yield this.addNewValueToSettings();
        notice.setText(`${this.inputEl.value} added to the field settings
click on reload`);
        this.addButton.buttonEl.hide();
        updateSettingsInfoContainer.show();
      }));
      this.addButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      this.reloadButton = new import_obsidian23.ButtonComponent(updateSettingsInfoContainer);
      this.reloadButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      this.reloadButton.setIcon("refresh-cw");
      this.reloadButton.setCta();
      this.reloadButton.onClick(() => __async(this, null, function* () {
        this.inputEl.value = "";
        this.updateSuggestions();
        updateSettingsInfoContainer.hide();
        this.addButton.buttonEl.hide();
      }));
      const confirmButton = new import_obsidian23.ButtonComponent(buttonContainer);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => __async(this, null, function* () {
        yield this.replaceValues();
        this.close();
      }));
      confirmButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      const cancelButton = new import_obsidian23.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => {
        this.close();
      });
      cancelButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      const clearButton = new import_obsidian23.ButtonComponent(buttonContainer);
      clearButton.setIcon("trash");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      clearButton.buttonEl.addClass("danger");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      var _a, _b;
      const newValue = this.inputEl.value;
      const fileClassName = (_b = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field) => field.name === this.field.name)) == null ? void 0 : _b.fileClassName;
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian23.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian23.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.plugin.fieldIndex.fullIndex("valueAdd");
      this.selectedOptions.push(newValue);
    });
  }
  replaceValues() {
    return __async(this, null, function* () {
      const options = this.selectedOptions;
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, options.join(", "));
        });
      } else {
        const renderedValues = !this.inFrontmatter ? options.join(", ") : options.length > 1 ? `[${options.join(", ")}]` : `${options[0]}`;
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, renderedValues, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedOptions.includes(values[i].toString())) {
        s.addClass("metadata-menu-value-selected");
        if (s.querySelectorAll(".metadata-menu-command-suggest-icon").length == 0) {
          const iconContainer = s.createDiv({ cls: "metadata-menu-command-suggest-icon" });
          (0, import_obsidian23.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("metadata-menu-value-selected");
        s.querySelectorAll(".metadata-menu-command-suggest-icon").forEach((icon) => icon.remove());
      }
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("metadata-menu-value-suggester-value-container");
    const spacer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-value-container-spacer" });
    el.appendChild(spacer);
    if (this.selectedOptions.includes(value.toString())) {
      el.addClass("metadata-menu-value-selected");
      const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
      (0, import_obsidian23.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  selectSuggestion(value, evt) {
    if (this.selectedOptions.includes(value.toString())) {
      this.selectedOptions.remove(value.toString());
    } else {
      this.selectedOptions.push(value.toString());
    }
    this.renderSelected();
  }
  onChooseSuggestion(item, evt) {
  }
};

// src/fields/fieldManagers/MultiField.ts
var MultiField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Multi" /* Multi */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiSuggestModal(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select values");
    const action = () => modal.open();
    if (MultiField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Multi" /* Multi */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Multi" /* Multi */]
      });
    } else if (MultiField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Multi" /* Multi */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new MultiSuggestModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Select options for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a, _b;
    let valueHovered = false;
    let currentValues = [];
    if (p[this.field.name]) {
      if (Object.keys(p[this.field.name]).includes("path")) {
        currentValues = [`[[${p[this.field.name].path.replace(".md", "")}]]`];
      } else if (Array.isArray(p[this.field.name])) {
        currentValues.push(...p[this.field.name].map((v) => v.trim()));
      } else {
        currentValues = p[this.field.name].split(",").map((v) => v.trim());
      }
    }
    const selectContainer = document.createElement("div");
    const select = document.createElement("select");
    select.setAttr("class", "metadata-menu-dv-select");
    selectContainer.appendChild(select);
    const nullOption = new Option("--select--", void 0);
    select.add(nullOption);
    const values = this.getOptionsList();
    values.filter((v) => !currentValues.contains(v)).forEach((v) => {
      const value = new Option(v, v);
      if (p[this.field.name] === value) {
        value.selected = true;
      }
      select.add(value);
    });
    select.onchange = () => __async(this, null, function* () {
      const newValues = [...currentValues, select.value].join(", ");
      MultiField.replaceValues(this.plugin, p.file.path, this.field.name, newValues);
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
      fieldContainer.appendChild(valuesContainer);
      fieldContainer.appendChild(singleSpacer);
      fieldContainer.appendChild(doubleSpacer);
      fieldContainer.removeChild(selectContainer);
    });
    select.onkeydown = (e) => {
      if (e.key === "Escape") {
        fieldContainer.appendChild(valuesContainer);
        fieldContainer.appendChild(singleSpacer);
        fieldContainer.appendChild(doubleSpacer);
        fieldContainer.removeChild(selectContainer);
      }
    };
    const closeSelect = document.createElement("button");
    (0, import_obsidian24.setIcon)(closeSelect, "cross");
    closeSelect.addClass("metadata-menu-dv-field-button");
    closeSelect.addClass("multi");
    closeSelect.onclick = () => {
      fieldContainer.appendChild(valuesContainer);
      fieldContainer.appendChild(singleSpacer);
      fieldContainer.appendChild(doubleSpacer);
      fieldContainer.removeChild(selectContainer);
    };
    selectContainer.appendChild(closeSelect);
    const valuesContainer = document.createElement("div");
    valuesContainer.addClass("metadata-menu-dv-multi-values-container");
    currentValues.forEach((v) => {
      const valueContainer = document.createElement("div");
      valueContainer.addClass("metadata-menu-dv-multi-values-container");
      const valueRemoveBtn = document.createElement("button");
      (0, import_obsidian24.setIcon)(valueRemoveBtn, "cross");
      valueRemoveBtn.addClass("metadata-menu-dv-field-button");
      valueRemoveBtn.addClass("multi");
      valueRemoveBtn.hide();
      valueRemoveBtn.onclick = () => __async(this, null, function* () {
        const remainingValues = currentValues.filter((cV) => cV !== v).join(", ");
        MultiField.replaceValues(this.plugin, p.file.path, this.field.name, remainingValues);
      });
      valueContainer.appendChild(valueRemoveBtn);
      const valueLabel = document.createElement("div");
      valueLabel.setText(v);
      valueLabel.addClass("metadata-menu-dv-multi-value-label");
      valueContainer.appendChild(valueLabel);
      valueContainer.onmouseover = () => {
        valueHovered = true;
        doubleSpacer.hide();
        singleSpacer.hide();
        valueRemoveBtn.show();
        valueLabel.addClass("hovered");
      };
      valueContainer.onmouseout = () => {
        valueHovered = false;
        valueRemoveBtn.hide();
        singleSpacer.show();
        doubleSpacer.hide();
        valueLabel.removeClass("hovered");
      };
      valuesContainer.appendChild(valueContainer);
    });
    const addBtn = document.createElement("button");
    (0, import_obsidian24.setIcon)(addBtn, "bullet-list");
    addBtn.setAttr("class", "metadata-menu-dv-field-button");
    valuesContainer.appendChild(addBtn);
    addBtn.onclick = () => {
      fieldContainer.removeChild(valuesContainer);
      fieldContainer.removeChild(singleSpacer);
      fieldContainer.removeChild(doubleSpacer);
      fieldContainer.appendChild(selectContainer);
    };
    const singleSpacer = document.createElement("div");
    singleSpacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const doubleSpacer = document.createElement("div");
    doubleSpacer.setAttr("class", "metadata-menu-dv-field-double-spacer");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      addBtn.hide();
      fieldContainer.onmouseover = () => {
        addBtn.show();
        doubleSpacer.hide();
        if (!valueHovered)
          singleSpacer.show();
      };
      fieldContainer.onmouseout = () => {
        addBtn.hide();
        singleSpacer.hide();
        doubleSpacer.show();
      };
    }
    if (!((_b = attrs == null ? void 0 : attrs.options) == null ? void 0 : _b.alwaysOn)) {
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
    } else {
      singleSpacer.show();
      doubleSpacer.hide();
      addBtn.show();
    }
    fieldContainer.appendChild(valuesContainer);
    fieldContainer.appendChild(singleSpacer);
    fieldContainer.appendChild(doubleSpacer);
  }
};

// src/fields/fieldManagers/DateField.ts
var import_obsidian27 = require("obsidian");

// src/modals/fields/DateModal.ts
var import_obsidian25 = require("obsidian");
var import_obsidian26 = require("obsidian");

// node_modules/flatpickr/dist/esm/types/options.js
var HOOKS = [
  "onChange",
  "onClose",
  "onDayCreate",
  "onDestroy",
  "onKeyDown",
  "onMonthChange",
  "onOpen",
  "onParseConfig",
  "onReady",
  "onValueUpdate",
  "onYearChange",
  "onPreCalendarPosition"
];
var defaults = {
  _disable: [],
  allowInput: false,
  allowInvalidPreload: false,
  altFormat: "F j, Y",
  altInput: false,
  altInputClass: "form-control input",
  animate: typeof window === "object" && window.navigator.userAgent.indexOf("MSIE") === -1,
  ariaDateFormat: "F j, Y",
  autoFillDefaultTime: true,
  clickOpens: true,
  closeOnSelect: true,
  conjunction: ", ",
  dateFormat: "Y-m-d",
  defaultHour: 12,
  defaultMinute: 0,
  defaultSeconds: 0,
  disable: [],
  disableMobile: false,
  enableSeconds: false,
  enableTime: false,
  errorHandler: function(err) {
    return typeof console !== "undefined" && console.warn(err);
  },
  getWeek: function(givenDate) {
    var date = new Date(givenDate.getTime());
    date.setHours(0, 0, 0, 0);
    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
    var week1 = new Date(date.getFullYear(), 0, 4);
    return 1 + Math.round(((date.getTime() - week1.getTime()) / 864e5 - 3 + (week1.getDay() + 6) % 7) / 7);
  },
  hourIncrement: 1,
  ignoredFocusElements: [],
  inline: false,
  locale: "default",
  minuteIncrement: 5,
  mode: "single",
  monthSelectorType: "dropdown",
  nextArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",
  noCalendar: false,
  now: new Date(),
  onChange: [],
  onClose: [],
  onDayCreate: [],
  onDestroy: [],
  onKeyDown: [],
  onMonthChange: [],
  onOpen: [],
  onParseConfig: [],
  onReady: [],
  onValueUpdate: [],
  onYearChange: [],
  onPreCalendarPosition: [],
  plugins: [],
  position: "auto",
  positionElement: void 0,
  prevArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",
  shorthandCurrentMonth: false,
  showMonths: 1,
  static: false,
  time_24hr: false,
  weekNumbers: false,
  wrap: false
};

// node_modules/flatpickr/dist/esm/l10n/default.js
var english = {
  weekdays: {
    shorthand: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
    longhand: [
      "Sunday",
      "Monday",
      "Tuesday",
      "Wednesday",
      "Thursday",
      "Friday",
      "Saturday"
    ]
  },
  months: {
    shorthand: [
      "Jan",
      "Feb",
      "Mar",
      "Apr",
      "May",
      "Jun",
      "Jul",
      "Aug",
      "Sep",
      "Oct",
      "Nov",
      "Dec"
    ],
    longhand: [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July",
      "August",
      "September",
      "October",
      "November",
      "December"
    ]
  },
  daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
  firstDayOfWeek: 0,
  ordinal: function(nth) {
    var s = nth % 100;
    if (s > 3 && s < 21)
      return "th";
    switch (s % 10) {
      case 1:
        return "st";
      case 2:
        return "nd";
      case 3:
        return "rd";
      default:
        return "th";
    }
  },
  rangeSeparator: " to ",
  weekAbbreviation: "Wk",
  scrollTitle: "Scroll to increment",
  toggleTitle: "Click to toggle",
  amPM: ["AM", "PM"],
  yearAriaLabel: "Year",
  monthAriaLabel: "Month",
  hourAriaLabel: "Hour",
  minuteAriaLabel: "Minute",
  time_24hr: false
};
var default_default = english;

// node_modules/flatpickr/dist/esm/utils/index.js
var pad = function(number, length) {
  if (length === void 0) {
    length = 2;
  }
  return ("000" + number).slice(length * -1);
};
var int = function(bool) {
  return bool === true ? 1 : 0;
};
function debounce2(fn2, wait) {
  var t;
  return function() {
    var _this = this;
    var args = arguments;
    clearTimeout(t);
    t = setTimeout(function() {
      return fn2.apply(_this, args);
    }, wait);
  };
}
var arrayify = function(obj) {
  return obj instanceof Array ? obj : [obj];
};

// node_modules/flatpickr/dist/esm/utils/dom.js
function toggleClass(elem, className, bool) {
  if (bool === true)
    return elem.classList.add(className);
  elem.classList.remove(className);
}
function createElement(tag, className, content) {
  var e = window.document.createElement(tag);
  className = className || "";
  content = content || "";
  e.className = className;
  if (content !== void 0)
    e.textContent = content;
  return e;
}
function clearNode(node) {
  while (node.firstChild)
    node.removeChild(node.firstChild);
}
function findParent(node, condition) {
  if (condition(node))
    return node;
  else if (node.parentNode)
    return findParent(node.parentNode, condition);
  return void 0;
}
function createNumberInput(inputClassName, opts) {
  var wrapper = createElement("div", "numInputWrapper"), numInput = createElement("input", "numInput " + inputClassName), arrowUp = createElement("span", "arrowUp"), arrowDown = createElement("span", "arrowDown");
  if (navigator.userAgent.indexOf("MSIE 9.0") === -1) {
    numInput.type = "number";
  } else {
    numInput.type = "text";
    numInput.pattern = "\\d*";
  }
  if (opts !== void 0)
    for (var key in opts)
      numInput.setAttribute(key, opts[key]);
  wrapper.appendChild(numInput);
  wrapper.appendChild(arrowUp);
  wrapper.appendChild(arrowDown);
  return wrapper;
}
function getEventTarget(event) {
  try {
    if (typeof event.composedPath === "function") {
      var path = event.composedPath();
      return path[0];
    }
    return event.target;
  } catch (error) {
    return event.target;
  }
}

// node_modules/flatpickr/dist/esm/utils/formatting.js
var doNothing = function() {
  return void 0;
};
var monthToStr = function(monthNumber, shorthand, locale) {
  return locale.months[shorthand ? "shorthand" : "longhand"][monthNumber];
};
var revFormat = {
  D: doNothing,
  F: function(dateObj, monthName, locale) {
    dateObj.setMonth(locale.months.longhand.indexOf(monthName));
  },
  G: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  H: function(dateObj, hour) {
    dateObj.setHours(parseFloat(hour));
  },
  J: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  K: function(dateObj, amPM, locale) {
    dateObj.setHours(dateObj.getHours() % 12 + 12 * int(new RegExp(locale.amPM[1], "i").test(amPM)));
  },
  M: function(dateObj, shortMonth, locale) {
    dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));
  },
  S: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  U: function(_, unixSeconds) {
    return new Date(parseFloat(unixSeconds) * 1e3);
  },
  W: function(dateObj, weekNum, locale) {
    var weekNumber = parseInt(weekNum);
    var date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);
    date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);
    return date;
  },
  Y: function(dateObj, year) {
    dateObj.setFullYear(parseFloat(year));
  },
  Z: function(_, ISODate) {
    return new Date(ISODate);
  },
  d: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  h: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  i: function(dateObj, minutes) {
    dateObj.setMinutes(parseFloat(minutes));
  },
  j: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  l: doNothing,
  m: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  n: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  s: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  u: function(_, unixMillSeconds) {
    return new Date(parseFloat(unixMillSeconds));
  },
  w: doNothing,
  y: function(dateObj, year) {
    dateObj.setFullYear(2e3 + parseFloat(year));
  }
};
var tokenRegex = {
  D: "",
  F: "",
  G: "(\\d\\d|\\d)",
  H: "(\\d\\d|\\d)",
  J: "(\\d\\d|\\d)\\w+",
  K: "",
  M: "",
  S: "(\\d\\d|\\d)",
  U: "(.+)",
  W: "(\\d\\d|\\d)",
  Y: "(\\d{4})",
  Z: "(.+)",
  d: "(\\d\\d|\\d)",
  h: "(\\d\\d|\\d)",
  i: "(\\d\\d|\\d)",
  j: "(\\d\\d|\\d)",
  l: "",
  m: "(\\d\\d|\\d)",
  n: "(\\d\\d|\\d)",
  s: "(\\d\\d|\\d)",
  u: "(.+)",
  w: "(\\d\\d|\\d)",
  y: "(\\d{2})"
};
var formats = {
  Z: function(date) {
    return date.toISOString();
  },
  D: function(date, locale, options) {
    return locale.weekdays.shorthand[formats.w(date, locale, options)];
  },
  F: function(date, locale, options) {
    return monthToStr(formats.n(date, locale, options) - 1, false, locale);
  },
  G: function(date, locale, options) {
    return pad(formats.h(date, locale, options));
  },
  H: function(date) {
    return pad(date.getHours());
  },
  J: function(date, locale) {
    return locale.ordinal !== void 0 ? date.getDate() + locale.ordinal(date.getDate()) : date.getDate();
  },
  K: function(date, locale) {
    return locale.amPM[int(date.getHours() > 11)];
  },
  M: function(date, locale) {
    return monthToStr(date.getMonth(), true, locale);
  },
  S: function(date) {
    return pad(date.getSeconds());
  },
  U: function(date) {
    return date.getTime() / 1e3;
  },
  W: function(date, _, options) {
    return options.getWeek(date);
  },
  Y: function(date) {
    return pad(date.getFullYear(), 4);
  },
  d: function(date) {
    return pad(date.getDate());
  },
  h: function(date) {
    return date.getHours() % 12 ? date.getHours() % 12 : 12;
  },
  i: function(date) {
    return pad(date.getMinutes());
  },
  j: function(date) {
    return date.getDate();
  },
  l: function(date, locale) {
    return locale.weekdays.longhand[date.getDay()];
  },
  m: function(date) {
    return pad(date.getMonth() + 1);
  },
  n: function(date) {
    return date.getMonth() + 1;
  },
  s: function(date) {
    return date.getSeconds();
  },
  u: function(date) {
    return date.getTime();
  },
  w: function(date) {
    return date.getDay();
  },
  y: function(date) {
    return String(date.getFullYear()).substring(2);
  }
};

// node_modules/flatpickr/dist/esm/utils/dates.js
var createDateFormatter = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c, _d = _a.isMobile, isMobile = _d === void 0 ? false : _d;
  return function(dateObj, frmt, overrideLocale) {
    var locale = overrideLocale || l10n;
    if (config.formatDate !== void 0 && !isMobile) {
      return config.formatDate(dateObj, frmt, locale);
    }
    return frmt.split("").map(function(c, i, arr) {
      return formats[c] && arr[i - 1] !== "\\" ? formats[c](dateObj, locale, config) : c !== "\\" ? c : "";
    }).join("");
  };
};
var createDateParser = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;
  return function(date, givenFormat, timeless, customLocale) {
    if (date !== 0 && !date)
      return void 0;
    var locale = customLocale || l10n;
    var parsedDate;
    var dateOrig = date;
    if (date instanceof Date)
      parsedDate = new Date(date.getTime());
    else if (typeof date !== "string" && date.toFixed !== void 0)
      parsedDate = new Date(date);
    else if (typeof date === "string") {
      var format2 = givenFormat || (config || defaults).dateFormat;
      var datestr = String(date).trim();
      if (datestr === "today") {
        parsedDate = new Date();
        timeless = true;
      } else if (config && config.parseDate) {
        parsedDate = config.parseDate(date, format2);
      } else if (/Z$/.test(datestr) || /GMT$/.test(datestr)) {
        parsedDate = new Date(date);
      } else {
        var matched = void 0, ops = [];
        for (var i = 0, matchIndex = 0, regexStr = ""; i < format2.length; i++) {
          var token = format2[i];
          var isBackSlash = token === "\\";
          var escaped = format2[i - 1] === "\\" || isBackSlash;
          if (tokenRegex[token] && !escaped) {
            regexStr += tokenRegex[token];
            var match = new RegExp(regexStr).exec(date);
            if (match && (matched = true)) {
              ops[token !== "Y" ? "push" : "unshift"]({
                fn: revFormat[token],
                val: match[++matchIndex]
              });
            }
          } else if (!isBackSlash)
            regexStr += ".";
        }
        parsedDate = !config || !config.noCalendar ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0) : new Date(new Date().setHours(0, 0, 0, 0));
        ops.forEach(function(_a2) {
          var fn2 = _a2.fn, val = _a2.val;
          return parsedDate = fn2(parsedDate, val, locale) || parsedDate;
        });
        parsedDate = matched ? parsedDate : void 0;
      }
    }
    if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {
      config.errorHandler(new Error("Invalid date provided: " + dateOrig));
      return void 0;
    }
    if (timeless === true)
      parsedDate.setHours(0, 0, 0, 0);
    return parsedDate;
  };
};
function compareDates(date1, date2, timeless) {
  if (timeless === void 0) {
    timeless = true;
  }
  if (timeless !== false) {
    return new Date(date1.getTime()).setHours(0, 0, 0, 0) - new Date(date2.getTime()).setHours(0, 0, 0, 0);
  }
  return date1.getTime() - date2.getTime();
}
var isBetween = function(ts, ts1, ts2) {
  return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);
};
var calculateSecondsSinceMidnight = function(hours, minutes, seconds) {
  return hours * 3600 + minutes * 60 + seconds;
};
var parseSeconds = function(secondsSinceMidnight) {
  var hours = Math.floor(secondsSinceMidnight / 3600), minutes = (secondsSinceMidnight - hours * 3600) / 60;
  return [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];
};
var duration = {
  DAY: 864e5
};
function getDefaultHours(config) {
  var hours = config.defaultHour;
  var minutes = config.defaultMinute;
  var seconds = config.defaultSeconds;
  if (config.minDate !== void 0) {
    var minHour = config.minDate.getHours();
    var minMinutes = config.minDate.getMinutes();
    var minSeconds = config.minDate.getSeconds();
    if (hours < minHour) {
      hours = minHour;
    }
    if (hours === minHour && minutes < minMinutes) {
      minutes = minMinutes;
    }
    if (hours === minHour && minutes === minMinutes && seconds < minSeconds)
      seconds = config.minDate.getSeconds();
  }
  if (config.maxDate !== void 0) {
    var maxHr = config.maxDate.getHours();
    var maxMinutes = config.maxDate.getMinutes();
    hours = Math.min(hours, maxHr);
    if (hours === maxHr)
      minutes = Math.min(maxMinutes, minutes);
    if (hours === maxHr && minutes === maxMinutes)
      seconds = config.maxDate.getSeconds();
  }
  return { hours, minutes, seconds };
}

// node_modules/flatpickr/dist/esm/utils/polyfills.js
if (typeof Object.assign !== "function") {
  Object.assign = function(target) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
      args[_i - 1] = arguments[_i];
    }
    if (!target) {
      throw TypeError("Cannot convert undefined or null to object");
    }
    var _loop_1 = function(source2) {
      if (source2) {
        Object.keys(source2).forEach(function(key) {
          return target[key] = source2[key];
        });
      }
    };
    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {
      var source = args_1[_a];
      _loop_1(source);
    }
    return target;
  };
}

// node_modules/flatpickr/dist/esm/index.js
var __assign = function() {
  __assign = Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s)
        if (Object.prototype.hasOwnProperty.call(s, p))
          t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
var __spreadArrays = function() {
  for (var s = 0, i = 0, il = arguments.length; i < il; i++)
    s += arguments[i].length;
  for (var r = Array(s), k = 0, i = 0; i < il; i++)
    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
      r[k] = a[j];
  return r;
};
var DEBOUNCED_CHANGE_MS = 300;
function FlatpickrInstance(element, instanceConfig) {
  var self = {
    config: __assign(__assign({}, defaults), flatpickr.defaultConfig),
    l10n: default_default
  };
  self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  self._handlers = [];
  self.pluginElements = [];
  self.loadedPlugins = [];
  self._bind = bind;
  self._setHoursFromDate = setHoursFromDate;
  self._positionCalendar = positionCalendar;
  self.changeMonth = changeMonth;
  self.changeYear = changeYear;
  self.clear = clear;
  self.close = close;
  self.onMouseOver = onMouseOver;
  self._createElement = createElement;
  self.createDay = createDay;
  self.destroy = destroy;
  self.isEnabled = isEnabled;
  self.jumpToDate = jumpToDate;
  self.updateValue = updateValue;
  self.open = open;
  self.redraw = redraw;
  self.set = set;
  self.setDate = setDate;
  self.toggle = toggle;
  function setupHelperFunctions() {
    self.utils = {
      getDaysInMonth: function(month, yr) {
        if (month === void 0) {
          month = self.currentMonth;
        }
        if (yr === void 0) {
          yr = self.currentYear;
        }
        if (month === 1 && (yr % 4 === 0 && yr % 100 !== 0 || yr % 400 === 0))
          return 29;
        return self.l10n.daysInMonth[month];
      }
    };
  }
  function init() {
    self.element = self.input = element;
    self.isOpen = false;
    parseConfig();
    setupLocale();
    setupInputs();
    setupDates();
    setupHelperFunctions();
    if (!self.isMobile)
      build();
    bindEvents();
    if (self.selectedDates.length || self.config.noCalendar) {
      if (self.config.enableTime) {
        setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : void 0);
      }
      updateValue(false);
    }
    setCalendarWidth();
    var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    if (!self.isMobile && isSafari) {
      positionCalendar();
    }
    triggerEvent("onReady");
  }
  function getClosestActiveElement() {
    var _a;
    return ((_a = self.calendarContainer) === null || _a === void 0 ? void 0 : _a.getRootNode()).activeElement || document.activeElement;
  }
  function bindToInstance(fn2) {
    return fn2.bind(self);
  }
  function setCalendarWidth() {
    var config = self.config;
    if (config.weekNumbers === false && config.showMonths === 1) {
      return;
    } else if (config.noCalendar !== true) {
      window.requestAnimationFrame(function() {
        if (self.calendarContainer !== void 0) {
          self.calendarContainer.style.visibility = "hidden";
          self.calendarContainer.style.display = "block";
        }
        if (self.daysContainer !== void 0) {
          var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;
          self.daysContainer.style.width = daysWidth + "px";
          self.calendarContainer.style.width = daysWidth + (self.weekWrapper !== void 0 ? self.weekWrapper.offsetWidth : 0) + "px";
          self.calendarContainer.style.removeProperty("visibility");
          self.calendarContainer.style.removeProperty("display");
        }
      });
    }
  }
  function updateTime(e) {
    if (self.selectedDates.length === 0) {
      var defaultDate = self.config.minDate === void 0 || compareDates(new Date(), self.config.minDate) >= 0 ? new Date() : new Date(self.config.minDate.getTime());
      var defaults2 = getDefaultHours(self.config);
      defaultDate.setHours(defaults2.hours, defaults2.minutes, defaults2.seconds, defaultDate.getMilliseconds());
      self.selectedDates = [defaultDate];
      self.latestSelectedDateObj = defaultDate;
    }
    if (e !== void 0 && e.type !== "blur") {
      timeWrapper(e);
    }
    var prevValue = self._input.value;
    setHoursFromInputs();
    updateValue();
    if (self._input.value !== prevValue) {
      self._debouncedChange();
    }
  }
  function ampm2military(hour, amPM) {
    return hour % 12 + 12 * int(amPM === self.l10n.amPM[1]);
  }
  function military2ampm(hour) {
    switch (hour % 24) {
      case 0:
      case 12:
        return 12;
      default:
        return hour % 12;
    }
  }
  function setHoursFromInputs() {
    if (self.hourElement === void 0 || self.minuteElement === void 0)
      return;
    var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== void 0 ? (parseInt(self.secondElement.value, 10) || 0) % 60 : 0;
    if (self.amPM !== void 0) {
      hours = ampm2military(hours, self.amPM.textContent);
    }
    var limitMinHours = self.config.minTime !== void 0 || self.config.minDate && self.minDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.minDate, true) === 0;
    var limitMaxHours = self.config.maxTime !== void 0 || self.config.maxDate && self.maxDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.maxDate, true) === 0;
    if (self.config.maxTime !== void 0 && self.config.minTime !== void 0 && self.config.minTime > self.config.maxTime) {
      var minBound = calculateSecondsSinceMidnight(self.config.minTime.getHours(), self.config.minTime.getMinutes(), self.config.minTime.getSeconds());
      var maxBound = calculateSecondsSinceMidnight(self.config.maxTime.getHours(), self.config.maxTime.getMinutes(), self.config.maxTime.getSeconds());
      var currentTime = calculateSecondsSinceMidnight(hours, minutes, seconds);
      if (currentTime > maxBound && currentTime < minBound) {
        var result = parseSeconds(minBound);
        hours = result[0];
        minutes = result[1];
        seconds = result[2];
      }
    } else {
      if (limitMaxHours) {
        var maxTime = self.config.maxTime !== void 0 ? self.config.maxTime : self.config.maxDate;
        hours = Math.min(hours, maxTime.getHours());
        if (hours === maxTime.getHours())
          minutes = Math.min(minutes, maxTime.getMinutes());
        if (minutes === maxTime.getMinutes())
          seconds = Math.min(seconds, maxTime.getSeconds());
      }
      if (limitMinHours) {
        var minTime = self.config.minTime !== void 0 ? self.config.minTime : self.config.minDate;
        hours = Math.max(hours, minTime.getHours());
        if (hours === minTime.getHours() && minutes < minTime.getMinutes())
          minutes = minTime.getMinutes();
        if (minutes === minTime.getMinutes())
          seconds = Math.max(seconds, minTime.getSeconds());
      }
    }
    setHours(hours, minutes, seconds);
  }
  function setHoursFromDate(dateObj) {
    var date = dateObj || self.latestSelectedDateObj;
    if (date && date instanceof Date) {
      setHours(date.getHours(), date.getMinutes(), date.getSeconds());
    }
  }
  function setHours(hours, minutes, seconds) {
    if (self.latestSelectedDateObj !== void 0) {
      self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);
    }
    if (!self.hourElement || !self.minuteElement || self.isMobile)
      return;
    self.hourElement.value = pad(!self.config.time_24hr ? (12 + hours) % 12 + 12 * int(hours % 12 === 0) : hours);
    self.minuteElement.value = pad(minutes);
    if (self.amPM !== void 0)
      self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];
    if (self.secondElement !== void 0)
      self.secondElement.value = pad(seconds);
  }
  function onYearInput(event) {
    var eventTarget = getEventTarget(event);
    var year = parseInt(eventTarget.value) + (event.delta || 0);
    if (year / 1e3 > 1 || event.key === "Enter" && !/[^\d]/.test(year.toString())) {
      changeYear(year);
    }
  }
  function bind(element2, event, handler, options) {
    if (event instanceof Array)
      return event.forEach(function(ev) {
        return bind(element2, ev, handler, options);
      });
    if (element2 instanceof Array)
      return element2.forEach(function(el) {
        return bind(el, event, handler, options);
      });
    element2.addEventListener(event, handler, options);
    self._handlers.push({
      remove: function() {
        return element2.removeEventListener(event, handler, options);
      }
    });
  }
  function triggerChange() {
    triggerEvent("onChange");
  }
  function bindEvents() {
    if (self.config.wrap) {
      ["open", "close", "toggle", "clear"].forEach(function(evt) {
        Array.prototype.forEach.call(self.element.querySelectorAll("[data-" + evt + "]"), function(el) {
          return bind(el, "click", self[evt]);
        });
      });
    }
    if (self.isMobile) {
      setupMobile();
      return;
    }
    var debouncedResize = debounce2(onResize, 50);
    self._debouncedChange = debounce2(triggerChange, DEBOUNCED_CHANGE_MS);
    if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))
      bind(self.daysContainer, "mouseover", function(e) {
        if (self.config.mode === "range")
          onMouseOver(getEventTarget(e));
      });
    bind(self._input, "keydown", onKeyDown);
    if (self.calendarContainer !== void 0) {
      bind(self.calendarContainer, "keydown", onKeyDown);
    }
    if (!self.config.inline && !self.config.static)
      bind(window, "resize", debouncedResize);
    if (window.ontouchstart !== void 0)
      bind(window.document, "touchstart", documentClick);
    else
      bind(window.document, "mousedown", documentClick);
    bind(window.document, "focus", documentClick, { capture: true });
    if (self.config.clickOpens === true) {
      bind(self._input, "focus", self.open);
      bind(self._input, "click", self.open);
    }
    if (self.daysContainer !== void 0) {
      bind(self.monthNav, "click", onMonthNavClick);
      bind(self.monthNav, ["keyup", "increment"], onYearInput);
      bind(self.daysContainer, "click", selectDate);
    }
    if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0) {
      var selText = function(e) {
        return getEventTarget(e).select();
      };
      bind(self.timeContainer, ["increment"], updateTime);
      bind(self.timeContainer, "blur", updateTime, { capture: true });
      bind(self.timeContainer, "click", timeIncrement);
      bind([self.hourElement, self.minuteElement], ["focus", "click"], selText);
      if (self.secondElement !== void 0)
        bind(self.secondElement, "focus", function() {
          return self.secondElement && self.secondElement.select();
        });
      if (self.amPM !== void 0) {
        bind(self.amPM, "click", function(e) {
          updateTime(e);
        });
      }
    }
    if (self.config.allowInput) {
      bind(self._input, "blur", onBlur);
    }
  }
  function jumpToDate(jumpDate, triggerChange2) {
    var jumpTo = jumpDate !== void 0 ? self.parseDate(jumpDate) : self.latestSelectedDateObj || (self.config.minDate && self.config.minDate > self.now ? self.config.minDate : self.config.maxDate && self.config.maxDate < self.now ? self.config.maxDate : self.now);
    var oldYear = self.currentYear;
    var oldMonth = self.currentMonth;
    try {
      if (jumpTo !== void 0) {
        self.currentYear = jumpTo.getFullYear();
        self.currentMonth = jumpTo.getMonth();
      }
    } catch (e) {
      e.message = "Invalid date supplied: " + jumpTo;
      self.config.errorHandler(e);
    }
    if (triggerChange2 && self.currentYear !== oldYear) {
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    if (triggerChange2 && (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {
      triggerEvent("onMonthChange");
    }
    self.redraw();
  }
  function timeIncrement(e) {
    var eventTarget = getEventTarget(e);
    if (~eventTarget.className.indexOf("arrow"))
      incrementNumInput(e, eventTarget.classList.contains("arrowUp") ? 1 : -1);
  }
  function incrementNumInput(e, delta, inputElem) {
    var target = e && getEventTarget(e);
    var input = inputElem || target && target.parentNode && target.parentNode.firstChild;
    var event = createEvent("increment");
    event.delta = delta;
    input && input.dispatchEvent(event);
  }
  function build() {
    var fragment = window.document.createDocumentFragment();
    self.calendarContainer = createElement("div", "flatpickr-calendar");
    self.calendarContainer.tabIndex = -1;
    if (!self.config.noCalendar) {
      fragment.appendChild(buildMonthNav());
      self.innerContainer = createElement("div", "flatpickr-innerContainer");
      if (self.config.weekNumbers) {
        var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;
        self.innerContainer.appendChild(weekWrapper);
        self.weekNumbers = weekNumbers;
        self.weekWrapper = weekWrapper;
      }
      self.rContainer = createElement("div", "flatpickr-rContainer");
      self.rContainer.appendChild(buildWeekdays());
      if (!self.daysContainer) {
        self.daysContainer = createElement("div", "flatpickr-days");
        self.daysContainer.tabIndex = -1;
      }
      buildDays();
      self.rContainer.appendChild(self.daysContainer);
      self.innerContainer.appendChild(self.rContainer);
      fragment.appendChild(self.innerContainer);
    }
    if (self.config.enableTime) {
      fragment.appendChild(buildTime());
    }
    toggleClass(self.calendarContainer, "rangeMode", self.config.mode === "range");
    toggleClass(self.calendarContainer, "animate", self.config.animate === true);
    toggleClass(self.calendarContainer, "multiMonth", self.config.showMonths > 1);
    self.calendarContainer.appendChild(fragment);
    var customAppend = self.config.appendTo !== void 0 && self.config.appendTo.nodeType !== void 0;
    if (self.config.inline || self.config.static) {
      self.calendarContainer.classList.add(self.config.inline ? "inline" : "static");
      if (self.config.inline) {
        if (!customAppend && self.element.parentNode)
          self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);
        else if (self.config.appendTo !== void 0)
          self.config.appendTo.appendChild(self.calendarContainer);
      }
      if (self.config.static) {
        var wrapper = createElement("div", "flatpickr-wrapper");
        if (self.element.parentNode)
          self.element.parentNode.insertBefore(wrapper, self.element);
        wrapper.appendChild(self.element);
        if (self.altInput)
          wrapper.appendChild(self.altInput);
        wrapper.appendChild(self.calendarContainer);
      }
    }
    if (!self.config.static && !self.config.inline)
      (self.config.appendTo !== void 0 ? self.config.appendTo : window.document.body).appendChild(self.calendarContainer);
  }
  function createDay(className, date, _dayNumber, i) {
    var dateIsEnabled = isEnabled(date, true), dayElement = createElement("span", className, date.getDate().toString());
    dayElement.dateObj = date;
    dayElement.$i = i;
    dayElement.setAttribute("aria-label", self.formatDate(date, self.config.ariaDateFormat));
    if (className.indexOf("hidden") === -1 && compareDates(date, self.now) === 0) {
      self.todayDateElem = dayElement;
      dayElement.classList.add("today");
      dayElement.setAttribute("aria-current", "date");
    }
    if (dateIsEnabled) {
      dayElement.tabIndex = -1;
      if (isDateSelected(date)) {
        dayElement.classList.add("selected");
        self.selectedDateElem = dayElement;
        if (self.config.mode === "range") {
          toggleClass(dayElement, "startRange", self.selectedDates[0] && compareDates(date, self.selectedDates[0], true) === 0);
          toggleClass(dayElement, "endRange", self.selectedDates[1] && compareDates(date, self.selectedDates[1], true) === 0);
          if (className === "nextMonthDay")
            dayElement.classList.add("inRange");
        }
      }
    } else {
      dayElement.classList.add("flatpickr-disabled");
    }
    if (self.config.mode === "range") {
      if (isDateInRange(date) && !isDateSelected(date))
        dayElement.classList.add("inRange");
    }
    if (self.weekNumbers && self.config.showMonths === 1 && className !== "prevMonthDay" && i % 7 === 6) {
      self.weekNumbers.insertAdjacentHTML("beforeend", "<span class='flatpickr-day'>" + self.config.getWeek(date) + "</span>");
    }
    triggerEvent("onDayCreate", dayElement);
    return dayElement;
  }
  function focusOnDayElem(targetNode) {
    targetNode.focus();
    if (self.config.mode === "range")
      onMouseOver(targetNode);
  }
  function getFirstAvailableDay(delta) {
    var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    for (var m = startMonth; m != endMonth; m += delta) {
      var month = self.daysContainer.children[m];
      var startIndex = delta > 0 ? 0 : month.children.length - 1;
      var endIndex = delta > 0 ? month.children.length : -1;
      for (var i = startIndex; i != endIndex; i += delta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj))
          return c;
      }
    }
    return void 0;
  }
  function getNextAvailableDay(current, delta) {
    var givenMonth = current.className.indexOf("Month") === -1 ? current.dateObj.getMonth() : self.currentMonth;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    var loopDelta = delta > 0 ? 1 : -1;
    for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {
      var month = self.daysContainer.children[m];
      var startIndex = givenMonth - self.currentMonth === m ? current.$i + delta : delta < 0 ? month.children.length - 1 : 0;
      var numMonthDays = month.children.length;
      for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj) && Math.abs(current.$i - i) >= Math.abs(delta))
          return focusOnDayElem(c);
      }
    }
    self.changeMonth(loopDelta);
    focusOnDay(getFirstAvailableDay(loopDelta), 0);
    return void 0;
  }
  function focusOnDay(current, offset2) {
    var activeElement = getClosestActiveElement();
    var dayFocused = isInView(activeElement || document.body);
    var startElem = current !== void 0 ? current : dayFocused ? activeElement : self.selectedDateElem !== void 0 && isInView(self.selectedDateElem) ? self.selectedDateElem : self.todayDateElem !== void 0 && isInView(self.todayDateElem) ? self.todayDateElem : getFirstAvailableDay(offset2 > 0 ? 1 : -1);
    if (startElem === void 0) {
      self._input.focus();
    } else if (!dayFocused) {
      focusOnDayElem(startElem);
    } else {
      getNextAvailableDay(startElem, offset2);
    }
  }
  function buildMonthDays(year, month) {
    var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;
    var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);
    var daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? "prevMonthDay hidden" : "prevMonthDay", nextMonthDayClass = isMultiMonth ? "nextMonthDay hidden" : "nextMonthDay";
    var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;
    for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));
    }
    for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day", new Date(year, month, dayNumber), dayNumber, dayIndex));
    }
    for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth && (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));
    }
    var dayContainer = createElement("div", "dayContainer");
    dayContainer.appendChild(days);
    return dayContainer;
  }
  function buildDays() {
    if (self.daysContainer === void 0) {
      return;
    }
    clearNode(self.daysContainer);
    if (self.weekNumbers)
      clearNode(self.weekNumbers);
    var frag = document.createDocumentFragment();
    for (var i = 0; i < self.config.showMonths; i++) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));
    }
    self.daysContainer.appendChild(frag);
    self.days = self.daysContainer.firstChild;
    if (self.config.mode === "range" && self.selectedDates.length === 1) {
      onMouseOver();
    }
  }
  function buildMonthSwitch() {
    if (self.config.showMonths > 1 || self.config.monthSelectorType !== "dropdown")
      return;
    var shouldBuildMonth = function(month2) {
      if (self.config.minDate !== void 0 && self.currentYear === self.config.minDate.getFullYear() && month2 < self.config.minDate.getMonth()) {
        return false;
      }
      return !(self.config.maxDate !== void 0 && self.currentYear === self.config.maxDate.getFullYear() && month2 > self.config.maxDate.getMonth());
    };
    self.monthsDropdownContainer.tabIndex = -1;
    self.monthsDropdownContainer.innerHTML = "";
    for (var i = 0; i < 12; i++) {
      if (!shouldBuildMonth(i))
        continue;
      var month = createElement("option", "flatpickr-monthDropdown-month");
      month.value = new Date(self.currentYear, i).getMonth().toString();
      month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);
      month.tabIndex = -1;
      if (self.currentMonth === i) {
        month.selected = true;
      }
      self.monthsDropdownContainer.appendChild(month);
    }
  }
  function buildMonth() {
    var container = createElement("div", "flatpickr-month");
    var monthNavFragment = window.document.createDocumentFragment();
    var monthElement;
    if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
      monthElement = createElement("span", "cur-month");
    } else {
      self.monthsDropdownContainer = createElement("select", "flatpickr-monthDropdown-months");
      self.monthsDropdownContainer.setAttribute("aria-label", self.l10n.monthAriaLabel);
      bind(self.monthsDropdownContainer, "change", function(e) {
        var target = getEventTarget(e);
        var selectedMonth = parseInt(target.value, 10);
        self.changeMonth(selectedMonth - self.currentMonth);
        triggerEvent("onMonthChange");
      });
      buildMonthSwitch();
      monthElement = self.monthsDropdownContainer;
    }
    var yearInput = createNumberInput("cur-year", { tabindex: "-1" });
    var yearElement = yearInput.getElementsByTagName("input")[0];
    yearElement.setAttribute("aria-label", self.l10n.yearAriaLabel);
    if (self.config.minDate) {
      yearElement.setAttribute("min", self.config.minDate.getFullYear().toString());
    }
    if (self.config.maxDate) {
      yearElement.setAttribute("max", self.config.maxDate.getFullYear().toString());
      yearElement.disabled = !!self.config.minDate && self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();
    }
    var currentMonth = createElement("div", "flatpickr-current-month");
    currentMonth.appendChild(monthElement);
    currentMonth.appendChild(yearInput);
    monthNavFragment.appendChild(currentMonth);
    container.appendChild(monthNavFragment);
    return {
      container,
      yearElement,
      monthElement
    };
  }
  function buildMonths() {
    clearNode(self.monthNav);
    self.monthNav.appendChild(self.prevMonthNav);
    if (self.config.showMonths) {
      self.yearElements = [];
      self.monthElements = [];
    }
    for (var m = self.config.showMonths; m--; ) {
      var month = buildMonth();
      self.yearElements.push(month.yearElement);
      self.monthElements.push(month.monthElement);
      self.monthNav.appendChild(month.container);
    }
    self.monthNav.appendChild(self.nextMonthNav);
  }
  function buildMonthNav() {
    self.monthNav = createElement("div", "flatpickr-months");
    self.yearElements = [];
    self.monthElements = [];
    self.prevMonthNav = createElement("span", "flatpickr-prev-month");
    self.prevMonthNav.innerHTML = self.config.prevArrow;
    self.nextMonthNav = createElement("span", "flatpickr-next-month");
    self.nextMonthNav.innerHTML = self.config.nextArrow;
    buildMonths();
    Object.defineProperty(self, "_hidePrevMonthArrow", {
      get: function() {
        return self.__hidePrevMonthArrow;
      },
      set: function(bool) {
        if (self.__hidePrevMonthArrow !== bool) {
          toggleClass(self.prevMonthNav, "flatpickr-disabled", bool);
          self.__hidePrevMonthArrow = bool;
        }
      }
    });
    Object.defineProperty(self, "_hideNextMonthArrow", {
      get: function() {
        return self.__hideNextMonthArrow;
      },
      set: function(bool) {
        if (self.__hideNextMonthArrow !== bool) {
          toggleClass(self.nextMonthNav, "flatpickr-disabled", bool);
          self.__hideNextMonthArrow = bool;
        }
      }
    });
    self.currentYearElement = self.yearElements[0];
    updateNavigationCurrentMonth();
    return self.monthNav;
  }
  function buildTime() {
    self.calendarContainer.classList.add("hasTime");
    if (self.config.noCalendar)
      self.calendarContainer.classList.add("noCalendar");
    var defaults2 = getDefaultHours(self.config);
    self.timeContainer = createElement("div", "flatpickr-time");
    self.timeContainer.tabIndex = -1;
    var separator = createElement("span", "flatpickr-time-separator", ":");
    var hourInput = createNumberInput("flatpickr-hour", {
      "aria-label": self.l10n.hourAriaLabel
    });
    self.hourElement = hourInput.getElementsByTagName("input")[0];
    var minuteInput = createNumberInput("flatpickr-minute", {
      "aria-label": self.l10n.minuteAriaLabel
    });
    self.minuteElement = minuteInput.getElementsByTagName("input")[0];
    self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;
    self.hourElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getHours() : self.config.time_24hr ? defaults2.hours : military2ampm(defaults2.hours));
    self.minuteElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getMinutes() : defaults2.minutes);
    self.hourElement.setAttribute("step", self.config.hourIncrement.toString());
    self.minuteElement.setAttribute("step", self.config.minuteIncrement.toString());
    self.hourElement.setAttribute("min", self.config.time_24hr ? "0" : "1");
    self.hourElement.setAttribute("max", self.config.time_24hr ? "23" : "12");
    self.hourElement.setAttribute("maxlength", "2");
    self.minuteElement.setAttribute("min", "0");
    self.minuteElement.setAttribute("max", "59");
    self.minuteElement.setAttribute("maxlength", "2");
    self.timeContainer.appendChild(hourInput);
    self.timeContainer.appendChild(separator);
    self.timeContainer.appendChild(minuteInput);
    if (self.config.time_24hr)
      self.timeContainer.classList.add("time24hr");
    if (self.config.enableSeconds) {
      self.timeContainer.classList.add("hasSeconds");
      var secondInput = createNumberInput("flatpickr-second");
      self.secondElement = secondInput.getElementsByTagName("input")[0];
      self.secondElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getSeconds() : defaults2.seconds);
      self.secondElement.setAttribute("step", self.minuteElement.getAttribute("step"));
      self.secondElement.setAttribute("min", "0");
      self.secondElement.setAttribute("max", "59");
      self.secondElement.setAttribute("maxlength", "2");
      self.timeContainer.appendChild(createElement("span", "flatpickr-time-separator", ":"));
      self.timeContainer.appendChild(secondInput);
    }
    if (!self.config.time_24hr) {
      self.amPM = createElement("span", "flatpickr-am-pm", self.l10n.amPM[int((self.latestSelectedDateObj ? self.hourElement.value : self.config.defaultHour) > 11)]);
      self.amPM.title = self.l10n.toggleTitle;
      self.amPM.tabIndex = -1;
      self.timeContainer.appendChild(self.amPM);
    }
    return self.timeContainer;
  }
  function buildWeekdays() {
    if (!self.weekdayContainer)
      self.weekdayContainer = createElement("div", "flatpickr-weekdays");
    else
      clearNode(self.weekdayContainer);
    for (var i = self.config.showMonths; i--; ) {
      var container = createElement("div", "flatpickr-weekdaycontainer");
      self.weekdayContainer.appendChild(container);
    }
    updateWeekdays();
    return self.weekdayContainer;
  }
  function updateWeekdays() {
    if (!self.weekdayContainer) {
      return;
    }
    var firstDayOfWeek = self.l10n.firstDayOfWeek;
    var weekdays = __spreadArrays(self.l10n.weekdays.shorthand);
    if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {
      weekdays = __spreadArrays(weekdays.splice(firstDayOfWeek, weekdays.length), weekdays.splice(0, firstDayOfWeek));
    }
    for (var i = self.config.showMonths; i--; ) {
      self.weekdayContainer.children[i].innerHTML = "\n      <span class='flatpickr-weekday'>\n        " + weekdays.join("</span><span class='flatpickr-weekday'>") + "\n      </span>\n      ";
    }
  }
  function buildWeeks() {
    self.calendarContainer.classList.add("hasWeeks");
    var weekWrapper = createElement("div", "flatpickr-weekwrapper");
    weekWrapper.appendChild(createElement("span", "flatpickr-weekday", self.l10n.weekAbbreviation));
    var weekNumbers = createElement("div", "flatpickr-weeks");
    weekWrapper.appendChild(weekNumbers);
    return {
      weekWrapper,
      weekNumbers
    };
  }
  function changeMonth(value, isOffset) {
    if (isOffset === void 0) {
      isOffset = true;
    }
    var delta = isOffset ? value : value - self.currentMonth;
    if (delta < 0 && self._hidePrevMonthArrow === true || delta > 0 && self._hideNextMonthArrow === true)
      return;
    self.currentMonth += delta;
    if (self.currentMonth < 0 || self.currentMonth > 11) {
      self.currentYear += self.currentMonth > 11 ? 1 : -1;
      self.currentMonth = (self.currentMonth + 12) % 12;
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    buildDays();
    triggerEvent("onMonthChange");
    updateNavigationCurrentMonth();
  }
  function clear(triggerChangeEvent, toInitial) {
    if (triggerChangeEvent === void 0) {
      triggerChangeEvent = true;
    }
    if (toInitial === void 0) {
      toInitial = true;
    }
    self.input.value = "";
    if (self.altInput !== void 0)
      self.altInput.value = "";
    if (self.mobileInput !== void 0)
      self.mobileInput.value = "";
    self.selectedDates = [];
    self.latestSelectedDateObj = void 0;
    if (toInitial === true) {
      self.currentYear = self._initialDate.getFullYear();
      self.currentMonth = self._initialDate.getMonth();
    }
    if (self.config.enableTime === true) {
      var _a = getDefaultHours(self.config), hours = _a.hours, minutes = _a.minutes, seconds = _a.seconds;
      setHours(hours, minutes, seconds);
    }
    self.redraw();
    if (triggerChangeEvent)
      triggerEvent("onChange");
  }
  function close() {
    self.isOpen = false;
    if (!self.isMobile) {
      if (self.calendarContainer !== void 0) {
        self.calendarContainer.classList.remove("open");
      }
      if (self._input !== void 0) {
        self._input.classList.remove("active");
      }
    }
    triggerEvent("onClose");
  }
  function destroy() {
    if (self.config !== void 0)
      triggerEvent("onDestroy");
    for (var i = self._handlers.length; i--; ) {
      self._handlers[i].remove();
    }
    self._handlers = [];
    if (self.mobileInput) {
      if (self.mobileInput.parentNode)
        self.mobileInput.parentNode.removeChild(self.mobileInput);
      self.mobileInput = void 0;
    } else if (self.calendarContainer && self.calendarContainer.parentNode) {
      if (self.config.static && self.calendarContainer.parentNode) {
        var wrapper = self.calendarContainer.parentNode;
        wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);
        if (wrapper.parentNode) {
          while (wrapper.firstChild)
            wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);
          wrapper.parentNode.removeChild(wrapper);
        }
      } else
        self.calendarContainer.parentNode.removeChild(self.calendarContainer);
    }
    if (self.altInput) {
      self.input.type = "text";
      if (self.altInput.parentNode)
        self.altInput.parentNode.removeChild(self.altInput);
      delete self.altInput;
    }
    if (self.input) {
      self.input.type = self.input._type;
      self.input.classList.remove("flatpickr-input");
      self.input.removeAttribute("readonly");
    }
    [
      "_showTimeInput",
      "latestSelectedDateObj",
      "_hideNextMonthArrow",
      "_hidePrevMonthArrow",
      "__hideNextMonthArrow",
      "__hidePrevMonthArrow",
      "isMobile",
      "isOpen",
      "selectedDateElem",
      "minDateHasTime",
      "maxDateHasTime",
      "days",
      "daysContainer",
      "_input",
      "_positionElement",
      "innerContainer",
      "rContainer",
      "monthNav",
      "todayDateElem",
      "calendarContainer",
      "weekdayContainer",
      "prevMonthNav",
      "nextMonthNav",
      "monthsDropdownContainer",
      "currentMonthElement",
      "currentYearElement",
      "navigationCurrentMonth",
      "selectedDateElem",
      "config"
    ].forEach(function(k) {
      try {
        delete self[k];
      } catch (_) {
      }
    });
  }
  function isCalendarElem(elem) {
    return self.calendarContainer.contains(elem);
  }
  function documentClick(e) {
    if (self.isOpen && !self.config.inline) {
      var eventTarget_1 = getEventTarget(e);
      var isCalendarElement = isCalendarElem(eventTarget_1);
      var isInput = eventTarget_1 === self.input || eventTarget_1 === self.altInput || self.element.contains(eventTarget_1) || e.path && e.path.indexOf && (~e.path.indexOf(self.input) || ~e.path.indexOf(self.altInput));
      var lostFocus = !isInput && !isCalendarElement && !isCalendarElem(e.relatedTarget);
      var isIgnored = !self.config.ignoredFocusElements.some(function(elem) {
        return elem.contains(eventTarget_1);
      });
      if (lostFocus && isIgnored) {
        if (self.config.allowInput) {
          self.setDate(self._input.value, false, self.config.altInput ? self.config.altFormat : self.config.dateFormat);
        }
        if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0 && self.input.value !== "" && self.input.value !== void 0) {
          updateTime();
        }
        self.close();
        if (self.config && self.config.mode === "range" && self.selectedDates.length === 1)
          self.clear(false);
      }
    }
  }
  function changeYear(newYear) {
    if (!newYear || self.config.minDate && newYear < self.config.minDate.getFullYear() || self.config.maxDate && newYear > self.config.maxDate.getFullYear())
      return;
    var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;
    self.currentYear = newYearNum || self.currentYear;
    if (self.config.maxDate && self.currentYear === self.config.maxDate.getFullYear()) {
      self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);
    } else if (self.config.minDate && self.currentYear === self.config.minDate.getFullYear()) {
      self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);
    }
    if (isNewYear) {
      self.redraw();
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
  }
  function isEnabled(date, timeless) {
    var _a;
    if (timeless === void 0) {
      timeless = true;
    }
    var dateToCheck = self.parseDate(date, void 0, timeless);
    if (self.config.minDate && dateToCheck && compareDates(dateToCheck, self.config.minDate, timeless !== void 0 ? timeless : !self.minDateHasTime) < 0 || self.config.maxDate && dateToCheck && compareDates(dateToCheck, self.config.maxDate, timeless !== void 0 ? timeless : !self.maxDateHasTime) > 0)
      return false;
    if (!self.config.enable && self.config.disable.length === 0)
      return true;
    if (dateToCheck === void 0)
      return false;
    var bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;
    for (var i = 0, d = void 0; i < array.length; i++) {
      d = array[i];
      if (typeof d === "function" && d(dateToCheck))
        return bool;
      else if (d instanceof Date && dateToCheck !== void 0 && d.getTime() === dateToCheck.getTime())
        return bool;
      else if (typeof d === "string") {
        var parsed = self.parseDate(d, void 0, true);
        return parsed && parsed.getTime() === dateToCheck.getTime() ? bool : !bool;
      } else if (typeof d === "object" && dateToCheck !== void 0 && d.from && d.to && dateToCheck.getTime() >= d.from.getTime() && dateToCheck.getTime() <= d.to.getTime())
        return bool;
    }
    return !bool;
  }
  function isInView(elem) {
    if (self.daysContainer !== void 0)
      return elem.className.indexOf("hidden") === -1 && elem.className.indexOf("flatpickr-disabled") === -1 && self.daysContainer.contains(elem);
    return false;
  }
  function onBlur(e) {
    var isInput = e.target === self._input;
    var valueChanged = self._input.value.trimEnd() !== getDateStr();
    if (isInput && valueChanged && !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {
      self.setDate(self._input.value, true, e.target === self.altInput ? self.config.altFormat : self.config.dateFormat);
    }
  }
  function onKeyDown(e) {
    var eventTarget = getEventTarget(e);
    var isInput = self.config.wrap ? element.contains(eventTarget) : eventTarget === self._input;
    var allowInput = self.config.allowInput;
    var allowKeydown = self.isOpen && (!allowInput || !isInput);
    var allowInlineKeydown = self.config.inline && isInput && !allowInput;
    if (e.keyCode === 13 && isInput) {
      if (allowInput) {
        self.setDate(self._input.value, true, eventTarget === self.altInput ? self.config.altFormat : self.config.dateFormat);
        self.close();
        return eventTarget.blur();
      } else {
        self.open();
      }
    } else if (isCalendarElem(eventTarget) || allowKeydown || allowInlineKeydown) {
      var isTimeObj = !!self.timeContainer && self.timeContainer.contains(eventTarget);
      switch (e.keyCode) {
        case 13:
          if (isTimeObj) {
            e.preventDefault();
            updateTime();
            focusAndClose();
          } else
            selectDate(e);
          break;
        case 27:
          e.preventDefault();
          focusAndClose();
          break;
        case 8:
        case 46:
          if (isInput && !self.config.allowInput) {
            e.preventDefault();
            self.clear();
          }
          break;
        case 37:
        case 39:
          if (!isTimeObj && !isInput) {
            e.preventDefault();
            var activeElement = getClosestActiveElement();
            if (self.daysContainer !== void 0 && (allowInput === false || activeElement && isInView(activeElement))) {
              var delta_1 = e.keyCode === 39 ? 1 : -1;
              if (!e.ctrlKey)
                focusOnDay(void 0, delta_1);
              else {
                e.stopPropagation();
                changeMonth(delta_1);
                focusOnDay(getFirstAvailableDay(1), 0);
              }
            }
          } else if (self.hourElement)
            self.hourElement.focus();
          break;
        case 38:
        case 40:
          e.preventDefault();
          var delta = e.keyCode === 40 ? 1 : -1;
          if (self.daysContainer && eventTarget.$i !== void 0 || eventTarget === self.input || eventTarget === self.altInput) {
            if (e.ctrlKey) {
              e.stopPropagation();
              changeYear(self.currentYear - delta);
              focusOnDay(getFirstAvailableDay(1), 0);
            } else if (!isTimeObj)
              focusOnDay(void 0, delta * 7);
          } else if (eventTarget === self.currentYearElement) {
            changeYear(self.currentYear - delta);
          } else if (self.config.enableTime) {
            if (!isTimeObj && self.hourElement)
              self.hourElement.focus();
            updateTime(e);
            self._debouncedChange();
          }
          break;
        case 9:
          if (isTimeObj) {
            var elems = [
              self.hourElement,
              self.minuteElement,
              self.secondElement,
              self.amPM
            ].concat(self.pluginElements).filter(function(x) {
              return x;
            });
            var i = elems.indexOf(eventTarget);
            if (i !== -1) {
              var target = elems[i + (e.shiftKey ? -1 : 1)];
              e.preventDefault();
              (target || self._input).focus();
            }
          } else if (!self.config.noCalendar && self.daysContainer && self.daysContainer.contains(eventTarget) && e.shiftKey) {
            e.preventDefault();
            self._input.focus();
          }
          break;
        default:
          break;
      }
    }
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      switch (e.key) {
        case self.l10n.amPM[0].charAt(0):
        case self.l10n.amPM[0].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[0];
          setHoursFromInputs();
          updateValue();
          break;
        case self.l10n.amPM[1].charAt(0):
        case self.l10n.amPM[1].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[1];
          setHoursFromInputs();
          updateValue();
          break;
      }
    }
    if (isInput || isCalendarElem(eventTarget)) {
      triggerEvent("onKeyDown", e);
    }
  }
  function onMouseOver(elem, cellClass) {
    if (cellClass === void 0) {
      cellClass = "flatpickr-day";
    }
    if (self.selectedDates.length !== 1 || elem && (!elem.classList.contains(cellClass) || elem.classList.contains("flatpickr-disabled")))
      return;
    var hoverDate = elem ? elem.dateObj.getTime() : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], void 0, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());
    var containsDisabled = false;
    var minRange = 0, maxRange = 0;
    for (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {
      if (!isEnabled(new Date(t), true)) {
        containsDisabled = containsDisabled || t > rangeStartDate && t < rangeEndDate;
        if (t < initialDate && (!minRange || t > minRange))
          minRange = t;
        else if (t > initialDate && (!maxRange || t < maxRange))
          maxRange = t;
      }
    }
    var hoverableCells = Array.from(self.rContainer.querySelectorAll("*:nth-child(-n+" + self.config.showMonths + ") > ." + cellClass));
    hoverableCells.forEach(function(dayElem) {
      var date = dayElem.dateObj;
      var timestamp = date.getTime();
      var outOfRange = minRange > 0 && timestamp < minRange || maxRange > 0 && timestamp > maxRange;
      if (outOfRange) {
        dayElem.classList.add("notAllowed");
        ["inRange", "startRange", "endRange"].forEach(function(c) {
          dayElem.classList.remove(c);
        });
        return;
      } else if (containsDisabled && !outOfRange)
        return;
      ["startRange", "inRange", "endRange", "notAllowed"].forEach(function(c) {
        dayElem.classList.remove(c);
      });
      if (elem !== void 0) {
        elem.classList.add(hoverDate <= self.selectedDates[0].getTime() ? "startRange" : "endRange");
        if (initialDate < hoverDate && timestamp === initialDate)
          dayElem.classList.add("startRange");
        else if (initialDate > hoverDate && timestamp === initialDate)
          dayElem.classList.add("endRange");
        if (timestamp >= minRange && (maxRange === 0 || timestamp <= maxRange) && isBetween(timestamp, initialDate, hoverDate))
          dayElem.classList.add("inRange");
      }
    });
  }
  function onResize() {
    if (self.isOpen && !self.config.static && !self.config.inline)
      positionCalendar();
  }
  function open(e, positionElement) {
    if (positionElement === void 0) {
      positionElement = self._positionElement;
    }
    if (self.isMobile === true) {
      if (e) {
        e.preventDefault();
        var eventTarget = getEventTarget(e);
        if (eventTarget) {
          eventTarget.blur();
        }
      }
      if (self.mobileInput !== void 0) {
        self.mobileInput.focus();
        self.mobileInput.click();
      }
      triggerEvent("onOpen");
      return;
    } else if (self._input.disabled || self.config.inline) {
      return;
    }
    var wasOpen = self.isOpen;
    self.isOpen = true;
    if (!wasOpen) {
      self.calendarContainer.classList.add("open");
      self._input.classList.add("active");
      triggerEvent("onOpen");
      positionCalendar(positionElement);
    }
    if (self.config.enableTime === true && self.config.noCalendar === true) {
      if (self.config.allowInput === false && (e === void 0 || !self.timeContainer.contains(e.relatedTarget))) {
        setTimeout(function() {
          return self.hourElement.select();
        }, 50);
      }
    }
  }
  function minMaxDateSetter(type) {
    return function(date) {
      var dateObj = self.config["_" + type + "Date"] = self.parseDate(date, self.config.dateFormat);
      var inverseDateObj = self.config["_" + (type === "min" ? "max" : "min") + "Date"];
      if (dateObj !== void 0) {
        self[type === "min" ? "minDateHasTime" : "maxDateHasTime"] = dateObj.getHours() > 0 || dateObj.getMinutes() > 0 || dateObj.getSeconds() > 0;
      }
      if (self.selectedDates) {
        self.selectedDates = self.selectedDates.filter(function(d) {
          return isEnabled(d);
        });
        if (!self.selectedDates.length && type === "min")
          setHoursFromDate(dateObj);
        updateValue();
      }
      if (self.daysContainer) {
        redraw();
        if (dateObj !== void 0)
          self.currentYearElement[type] = dateObj.getFullYear().toString();
        else
          self.currentYearElement.removeAttribute(type);
        self.currentYearElement.disabled = !!inverseDateObj && dateObj !== void 0 && inverseDateObj.getFullYear() === dateObj.getFullYear();
      }
    };
  }
  function parseConfig() {
    var boolOpts = [
      "wrap",
      "weekNumbers",
      "allowInput",
      "allowInvalidPreload",
      "clickOpens",
      "time_24hr",
      "enableTime",
      "noCalendar",
      "altInput",
      "shorthandCurrentMonth",
      "inline",
      "static",
      "enableSeconds",
      "disableMobile"
    ];
    var userConfig = __assign(__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);
    var formats2 = {};
    self.config.parseDate = userConfig.parseDate;
    self.config.formatDate = userConfig.formatDate;
    Object.defineProperty(self.config, "enable", {
      get: function() {
        return self.config._enable;
      },
      set: function(dates) {
        self.config._enable = parseDateRules(dates);
      }
    });
    Object.defineProperty(self.config, "disable", {
      get: function() {
        return self.config._disable;
      },
      set: function(dates) {
        self.config._disable = parseDateRules(dates);
      }
    });
    var timeMode = userConfig.mode === "time";
    if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {
      var defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaults.dateFormat;
      formats2.dateFormat = userConfig.noCalendar || timeMode ? "H:i" + (userConfig.enableSeconds ? ":S" : "") : defaultDateFormat + " H:i" + (userConfig.enableSeconds ? ":S" : "");
    }
    if (userConfig.altInput && (userConfig.enableTime || timeMode) && !userConfig.altFormat) {
      var defaultAltFormat = flatpickr.defaultConfig.altFormat || defaults.altFormat;
      formats2.altFormat = userConfig.noCalendar || timeMode ? "h:i" + (userConfig.enableSeconds ? ":S K" : " K") : defaultAltFormat + (" h:i" + (userConfig.enableSeconds ? ":S" : "") + " K");
    }
    Object.defineProperty(self.config, "minDate", {
      get: function() {
        return self.config._minDate;
      },
      set: minMaxDateSetter("min")
    });
    Object.defineProperty(self.config, "maxDate", {
      get: function() {
        return self.config._maxDate;
      },
      set: minMaxDateSetter("max")
    });
    var minMaxTimeSetter = function(type) {
      return function(val) {
        self.config[type === "min" ? "_minTime" : "_maxTime"] = self.parseDate(val, "H:i:S");
      };
    };
    Object.defineProperty(self.config, "minTime", {
      get: function() {
        return self.config._minTime;
      },
      set: minMaxTimeSetter("min")
    });
    Object.defineProperty(self.config, "maxTime", {
      get: function() {
        return self.config._maxTime;
      },
      set: minMaxTimeSetter("max")
    });
    if (userConfig.mode === "time") {
      self.config.noCalendar = true;
      self.config.enableTime = true;
    }
    Object.assign(self.config, formats2, userConfig);
    for (var i = 0; i < boolOpts.length; i++)
      self.config[boolOpts[i]] = self.config[boolOpts[i]] === true || self.config[boolOpts[i]] === "true";
    HOOKS.filter(function(hook) {
      return self.config[hook] !== void 0;
    }).forEach(function(hook) {
      self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);
    });
    self.isMobile = !self.config.disableMobile && !self.config.inline && self.config.mode === "single" && !self.config.disable.length && !self.config.enable && !self.config.weekNumbers && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    for (var i = 0; i < self.config.plugins.length; i++) {
      var pluginConf = self.config.plugins[i](self) || {};
      for (var key in pluginConf) {
        if (HOOKS.indexOf(key) > -1) {
          self.config[key] = arrayify(pluginConf[key]).map(bindToInstance).concat(self.config[key]);
        } else if (typeof userConfig[key] === "undefined")
          self.config[key] = pluginConf[key];
      }
    }
    if (!userConfig.altInputClass) {
      self.config.altInputClass = getInputElem().className + " " + self.config.altInputClass;
    }
    triggerEvent("onParseConfig");
  }
  function getInputElem() {
    return self.config.wrap ? element.querySelector("[data-input]") : element;
  }
  function setupLocale() {
    if (typeof self.config.locale !== "object" && typeof flatpickr.l10ns[self.config.locale] === "undefined")
      self.config.errorHandler(new Error("flatpickr: invalid locale " + self.config.locale));
    self.l10n = __assign(__assign({}, flatpickr.l10ns.default), typeof self.config.locale === "object" ? self.config.locale : self.config.locale !== "default" ? flatpickr.l10ns[self.config.locale] : void 0);
    tokenRegex.D = "(" + self.l10n.weekdays.shorthand.join("|") + ")";
    tokenRegex.l = "(" + self.l10n.weekdays.longhand.join("|") + ")";
    tokenRegex.M = "(" + self.l10n.months.shorthand.join("|") + ")";
    tokenRegex.F = "(" + self.l10n.months.longhand.join("|") + ")";
    tokenRegex.K = "(" + self.l10n.amPM[0] + "|" + self.l10n.amPM[1] + "|" + self.l10n.amPM[0].toLowerCase() + "|" + self.l10n.amPM[1].toLowerCase() + ")";
    var userConfig = __assign(__assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));
    if (userConfig.time_24hr === void 0 && flatpickr.defaultConfig.time_24hr === void 0) {
      self.config.time_24hr = self.l10n.time_24hr;
    }
    self.formatDate = createDateFormatter(self);
    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  }
  function positionCalendar(customPositionElement) {
    if (typeof self.config.position === "function") {
      return void self.config.position(self, customPositionElement);
    }
    if (self.calendarContainer === void 0)
      return;
    triggerEvent("onPreCalendarPosition");
    var positionElement = customPositionElement || self._positionElement;
    var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, function(acc, child) {
      return acc + child.offsetHeight;
    }, 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(" "), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === "above" || configPosVertical !== "below" && distanceFromBottom < calendarHeight && inputBounds.top > calendarHeight;
    var top2 = window.pageYOffset + inputBounds.top + (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);
    toggleClass(self.calendarContainer, "arrowTop", !showOnTop);
    toggleClass(self.calendarContainer, "arrowBottom", showOnTop);
    if (self.config.inline)
      return;
    var left2 = window.pageXOffset + inputBounds.left;
    var isCenter = false;
    var isRight = false;
    if (configPosHorizontal === "center") {
      left2 -= (calendarWidth - inputBounds.width) / 2;
      isCenter = true;
    } else if (configPosHorizontal === "right") {
      left2 -= calendarWidth - inputBounds.width;
      isRight = true;
    }
    toggleClass(self.calendarContainer, "arrowLeft", !isCenter && !isRight);
    toggleClass(self.calendarContainer, "arrowCenter", isCenter);
    toggleClass(self.calendarContainer, "arrowRight", isRight);
    var right2 = window.document.body.offsetWidth - (window.pageXOffset + inputBounds.right);
    var rightMost = left2 + calendarWidth > window.document.body.offsetWidth;
    var centerMost = right2 + calendarWidth > window.document.body.offsetWidth;
    toggleClass(self.calendarContainer, "rightMost", rightMost);
    if (self.config.static)
      return;
    self.calendarContainer.style.top = top2 + "px";
    if (!rightMost) {
      self.calendarContainer.style.left = left2 + "px";
      self.calendarContainer.style.right = "auto";
    } else if (!centerMost) {
      self.calendarContainer.style.left = "auto";
      self.calendarContainer.style.right = right2 + "px";
    } else {
      var doc = getDocumentStyleSheet();
      if (doc === void 0)
        return;
      var bodyWidth = window.document.body.offsetWidth;
      var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);
      var centerBefore = ".flatpickr-calendar.centerMost:before";
      var centerAfter = ".flatpickr-calendar.centerMost:after";
      var centerIndex = doc.cssRules.length;
      var centerStyle = "{left:" + inputBounds.left + "px;right:auto;}";
      toggleClass(self.calendarContainer, "rightMost", false);
      toggleClass(self.calendarContainer, "centerMost", true);
      doc.insertRule(centerBefore + "," + centerAfter + centerStyle, centerIndex);
      self.calendarContainer.style.left = centerLeft + "px";
      self.calendarContainer.style.right = "auto";
    }
  }
  function getDocumentStyleSheet() {
    var editableSheet = null;
    for (var i = 0; i < document.styleSheets.length; i++) {
      var sheet = document.styleSheets[i];
      if (!sheet.cssRules)
        continue;
      try {
        sheet.cssRules;
      } catch (err) {
        continue;
      }
      editableSheet = sheet;
      break;
    }
    return editableSheet != null ? editableSheet : createStyleSheet();
  }
  function createStyleSheet() {
    var style = document.createElement("style");
    document.head.appendChild(style);
    return style.sheet;
  }
  function redraw() {
    if (self.config.noCalendar || self.isMobile)
      return;
    buildMonthSwitch();
    updateNavigationCurrentMonth();
    buildDays();
  }
  function focusAndClose() {
    self._input.focus();
    if (window.navigator.userAgent.indexOf("MSIE") !== -1 || navigator.msMaxTouchPoints !== void 0) {
      setTimeout(self.close, 0);
    } else {
      self.close();
    }
  }
  function selectDate(e) {
    e.preventDefault();
    e.stopPropagation();
    var isSelectable = function(day) {
      return day.classList && day.classList.contains("flatpickr-day") && !day.classList.contains("flatpickr-disabled") && !day.classList.contains("notAllowed");
    };
    var t = findParent(getEventTarget(e), isSelectable);
    if (t === void 0)
      return;
    var target = t;
    var selectedDate = self.latestSelectedDateObj = new Date(target.dateObj.getTime());
    var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth || selectedDate.getMonth() > self.currentMonth + self.config.showMonths - 1) && self.config.mode !== "range";
    self.selectedDateElem = target;
    if (self.config.mode === "single")
      self.selectedDates = [selectedDate];
    else if (self.config.mode === "multiple") {
      var selectedIndex = isDateSelected(selectedDate);
      if (selectedIndex)
        self.selectedDates.splice(parseInt(selectedIndex), 1);
      else
        self.selectedDates.push(selectedDate);
    } else if (self.config.mode === "range") {
      if (self.selectedDates.length === 2) {
        self.clear(false, false);
      }
      self.latestSelectedDateObj = selectedDate;
      self.selectedDates.push(selectedDate);
      if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)
        self.selectedDates.sort(function(a, b) {
          return a.getTime() - b.getTime();
        });
    }
    setHoursFromInputs();
    if (shouldChangeMonth) {
      var isNewYear = self.currentYear !== selectedDate.getFullYear();
      self.currentYear = selectedDate.getFullYear();
      self.currentMonth = selectedDate.getMonth();
      if (isNewYear) {
        triggerEvent("onYearChange");
        buildMonthSwitch();
      }
      triggerEvent("onMonthChange");
    }
    updateNavigationCurrentMonth();
    buildDays();
    updateValue();
    if (!shouldChangeMonth && self.config.mode !== "range" && self.config.showMonths === 1)
      focusOnDayElem(target);
    else if (self.selectedDateElem !== void 0 && self.hourElement === void 0) {
      self.selectedDateElem && self.selectedDateElem.focus();
    }
    if (self.hourElement !== void 0)
      self.hourElement !== void 0 && self.hourElement.focus();
    if (self.config.closeOnSelect) {
      var single = self.config.mode === "single" && !self.config.enableTime;
      var range = self.config.mode === "range" && self.selectedDates.length === 2 && !self.config.enableTime;
      if (single || range) {
        focusAndClose();
      }
    }
    triggerChange();
  }
  var CALLBACKS = {
    locale: [setupLocale, updateWeekdays],
    showMonths: [buildMonths, setCalendarWidth, buildWeekdays],
    minDate: [jumpToDate],
    maxDate: [jumpToDate],
    positionElement: [updatePositionElement],
    clickOpens: [
      function() {
        if (self.config.clickOpens === true) {
          bind(self._input, "focus", self.open);
          bind(self._input, "click", self.open);
        } else {
          self._input.removeEventListener("focus", self.open);
          self._input.removeEventListener("click", self.open);
        }
      }
    ]
  };
  function set(option, value) {
    if (option !== null && typeof option === "object") {
      Object.assign(self.config, option);
      for (var key in option) {
        if (CALLBACKS[key] !== void 0)
          CALLBACKS[key].forEach(function(x) {
            return x();
          });
      }
    } else {
      self.config[option] = value;
      if (CALLBACKS[option] !== void 0)
        CALLBACKS[option].forEach(function(x) {
          return x();
        });
      else if (HOOKS.indexOf(option) > -1)
        self.config[option] = arrayify(value);
    }
    self.redraw();
    updateValue(true);
  }
  function setSelectedDate(inputDate, format2) {
    var dates = [];
    if (inputDate instanceof Array)
      dates = inputDate.map(function(d) {
        return self.parseDate(d, format2);
      });
    else if (inputDate instanceof Date || typeof inputDate === "number")
      dates = [self.parseDate(inputDate, format2)];
    else if (typeof inputDate === "string") {
      switch (self.config.mode) {
        case "single":
        case "time":
          dates = [self.parseDate(inputDate, format2)];
          break;
        case "multiple":
          dates = inputDate.split(self.config.conjunction).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        case "range":
          dates = inputDate.split(self.l10n.rangeSeparator).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        default:
          break;
      }
    } else
      self.config.errorHandler(new Error("Invalid date supplied: " + JSON.stringify(inputDate)));
    self.selectedDates = self.config.allowInvalidPreload ? dates : dates.filter(function(d) {
      return d instanceof Date && isEnabled(d, false);
    });
    if (self.config.mode === "range")
      self.selectedDates.sort(function(a, b) {
        return a.getTime() - b.getTime();
      });
  }
  function setDate(date, triggerChange2, format2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = false;
    }
    if (format2 === void 0) {
      format2 = self.config.dateFormat;
    }
    if (date !== 0 && !date || date instanceof Array && date.length === 0)
      return self.clear(triggerChange2);
    setSelectedDate(date, format2);
    self.latestSelectedDateObj = self.selectedDates[self.selectedDates.length - 1];
    self.redraw();
    jumpToDate(void 0, triggerChange2);
    setHoursFromDate();
    if (self.selectedDates.length === 0) {
      self.clear(false);
    }
    updateValue(triggerChange2);
    if (triggerChange2)
      triggerEvent("onChange");
  }
  function parseDateRules(arr) {
    return arr.slice().map(function(rule) {
      if (typeof rule === "string" || typeof rule === "number" || rule instanceof Date) {
        return self.parseDate(rule, void 0, true);
      } else if (rule && typeof rule === "object" && rule.from && rule.to)
        return {
          from: self.parseDate(rule.from, void 0),
          to: self.parseDate(rule.to, void 0)
        };
      return rule;
    }).filter(function(x) {
      return x;
    });
  }
  function setupDates() {
    self.selectedDates = [];
    self.now = self.parseDate(self.config.now) || new Date();
    var preloadedDate = self.config.defaultDate || ((self.input.nodeName === "INPUT" || self.input.nodeName === "TEXTAREA") && self.input.placeholder && self.input.value === self.input.placeholder ? null : self.input.value);
    if (preloadedDate)
      setSelectedDate(preloadedDate, self.config.dateFormat);
    self._initialDate = self.selectedDates.length > 0 ? self.selectedDates[0] : self.config.minDate && self.config.minDate.getTime() > self.now.getTime() ? self.config.minDate : self.config.maxDate && self.config.maxDate.getTime() < self.now.getTime() ? self.config.maxDate : self.now;
    self.currentYear = self._initialDate.getFullYear();
    self.currentMonth = self._initialDate.getMonth();
    if (self.selectedDates.length > 0)
      self.latestSelectedDateObj = self.selectedDates[0];
    if (self.config.minTime !== void 0)
      self.config.minTime = self.parseDate(self.config.minTime, "H:i");
    if (self.config.maxTime !== void 0)
      self.config.maxTime = self.parseDate(self.config.maxTime, "H:i");
    self.minDateHasTime = !!self.config.minDate && (self.config.minDate.getHours() > 0 || self.config.minDate.getMinutes() > 0 || self.config.minDate.getSeconds() > 0);
    self.maxDateHasTime = !!self.config.maxDate && (self.config.maxDate.getHours() > 0 || self.config.maxDate.getMinutes() > 0 || self.config.maxDate.getSeconds() > 0);
  }
  function setupInputs() {
    self.input = getInputElem();
    if (!self.input) {
      self.config.errorHandler(new Error("Invalid input element specified"));
      return;
    }
    self.input._type = self.input.type;
    self.input.type = "text";
    self.input.classList.add("flatpickr-input");
    self._input = self.input;
    if (self.config.altInput) {
      self.altInput = createElement(self.input.nodeName, self.config.altInputClass);
      self._input = self.altInput;
      self.altInput.placeholder = self.input.placeholder;
      self.altInput.disabled = self.input.disabled;
      self.altInput.required = self.input.required;
      self.altInput.tabIndex = self.input.tabIndex;
      self.altInput.type = "text";
      self.input.setAttribute("type", "hidden");
      if (!self.config.static && self.input.parentNode)
        self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);
    }
    if (!self.config.allowInput)
      self._input.setAttribute("readonly", "readonly");
    updatePositionElement();
  }
  function updatePositionElement() {
    self._positionElement = self.config.positionElement || self._input;
  }
  function setupMobile() {
    var inputType = self.config.enableTime ? self.config.noCalendar ? "time" : "datetime-local" : "date";
    self.mobileInput = createElement("input", self.input.className + " flatpickr-mobile");
    self.mobileInput.tabIndex = 1;
    self.mobileInput.type = inputType;
    self.mobileInput.disabled = self.input.disabled;
    self.mobileInput.required = self.input.required;
    self.mobileInput.placeholder = self.input.placeholder;
    self.mobileFormatStr = inputType === "datetime-local" ? "Y-m-d\\TH:i:S" : inputType === "date" ? "Y-m-d" : "H:i:S";
    if (self.selectedDates.length > 0) {
      self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);
    }
    if (self.config.minDate)
      self.mobileInput.min = self.formatDate(self.config.minDate, "Y-m-d");
    if (self.config.maxDate)
      self.mobileInput.max = self.formatDate(self.config.maxDate, "Y-m-d");
    if (self.input.getAttribute("step"))
      self.mobileInput.step = String(self.input.getAttribute("step"));
    self.input.type = "hidden";
    if (self.altInput !== void 0)
      self.altInput.type = "hidden";
    try {
      if (self.input.parentNode)
        self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);
    } catch (_a) {
    }
    bind(self.mobileInput, "change", function(e) {
      self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);
      triggerEvent("onChange");
      triggerEvent("onClose");
    });
  }
  function toggle(e) {
    if (self.isOpen === true)
      return self.close();
    self.open(e);
  }
  function triggerEvent(event, data) {
    if (self.config === void 0)
      return;
    var hooks = self.config[event];
    if (hooks !== void 0 && hooks.length > 0) {
      for (var i = 0; hooks[i] && i < hooks.length; i++)
        hooks[i](self.selectedDates, self.input.value, self, data);
    }
    if (event === "onChange") {
      self.input.dispatchEvent(createEvent("change"));
      self.input.dispatchEvent(createEvent("input"));
    }
  }
  function createEvent(name) {
    var e = document.createEvent("Event");
    e.initEvent(name, true, true);
    return e;
  }
  function isDateSelected(date) {
    for (var i = 0; i < self.selectedDates.length; i++) {
      var selectedDate = self.selectedDates[i];
      if (selectedDate instanceof Date && compareDates(selectedDate, date) === 0)
        return "" + i;
    }
    return false;
  }
  function isDateInRange(date) {
    if (self.config.mode !== "range" || self.selectedDates.length < 2)
      return false;
    return compareDates(date, self.selectedDates[0]) >= 0 && compareDates(date, self.selectedDates[1]) <= 0;
  }
  function updateNavigationCurrentMonth() {
    if (self.config.noCalendar || self.isMobile || !self.monthNav)
      return;
    self.yearElements.forEach(function(yearElement, i) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
        self.monthElements[i].textContent = monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + " ";
      } else {
        self.monthsDropdownContainer.value = d.getMonth().toString();
      }
      yearElement.value = d.getFullYear().toString();
    });
    self._hidePrevMonthArrow = self.config.minDate !== void 0 && (self.currentYear === self.config.minDate.getFullYear() ? self.currentMonth <= self.config.minDate.getMonth() : self.currentYear < self.config.minDate.getFullYear());
    self._hideNextMonthArrow = self.config.maxDate !== void 0 && (self.currentYear === self.config.maxDate.getFullYear() ? self.currentMonth + 1 > self.config.maxDate.getMonth() : self.currentYear > self.config.maxDate.getFullYear());
  }
  function getDateStr(specificFormat) {
    var format2 = specificFormat || (self.config.altInput ? self.config.altFormat : self.config.dateFormat);
    return self.selectedDates.map(function(dObj) {
      return self.formatDate(dObj, format2);
    }).filter(function(d, i, arr) {
      return self.config.mode !== "range" || self.config.enableTime || arr.indexOf(d) === i;
    }).join(self.config.mode !== "range" ? self.config.conjunction : self.l10n.rangeSeparator);
  }
  function updateValue(triggerChange2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = true;
    }
    if (self.mobileInput !== void 0 && self.mobileFormatStr) {
      self.mobileInput.value = self.latestSelectedDateObj !== void 0 ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr) : "";
    }
    self.input.value = getDateStr(self.config.dateFormat);
    if (self.altInput !== void 0) {
      self.altInput.value = getDateStr(self.config.altFormat);
    }
    if (triggerChange2 !== false)
      triggerEvent("onValueUpdate");
  }
  function onMonthNavClick(e) {
    var eventTarget = getEventTarget(e);
    var isPrevMonth = self.prevMonthNav.contains(eventTarget);
    var isNextMonth = self.nextMonthNav.contains(eventTarget);
    if (isPrevMonth || isNextMonth) {
      changeMonth(isPrevMonth ? -1 : 1);
    } else if (self.yearElements.indexOf(eventTarget) >= 0) {
      eventTarget.select();
    } else if (eventTarget.classList.contains("arrowUp")) {
      self.changeYear(self.currentYear + 1);
    } else if (eventTarget.classList.contains("arrowDown")) {
      self.changeYear(self.currentYear - 1);
    }
  }
  function timeWrapper(e) {
    e.preventDefault();
    var isKeyDown = e.type === "keydown", eventTarget = getEventTarget(e), input = eventTarget;
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
    }
    var min2 = parseFloat(input.getAttribute("min")), max2 = parseFloat(input.getAttribute("max")), step = parseFloat(input.getAttribute("step")), curValue = parseInt(input.value, 10), delta = e.delta || (isKeyDown ? e.which === 38 ? 1 : -1 : 0);
    var newValue = curValue + step * delta;
    if (typeof input.value !== "undefined" && input.value.length === 2) {
      var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;
      if (newValue < min2) {
        newValue = max2 + newValue + int(!isHourElem) + (int(isHourElem) && int(!self.amPM));
        if (isMinuteElem)
          incrementNumInput(void 0, -1, self.hourElement);
      } else if (newValue > max2) {
        newValue = input === self.hourElement ? newValue - max2 - int(!self.amPM) : min2;
        if (isMinuteElem)
          incrementNumInput(void 0, 1, self.hourElement);
      }
      if (self.amPM && isHourElem && (step === 1 ? newValue + curValue === 23 : Math.abs(newValue - curValue) > step)) {
        self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
      }
      input.value = pad(newValue);
    }
  }
  init();
  return self;
}
function _flatpickr(nodeList, config) {
  var nodes = Array.prototype.slice.call(nodeList).filter(function(x) {
    return x instanceof HTMLElement;
  });
  var instances = [];
  for (var i = 0; i < nodes.length; i++) {
    var node = nodes[i];
    try {
      if (node.getAttribute("data-fp-omit") !== null)
        continue;
      if (node._flatpickr !== void 0) {
        node._flatpickr.destroy();
        node._flatpickr = void 0;
      }
      node._flatpickr = FlatpickrInstance(node, config || {});
      instances.push(node._flatpickr);
    } catch (e) {
      console.error(e);
    }
  }
  return instances.length === 1 ? instances[0] : instances;
}
if (typeof HTMLElement !== "undefined" && typeof HTMLCollection !== "undefined" && typeof NodeList !== "undefined") {
  HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
  HTMLElement.prototype.flatpickr = function(config) {
    return _flatpickr([this], config);
  };
}
var flatpickr = function(selector, config) {
  if (typeof selector === "string") {
    return _flatpickr(window.document.querySelectorAll(selector), config);
  } else if (selector instanceof Node) {
    return _flatpickr([selector], config);
  } else {
    return _flatpickr(selector, config);
  }
};
flatpickr.defaultConfig = {};
flatpickr.l10ns = {
  en: __assign({}, default_default),
  default: __assign({}, default_default)
};
flatpickr.localize = function(l10n) {
  flatpickr.l10ns.default = __assign(__assign({}, flatpickr.l10ns.default), l10n);
};
flatpickr.setDefaults = function(config) {
  flatpickr.defaultConfig = __assign(__assign({}, flatpickr.defaultConfig), config);
};
flatpickr.parseDate = createDateParser({});
flatpickr.formatDate = createDateFormatter({});
flatpickr.compareDates = compareDates;
if (typeof jQuery !== "undefined" && typeof jQuery.fn !== "undefined") {
  jQuery.fn.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
}
Date.prototype.fp_incr = function(days) {
  return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === "string" ? parseInt(days, 10) : days));
};
if (typeof window !== "undefined") {
  window.flatpickr = flatpickr;
}
var esm_default = flatpickr;

// src/modals/fields/DateModal.ts
var DateModal = class extends import_obsidian25.Modal {
  constructor(plugin, file, field, initialValue, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a, _b;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.initialValue = initialValue;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.pushNextInterval = false;
    this.initialValue = initialValue ? ((_a = initialValue.toString().replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last()) || "" : "";
    this.insertAsLink = FieldManager2.stringToBoolean(this.field.options.defaultInsertAsLink || "false") || false;
    this.format = this.field.options.dateFormat || this.field.options.defaultDateFormat;
    this.dvApi = (_b = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _b.api;
    if (this.dvApi)
      this.dateManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.value = this.initialValue;
  }
  onOpen() {
    const fieldContainer = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
    this.buildFields(fieldContainer);
  }
  buildFields(parentContainer) {
    const dateFieldsContainer = parentContainer.createEl("div", { cls: "metadata-menu-modal-fields-container" });
    this.buildInputEl(dateFieldsContainer);
    this.errorField = dateFieldsContainer.createEl("div", { cls: "metadata-menu-modal-value-error-field" });
    this.errorField.hide();
    this.buildInsertAsLinkToggler(dateFieldsContainer);
    const saveBtnContainer = dateFieldsContainer.createEl("div", { cls: "metadata-menu-value-grid-footer" });
    const saveBtn = new import_obsidian25.ButtonComponent(saveBtnContainer);
    saveBtn.setIcon("checkmark");
    saveBtn.onClick((e) => __async(this, null, function* () {
      e.preventDefault();
      let newValue;
      if (this.plugin.app.plugins.enabledPlugins.has("nldates-obsidian")) {
        try {
          const nldates = this.plugin.app.plugins.plugins["nldates-obsidian"];
          newValue = nldates.parseDate(this.value).moment;
        } catch (error) {
          newValue = (0, import_obsidian26.moment)(this.value, this.format);
        }
      } else {
        newValue = (0, import_obsidian26.moment)(this.value, this.format);
      }
      if (newValue.isValid()) {
        const linkPath = this.plugin.app.metadataCache.getFirstLinkpathDest(this.field.options.linkPath || "" + newValue.format(this.format), this.file.path);
        const formattedValue = this.insertAsLink ? `[[${this.field.options.linkPath || ""}${newValue.format(this.format)}${linkPath ? "|" + linkPath.basename : ""}]]` : newValue.format(this.format);
        if (this.lineNumber == -1) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file, this.field.name, formattedValue);
          });
        } else {
          yield this.plugin.fileTaskManager.pushTask(() => {
            insertValues(this.plugin, this.file, this.field.name, formattedValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
          });
        }
        ;
        if (this.nextIntervalField && this.pushNextInterval && this.nextShift) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file.path, this.nextIntervalField.name, this.nextShift);
          });
        }
        this.close();
      } else if (!this.value) {
        if (this.lineNumber == -1) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file, this.field.name, "");
          });
        } else {
          yield this.plugin.fileTaskManager.pushTask(() => {
            insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
          });
        }
        ;
        this.close();
      } else {
        this.errorField.show();
        this.errorField.setText(`value must be a valid date`);
        this.inputEl.inputEl.addClass("is-invalid");
        return;
      }
    }));
  }
  buildInsertAsLinkToggler(container) {
    const togglerContainer = container.createDiv({ cls: "metadata-menu-toggler-with-label" });
    const togglerContainerLabel = togglerContainer.createDiv({
      cls: "metadata-menu-toggler-label"
    });
    togglerContainerLabel.setText("Insert as link");
    const toggleEl = new import_obsidian25.ToggleComponent(togglerContainer);
    toggleEl.setValue(FieldManager2.stringToBoolean(this.field.options.defaultInsertAsLink || "false"));
    toggleEl.onChange((value) => {
      this.insertAsLink = value;
    });
  }
  toggleButton(button, value) {
    button.setDisabled(!!value);
    if (value) {
      button.buttonEl.addClass("disabled");
    } else {
      button.buttonEl.removeClass("disabled");
    }
  }
  buildInputEl(container) {
    if (this.dateManager)
      [this.currentShift, this.nextIntervalField, this.nextShift] = this.dateManager.shiftDuration(this.file);
    const inputContainer = container.createDiv({ cls: "metadata-menu-dateinput-with-picker" });
    this.inputEl = new import_obsidian25.TextComponent(inputContainer);
    this.inputEl.inputEl.focus();
    this.inputEl.setPlaceholder(this.initialValue ? (0, import_obsidian26.moment)(this.initialValue, this.field.options.dateFormat).format(this.field.options.dateFormat) : "");
    this.inputEl.inputEl.addClass("metadata-menu-prompt-input");
    this.inputEl.onChange((value) => {
      this.inputEl.inputEl.removeClass("is-invalid");
      this.errorField.hide();
      this.errorField.setText("");
      this.value = value;
      this.toggleButton(shiftFromTodayBtn, value);
    });
    const calendarDisplayBtn = new import_obsidian25.ButtonComponent(inputContainer);
    calendarDisplayBtn.buttonEl.addClass("metadata-menu-modal-inline-btn");
    calendarDisplayBtn.setIcon(FieldIcon["Date" /* Date */]);
    calendarDisplayBtn.setTooltip("open date picker");
    const shiftFromTodayBtn = new import_obsidian25.ButtonComponent(inputContainer);
    shiftFromTodayBtn.buttonEl.addClass("metadata-menu-modal-inline-btn");
    shiftFromTodayBtn.setIcon("skip-forward");
    shiftFromTodayBtn.setTooltip(`Shift ${this.field.name} ${this.currentShift || "1 day"} ahead`);
    const datePickerContainer = container.createDiv({ cls: "metadata-menu-picker-container" });
    const datePicker = esm_default(datePickerContainer, {
      locale: {
        firstDayOfWeek: this.plugin.settings.firstDayOfWeek
      },
      defaultDate: (0, import_obsidian26.moment)(Date.now()).format("YYYY-MM-DD")
    });
    datePicker.config.onChange.push((value) => {
      const newDate = (0, import_obsidian26.moment)(value.toString()).format(this.format);
      this.inputEl.setValue(newDate);
      this.value = newDate;
      this.toggleButton(shiftFromTodayBtn, this.value);
    });
    calendarDisplayBtn.onClick((e) => {
      e.preventDefault();
      datePicker.setDate(datePicker.parseDate(this.inputEl.getValue()) || new Date());
      datePicker.open();
    });
    shiftFromTodayBtn.onClick((e) => __async(this, null, function* () {
      const currentDvDate = this.dvApi.date((0, import_obsidian26.moment)(this.initialValue, this.format).toISOString());
      const newDate = currentDvDate.plus(this.dvApi.duration(this.currentShift || "1 day"));
      const newValue = (0, import_obsidian26.moment)(newDate.toString()).format(this.format);
      this.inputEl.setValue(newValue);
      this.value = newValue;
      this.pushNextInterval = true;
      this.toggleButton(shiftFromTodayBtn, this.inputEl.getValue());
    }));
    if (!this.dvApi) {
      shiftFromTodayBtn.buttonEl.hide();
      shiftFromTodayBtn.setDisabled(true);
    }
  }
};

// src/utils/dataviewUtils.ts
function genuineKeys(dvFile) {
  const genuineKeys2 = [];
  Object.keys(dvFile).forEach((key) => {
    if (!genuineKeys2.map((k) => k.toLowerCase().replace(/\s/g, "-")).includes(key.toLowerCase().replace(/\s/g, "-"))) {
      genuineKeys2.push(key);
    } else {
      if (key !== key.toLowerCase().replace(/\s/g, "-")) {
        genuineKeys2[genuineKeys2.indexOf(key.toLowerCase().replace(/\s/g, "-"))] = key;
      }
    }
  });
  return genuineKeys2;
}
function compareDuration(dvDurA, dvDurB) {
  const normalizedA = dvDurA.shiftTo("years", "months", "weeks", "days", "hours", "minutes", "seconds", "milliseconds").normalize();
  const normalizedB = dvDurB.shiftTo("years", "months", "weeks", "days", "hours", "minutes", "seconds", "milliseconds").normalize();
  return normalizedA.equals(normalizedB);
}

// src/fields/fieldManagers/DateField.ts
var DateField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Date" /* Date */);
    this.defaultDateFormat = "YYYY-MM-DD";
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    var _a;
    const modal = new DateModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change date for <${name}>`);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const dateIconName = FieldIcon["Date" /* Date */];
    const dateModalAction = () => modal.open();
    const p = dvApi.page(file.path);
    const shiftDateAction = () => this.shiftDate(dvApi, p, file);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const [currentShift] = fieldManager.shiftDuration(file);
    if (DateField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(dateIconName);
        item.onClick(dateModalAction);
        item.setSection("metadata-menu.fields");
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        location.addItem((item) => {
          item.setTitle(`Shift <${name}> ${currentShift} ahead`);
          item.setIcon("skip-forward");
          item.onClick(shiftDateAction);
          item.setSection("metadata-menu.fields");
        });
      }
    } else if (DateField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: dateModalAction,
        icon: dateIconName
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Shift <b>${name}</b> ${currentShift} ahead</span>`,
          action: shiftDateAction,
          icon: "skip-forward"
        });
      }
    } else if (DateField.isFieldOptions(location)) {
      location.addOption("skip-forward", shiftDateAction, `Shift ${name} ahead by ${currentShift}`);
      location.addOption(dateIconName, dateModalAction, `Set ${name}'s date`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new DateModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter date for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDateContainer(parentContainer) {
    if (!this.field.options.dateFormat)
      this.field.options.dateFormat = this.defaultDateFormat;
    if (!this.field.options.defaultInsertAsLink)
      this.field.options.defaultInsertAsLink = "false";
    const dateFormatContainer = parentContainer.createDiv();
    dateFormatContainer.createEl("span", { text: "Date format", cls: "metadata-menu-field-option" });
    const dateFormatInput = new import_obsidian27.TextComponent(dateFormatContainer);
    dateFormatInput.setValue(this.field.options.dateFormat);
    const dateExample = dateFormatContainer.createEl("span", { text: "", cls: "metadata-menu-field-option" });
    dateExample.setText(`example: ${(0, import_obsidian27.moment)().format(dateFormatInput.getValue())}`);
    dateFormatInput.onChange((value) => {
      this.field.options.dateFormat = value;
      dateExample.setText(`example: ${(0, import_obsidian27.moment)().format(value)}`);
    });
    const defaultInsertAsLinkContainer = parentContainer.createDiv();
    defaultInsertAsLinkContainer.createEl("span", { text: "Insert as link by default", cls: "metadata-menu-field-option" });
    const defaultInsertAsLink = new import_obsidian27.ToggleComponent(defaultInsertAsLinkContainer);
    defaultInsertAsLink.setValue(DateField.stringToBoolean(this.field.options.defaultInsertAsLink));
    defaultInsertAsLink.onChange((value) => {
      this.field.options.defaultInsertAsLink = value.toString();
    });
    const dateLinkPathContainer = parentContainer.createDiv();
    dateLinkPathContainer.createEl("span", { text: "Link path (optional)", cls: "metadata-menu-field-option" });
    const dateLinkPathInput = new import_obsidian27.TextComponent(dateLinkPathContainer);
    dateLinkPathInput.setValue(this.field.options.linkPath);
    dateLinkPathInput.onChange((value) => {
      this.field.options.linkPath = value.endsWith("/") ? value : value + "/";
    });
    const dateShiftIntervalContainer = parentContainer.createDiv();
    dateShiftIntervalContainer.createEl("span", { text: "Define a shift interval", cls: "metadata-menu-field-option" });
    const dateShiftInterval = new import_obsidian27.TextComponent(dateShiftIntervalContainer);
    dateShiftInterval.setPlaceholder("ex: 1 month 2 days");
    dateShiftInterval.setValue(this.field.options.dateShiftInterval);
    dateShiftInterval.onChange((value) => {
      if (!value) {
        delete this.field.options.dateShiftInterval;
      } else {
        this.field.options.dateShiftInterval = value.toString();
      }
    });
    const nextShiftIntervalFieldContainer = parentContainer.createDiv();
    nextShiftIntervalFieldContainer.createEl("span", {
      text: "Field containing shift intervals (has the priority over the Shift Interval above)",
      cls: "metadata-menu-field-option"
    });
    const nextShiftIntervalField = new import_obsidian27.TextComponent(nextShiftIntervalFieldContainer);
    nextShiftIntervalField.setValue(this.field.options.nextShiftIntervalField);
    nextShiftIntervalField.onChange((value) => {
      if (!value) {
        delete this.field.options.nextShiftIntervalField;
      } else {
        this.field.options.nextShiftIntervalField = value.toString();
      }
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.dateValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createDateContainer(this.dateValidatorField);
    this.dateValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  shiftDate(dv, p, file) {
    return __async(this, null, function* () {
      const { dateFormat, defaultInsertAsLink, linkPath } = this.field.options;
      const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      const [currentShift, nextIntervalField, nextShift] = fieldManager.shiftDuration(file);
      const dvDate = p[this.field.name];
      const currentDateValue = dv.value.isLink(dvDate) ? dvDate.path.split("/").last() : dv.value.isDate(dvDate) ? (0, import_obsidian27.moment)(dvDate.toJSDate()).format(dateFormat) : dvDate;
      const currentDvDate = dv.date((0, import_obsidian27.moment)(currentDateValue, dateFormat).toISOString());
      const newDate = currentDvDate.plus(dv.duration(currentShift || "1 day"));
      const newValue = (0, import_obsidian27.moment)(newDate.toString()).format(dateFormat);
      if (nextIntervalField && nextShift) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file.path, nextIntervalField.name, nextShift);
        });
      }
      const linkFile = this.plugin.app.metadataCache.getFirstLinkpathDest(linkPath || "" + newValue.format(dateFormat), file.path);
      const formattedValue = DateField.stringToBoolean(defaultInsertAsLink) ? `[[${linkPath || ""}${newValue}${linkFile ? "|" + linkFile.basename : ""}]]` : newValue;
      yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file.path, this.field.name, formattedValue);
      });
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const dateBtn = document.createElement("button");
    (0, import_obsidian27.setIcon)(dateBtn, FieldIcon["Date" /* Date */]);
    dateBtn.addClass("metadata-menu-dv-field-button");
    const spacer = document.createElement("div");
    if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField) {
      this.shiftBtn = document.createElement("button");
      (0, import_obsidian27.setIcon)(this.shiftBtn, "skip-forward");
      this.shiftBtn.addClass("metadata-menu-dv-field-button");
      spacer.setAttr("class", "metadata-menu-dv-field-double-spacer");
    } else {
      spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
    let fieldModal;
    if (file instanceof import_obsidian27.TFile && file.extension == "md") {
      if (p[this.field.name] && p[this.field.name].hasOwnProperty("path")) {
        const dateFile = this.plugin.app.vault.getAbstractFileByPath(p[this.field.name]);
        if (dateFile instanceof import_obsidian27.TFile && dateFile.extension == "md") {
          fieldModal = new DateModal(this.plugin, file, this.field, dateFile.name);
        } else {
          fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name].path.split("/").last().replace(".md", ""));
        }
      } else if (p[this.field.name]) {
        fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name]);
      } else {
        fieldModal = new DateModal(this.plugin, file, this.field, "");
      }
      if (this.shiftBtn)
        this.shiftBtn.onclick = () => {
          this.shiftDate(dv, p, file);
        };
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    fieldModal.onClose = () => {
      fieldModal.contentEl.innerHTML = "";
    };
    dateBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      dateBtn.hide();
      if (this.shiftBtn)
        this.shiftBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        dateBtn.show();
        if (this.shiftBtn)
          this.shiftBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        dateBtn.hide();
        if (this.shiftBtn)
          this.shiftBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(dateBtn);
    if (this.shiftBtn)
      fieldContainer.appendChild(this.shiftBtn);
    fieldContainer.appendChild(spacer);
  }
  getOptionsStr() {
    return this.field.options.dateFormat;
  }
  validateOptions() {
    return true;
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const value = dvApi.page(file.path)[fieldName];
      if (dvApi.value.isDate(value)) {
        container.createDiv({ text: value.display });
      } else if (dvApi.value.isLink(value)) {
        const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
        link.onclick = () => {
          this.plugin.app.workspace.openLinkText(value.path, file.path, true);
          onClicked();
        };
      } else {
        container.createDiv({ text: value });
      }
    }
    container.createDiv({});
  }
  validateValue(value) {
    var _a, _b;
    if (!value) {
      return true;
    } else {
      if (typeof value == "string") {
        return (0, import_obsidian27.moment)((_a = value.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last(), this.field.options.dateFormat).isValid();
      } else {
        return (0, import_obsidian27.moment)((_b = value.path.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _b.split("/").last(), this.field.options.dateFormat).isValid();
      }
    }
  }
  shiftDuration(file) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const interval = this.field.options.dateShiftInterval;
      const cycleIntervalField = this.field.options.nextShiftIntervalField;
      const cycle = (_b = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _b.find((field) => field.name === cycleIntervalField);
      if (cycle) {
        const cycleManager = new FieldManager[cycle.type](this.plugin, cycle);
        const options = cycleManager.getOptionsList(file);
        const currentValue = dvApi.page(file.path)[cycle.name];
        if (currentValue) {
          const currentValueString = options.filter((o) => dvApi.duration(o) !== null).find((o) => compareDuration(dvApi.duration(o), currentValue));
          if (currentValueString) {
            const nextValue = cycleManager.nextOption(currentValueString);
            return [currentValueString, cycle, nextValue];
          }
        }
        return [options[0], cycle, options[1] || options[0]];
      } else if (interval && dvApi.duration(interval)) {
        return [interval, void 0, void 0];
      }
    }
    return [void 0, void 0, void 0];
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var import_obsidian29 = require("obsidian");

// src/modals/fields/MultiFileModal.ts
var import_obsidian28 = require("obsidian");
var MultiFileFuzzySuggester = class extends import_obsidian28.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.selectedFiles = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const selectedValues = Array.isArray(initialValueObject) ? initialValueObject : [initialValueObject];
      selectedValues.forEach((value) => {
        if (dvApi.value.isLink(value)) {
          const file2 = this.plugin.app.vault.getAbstractFileByPath(value.path);
          if (file2 instanceof import_obsidian28.TFile)
            this.selectedFiles.push(file2);
        }
      });
    }
  }
  onOpen() {
    super.onOpen();
    this.containerEl.onkeydown = (e) => __async(this, null, function* () {
      if (e.key == "Enter" && e.altKey) {
        yield this.replaceValues();
        this.close();
      }
    });
    const buttonContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-actions" });
    buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-actions-spacer" });
    const infoContainer = buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-info" });
    infoContainer.setText("Alt+Enter to save");
    const confirmButton = new import_obsidian28.ButtonComponent(buttonContainer);
    confirmButton.setIcon("checkmark");
    confirmButton.onClick(() => __async(this, null, function* () {
      yield this.replaceValues();
      this.close();
    }));
    confirmButton.buttonEl.addClass("metadata-menu-value-suggester-button");
    const cancelButton = new import_obsidian28.ButtonComponent(buttonContainer);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
    cancelButton.buttonEl.addClass("metadata-menu-value-suggester-button");
    const clearButton = new import_obsidian28.ButtonComponent(buttonContainer);
    clearButton.setIcon("trash");
    clearButton.onClick(() => __async(this, null, function* () {
      yield this.clearValues();
      this.close();
    }));
    clearButton.buttonEl.addClass("metadata-menu-value-suggester-button");
    clearButton.buttonEl.addClass("danger");
    this.modalEl.appendChild(buttonContainer);
  }
  getItems() {
    const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
      return a.basename < b.basename ? -1 : 1;
    };
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file).sort(sortingMethod);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  replaceValues() {
    return __async(this, null, function* () {
      const result = this.selectedFiles.map((file) => {
        var _a;
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        let alias = void 0;
        if (dvApi && this.field.options.customRendering) {
          alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(file.path));
        }
        return FieldManager2.buildMarkDownLink(this.plugin, this.file, file.basename, alias);
      });
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, result.join(", "));
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, result.join(", "), this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, this.file, this.field.name, "");
      });
    });
  }
  renderSuggestion(value, el) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "metadata-menu-suggester-item-with-alias" });
      const label = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-label" });
      label.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path)));
      const filePath = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-filepath" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("metadata-menu-value-suggester-value-container");
    const spacer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-value-container-spacer" });
    el.appendChild(spacer);
    if (this.selectedFiles.some((file) => file.path === value.item.path)) {
      el.addClass("metadata-menu-value-selected");
      const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
      (0, import_obsidian28.setIcon)(iconContainer, "check-circle");
    }
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedFiles.some((file) => file.path === values[i].item.path)) {
        s.addClass("metadata-menu-value-selected");
        if (s.querySelectorAll(".metadata-menu-command-suggest-icon").length == 0) {
          const iconContainer = s.createDiv({ cls: "metadata-menu-command-suggest-icon" });
          (0, import_obsidian28.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("metadata-menu-value-selected");
        s.querySelectorAll(".metadata-menu-command-suggest-icon").forEach((icon) => icon.remove());
      }
    });
  }
  selectSuggestion(value, evt) {
    if (this.selectedFiles.includes(value.item)) {
      this.selectedFiles.remove(value.item);
    } else {
      this.selectedFiles.push(value.item);
    }
    this.renderSelected();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
    });
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var MultiFileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "MultiFile" /* MultiFile */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian29.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  static buildMarkDownLink(plugin, file, path) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, destFile.basename);
    }
    return "";
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value);
    const action = () => modal.open();
    if (MultiFileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiFileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["File" /* File */]
      });
    } else if (MultiFileField.isFieldOptions(location)) {
      location.addOption(FieldIcon["File" /* File */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const searchBtn = document.createElement("button");
    (0, import_obsidian29.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    searchBtn.addClass("metadata-menu-dv-field-button");
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian29.TFile && file.extension == "md") {
      fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(searchBtn);
    fieldContainer.appendChild(spacer);
  }
  createFileContainer(parentContainer) {
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Dataview Query (optional)", cls: "metadata-menu-field-option" });
    this.dvQueryString = new import_obsidian29.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingContainer = parentContainer.createDiv();
    customeRenderingContainer.createEl("span", { text: "Alias", cls: "metadata-menu-field-option" });
    customeRenderingContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "metadata-menu-field-option-subtext" });
    customeRenderingContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customRendering = new import_obsidian29.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
    const customSortingContainer = parentContainer.createDiv();
    customSortingContainer.createEl("span", { text: "Sorting order", cls: "metadata-menu-field-option" });
    customSortingContainer.createEl("span", { text: "Personalise the sorting order of your links with a instruction taking 2 files (a, b) and returning -1, 0 or 1", cls: "metadata-menu-field-option-subtext" });
    customSortingContainer.createEl("code", {
      text: `(a: TFile, b: TFile): number`
    });
    const customSorting = new import_obsidian29.TextAreaComponent(customSortingContainer);
    customSorting.inputEl.cols = 50;
    customSorting.inputEl.rows = 4;
    customSorting.setValue(this.field.options.customSorting || "");
    customSorting.setPlaceholder("Javascript instruction, (a: TFile, b: TFile): number\nexample 1 (alphabetical order): a.basename < b.basename ? 1 : -1 \nexample 2 (creation time newer to older): b.stat.ctime - b.stat.ctime");
    customSorting.onChange((value) => {
      this.field.options.customSorting = value;
      FieldSettingsModal.removeValidationError(customSorting);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.fileValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createFileContainer(this.fileValidatorField);
    this.fileValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    return true;
  }
  displayValue(container, file, fieldName, onClick) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvValue = dvApi.page(file.path)[fieldName];
      const values = Array.isArray(dvValue) ? dvValue : [dvValue];
      values.forEach((value, i) => {
        if (dvApi.value.isLink(value)) {
          const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
          link.onclick = () => {
            this.plugin.app.workspace.openLinkText(value.path, file.path, true);
            onClick();
          };
        } else {
          container.createDiv({ text: value });
        }
        if (i < values.length - 1) {
          container.createEl("span", { text: " | " });
        }
      });
    }
    container.createDiv();
  }
};

// src/fields/fieldManagers/LookupField.ts
var import_obsidian32 = require("obsidian");

// src/commands/updateLookups.ts
var import_obsidian31 = require("obsidian");

// src/commands/getValues.ts
var import_obsidian30 = require("obsidian");
function getValues(plugin, fileOrfilePath, attribute) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrfilePath instanceof import_obsidian30.TFile) {
      file = fileOrfilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
      if (_file instanceof import_obsidian30.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const result = [];
    content.map((line, i) => {
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodeLink(line).match(fullLineRegex2);
        if (fR == null ? void 0 : fR.groups) {
          result.push(decodeLink(fR.groups.values));
        }
        ;
        const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
        const sRB = encodeLink(line).matchAll(inSentenceRegexBrackets2);
        let next = sRB.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRB.next();
        }
        const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
        const sRP = encodeLink(line).matchAll(inSentenceRegexPar2);
        next = sRP.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRP.next();
        }
      }
    });
    return result;
  });
}

// src/commands/updateLookups.ts
function arraysAsStringAreEqual(a, b) {
  const aAsArray = a.split(",").map((v) => v.trim());
  const bAsArray = b.split(",").map((v) => v.trim());
  return aAsArray.every((item) => bAsArray.includes(item)) && bAsArray.every((item) => aAsArray.includes(item));
}
function parseFieldValues(plugin, file, fieldName) {
  return __async(this, null, function* () {
    var _a, _b;
    const rawValue = (_a = yield getValues(plugin, file, fieldName)) == null ? void 0 : _a[0];
    const regex = new RegExp(`<div hidden id="${fieldName}_values">(?<values>.*)</div>`);
    const fR = rawValue.match(regex);
    return ((_b = fR == null ? void 0 : fR.groups) == null ? void 0 : _b.values) || rawValue;
  });
}
function updateLookups(plugin, source = "", forceUpdateOne) {
  return __async(this, null, function* () {
    var _a, _b, _c;
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    for (let id of f.fileLookupFiles.keys()) {
      const matchRegex = new RegExp("(?<filePath>.*)__related__(?<fileClassName>.*)___(?<fieldName>.*)");
      const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
      const tFile = plugin.app.vault.getAbstractFileByPath(filePath);
      const dvApi = (_b = plugin.app.plugins.plugins.dataview) == null ? void 0 : _b.api;
      const dvFile = dvApi && dvApi.page(tFile.path);
      if (tFile && dvFile) {
        let newValue = "";
        const pages = f.fileLookupFiles.get(id);
        const field = (_c = f.filesFields.get(filePath)) == null ? void 0 : _c.find((field2) => field2.name == fieldName);
        if (field) {
          const outputType = field.options.outputType;
          if (!f.fileLookupFieldLastOutputType.get(id))
            f.fileLookupFieldLastOutputType.set(id, outputType);
          switch (outputType) {
            case "LinksList" /* LinksList */:
            case "LinksBulletList" /* LinksBulletList */:
              {
                const newValuesArray = pages == null ? void 0 : pages.map((dvFile2) => {
                  return FieldManager2.buildMarkDownLink(plugin, tFile, dvFile2.file.path);
                });
                newValue = (newValuesArray || []).join(", ");
              }
              break;
            case "CustomList" /* CustomList */:
            case "CustomBulletList" /* CustomBulletList */:
              {
                const renderingFunction = new Function("page", `return ${field.options.customListFunction}`);
                const newValuesArray = pages == null ? void 0 : pages.map((dvFile2) => {
                  try {
                    return renderingFunction(dvFile2);
                  } catch (e) {
                    if (!renderingErrors.includes(field.name))
                      renderingErrors.push(field.name);
                    return "";
                  }
                });
                newValue = (newValuesArray || []).join(", ");
              }
              break;
            case "CustomSummarizing" /* CustomSummarizing */:
              {
                const customSummarizingFunction = field.options.customSummarizingFunction;
                const summarizingFunction = new Function("pages", customSummarizingFunction.replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
                try {
                  newValue = summarizingFunction(pages).toString();
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  newValue = "";
                }
              }
              break;
            case "BuiltinSummarizing" /* BuiltinSummarizing */:
              {
                const builtinFunction = field.options.builtinSummarizingFunction;
                const summarizingFunction = new Function("pages", BuiltinSummarizingFunction[builtinFunction].replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
                try {
                  newValue = summarizingFunction(pages).toString();
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  newValue = "";
                }
              }
              break;
            default:
              break;
          }
          const currentValue = f.fileLookupFieldLastValue.get(id) || (yield parseFieldValues(plugin, tFile, field.name)) || "";
          const shouldCheckForUpdate = field.options.autoUpdate || field.options.autoUpdate === void 0 || (forceUpdateOne == null ? void 0 : forceUpdateOne.file.path) === tFile.path && (forceUpdateOne == null ? void 0 : forceUpdateOne.fieldName) === field.name;
          const valueHasChanged = !currentValue && newValue !== "" || !arraysAsStringAreEqual(currentValue, newValue);
          const formatHasChanged = outputType !== f.fileLookupFieldLastOutputType.get(id);
          if (shouldCheckForUpdate) {
            f.fileLookupFieldLastValue.set(id, newValue);
            f.fileLookupFieldLastOutputType.set(id, outputType);
          }
          if (shouldCheckForUpdate && (valueHasChanged || formatHasChanged)) {
            const previousValuesCount = plugin.fieldIndex.previousFileLookupFilesValues.get(id) || 0;
            yield plugin.fileTaskManager.pushTask(() => replaceValues(plugin, tFile, fieldName, newValue, previousValuesCount));
            f.fileLookupFieldsStatus.set(`${filePath}__${fieldName}`, "upToDate" /* upToDate */);
          } else if (source !== "full Index") {
            plugin.fieldIndex.fileChanged = false;
          }
          if (!valueHasChanged && !formatHasChanged) {
            f.fileLookupFieldsStatus.set(`${filePath}__${fieldName}`, "upToDate" /* upToDate */);
          }
        }
      }
    }
    if (renderingErrors.length)
      new import_obsidian31.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
  });
}

// src/fields/fieldManagers/LookupField.ts
var LookupField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Lookup" /* Lookup */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    if (!this.field.options.autoUpdate && this.field.options.autoUpdate !== void 0) {
      const f = this.plugin.fieldIndex;
      const id = `${file.path}__${this.field.name}`;
      let status2;
      status2 = f.fileLookupFieldsStatus.get(id) || "changed" /* changed */;
      if (f.fileLookupFieldLastOutputType.get(`${file.path}__related__${this.field.fileClassName}___${this.field.name}`) !== this.field.options.outputType)
        status2 = "changed" /* changed */;
      const icon = status2 === "changed" /* changed */ ? "refresh-ccw" : "file-check";
      const action = () => {
        updateLookups(this.plugin, "single_command", { file, fieldName: this.field.name });
      };
      if (LookupField.isMenu(location) && status2 === "changed" /* changed */) {
        location.addItem((item) => {
          item.setTitle(`Update <${name}>`);
          item.setIcon(icon);
          item.onClick(action);
          item.setSection("metadata-menu.fields");
        });
      } else if (LookupField.isSuggest(location) && status2 === "changed" /* changed */) {
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Update <b>${name}</b></span>`,
          action,
          icon
        });
      } else if (LookupField.isFieldOptions(location) && status2 === "changed" /* changed */) {
        location.addOption(icon, action, `Update ${name}'s value`);
      } else if (LookupField.isFieldOptions(location) && status2 === "upToDate" /* upToDate */) {
        location.addOption(icon, () => {
        }, `${name} is up to date`);
      }
    } else if (LookupField.isFieldOptions(location)) {
      location.addOption("server-cog", () => {
      }, `${name} is auto-updated`, "disabled");
    }
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    return __async(this, null, function* () {
      if (lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, file, this.field.name, "", lineNumber, inFrontmatter, after, asList, asComment);
        });
      }
      ;
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
  }
  displaySelectedOutputOptionContainer(optionContainers, value) {
    optionContainers.forEach((options_set) => {
      var _a, _b;
      if (options_set[0].includes(value)) {
        (_a = options_set[1]) == null ? void 0 : _a.show();
      } else {
        (_b = options_set[1]) == null ? void 0 : _b.hide();
      }
    });
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a, _b;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    container.createDiv({ text: this.plugin.fieldIndex.fileLookupFieldLastValue.get(`${file.path}__related__${fileClassName}___${fieldName}`) });
  }
  displaySelectedOutputWarningContainer(optionWarningContainer, value) {
    ["LinksBulletList" /* LinksBulletList */.toString(), "CustomBulletList" /* CustomBulletList */.toString()].includes(value) ? optionWarningContainer.show() : optionWarningContainer.hide();
  }
  createLookupContainer(parentContainer) {
    const autoUpdateContainer = parentContainer.createDiv();
    autoUpdateContainer.createEl("span", { text: "Auto update this field ", cls: "metadata-menu-field-option" });
    autoUpdateContainer.createEl("span", { text: "This could lead to latencies depending on the queries", cls: "metadata-menu-field-option-subtext warning" });
    const autoUpdate = new import_obsidian32.ToggleComponent(autoUpdateContainer);
    if (this.field.options.autoUpdate === void 0)
      this.field.options.autoUpdate = true;
    autoUpdate.setValue(this.field.options.autoUpdate);
    autoUpdate.onChange((value) => {
      this.field.options.autoUpdate = value;
    });
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Pages to look for in your vault (DataviewJS Query)", cls: "metadata-menu-field-option" });
    dvQueryStringContainer.createEl("span", { text: "DataviewJS query of the form `dv.pages(...)`", cls: "metadata-menu-field-option-subtext" });
    const dvQueryString = new import_obsidian32.TextAreaComponent(dvQueryStringContainer);
    dvQueryString.inputEl.cols = 50;
    dvQueryString.inputEl.rows = 4;
    dvQueryString.setValue(this.field.options.dvQueryString || "");
    dvQueryString.setPlaceholder("exampe: dv.pages('#student')");
    dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(dvQueryString);
    });
    const targetFieldContainer = parentContainer.createDiv();
    targetFieldContainer.createEl("span", { text: "Name of the related field", cls: "metadata-menu-field-option" });
    targetFieldContainer.createEl("span", { text: "field in the target pages that contains a link to the page where this lookup field is", cls: "metadata-menu-field-option-subtext" });
    const targetFieldName = new import_obsidian32.TextComponent(targetFieldContainer);
    targetFieldName.setValue(this.field.options.targetFieldName || "");
    targetFieldName.onChange((value) => {
      this.field.options.targetFieldName = value;
      FieldSettingsModal.removeValidationError(targetFieldName);
    });
    const outputTypeContainer = parentContainer.createDiv();
    this.field.options.outputType = this.field.options.outputType || "LinksList" /* LinksList */;
    outputTypeContainer.createEl("span", { text: "Type of output", cls: "metadata-menu-field-option" });
    const outputTypeList = new import_obsidian32.DropdownComponent(outputTypeContainer);
    Object.keys(Type).forEach((outputType) => {
      outputTypeList.addOption(outputType, Description[outputType]);
    });
    outputTypeList.setValue(this.field.options.outputType);
    const outputWarningContainer = parentContainer.createDiv();
    outputWarningContainer.createEl("p", {
      text: "Warning: this may override some lines under your list. There shouldn't be an extra manual item in the list that is automatically rendered by this field: it would be overriden after each field indexing",
      cls: "metadata-menu-field-option-warning"
    });
    const builtinOptionsContainer = parentContainer.createDiv();
    const builtinSummarizeFunctionContainer = builtinOptionsContainer.createDiv();
    this.field.options.builtinSummarizingFunction = this.field.options.builtinSummarizingFunction || Default.BuiltinSummarizing;
    builtinSummarizeFunctionContainer.createEl("span", { text: OptionLabel.BuiltinSummarizing, cls: "metadata-menu-field-option" });
    const builtinSummarizeFunctionList = new import_obsidian32.DropdownComponent(builtinSummarizeFunctionContainer);
    Object.keys(BuiltinSummarizing).forEach((builtinFunction2) => {
      builtinSummarizeFunctionList.addOption(builtinFunction2, BuiltinSummarizing[builtinFunction2]);
    });
    const builtinOptionsDescriptionContainer = builtinOptionsContainer.createDiv({ cls: "metadata-menu-field-option-subtext" });
    const builtinFunction = this.field.options.builtinSummarizingFunction;
    builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[builtinFunction].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    builtinSummarizeFunctionList.setValue(this.field.options.builtinSummarizingFunction);
    builtinSummarizeFunctionList.onChange((value) => {
      this.field.options.builtinSummarizingFunction = value;
      builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[value].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    });
    const summarizedFieldNameContainer = builtinOptionsContainer.createDiv();
    this.field.options.summarizedFieldName = this.field.options.summarizedFieldName;
    summarizedFieldNameContainer.createEl("span", { text: "Summarized field name", cls: "metadata-menu-field-option" });
    summarizedFieldNameContainer.createEl("span", { text: "Name of the field containing summarized value used for the summarizing function", cls: "metadata-menu-field-option-subtext" });
    const summarizedFieldName = new import_obsidian32.TextComponent(summarizedFieldNameContainer);
    summarizedFieldName.setValue(this.field.options.summarizedFieldName);
    summarizedFieldName.onChange((value) => {
      this.field.options.summarizedFieldName = value;
    });
    const outputRenderingFunctionContainer = parentContainer.createDiv();
    this.field.options.customListFunction = this.field.options.customListFunction || Default.CustomList;
    outputRenderingFunctionContainer.createEl("span", { text: OptionLabel.CustomList, cls: "metadata-menu-field-option" });
    outputRenderingFunctionContainer.createEl("code", { text: OptionSubLabel.CustomList, cls: "metadata-menu-field-option-subtext" });
    const outputRenderingFunction = new import_obsidian32.TextAreaComponent(outputRenderingFunctionContainer);
    outputRenderingFunction.setPlaceholder(Helper.CustomList);
    outputRenderingFunction.setValue(this.field.options.customListFunction);
    outputRenderingFunction.inputEl.cols = 65;
    outputRenderingFunction.inputEl.rows = 4;
    outputRenderingFunction.onChange((value) => {
      this.field.options.customListFunction = value;
    });
    const outputSummarizingFunctionContainer = parentContainer.createDiv();
    this.field.options.customSummarizingFunction = this.field.options.customSummarizingFunction || Default.CustomSummarizing;
    outputSummarizingFunctionContainer.createEl("span", { text: OptionLabel.CustomSummarizing, cls: "metadata-menu-field-option" });
    outputSummarizingFunctionContainer.createEl("code", { text: OptionSubLabel.CustomSummarizing, cls: "metadata-menu-field-option-subtext" });
    const outputSummarizingFunction = new import_obsidian32.TextAreaComponent(outputSummarizingFunctionContainer);
    outputSummarizingFunction.setPlaceholder(Helper.CustomSummarizing);
    outputSummarizingFunction.setValue(this.field.options.customSummarizingFunction);
    outputSummarizingFunction.inputEl.cols = 65;
    outputSummarizingFunction.inputEl.rows = 8;
    outputSummarizingFunction.onChange((value) => {
      this.field.options.customSummarizingFunction = value;
    });
    const optionContainers = [
      [["LinksList", "LinksBulletList"], void 0],
      [["BuiltinSummarizing"], builtinOptionsContainer],
      [["CustomList", "CustomBulletList"], outputRenderingFunctionContainer],
      [["CustomSummarizing"], outputSummarizingFunctionContainer]
    ];
    this.displaySelectedOutputOptionContainer(optionContainers, outputTypeList.getValue());
    this.displaySelectedOutputWarningContainer(outputWarningContainer, outputTypeList.getValue());
    outputTypeList.onChange((value) => {
      this.field.options.outputType = value;
      this.displaySelectedOutputOptionContainer(optionContainers, value);
      this.displaySelectedOutputWarningContainer(outputWarningContainer, value);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.lookupValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createLookupContainer(this.lookupValidatorField);
    this.lookupValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    const shortDescription = ShortDescription[this.field.options.outputType];
    let complement = "";
    if (this.field.options.outputType === "BuiltinSummarizing" /* BuiltinSummarizing */) {
      complement = ` ${this.field.options.builtinSummarizingFunction}${this.field.options.builtinSummarizingFunction !== "CountAll" /* CountAll */ ? " " + this.field.options.summarizedFieldName : ""}`;
    }
    return shortDescription + complement;
  }
  validateOptions() {
    return true;
  }
};

// src/fields/fieldManagers/FormulaField.ts
var import_obsidian33 = require("obsidian");
var FormulaField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Formula" /* Formula */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    const action = () => {
    };
    if (FormulaField.isMenu(location) && status === "changed" /* changed */) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon.Formula);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (FormulaField.isSuggest(location) && status === "changed" /* changed */) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon.Formula
      });
    } else if (FormulaField.isFieldOptions(location)) {
      location.addOption(FieldIcon.Formula, () => {
      }, `${name} is automatically calculated`, "disabled");
    }
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    return __async(this, null, function* () {
      if (lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, file, this.field.name, "", lineNumber, inFrontmatter, after, asList, asComment);
        });
      }
      ;
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a, _b;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    container.createDiv({ text: this.plugin.fieldIndex.fileFormulaFieldLastValue.get(`${file.path}__calculated__${fileClassName}___${fieldName}`) });
  }
  createFormulaContainer(parentContainer) {
    const formulaContainer = parentContainer.createDiv();
    formulaContainer.createEl("span", { text: "javascript formula", cls: "metadata-menu-field-option" });
    formulaContainer.createEl("span", { text: "current and pages variables are available`", cls: "metadata-menu-field-option-subtext" });
    const formula = new import_obsidian33.TextAreaComponent(formulaContainer);
    formula.inputEl.cols = 50;
    formula.inputEl.rows = 4;
    formula.setValue(this.field.options.formula || "");
    formula.setPlaceholder("exampe: current.apple + current.bananas - 3");
    formula.onChange((value) => {
      this.field.options.formula = value;
      FieldSettingsModal.removeValidationError(formula);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.formulaValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createFormulaContainer(this.formulaValidatorField);
    this.formulaValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    return this.field.options.formula;
  }
  validateOptions() {
    return true;
  }
};

// src/fields/fieldManagers/Managers.ts
var Managers = {
  Input: InputField,
  Boolean: BooleanField,
  Number: NumberField,
  Select: SelectField,
  Cycle: CycleField,
  Multi: MultiField,
  File: FileField,
  Date: DateField,
  MultiFile: MultiFileField,
  Lookup: LookupField,
  Formula: FormulaField
};
var Managers_default = Managers;

// src/types/fieldTypes.ts
var FieldTypeLabelMapping = {
  "Input": "Input" /* Input */,
  "Select": "Select" /* Select */,
  "Multi": "Multi" /* Multi */,
  "Cycle": "Cycle" /* Cycle */,
  "Boolean": "Boolean" /* Boolean */,
  "Number": "Number" /* Number */,
  "File": "File" /* File */,
  "MultiFile": "MultiFile" /* MultiFile */,
  "Date": "Date" /* Date */,
  "Lookup": "Lookup" /* Lookup */,
  "Formula": "Formula" /* Formula */
};
var FieldTypeTagClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup",
  "Formula": "formula"
};
var FieldTypeTooltip = {
  "Input": "Accept any value",
  "Select": "Accept a single value from a list",
  "Multi": "Accept multiple values from a list",
  "Cycle": "Cycle through values from a list",
  "Boolean": "Accept true of false",
  "Number": "Accept a number",
  "File": "Accept a link",
  "MultiFile": "Accept multiple links",
  "Date": "Accept a date",
  "Lookup": "Accept a lookup query",
  "Formula": "Accept a formula"
};
var FieldManager = {
  "Input": Managers_default.Input,
  "Select": Managers_default.Select,
  "Multi": Managers_default.Multi,
  "Cycle": Managers_default.Cycle,
  "Boolean": Managers_default.Boolean,
  "Number": Managers_default.Number,
  "File": Managers_default.File,
  "MultiFile": Managers_default.MultiFile,
  "Date": Managers_default.Date,
  "Lookup": Managers_default.Lookup,
  "Formula": Managers_default.Formula
};
var FieldIcon = {
  "Input": "pencil",
  "Select": "right-triangle",
  "Multi": "bullet-list",
  "Cycle": "switch",
  "Boolean": "checkmark",
  "Number": "plus-minus-glyph",
  "File": "link",
  "MultiFile": "link",
  "Date": "calendar-with-checkmark",
  "Lookup": "file-search",
  "Formula": "function-square"
};
var FieldBackgroundColorClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup",
  "Formula": "lookup"
};

// src/fields/Field.ts
var Field = class {
  constructor(name = "", options = {}, id = "", type = "Input" /* Input */, fileClassName) {
    this.name = name;
    this.options = options;
    this.id = id;
    this.type = type;
    this.fileClassName = fileClassName;
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.type = source.type;
    Object.keys(source.options).forEach((k) => {
      target.options[k] = source.options[k];
    });
    Object.keys(target.options).forEach((k) => {
      if (!Object.keys(source.options).includes(k)) {
        delete target.options[k];
      }
      ;
    });
  }
  static createDefault(name) {
    const field = new Field();
    field.type = "Input" /* Input */;
    field.name = name;
    return field;
  }
};
var Field_default = Field;

// src/components/FieldIndex.ts
var import_obsidian36 = require("obsidian");

// src/fileClass/fileClassAttribute.ts
var FileClassAttribute = class {
  constructor(origin, name, type = "Input" /* Input */, options = [], fileClassName) {
    this.origin = origin;
    this.name = name;
    this.type = type;
    this.options = options;
    this.fileClassName = fileClassName;
  }
  getField() {
    var _a;
    let options = {};
    if (Array.isArray(this.options)) {
      (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
        options[index] = option;
      });
    } else {
      options = this.options;
    }
    return new Field_default(this.name, options, this.name, this.type, this.fileClassName);
  }
};

// src/fileClass/fileClass.ts
var import_obsidian34 = require("obsidian");

// src/utils/textUtils.ts
var capitalize = (s) => {
  return s && s[0].toUpperCase() + s.slice(1);
};

// src/fileClass/fileClass.ts
var AddFileClassToFileModal = class extends import_obsidian34.SuggestModal {
  constructor(plugin, file) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
  }
  getSuggestions(query) {
    return [...this.plugin.fieldIndex.fileClassesName.keys()].filter((fileClassName) => {
      var _a;
      return !((_a = this.plugin.fieldIndex.filesFileClasses.get(this.file.path)) == null ? void 0 : _a.map((fileClass) => fileClass.name).includes(fileClassName));
    }).filter((fileClassName) => fileClassName.toLocaleLowerCase().contains(query.toLowerCase()));
  }
  renderSuggestion(value, el) {
    el.setText(value);
  }
  onChooseSuggestion(item, evt) {
    this.insertFileClassToFile(item);
  }
  insertFileClassToFile(value) {
    return __async(this, null, function* () {
      var _a, _b, _c;
      const fileClassAlias = this.plugin.settings.fileClassAlias;
      const currentFileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path);
      const frontmatterFileClasses = (_b = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b[fileClassAlias];
      if (currentFileClasses && frontmatterFileClasses) {
        replaceValues(this.plugin, this.file, fileClassAlias, [...currentFileClasses.map((fc) => fc.name), value].join(", "));
      } else {
        const frontmatter = (_c = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _c.frontmatter;
        if (frontmatter) {
          if (Object.keys(frontmatter).includes(fileClassAlias)) {
            yield replaceValues(this.plugin, this.file, fileClassAlias, value);
          } else {
            const lineNumber = frontmatter.position.end.line - 1;
            yield insertValues(this.plugin, this.file, fileClassAlias, value, lineNumber, true);
          }
        } else {
          const fields = {};
          fields[fileClassAlias] = value;
          yield insertFrontmatterWithFields(this.plugin, this.file, fields);
        }
      }
    });
  }
};
var FileClassManager = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.path.replace(/md$/, "").endsWith(name));
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassManager(this);
    this.attributes = [];
  }
  isMappedWithTag() {
    var _a, _b;
    try {
      const fileClassFile = this.getClassFile();
      const mapWithTag = (_b = (_a = this.plugin.app.metadataCache.getFileCache(fileClassFile)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.mapWithTag;
      return !!mapWithTag;
    } catch (error) {
      return false;
    }
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian34.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error(`no file named <${this.name}.md> in <${filesClassPath}> folder to match <${this.plugin.settings.fileClassAlias}: ${this.name}> in one of these notes`);
      throw error;
    }
  }
  getInheritanceList() {
    var _a, _b;
    const file = this.getClassFile();
    const parent = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.extends;
    if (false) {
      const parentFileClass = FileClass.createFileClass(this.plugin, parent);
      return [...parentFileClass.getInheritanceList(), this];
    }
    return [this];
  }
  getIcon() {
    const parents = this.getInheritanceList();
    parents.reverse();
    let icon;
    parents.some((fileClass, i) => {
      var _a, _b;
      const file = fileClass.getClassFile();
      const _icon = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.icon;
      if (_icon) {
        icon = _icon;
        return true;
      }
      ;
    });
    return icon;
  }
  static getFileClassAttributes(plugin, fileClass, excludes) {
    var _a;
    const file = fileClass.getClassFile();
    let attributes = [];
    const dvApi = (_a = plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(file.path);
      try {
        genuineKeys(dvFile).forEach((key) => {
          if (key !== "file" && !Object.keys(dvFile.file.frontmatter || {}).includes(key)) {
            const item = typeof dvFile[key] !== "string" ? JSON.stringify(dvFile[key]) : dvFile[key];
            try {
              const { type, options } = JSON.parse(item);
              const fieldType = FieldTypeLabelMapping[capitalize(type)];
              const attr = new FileClassAttribute(this.name, key, fieldType, options, fileClass.name);
              attributes.push(attr);
            } catch (e) {
            }
          }
        });
      } catch (error) {
        throw error;
      }
    }
    if (excludes) {
      return attributes.filter((attr) => !excludes.includes(attr.name));
    } else {
      return attributes;
    }
  }
  static getExcludedFieldsFromFrontmatter(excludedFields) {
    if (Array.isArray(excludedFields)) {
      return excludedFields;
    } else if (excludedFields) {
      return excludedFields.split(",");
    } else {
      return [];
    }
  }
  getAttributes(excludeParents = false) {
    var _a, _b;
    try {
      const file = this.getClassFile();
      const ancestors = this.plugin.fieldIndex.fileClassesAncestors.get(this.name);
      const _excludedFields = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.excludes;
      let excludedFields = FileClass.getExcludedFieldsFromFrontmatter(_excludedFields);
      const ancestorsAttributes = /* @__PURE__ */ new Map();
      ancestorsAttributes.set(this.name, FileClass.getFileClassAttributes(this.plugin, this, excludedFields));
      if (!excludeParents) {
        ancestors == null ? void 0 : ancestors.forEach((ancestorName) => {
          var _a2, _b2;
          const ancestorFile = this.plugin.app.vault.getAbstractFileByPath(`${this.plugin.settings.classFilesPath}${ancestorName}.md`);
          const ancestor = new FileClass(this.plugin, ancestorName);
          ancestorsAttributes.set(ancestorName, FileClass.getFileClassAttributes(this.plugin, ancestor, excludedFields));
          if (ancestorFile instanceof import_obsidian34.TFile && ancestorFile.extension === "md") {
            const _excludedFields2 = (_b2 = (_a2 = this.plugin.app.metadataCache.getFileCache(ancestorFile)) == null ? void 0 : _a2.frontmatter) == null ? void 0 : _b2.excludes;
            excludedFields = FileClass.getExcludedFieldsFromFrontmatter(_excludedFields2);
          }
        });
      }
      for (const [fileClassName, fileClassAttributes] of ancestorsAttributes) {
        this.attributes.push(...fileClassAttributes.filter((attr) => !this.attributes.map((_attr) => _attr.name).includes(attr.name)));
      }
    } catch (error) {
      throw error;
    }
  }
  updateAttribute(newType, newName, newOptions, attr) {
    return __async(this, null, function* () {
      const fileClass = attr ? this.plugin.fieldIndex.fileClassesName.get(attr.fileClassName) : this;
      const file = fileClass.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            let settings = {};
            settings["type"] = newType;
            if (newOptions)
              settings["options"] = newOptions;
            newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
          } else {
            newContent.push(line);
          }
        });
        this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        if (newOptions)
          settings["options"] = newOptions;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
  static createFileClass(plugin, name, excludeParent = false) {
    const fileClass = new FileClass(plugin, name);
    fileClass.getAttributes();
    return fileClass;
  }
  static getFileClassNameFromPath(plugin, path) {
    var _a, _b;
    const fileClassNameRegex = new RegExp(`${plugin.settings.classFilesPath}(?<fileClassName>.*).md`);
    return (_b = (_a = path.match(fileClassNameRegex)) == null ? void 0 : _a.groups) == null ? void 0 : _b.fileClassName;
  }
};

// src/fileClass/FileClassQuery.ts
var FileClassQuery = class {
  constructor(name = "", id = "", query = "", fileClassName = "") {
    this.name = name;
    this.id = id;
    this.query = query;
    this.fileClassName = fileClassName;
  }
  getResults(api) {
    try {
      return new Function("dv", `return ${this.query}`)(api);
    } catch (error) {
      throw Error(`Wrong query for field <${this.name}>. Check your settings`);
    }
  }
  matchFile(file) {
    const dataview = app.plugins.plugins.dataview;
    if (this.query && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
      try {
        const filesPath = this.getResults(dataview.api).values.map((v) => v.file.path);
        return filesPath.includes(file.path);
      } catch (error) {
        return false;
      }
    } else {
      return false;
    }
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.query = source.query;
    target.fileClassName = source.fileClassName;
  }
};
var FileClassQuery_default = FileClassQuery;

// src/commands/resolveLookups.ts
function resolveLookups(plugin, source = "") {
  var _a, _b;
  const f = plugin.fieldIndex;
  const lookupQueryResults = /* @__PURE__ */ new Map();
  [...f.lookupQueries].forEach(([lookupName, field]) => {
    const queryRelatedDVFiles = new Function("dv", `return ${field.options.dvQueryString}`)(f.dv.api).values;
    lookupQueryResults.set(lookupName, queryRelatedDVFiles);
  });
  [...f.filesFieldsExists].forEach(([filePath, fields]) => {
    fields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((lookupField) => {
      const queryRelatedDVFiles = lookupQueryResults.get(`${lookupField.fileClassName || "presetField"}___${lookupField.name}`) || [];
      const fileRelatedDVFiles = queryRelatedDVFiles.filter((dvFile) => {
        const targetValue = dvFile[lookupField.options.targetFieldName];
        if (Array.isArray(targetValue)) {
          return targetValue.filter((v) => f.dv.api.value.isLink(v)).map((v) => v.path).includes(filePath);
        } else {
          return (targetValue == null ? void 0 : targetValue.path) === filePath;
        }
      });
      const relatedFieldName = `${filePath}__related__${lookupField.fileClassName || "presetField"}___${lookupField.name}`;
      const existingFileLookupFields = f.fileLookupFiles.get(relatedFieldName);
      f.fileLookupFiles.set(relatedFieldName, fileRelatedDVFiles);
      if (!(f.fileLookupFieldsStatus.get(`${filePath}__${lookupField.name}`) === "changed" /* changed */))
        f.previousFileLookupFilesValues.set(relatedFieldName, (existingFileLookupFields || fileRelatedDVFiles).length);
      f.fileLookupFieldsStatus.set(`${filePath}__${lookupField.name}`, "changed" /* changed */);
    });
  });
  for (let id of f.fileLookupFiles.keys()) {
    const matchRegex = new RegExp("(?<filePath>.*)__related__(?<fileClassName>.*)___(?<fieldName>.*)");
    const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
    const existingLookFieldWithNameAndFileClassName = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.find((field) => field.name === fieldName && (field.fileClassName === void 0 && fileClassName === "presetField" || field.fileClassName === fileClassName));
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0 || dvPage[fieldName] === void 0 || !existingLookFieldWithNameAndFileClassName) {
      f.fileLookupFiles.delete(id);
      f.fileLookupFieldLastValue.delete(id);
      f.fileLookupFieldLastOutputType.delete(id);
      f.previousFileLookupFilesValues.delete(id);
      f.fileLookupFieldsStatus.delete(`${filePath}__${fieldName}`);
    }
  }
}

// src/commands/updateFormulas.ts
var import_obsidian35 = require("obsidian");
function cleanRemovedFormulasFromIndex(plugin) {
  var _a, _b;
  const f = plugin.fieldIndex;
  for (let id of f.fileFormulaFieldLastValue.keys()) {
    const matchRegex = new RegExp("(?<filePath>.*)__calculated__(?<fileClassName>.*)___(?<fieldName>.*)");
    const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
    const existingFormulaFieldWithNameAndFileClassName = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.find((field) => field.name === fieldName && (field.fileClassName === void 0 && fileClassName === "presetField" || field.fileClassName === fileClassName));
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0 || dvPage[fieldName] === void 0 || !existingFormulaFieldWithNameAndFileClassName) {
      f.fileFormulaFieldLastValue.delete(id);
    }
  }
}
function updateFormulas(plugin) {
  return __async(this, null, function* () {
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    const fileFormulasFields = /* @__PURE__ */ new Map();
    [...f.filesFieldsExists].forEach(([filePath, fields]) => {
      fields.filter((field) => field.type === "Formula" /* Formula */).forEach((field) => {
        fileFormulasFields.set(`${filePath}__calculated__${field.fileClassName || "presetField"}___${field.name}`, field);
      });
    });
    [...fileFormulasFields].forEach((_0) => __async(this, [_0], function* ([id, field]) {
      var _a;
      const matchRegex = new RegExp("(?<filePath>.*)__calculated__(?<fileClassName>.*)___(?<fieldName>.*)");
      const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
      const dvFile = f.dv.api.page(filePath);
      const currentdvValue = dvFile && dvFile[field.name];
      const currentValue = currentdvValue ? currentdvValue.toString() : "";
      f.fileFormulaFieldLastValue.set(id, currentValue);
      try {
        const newValue = new Function("current, dv", `return ${field.options.formula}`)(dvFile, f.dv.api).toString();
        if (!currentValue && newValue !== "" || currentValue !== newValue) {
          yield plugin.fileTaskManager.pushTask(() => replaceValues(plugin, filePath, field.name, newValue));
          f.fileFormulaFieldLastValue.set(id, newValue);
        }
      } catch (e) {
        if (renderingErrors.includes(field.name))
          renderingErrors.push(field.name);
      }
    }));
    if (renderingErrors.length)
      new import_obsidian35.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
    cleanRemovedFormulasFromIndex(plugin);
  });
}

// src/components/FieldIndex.ts
var FieldIndex = class extends import_obsidian36.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.fileChanged = false;
    this.dvReady = false;
    this.firstIndexingDone = false;
    this.flushCache();
    this.fileLookupFiles = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastValue = /* @__PURE__ */ new Map();
    this.fileLookupFieldsStatus = /* @__PURE__ */ new Map();
    this.previousFileLookupFilesValues = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastOutputType = /* @__PURE__ */ new Map();
    this.fileFormulaFieldLastValue = /* @__PURE__ */ new Map();
    this.dv = this.plugin.app.plugins.plugins.dataview;
    this.classFilesPath = plugin.settings.classFilesPath;
  }
  onload() {
    return __async(this, null, function* () {
      var _a;
      this.loadTime = Date.now();
      yield (() => __async(this, null, function* () {
      }))();
      if ((_a = this.dv) == null ? void 0 : _a.api.index.initialized) {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.lastRevision = this.dv.api.index.revision;
        this.dvReady = true;
        yield this.fullIndex("dv is running", false);
      }
      this.registerEvent(this.plugin.app.metadataCache.on("dataview:index-ready", () => __async(this, null, function* () {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.dvReady = true;
        yield this.fullIndex("dv index", false);
        this.lastRevision = this.dv.api.index.revision;
      })));
      this.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        var _a2;
        if (this.plugin.app.metadataCache.inProgressTaskCount === 0) {
          this.fileChanged = true;
          yield this.fullIndex("cache resolved", false, true);
          this.lastRevision = ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) || 0;
        }
      })));
      this.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", (op, file) => __async(this, null, function* () {
        var _a2;
        if (op === "update" && this.plugin.app.metadataCache.fileCache[file.path].mtime >= this.loadTime && ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) !== this.lastRevision && this.fileChanged && this.dvReady) {
          cleanRemovedFormulasFromIndex(this.plugin);
          this.getFilesFieldsExists(file);
          if (this.classFilesPath && file.path.startsWith(this.classFilesPath)) {
            this.fullIndex("fileClass changed");
          } else {
            yield this.updateFormulas();
            this.resolveLookups(false);
            const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, file.path);
            yield this.updateLookups(fileClassName, false);
          }
          this.lastRevision = this.dv.api.index.revision;
        }
      })));
      this.plugin.app.workspace.trigger("metadata-menu:indexed");
    });
  }
  flushCache() {
    this.filesFields = /* @__PURE__ */ new Map();
    this.filesFieldsExists = /* @__PURE__ */ new Map();
    this.fileClassesFields = /* @__PURE__ */ new Map();
    this.fieldsFromGlobalFileClass = [];
    this.filesFieldsFromTags = /* @__PURE__ */ new Map();
    this.filesFieldsFromFileClassQueries = /* @__PURE__ */ new Map();
    this.filesFieldsFromInnerFileClasses = /* @__PURE__ */ new Map();
    this.fileClassesPath = /* @__PURE__ */ new Map();
    this.fileClassesName = /* @__PURE__ */ new Map();
    this.fileClassesAncestors = /* @__PURE__ */ new Map();
    this.valuesListNotePathValues = /* @__PURE__ */ new Map();
    this.tagsMatchingFileClasses = /* @__PURE__ */ new Map();
    this.filesFileClasses = /* @__PURE__ */ new Map();
    this.filesFileClassesNames = /* @__PURE__ */ new Map();
    this.lookupQueries = /* @__PURE__ */ new Map();
  }
  fullIndex(event, force_update_all = false, without_lookups = false) {
    return __async(this, null, function* () {
      let start2 = Date.now(), time = Date.now();
      this.flushCache();
      this.getFileClassesAncestors();
      this.getGlobalFileClass();
      this.getFileClasses();
      this.getLookupQueries();
      this.resolveFileClassMatchingTags();
      this.resolveFileClassQueries();
      this.getFilesFieldsFromFileClass();
      this.getFilesFields();
      this.getFilesFieldsExists();
      yield this.getValuesListNotePathValues();
      this.resolveLookups(without_lookups);
      yield this.updateLookups("full Index", without_lookups);
      if (force_update_all || !this.firstIndexingDone)
        yield this.updateFormulas();
      this.firstIndexingDone = true;
    });
  }
  resolveLookups(without_lookups) {
    if (!without_lookups)
      resolveLookups(this.plugin);
  }
  updateLookups(source = "", without_lookups) {
    return __async(this, null, function* () {
      if (!without_lookups)
        yield updateLookups(this.plugin, source);
    });
  }
  updateFormulas() {
    return __async(this, null, function* () {
      yield updateFormulas(this.plugin);
    });
  }
  getValuesListNotePathValues() {
    return __async(this, null, function* () {
      this.fileClassesName.forEach((fileClass) => {
        fileClass.attributes.forEach((attr) => __async(this, null, function* () {
          if (typeof attr.options === "object" && !!attr.options["valuesListNotePath"]) {
            this.valuesListNotePathValues.set(attr.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, attr.options.valuesListNotePath));
          }
        }));
      });
      this.plugin.settings.presetFields.forEach((setting) => __async(this, null, function* () {
        if (setting.options.valuesListNotePath) {
          this.valuesListNotePathValues.set(setting.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, setting.options.valuesListNotePath));
        }
      }));
    });
  }
  getFileClassesAncestors() {
    const classFilesPath = this.plugin.settings.classFilesPath;
    if (classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(classFilesPath)).forEach((f) => {
        var _a, _b;
        const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, f.path);
        if (fileClassName) {
          const parent = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.extends;
          if (parent) {
            const parentFile = this.plugin.app.vault.getAbstractFileByPath(`${classFilesPath}${parent}.md`);
            if (parentFile) {
              this.fileClassesAncestors.set(fileClassName, [parent]);
            } else {
              this.fileClassesAncestors.set(fileClassName, []);
            }
          } else {
            this.fileClassesAncestors.set(fileClassName, []);
          }
        }
      });
    }
    [...this.fileClassesAncestors].forEach(([fileClassName, ancestors]) => {
      if (ancestors.length > 0) {
        this.getAncestorsRecursively(fileClassName);
      }
    });
  }
  getAncestorsRecursively(fileClassName) {
    var _a;
    const ancestors = this.fileClassesAncestors.get(fileClassName);
    if (ancestors && ancestors.length) {
      const lastAncestor = ancestors.last();
      const lastAncestorParent = (_a = this.fileClassesAncestors.get(lastAncestor)) == null ? void 0 : _a[0];
      if (lastAncestorParent && lastAncestorParent !== fileClassName) {
        this.fileClassesAncestors.set(fileClassName, [...ancestors, lastAncestorParent]);
      }
    }
  }
  getGlobalFileClass() {
    const globalFileClass = this.plugin.settings.globalFileClass;
    if (!globalFileClass) {
      this.fieldsFromGlobalFileClass = [];
    } else {
      try {
        this.fieldsFromGlobalFileClass = FileClass.createFileClass(this.plugin, globalFileClass).attributes.map((attr) => attr.getField());
      } catch (error) {
      }
    }
  }
  getFileClasses() {
    const classFilesPath = this.classFilesPath;
    if (classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(classFilesPath)).forEach((f) => {
        var _a;
        const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, f.path);
        if (fileClassName) {
          try {
            const fileClass = FileClass.createFileClass(this.plugin, fileClassName);
            this.fileClassesFields.set(fileClassName, fileClass.attributes.map((attr) => attr.getField()));
            this.fileClassesPath.set(f.path, fileClass);
            this.fileClassesName.set(fileClass.name, fileClass);
            const cache = this.plugin.app.metadataCache.getFileCache(f);
            if ((_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a.mapWithTag) {
              this.tagsMatchingFileClasses.set(fileClassName, fileClass);
            }
          } catch (error) {
          }
        }
      });
    }
  }
  getLookupQueries() {
    this.plugin.settings.presetFields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((field) => {
      this.lookupQueries.set(`presetField___${field.name}`, field);
    });
    [...this.fileClassesFields].forEach(([fileClassName, fields]) => {
      fields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((field) => {
        this.lookupQueries.set(`${fileClassName}___${field.name}`, field);
      });
    });
  }
  resolveFileClassMatchingTags() {
    if (![...this.tagsMatchingFileClasses].length)
      return;
    const mappedTags = [...this.tagsMatchingFileClasses.keys()];
    const filesWithMappedTagQuery = mappedTags.map((t) => `#${t}`).join(" or ");
    this.dv.api.pages(filesWithMappedTagQuery).forEach((dvFile) => {
      dvFile.file.tags.forEach((_tag) => {
        const tag = _tag.replace(/^\#/, "");
        const fileClass = this.tagsMatchingFileClasses.get(tag);
        const filePath = dvFile.file.path;
        if (fileClass) {
          this.filesFileClasses.set(filePath, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(filePath) || [], fileClass])]);
          this.filesFileClassesNames.set(dvFile.file.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(filePath) || [], fileClass.name])]);
          const fileFileClassesFieldsFromTag = this.fileClassesFields.get(fileClass.name);
          const currentFields = this.filesFieldsFromTags.get(filePath);
          if (fileFileClassesFieldsFromTag) {
            const newFields = [...fileFileClassesFieldsFromTag];
            const filteredCurrentFields = (currentFields == null ? void 0 : currentFields.filter((field) => !newFields.map((f) => f.name).includes(field.name))) || [];
            newFields.push(...filteredCurrentFields);
            this.filesFieldsFromTags.set(filePath, newFields);
          }
        }
      });
    });
  }
  resolveFileClassQueries() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.plugin.settings.fileClassQueries.forEach((sfcq) => {
      const fcq = new FileClassQuery_default(sfcq.name, sfcq.id, sfcq.query, sfcq.fileClassName);
      fcq.getResults(dvApi).forEach((result) => {
        const fileClass = this.fileClassesName.get(fcq.fileClassName);
        if (fileClass) {
          const f = result.file;
          this.filesFileClasses.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(f.path) || [], fileClass])]);
          this.filesFileClassesNames.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(f.path) || [], fileClass.name])]);
        }
        const fileFileClassesFieldsFromQuery = this.fileClassesFields.get(fcq.fileClassName);
        if (fileFileClassesFieldsFromQuery)
          this.filesFieldsFromFileClassQueries.set(result.file.path, fileFileClassesFieldsFromQuery);
      });
    });
  }
  getFilesFieldsFromFileClass() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.classFilesPath || !f.path.includes(this.classFilesPath)).forEach((f) => {
      var _a, _b;
      const fileFileClassesNames = [];
      const fileClassesCache = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b[this.plugin.settings.fileClassAlias];
      if (fileClassesCache) {
        Array.isArray(fileClassesCache) ? fileFileClassesNames.push(...fileClassesCache) : fileFileClassesNames.push(...fileClassesCache.split(",").map((fcn) => fcn.trim()));
        fileFileClassesNames.forEach((fileFileClassName) => {
          const fileClass = this.fileClassesName.get(fileFileClassName);
          if (fileClass) {
            this.filesFileClasses.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(f.path) || [], fileClass])]);
            this.filesFileClassesNames.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(f.path) || [], fileClass.name])]);
            const fileClassesFieldsFromFile = this.fileClassesFields.get(fileFileClassName);
            const currentFields = this.filesFieldsFromInnerFileClasses.get(f.path);
            if (fileClassesFieldsFromFile) {
              const newFields = [...fileClassesFieldsFromFile];
              const filteredCurrentFields = (currentFields == null ? void 0 : currentFields.filter((field) => !newFields.map((f2) => f2.name).includes(field.name))) || [];
              newFields.push(...filteredCurrentFields);
              this.filesFieldsFromInnerFileClasses.set(f.path, newFields);
            } else {
              this.filesFieldsFromInnerFileClasses.set(f.path, []);
            }
          } else {
            this.filesFieldsFromInnerFileClasses.set(f.path, []);
          }
        });
      } else {
        this.filesFieldsFromInnerFileClasses.set(f.path, []);
      }
    });
  }
  getFilesFields() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.classFilesPath || !f.path.includes(this.classFilesPath)).forEach((f) => {
      const fileFieldsFromInnerFileClasses = this.filesFieldsFromInnerFileClasses.get(f.path);
      const fileFieldsFromQuery = this.filesFieldsFromFileClassQueries.get(f.path);
      const fileFieldsFromTag = this.filesFieldsFromTags.get(f.path);
      if ((fileFieldsFromInnerFileClasses == null ? void 0 : fileFieldsFromInnerFileClasses.length) || (fileFieldsFromQuery == null ? void 0 : fileFieldsFromQuery.length) || (fileFieldsFromTag == null ? void 0 : fileFieldsFromTag.length)) {
        const filesFields = fileFieldsFromInnerFileClasses || [];
        filesFields.push(...(fileFieldsFromTag || []).filter((field) => !filesFields.map((f2) => f2.name).includes(field.name)));
        filesFields.push(...(fileFieldsFromQuery || []).filter((field) => !filesFields.map((f2) => f2.name).includes(field.name)));
        this.filesFields.set(f.path, filesFields);
      } else if (this.fieldsFromGlobalFileClass.length) {
        this.filesFields.set(f.path, this.fieldsFromGlobalFileClass);
        this.filesFileClasses.set(f.path, [this.fileClassesName.get(this.plugin.settings.globalFileClass)]);
        this.filesFileClassesNames.set(f.path, [this.plugin.settings.globalFileClass]);
      } else {
        const fields = this.plugin.settings.presetFields.map((prop) => {
          const property = new Field_default();
          return Object.assign(property, prop);
        });
        this.filesFields.set(f.path, fields);
      }
    });
  }
  getFilesFieldsExists(file) {
    let fileFields2;
    if (file) {
      fileFields2 = [[file.path, this.filesFields.get(file.path) || []]];
    } else {
      fileFields2 = [...this.filesFields];
    }
    fileFields2.forEach(([filePath, fields]) => {
      const dvFile = this.dv.api.page(filePath);
      const existingFields = [];
      fields.forEach((field) => {
        if (dvFile && dvFile[field.name] !== void 0) {
          existingFields.push(field);
        }
      });
      if (existingFields.length) {
        this.filesFieldsExists.set(filePath, existingFields);
      } else {
        this.filesFieldsExists.delete(filePath);
      }
    });
  }
};

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian37 = require("obsidian");
var FileClassAttributeModal = class extends import_obsidian37.Modal {
  constructor(plugin, fileClass, attr) {
    super(plugin.app);
    this.plugin = plugin;
    this.fileClass = fileClass;
    this.attr = attr;
    this.initialField = new Field_default();
    if (this.attr) {
      this.field = attr.getField();
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      this.field = new Field_default();
    }
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.nameInputContainer = this.contentEl.createDiv();
    this.typeSelectContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    this.fieldOptionsContainer = this.contentEl.createDiv();
  }
  buildNameInputContainer() {
    this.nameInputContainer.setText("Name: ");
    this.nameInput = new import_obsidian37.TextComponent(this.nameInputContainer);
    this.attr ? this.nameInput.setValue(this.field.name) : this.nameInput.setPlaceholder("Type a name for this attribute");
    this.nameInput.inputEl.focus();
    this.nameInput.onChange((value) => {
      this.field.name = value;
      this.attrName.setText(`<${value}>`);
    });
    this.typeSelectContainer.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  buildTypeSelectContainer() {
    const typeSelectHeader = this.typeSelectContainer.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    this.attrName = attrLine.createEl("strong");
    this.attrName.setText(`<${this.field.name}>`);
    attrLine.append(" fields in files with:");
    String(`---
${this.plugin.settings.fileClassAlias}: ${this.fileClass.name}
...
---`).split("\n").forEach((line) => {
      typeSelectHeader.createEl("div", "yaml-metadata-menu-red").setText(line);
    });
    const typeSelectLabel = this.typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label" });
    typeSelectLabel.setText("will: ");
    const typeSelectDropDown = this.typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-toggler" });
    const typeSelect = new import_obsidian37.DropdownComponent(typeSelectDropDown);
    Object.keys(FieldTypeTooltip).forEach((key) => typeSelect.addOption(key, FieldTypeTooltip[key]));
    typeSelect.setValue(this.field.type);
    typeSelect.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.nameInput.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.nameInput, this.nameInput.inputEl) && this.fieldManager.validateOptions();
  }
  createSaveBtn(container) {
    const saveButton = new import_obsidian37.ButtonComponent(container);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      let error = !this.validateFields();
      if (error) {
        new import_obsidian37.Notice("Fix errors before saving.");
        return;
      }
      ;
      yield this.fileClass.updateAttribute(this.field.type, this.field.name, this.field.options, this.attr);
      this.close();
    }));
  }
  createRemovelBtn(container) {
    const removeButton = new import_obsidian37.ButtonComponent(container);
    removeButton.setIcon("trash");
    removeButton.onClick(() => {
      var _a;
      const confirmModal = new import_obsidian37.Modal(this.plugin.app);
      confirmModal.titleEl.setText("Please confirm");
      confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
      const confirmFooter = confirmModal.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
      const confirmButton = new import_obsidian37.ButtonComponent(confirmFooter);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => {
        if (this.attr)
          this.fileClass.removeAttribute(this.attr);
        confirmModal.close();
        this.close();
      });
      const dismissButton = new import_obsidian37.ExtraButtonComponent(confirmFooter);
      dismissButton.setIcon("cross");
      dismissButton.onClick(() => this.close());
      confirmModal.open();
    });
  }
  createCancelBtn(container) {
    const cancelButton = new import_obsidian37.ExtraButtonComponent(container);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
  onOpen() {
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    this.buildNameInputContainer();
    this.buildTypeSelectContainer();
    this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    this.createSaveBtn(footer);
    if (this.attr)
      this.createRemovelBtn(footer);
    this.createCancelBtn(footer);
  }
};

// src/modals/chooseSectionModal.ts
var import_obsidian38 = require("obsidian");
var chooseSectionModal = class extends import_obsidian38.SuggestModal {
  constructor(plugin, file, onSelect) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.onSelect = onSelect;
    this.addAsListItem = false;
    this.addAsComment = false;
    this.addAtEndOfFrontMatter = false;
    this.onSelect = onSelect;
  }
  onOpen() {
    super.onOpen();
    const inputContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-input-container" });
    inputContainer.appendChild(this.inputEl);
    this.containerEl.find(".prompt").prepend(inputContainer);
    const addAsListItemBtn = new import_obsidian38.ButtonComponent(inputContainer);
    addAsListItemBtn.setIcon("list");
    addAsListItemBtn.onClick(() => {
      if (this.addAsListItem) {
        addAsListItemBtn.removeCta();
        this.addAsListItem = false;
      } else {
        addAsListItemBtn.setCta();
        this.addAsListItem = true;
      }
    });
    addAsListItemBtn.setDisabled(this.addAtEndOfFrontMatter);
    addAsListItemBtn.buttonEl.addClass("metadata-menu-value-suggester-button");
    addAsListItemBtn.setTooltip("Add this field as a list item");
    const addAsCommentItemBtn = new import_obsidian38.ButtonComponent(inputContainer);
    addAsCommentItemBtn.setIcon("message-square");
    addAsCommentItemBtn.onClick(() => {
      if (this.addAsComment) {
        addAsCommentItemBtn.removeCta();
        this.addAsComment = false;
      } else {
        addAsCommentItemBtn.setCta();
        this.addAsComment = true;
      }
    });
    addAsCommentItemBtn.setDisabled(this.addAtEndOfFrontMatter);
    addAsCommentItemBtn.buttonEl.addClass("metadata-menu-value-suggester-button");
    addAsCommentItemBtn.setTooltip("Add this field as a comment item");
    const addAtEndOfFrontMatterBtn = new import_obsidian38.ButtonComponent(inputContainer);
    addAtEndOfFrontMatterBtn.setIcon("list-end");
    addAtEndOfFrontMatterBtn.onClick(() => {
      this.onSelect(-2, true, false, false, false);
      this.close();
    });
    addAtEndOfFrontMatterBtn.buttonEl.addClass("metadata-menu-value-suggester-button");
    addAtEndOfFrontMatterBtn.setTooltip("Add this field at the end of the frontmatter");
  }
  getSuggestions(query) {
    return __async(this, null, function* () {
      const content = yield this.plugin.app.vault.read(this.file);
      const suggestions = [{
        lineNumber: -1,
        lineText: "----------Add on top of the file--------"
      }];
      content.split("\n").forEach((lineContent, i) => {
        if (lineContent.toLowerCase().includes(query.toLowerCase())) {
          suggestions.push({
            lineNumber: i,
            lineText: lineContent.substring(0, 37) + (lineContent.length < 37 ? "" : "...")
          });
        }
      });
      return suggestions;
    });
  }
  renderSuggestion(value, el) {
    el.addClass("metadata-menu-choose-section-modal-item");
    const container = el.createDiv({ cls: "metadata-menu-choose-section-modal-line" });
    container.createDiv({ text: `${value.lineNumber + 1}`, cls: "lineNumber" });
    container.createDiv({ text: value.lineText, cls: "lineText" });
  }
  onChooseSuggestion(item, evt) {
    var _a;
    const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter;
    const inFrontmatter = frontmatter !== void 0 && item.lineNumber <= frontmatter.position.end.line;
    const after = item.lineNumber == -1 ? false : true;
    this.onSelect(item.lineNumber == -1 ? 0 : item.lineNumber, inFrontmatter, after, this.addAsListItem, this.addAsComment);
  }
};

// src/commands/fieldModifier.ts
var import_obsidian39 = require("obsidian");
function buildAndOpenModal(plugin, file, fieldName, attrs) {
  var _a, _b;
  if (((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.inFrontmatter) && ((_b = plugin.app.metadataCache.getCache(file.path)) == null ? void 0 : _b.frontmatter)) {
    const lineNumber = plugin.app.metadataCache.getCache(file.path).frontmatter.position.end.line - 1;
    FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, true, false, false, false);
  } else {
    new chooseSectionModal(plugin, file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
  }
}
function createDvField(plugin, dv, p, fieldContainer, fieldName, attrs) {
  var _a;
  const field = (_a = plugin.fieldIndex.filesFields.get(p.file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
  if (field == null ? void 0 : field.type) {
    const fieldManager = new FieldManager[field.type](plugin, field);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  } else {
    const fieldManager = FieldManager2.createDefault(plugin, fieldName);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  }
}
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  var _a, _b;
  const fieldContainer = dv.el("div", "");
  fieldContainer.setAttr("class", "metadata-menu-dv-field-container");
  if (p[fieldName] === void 0) {
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.showAddField)) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const addFieldBtn = dv.el("button", attrs);
      (0, import_obsidian39.setIcon)(addFieldBtn, "plus-with-circle");
      addFieldBtn.addClass("metadata-menu-dv-field-button");
      addFieldBtn.addClass("isolated");
      addFieldBtn.onclick = () => __async(this, null, function* () {
        var _a2;
        const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian39.TFile && file.extension == "md") {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((field2) => field2.name === fieldName);
          if (field) {
            buildAndOpenModal(plugin, file, fieldName, attrs);
          } else {
            new chooseSectionModal(plugin, file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(plugin, file, void 0, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
          }
        } else {
          throw Error("path doesn't correspond to a proper file");
        }
      });
      fieldContainer.appendChild(addFieldBtn);
    }
  } else {
    const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
    if (file instanceof import_obsidian39.TFile && file.extension == "md") {
      const field = (_b = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _b.find((field2) => field2.name === fieldName);
      if (field) {
        createDvField(plugin, dv, p, fieldContainer, fieldName, attrs);
      } else {
        const fieldManager = FieldManager2.createDefault(plugin, fieldName);
        fieldManager.createDvField(dv, p, fieldContainer, attrs);
      }
    }
  }
  return fieldContainer;
}

// src/commands/fileFields.ts
var import_obsidian40 = require("obsidian");
var FieldInfo = class {
  constructor() {
    this.type = void 0;
    this.sourceType = void 0;
    this.fileClass = void 0;
    this.options = void 0;
    this.isValid = void 0;
    this.value = "";
    this.valuesListNotePath = void 0;
    this.unique = true;
  }
  setInfos(plugin, file, fieldName, value, matchingFileClassQuery) {
    var _a;
    this.value = value;
    this.ignoreInMenu = plugin.settings.globallyIgnoredFields.includes(fieldName);
    const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      this.isValid = fieldManager.validateValue(value);
      this.fileClass = field.fileClassName;
      this.type = field.type;
      this.options = field.options;
      this.sourceType = field.fileClassName ? "fileClass" : "settings";
    }
  }
};
function fileFields(plugin, fileOrfilePath) {
  var _a;
  let file;
  if (fileOrfilePath instanceof import_obsidian40.TFile) {
    file = fileOrfilePath;
  } else {
    const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
    if (_file instanceof import_obsidian40.TFile && _file.extension == "md") {
      file = _file;
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
  }
  const fields = {};
  const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
  if (dvApi) {
    const dvFile = dvApi.page(file.path);
    try {
      genuineKeys(dvFile).forEach((key) => __async(this, null, function* () {
        if (key !== "file") {
          const fieldInfo = new FieldInfo();
          fieldInfo.unique = !Object.keys(fields).includes(key);
          fields[key] = fieldInfo;
          fieldInfo.setInfos(plugin, file, key, dvFile[key]);
        }
      }));
    } catch (error) {
      throw error;
    }
  }
  return fields;
}

// src/commands/insertMissingFields.ts
var import_obsidian41 = require("obsidian");
function insertMissingFields(plugin, fileOrFilePath, lineNumber, inFrontmatter = false, after = false, asList = false, asComment = false, fileClassName) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian41.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian41.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const f = plugin.fieldIndex;
      const tm = plugin.fileTaskManager;
      const fields = f.filesFields.get(file.path);
      const currentFieldsNames = genuineKeys(dvApi.page(file.path));
      const filteredClassFields = fileClassName ? ((_b = plugin.fieldIndex.fileClassesFields.get(fileClassName)) == null ? void 0 : _b.filter((field) => field.fileClassName === fileClassName)) || void 0 : void 0;
      fields == null ? void 0 : fields.filter((field) => !currentFieldsNames.includes(field.name)).filter((field) => filteredClassFields ? filteredClassFields.map((f2) => f2.name).includes(field.name) : true).forEach((field) => __async(this, null, function* () {
        yield tm.pushTask(() => {
          insertValues(plugin, file.path, field.name, "", lineNumber, inFrontmatter, after, asList, asComment);
        });
      }));
    }
  });
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      insertValues: this.insertValues(),
      fieldModifier: this.fieldModifier(),
      fileFields: this.fileFields(),
      insertMissingFields: this.insertMissingFields()
    };
  }
  getValues() {
    return (fileOrFilePath, attribute) => __async(this, null, function* () {
      return getValues(this.plugin, fileOrFilePath, attribute);
    });
  }
  replaceValues() {
    return (fileOrFilePath, attribute, input) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, fileOrFilePath, attribute, input);
      });
    });
  }
  insertValues() {
    return (fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        insertValues(this.plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
      });
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
  fileFields() {
    return (fileOrFilePath) => __async(this, null, function* () {
      return fileFields(this.plugin, fileOrFilePath);
    });
  }
  insertMissingFields() {
    return (fileOrFilePath, lineNumber, inFrontmatter, after, asList, asComment, fileClassName) => __async(this, null, function* () {
      return insertMissingFields(this.plugin, fileOrFilePath, lineNumber, inFrontmatter, after, asList, asComment, fileClassName);
    });
  }
};

// src/options/FieldCommandSuggestModal.ts
var import_obsidian42 = require("obsidian");
var FieldCommandSuggestModal = class extends import_obsidian42.FuzzySuggestModal {
  constructor() {
    super(...arguments);
    this.options = [];
  }
  getItems() {
    return this.options;
  }
  getItemText(item) {
    return item.actionLabel;
  }
  onChooseItem(item, evt) {
    item.action();
  }
  renderSuggestion(item, el) {
    el.addClass("metadata-menu-command-suggest-item");
    const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
    item.item.icon ? (0, import_obsidian42.setIcon)(iconContainer, item.item.icon) : (0, import_obsidian42.setIcon)(iconContainer, "pencil");
    const actionLabel = el.createDiv({ cls: "metadata-menu-command-suggest-action-label" });
    actionLabel.innerHTML = item.item.actionLabel;
  }
};

// src/options/FileClassOptionsList.ts
var import_obsidian43 = require("obsidian");
function isMenu(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand(location) {
  return location === "InsertFieldCommand";
}
function isSuggest(location) {
  return location.getItems !== void 0;
}
var FileClassOptionsList = class {
  constructor(plugin, file, location, fromFile) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.fromFile = fromFile;
    this.fileClass = this.plugin.fieldIndex.fileClassesPath.get(this.file.path);
  }
  createExtraOptionList(openAfterCreate = true) {
    var _a, _b;
    const mapWithTagAction = () => __async(this, null, function* () {
      var _a2;
      const frontmatter = (_a2 = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a2.frontmatter;
      if (frontmatter) {
        if (Object.keys(frontmatter).includes("mapWithTag")) {
          yield replaceValues(this.plugin, this.file, "mapWithTag", "true");
        } else {
          const lineNumber = frontmatter.position.end.line - 1;
          yield insertValues(this.plugin, this.file, "mapWithTag", "true", lineNumber, true);
        }
      } else {
        const fields = { "mapWithTag": "true" };
        yield insertFrontmatterWithFields(this.plugin, this.file, fields);
      }
    });
    if (isMenu(this.location)) {
      this.location.addSeparator();
    }
    ;
    const fileClass = this.fileClass;
    const currentFieldsNames = [];
    let addMissingFieldsAction = () => {
      new import_obsidian43.Notice("Something went wrong, please check your fileClass definitions");
    };
    if (this.fromFile) {
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (dvApi) {
        const dvFile = dvApi.page(this.fromFile.path);
        if (dvFile) {
          currentFieldsNames.push(...genuineKeys(dvFile));
          const modal = new chooseSectionModal(this.plugin, this.fromFile, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment, fileClass == null ? void 0 : fileClass.name));
          addMissingFieldsAction = () => {
            modal.open();
          };
        }
      }
      ;
    }
    const missingFields = fileClass && this.fromFile ? !((_b = this.plugin.fieldIndex.fileClassesFields.get(fileClass.name)) == null ? void 0 : _b.map((f) => f.name).every((fieldName) => currentFieldsNames.includes(fieldName))) : false;
    if (isInsertFieldCommand(this.location) && fileClass) {
      const modal = new FileClassAttributeModal(this.plugin, fileClass);
      modal.open();
    } else if (isSuggest(this.location)) {
      this.buildFieldOptions();
      if (fileClass && !fileClass.isMappedWithTag()) {
        this.location.options.push({
          id: "map_fileClass_with_tag",
          actionLabel: `<span>Map <b>${fileClass.name}</b> with tag of same name</span>`,
          action: mapWithTagAction,
          icon: "hash"
        });
      }
      if (fileClass && missingFields && this.fromFile) {
        this.location.options.push({
          id: `insert_missig_fields_from_${fileClass.name.replace("/", "_")}`,
          actionLabel: `<span>Insert missing fields from <b>${fileClass.name}</b></span>`,
          action: addMissingFieldsAction,
          icon: "battery-full"
        });
      }
      if (openAfterCreate)
        this.location.open();
    } else if (isMenu(this.location)) {
      if (fileClass && !fileClass.isMappedWithTag()) {
        this.location.addItem((item) => {
          item.setTitle(`Map ${fileClass.name} with tag`);
          item.setIcon("hash");
          item.onClick(mapWithTagAction);
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      if (fileClass && missingFields && this.fromFile) {
        this.location.addItem((item) => {
          item.setTitle(`Insert missing fields from ${fileClass.name}`);
          item.setIcon("battery-full");
          item.onClick(addMissingFieldsAction);
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      this.buildFieldOptions();
    } else {
      this.buildFieldOptions;
    }
  }
  buildFieldOptions() {
    var _a;
    (_a = this.fileClass) == null ? void 0 : _a.attributes.forEach((attr) => {
      const modal2 = new FileClassAttributeModal(this.plugin, this.fileClass, attr);
      if (isMenu(this.location)) {
        this.location.addItem((item) => {
          item.setTitle(`${this.fileClass.name} - ${attr.name}`);
          item.setIcon("wrench");
          item.onClick(() => {
            modal2.open();
          });
          item.setSection(`metadata-menu-fileclass.${this.fileClass.name}.fileclass-fields`);
        });
      } else if (isSuggest(this.location)) {
        this.location.options.push({
          id: `update_${attr.name}`,
          actionLabel: `<span>${attr.name}</span>`,
          action: () => modal2.open(),
          icon: "gear"
        });
      }
    });
    const modal = new FileClassAttributeModal(this.plugin, this.fileClass);
    const action = () => modal.open();
    if (isMenu(this.location) && this.fileClass) {
      this.location.addItem((item) => {
        item.setTitle("Add new field");
        item.setIcon("plus-circle");
        item.onClick(action);
        item.setSection(`metadata-menu-fileclass.${this.fileClass.name}.fileclass-fields`);
      });
    } else if (isSuggest(this.location) && this.fileClass) {
      this.location.options.push({
        id: "add_fileClass_attribute",
        actionLabel: `<span>Insert an attribute for <b>${this.fileClass.name}</b> fileClass</span>`,
        action,
        icon: "plus-circle"
      });
    }
  }
};

// src/options/linkContextMenu.ts
var import_obsidian46 = require("obsidian");

// src/options/OptionsList.ts
var import_obsidian45 = require("obsidian");

// src/modals/addNewFileClassModal.ts
var import_obsidian44 = require("obsidian");

// src/commands/createFileClass.ts
function createFileClass(plugin, name, mapWithTag = false) {
  return __async(this, null, function* () {
    const classFilesPath = plugin.settings.classFilesPath;
    if (classFilesPath) {
      try {
        const content = mapWithTag ? "---\nmapWithTag: true\n---\n" : "";
        yield plugin.app.vault.create(`${classFilesPath}${name}.md`, content);
      } catch (error) {
        throw error;
      }
    }
  });
}

// src/modals/addNewFileClassModal.ts
var AddNewFileClassModal = class extends import_obsidian44.Modal {
  constructor(plugin) {
    super(plugin.app);
    this.plugin = plugin;
  }
  onOpen() {
    this.titleEl.setText("Add a new fileClass");
    this.buildAddFileClassForm();
  }
  buildAddFileClassForm() {
    const fileClassesPath = this.plugin.settings.classFilesPath;
    const fileClassAlias = this.plugin.settings.fileClassAlias;
    const nameContainer = this.contentEl.createDiv({});
    const nameInputContainer = nameContainer.createDiv({ cls: "metadata-menu-input" });
    nameInputContainer.createDiv({ text: `${fileClassAlias} name` });
    const nameInput = new import_obsidian44.TextComponent(nameInputContainer);
    const nameErrorContainer = nameContainer.createDiv({ cls: "metadata-menu-modal-value-error-field", text: `This ${fileClassAlias} file already exists` });
    const mapWithTagToggleContainer = this.contentEl.createDiv({ cls: "metadata-menu-toggler-with-label" });
    mapWithTagToggleContainer.createDiv({ cls: "metadata-menu-toggler-label", text: `Map this ${fileClassAlias} file with the tag of same name` });
    const mapWithTagToggler = new import_obsidian44.ToggleComponent(mapWithTagToggleContainer);
    mapWithTagToggler.setValue(false);
    const actionsContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveBtnContainer = actionsContainer.createDiv({});
    const saveBtn = new import_obsidian44.ButtonComponent(saveBtnContainer);
    saveBtn.setDisabled(true);
    saveBtn.setIcon("file-plus-2");
    nameErrorContainer.hide();
    nameInput.onChange((value) => __async(this, null, function* () {
      nameErrorContainer.hide();
      saveBtn.setDisabled(false);
      saveBtn.setCta();
      if (yield this.plugin.app.vault.adapter.exists(`${fileClassesPath}${value}.md`)) {
        nameErrorContainer.show();
        saveBtn.setDisabled(true);
        saveBtn.removeCta();
      }
    }));
    saveBtn.onClick(() => {
      createFileClass(this.plugin, nameInput.getValue(), mapWithTagToggler.getValue());
      this.close();
    });
  }
};

// src/options/OptionsList.ts
function isMenu2(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand2(location) {
  return location === "InsertFieldCommand";
}
function isSuggest2(location) {
  return location.getItems !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, location, includedFields) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.includedFields = includedFields;
    this.fieldsFromIndex = {};
    this.file = file;
    this.location = location;
    this.attributes = {};
    this.includedFields = includedFields ? [this.plugin.settings.fileClassAlias, ...includedFields] : [this.plugin.settings.fileClassAlias];
    this.getFieldsFromIndex();
    this.getFieldsValues();
  }
  getFieldsValues() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      try {
        genuineKeys(dvFile).forEach((key) => this.addAttribute(key, dvFile[key]));
      } catch (error) {
        throw error;
      }
    }
  }
  addAttribute(key, value) {
    const includedFields = this.includedFields.filter((f) => f !== this.plugin.settings.fileClassAlias);
    if (includedFields.length > 0) {
      if (this.includedFields.includes(key) && !this.plugin.settings.globallyIgnoredFields.includes(key)) {
        this.attributes[key] = value;
      }
    } else if (!this.plugin.settings.globallyIgnoredFields.includes(key)) {
      this.attributes[key] = value;
    }
  }
  getFieldsFromIndex() {
    const index = this.plugin.fieldIndex;
    const fields = index.filesFields.get(this.file.path);
    fields == null ? void 0 : fields.forEach((field) => this.fieldsFromIndex[field.name] = field);
  }
  createAndOpenFieldModal(fieldName) {
    const field = this.fieldsFromIndex[fieldName];
    if (field) {
      const fieldManager = new FieldManager[field.type](this.plugin, field);
      fieldManager.createAndOpenFieldModal(this.file, field.name, this.attributes[field.name]);
    } else {
      const defaultField = new Field_default(fieldName);
      defaultField.type = "Input" /* Input */;
      if (fieldName === this.plugin.settings.fileClassAlias) {
        this.buildFileClassFieldOptions(defaultField, this.attributes[fieldName]);
      } else if (this.location === "ManageAtCursorCommand") {
        const fieldManager = new Managers_default.Input(this.plugin, defaultField);
        fieldManager.createAndOpenFieldModal(this.file, fieldName, this.attributes[fieldName]);
      }
    }
  }
  createExtraOptionList(openAfterCreate = true) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const location = this.location;
    if (isMenu2(location)) {
      location.addSeparator();
    }
    ;
    if (isInsertFieldCommand2(location)) {
      this.addFieldAtCurrentPositionOption();
    } else if (isSuggest2(location)) {
      this.buildFieldOptions();
      this.addFieldAtCurrentPositionOption();
      this.addSectionSelectModalOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (dvApi) {
        const currentFieldsNames = genuineKeys(dvApi.page(this.file.path));
        if (![...this.plugin.fieldIndex.filesFields.get(this.file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          this.addAllMissingFieldsAtSection();
        }
      }
      const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
      fileClasses.forEach((fileClass) => {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
        const optionsList = new FileClassOptionsList(this.plugin, fileClass.getClassFile(), fieldCommandSuggestModal, this.file);
        optionsList.createExtraOptionList(false);
        location.options.push({
          id: "manage_fileClass_attributes",
          actionLabel: `<span>Manage <b>${fileClass.name}</b> fileClass fields</span>`,
          action: () => {
            fieldCommandSuggestModal.open();
          },
          icon: "wrench"
        });
      });
      this.addFileClassToFileOption();
      this.addNewFileClassOption();
      if (openAfterCreate)
        location.open();
    } else if (isMenu2(location)) {
      this.buildFieldOptions();
      this.addSectionSelectModalOption();
      this.addFieldAtCurrentPositionOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (dvApi) {
        const currentFieldsNames = genuineKeys(dvApi.page(this.file.path));
        if (![...this.plugin.fieldIndex.filesFields.get(this.file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          this.addAllMissingFieldsAtSection();
        }
      }
      const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
      fileClasses.forEach((fileClass) => {
        const fileClassOptionsList = new FileClassOptionsList(this.plugin, fileClass.getClassFile(), location, this.file);
        fileClassOptionsList.createExtraOptionList(false);
      });
      this.addFileClassToFileOption();
      this.addNewFileClassOption();
    }
  }
  buildFileClassFieldOptions(field, value) {
    const modal = new InputModal(this.plugin, this.file, field, value);
    modal.titleEl.setText(`Change Value for <${field.name}>`);
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setTitle(`Update ${field.name}`);
        item.setIcon("wrench");
        item.onClick(() => modal.open());
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: `update_${field.name}`,
        actionLabel: `<span>Update <b>${field.name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Input" /* Input */]
      });
    }
    ;
  }
  buildFieldOptions() {
    Object.keys(this.attributes).forEach((key) => {
      const value = this.attributes[key];
      const field = this.fieldsFromIndex[key];
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.addFieldOption(key, value, this.file, this.location);
      } else if (key !== "file" && (isSuggest2(this.location) || isMenu2(this.location))) {
        const defaultField = new Field_default(key);
        defaultField.type = "Input" /* Input */;
        if (key === this.plugin.settings.fileClassAlias) {
          this.buildFileClassFieldOptions(defaultField, value);
        } else {
          const fieldManager = new Managers_default.Input(this.plugin, defaultField);
          fieldManager.addFieldOption(key, value || "", this.file, this.location);
        }
      }
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, after, asList, asComment));
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("enter");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_field_at_section",
        actionLabel: "Add field at section...",
        action: () => modal.open(),
        icon: "enter"
      });
    }
    ;
  }
  addAllMissingFieldsAtSection() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment));
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("battery-full");
          item.setTitle("Add missing fields at section...");
          item.onClick((evt) => {
            modal.open();
          });
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_missing_fields_at_section",
          actionLabel: "Add missing fields at section...",
          action: () => modal.open(),
          icon: "battery-full"
        });
      }
      ;
    }
  }
  addFieldAtTheEndOfFrontmatterOption() {
    var _a;
    if ((_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter) {
      const lineNumber = this.plugin.app.metadataCache.getCache(this.file.path).frontmatter.position.end.line - 1;
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field in frontmatter");
          item.onClick((evt) => __async(this, null, function* () {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber + 1, true, false, false, false);
          }));
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_in_frontmatter",
          actionLabel: "Add a field in frontmatter...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber + 1, true, false, false, false),
          icon: "pin"
        });
      }
    }
  }
  addFieldAtCurrentPositionOption() {
    var _a;
    const currentView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
    const lineNumber = currentView == null ? void 0 : currentView.editor.getCursor().line;
    if (lineNumber !== void 0 && this.file.path == (currentView == null ? void 0 : currentView.file.path)) {
      let inFrontmatter = false;
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter;
      if (frontmatter) {
        const { position: { start: start2, end: end2 } } = frontmatter;
        if (lineNumber >= start2.line && lineNumber < end2.line)
          inFrontmatter = true;
      }
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field at cursor");
          item.onClick((evt) => {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, false, false);
          });
          item.setSection("metadata-menu");
        });
      } else if (isInsertFieldCommand2(this.location)) {
        FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, false, false);
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_at_cursor",
          actionLabel: "Add field at cursor...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, false, false),
          icon: "pin"
        });
      }
      ;
    }
  }
  addFileClassToFileOption() {
    const modal = new AddFileClassToFileModal(this.plugin, this.file);
    const action = () => modal.open();
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("plus-square");
        item.setTitle(`Add ${this.plugin.settings.fileClassAlias} to ${this.file.basename}`);
        item.onClick(action);
        item.setSection("metadata-menu-fileclass");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_fileclass_to_file",
        actionLabel: `Add ${this.plugin.settings.fileClassAlias} to ${this.file.basename}`,
        action,
        icon: "plus-square"
      });
    }
    ;
  }
  addNewFileClassOption() {
    const modal = new AddNewFileClassModal(this.plugin);
    const action = () => modal.open();
    if (this.plugin.settings.classFilesPath) {
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("file-plus-2");
          item.setTitle(`Add a new ${this.plugin.settings.fileClassAlias}`);
          item.onClick(action);
          item.setSection("metadata-menu-fileclass");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_new_fileclass",
          actionLabel: `Add a new ${this.plugin.settings.fileClassAlias}`,
          action,
          icon: "file-plus-2"
        });
      }
    }
  }
};

// src/options/linkContextMenu.ts
var linkContextMenu = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.createContextMenu();
  }
  buildOptions(file, menu, includedFields) {
    const classFilesPath = this.plugin.settings.classFilesPath;
    if (file instanceof import_obsidian46.TFile && file.extension === "md") {
      if (!import_obsidian46.Platform.isMobile && (0, import_obsidian46.requireApiVersion)("0.16.0")) {
        if (classFilesPath && file.path.startsWith(classFilesPath)) {
          const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, file.path);
          menu.setSectionSubmenu(`metadata-menu-fileclass.${fileClassName}.fileclass-fields`, { title: "Manage fields", icon: "wrench" });
        } else {
          menu.setSectionSubmenu("metadata-menu.current_field", { title: "Current field", icon: "pencil" });
          menu.setSectionSubmenu("metadata-menu.fields", { title: "Manage fields", icon: "pencil" });
          const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(file.path) || [];
          fileClasses.forEach((fileClass) => {
            menu.setSectionSubmenu(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`, { title: `Manage ${fileClass.name} fields`, icon: "wrench" });
          });
        }
      }
      if (this.plugin.settings.displayFieldsInContextMenu) {
        if (classFilesPath && file.path.startsWith(classFilesPath)) {
          const fileClassOptionsList = new FileClassOptionsList(this.plugin, file, menu);
          fileClassOptionsList.createExtraOptionList();
        } else {
          const optionsList = new OptionsList(this.plugin, file, menu, includedFields);
          optionsList.createExtraOptionList();
        }
        ;
      } else {
        menu.addItem((item) => {
          item.setIcon("list");
          item.setTitle("Field Options");
          item.onClick(() => {
            const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
            const optionsList = new OptionsList(this.plugin, file, fieldCommandSuggestModal);
            optionsList.createExtraOptionList();
          });
        });
      }
    }
    ;
  }
  createContextMenu() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
      this.buildOptions(file, menu);
    }));
    this.plugin.registerEvent(this.plugin.app.workspace.on("editor-menu", (menu, editor, view) => {
      var _a;
      const file = this.plugin.app.workspace.getActiveFile();
      const includedFields = [];
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
      if (frontmatter && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
        const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
        if (attribute)
          includedFields.push(attribute);
      } else {
        getLineFields(editor.getLine(editor.getCursor().line)).forEach((field) => {
          if (editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) {
            includedFields.push(field.attribute);
          }
        });
      }
      if (includedFields.length) {
        this.buildOptions(file, menu, includedFields);
      } else {
        this.buildOptions(file, menu);
      }
    }));
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  fileClassQueries: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: null,
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass",
  settingsVersion: void 0,
  globalFileClass: void 0,
  firstDayOfWeek: 1,
  enableLinks: true,
  enableTabHeader: true,
  enableEditor: true,
  enableBacklinks: true,
  enableStarred: true,
  enableFileExplorer: true,
  enableSearch: true,
  buttonIcon: "clipboard-list"
};

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian50 = require("obsidian");

// src/suggester/FolderSuggester.ts
var import_obsidian47 = require("obsidian");
var FolderSuggest = class extends TextInputSuggest {
  constructor(plugin, inputEl) {
    super(inputEl);
    this.plugin = plugin;
    this.inputEl = inputEl;
  }
  getSuggestions(inputStr) {
    const abstractFiles = this.plugin.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian47.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/settings/FileClassQuerySettingModal.ts
var import_obsidian49 = require("obsidian");

// src/settings/FileClassQuerySetting.ts
var import_obsidian48 = require("obsidian");
var FileClassQuerySetting = class extends import_obsidian48.Setting {
  constructor(containerEl, property, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.plugin = plugin;
    this.fileClassQuery = property;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
    this.addMoveUpButton();
  }
  setTextContentWithname() {
    this.infoEl.textContent = "";
    this.infoEl.addClass("metadata-menu-setting-item");
    const fileClassQueryContainer = this.infoEl.createDiv();
    const nameContainer = fileClassQueryContainer.createEl("div", "metadata-menu-setting-item-name");
    nameContainer.innerHTML = `<strong>${this.fileClassQuery.name}</strong>`;
    const fileClassNameContainer = fileClassQueryContainer.createEl("div");
    fileClassNameContainer.innerHTML = `<span>FileClass</span> : ${this.fileClassQuery.fileClassName}`;
    const queryContainer = fileClassQueryContainer.createEl("div");
    queryContainer.innerHTML = `<span>Query</span> : ${this.fileClassQuery.query}`;
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FileClassQuerySettingsModal(this.plugin, this.containerEl, this, this.fileClassQuery);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.find((p) => p.id == this.fileClassQuery.id);
        if (currentExistingFileClassQuery) {
          this.plugin.initialFileClassQueries.remove(currentExistingFileClassQuery);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  addMoveUpButton() {
    this.addButton((b) => {
      b.setIcon("up-chevron-glyph").setTooltip("Move up (lower priority)").onClick(() => {
        const currentFileClassQueryIndex = this.plugin.initialFileClassQueries.map((fcq) => fcq.id).indexOf(this.fileClassQuery.id);
        if (currentFileClassQueryIndex > 0) {
          this.containerEl.insertBefore(this.settingEl, this.settingEl.previousElementSibling);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex, 1);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex - 1, 0, this.fileClassQuery);
          this.plugin.saveSettings();
        }
      });
    });
  }
};

// src/settings/FileClassQuerySettingModal.ts
var FileClassQuerySettingsModal = class extends import_obsidian49.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, fileClassQuery) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialFileClassQuery = new FileClassQuery_default();
    if (fileClassQuery) {
      this.new = false;
      this.fileClassQuery = fileClassQuery;
      FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
    } else {
      let newId = 1;
      this.plugin.initialFileClassQueries.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.fileClassQuery = new FileClassQuery_default();
      this.fileClassQuery.id = newId.toString();
      this.initialFileClassQuery.id = newId.toString();
    }
    ;
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.fileClassQuery.name == "") {
        this.titleEl.setText(`Select a fileClass and add an applicable query`);
      } else {
        this.titleEl.setText(`Manage ${this.fileClassQuery.name} settings`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.fileClassQuery, this.initialFileClassQuery);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FileClassQuerySetting(this.parentSettingContainer, this.fileClassQuery, this.plugin);
    }
    ;
  }
  createnameInputContainer(parentNode) {
    const fileClassQueryNameContainerLabel = parentNode.createDiv();
    fileClassQueryNameContainerLabel.setText(`FileClass Query Name:`);
    const input = new import_obsidian49.TextComponent(parentNode);
    const name = this.fileClassQuery.name;
    input.setValue(name);
    input.setPlaceholder("Name of this fileClass query");
    input.onChange((value) => {
      this.fileClassQuery.name = value;
      this.titleEl.setText(`Manage options for ${this.fileClassQuery.name}`);
    });
    return input;
  }
  createFileClassSelectorContainer(parentNode) {
    const FileClassSelectorContainerLabel = parentNode.createDiv();
    FileClassSelectorContainerLabel.setText(`Fileclass:`);
    const select = new import_obsidian49.DropdownComponent(parentNode);
    const classFilesPath = this.plugin.settings.classFilesPath;
    const fileClasses = this.plugin.app.vault.getFiles().filter((f) => classFilesPath && f.path.startsWith(classFilesPath));
    select.addOption("--Select a fileClass--", "--Select a fileClass--");
    fileClasses.forEach((fileClass) => {
      const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, fileClass.path);
      if (fileClassName)
        select.addOption(fileClassName, fileClassName);
    });
    if (this.fileClassQuery.fileClassName) {
      select.setValue(this.fileClassQuery.fileClassName);
    }
    select.onChange((value) => {
      if (value != "--Select a fileClass--") {
        this.fileClassQuery.fileClassName = value;
      } else {
        this.fileClassQuery.fileClassName = "";
      }
    });
  }
  createQueryInputContainer(parentNode) {
    const queryContainerLabel = parentNode.createDiv();
    queryContainerLabel.setText("dataviewJS query:");
    const queryStringInput = new import_obsidian49.TextAreaComponent(parentNode);
    queryStringInput.setValue(this.fileClassQuery.query);
    queryStringInput.onChange((value) => this.fileClassQuery.query = value);
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({ cls: "metadata-menu-prompt-div" });
      const mainDiv = div.createDiv({ cls: "metadata-menu-prompt-form" });
      const nameContainer = mainDiv.createDiv();
      this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const fileClassSelectContainer = mainDiv.createDiv();
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian49.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
      this.createFileClassSelectorContainer(fileClassSelectContainer);
      const fileClassQueryContainer = mainDiv.createDiv();
      this.createQueryInputContainer(fileClassQueryContainer);
    });
  }
  createSaveButton(b) {
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      if (this.fileClassQuery.fileClassName && this.fileClassQuery.name && this.fileClassQuery.query) {
        this.saved = true;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.filter((p) => p.id == this.fileClassQuery.id)[0];
        if (currentExistingFileClassQuery) {
          FileClassQuery_default.copyProperty(currentExistingFileClassQuery, this.fileClassQuery);
        } else {
          this.plugin.initialFileClassQueries.push(this.fileClassQuery);
        }
        ;
        FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
        if (this.parentSetting)
          FileClassQuery_default.copyProperty(this.parentSetting.fileClassQuery, this.fileClassQuery);
        (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
        this.plugin.saveSettings();
        this.close();
      }
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialFileClassQuery.name != "") {
        Object.assign(this.fileClassQuery, this.initialFileClassQuery);
      }
      ;
      this.close();
    });
    return b;
  }
};

// src/settings/MetadataMenuSettingTab.ts
var SettingsMigrationConfirmModal = class extends import_obsidian50.Modal {
  constructor(plugin, tab) {
    super(plugin.app);
    this.plugin = plugin;
    this.tab = tab;
  }
  onOpen() {
    this.titleEl.setText("Confirm");
    const body = this.contentEl.createDiv({
      cls: "modal-text-danger"
    });
    body.setText("This will erase current settings. Are you sure?");
    const confirmButton = new import_obsidian50.ButtonComponent(this.contentEl);
    confirmButton.setIcon("check");
    confirmButton.onClick(() => {
      if (this.plugin.app.plugins.plugins.hasOwnProperty("supercharged-links-obsidian")) {
        let settings = this.plugin.app.plugins.plugins["supercharged-links-obsidian"].settings;
        this.plugin.initialProperties = [];
        settings.presetFields.forEach((prop) => {
          const field = new Field_default();
          Object.assign(field, prop);
          this.plugin.initialProperties.push(field);
        });
        this.plugin.saveSettings();
        this.close();
      }
      ;
    });
  }
  onClose() {
    this.tab.display();
  }
};
var MetadataMenuSettingTab = class extends import_obsidian50.PluginSettingTab {
  constructor(plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = containerEl.createEl("div");
    globalSettings.createEl("h4", { text: "Global settings", cls: "metadata-menu-setting-section-header" });
    globalSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Global settings to apply to your whole vault"
    });
    new import_obsidian50.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian50.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.split(",").map((item) => item.trim());
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    new import_obsidian50.Setting(globalSettings).setName("First day of week").setDesc("For date fields, which day the date picker's week should start with").addDropdown((cb) => {
      for (let i = 0; i < 2; i++) {
        cb.addOption(i.toString(), (0, import_obsidian50.moment)().day(i).format("dddd"));
      }
      cb.setValue(this.plugin.settings.firstDayOfWeek.toString() || "1");
      cb.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.firstDayOfWeek = parseInt(value);
        yield this.plugin.saveSettings();
      }));
    });
    const presetFieldsSettings = containerEl.createEl("div");
    const presetFieldsSettingHeaderContainer = presetFieldsSettings.createEl("div", { cls: "metadata-menu-setting-section-header-container" });
    const presetFieldsSettingHeaderTextContainer = presetFieldsSettingHeaderContainer.createEl("div", { cls: "metadata-menu-setting-section-header-text-container" });
    presetFieldsSettingHeaderTextContainer.createEl("h4", { text: "Preset Fields settings", cls: "metadata-menu-setting-section-header" });
    presetFieldsSettingHeaderTextContainer.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and options for a field throughout your whole vault"
    });
    const presetFieldsSettingsContainerShowButtonContainer = presetFieldsSettingHeaderContainer.createEl("div", { cls: "setting-item-control" });
    const presetFieldsSettingsContainerShowButton = presetFieldsSettingsContainerShowButtonContainer.createEl("button");
    presetFieldsSettingsContainerShowButton.addClass("setting-item-control");
    const presetFieldsSettingsContainer = presetFieldsSettings.createEl("div");
    new import_obsidian50.Setting(presetFieldsSettingsContainer).setName("Add New Field Setting").setDesc("Add a new Frontmatter property for which you want preset options.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.plugin, presetFieldsSettingsContainer);
        modal.open();
      }));
    });
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettingsContainer, property, this.plugin);
    });
    presetFieldsSettingsContainer.isShown() ? (0, import_obsidian50.setIcon)(presetFieldsSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian50.setIcon)(presetFieldsSettingsContainerShowButton, "double-down-arrow-glyph");
    presetFieldsSettingsContainerShowButton.onclick = () => {
      presetFieldsSettingsContainer.isShown() ? presetFieldsSettingsContainer.hide() : presetFieldsSettingsContainer.show();
      presetFieldsSettingsContainer.isShown() ? (0, import_obsidian50.setIcon)(presetFieldsSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian50.setIcon)(presetFieldsSettingsContainerShowButton, "double-down-arrow-glyph");
    };
    const classFilesSettings = containerEl.createEl("div");
    const classFilesSettingsHeaderContainer = classFilesSettings.createEl("div", { cls: "metadata-menu-setting-section-header-container" });
    const classFilesSettingsHeaderTextContainer = classFilesSettingsHeaderContainer.createEl("div", { cls: "metadata-menu-setting-section-header-text-container" });
    classFilesSettingsHeaderTextContainer.createEl("h4", { text: "FileClass settings", cls: "metadata-menu-setting-section-header" });
    classFilesSettingsHeaderTextContainer.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage fileClass folder and alias. When a note has a fileClass defined, fileClass field properties will override global preset fields settings for the same field name"
    });
    const classFilesSettingsContainerShowButtonContainer = classFilesSettingsHeaderContainer.createEl("div", { cls: "setting-item-control" });
    const classFilesSettingsContainerShowButton = classFilesSettingsContainerShowButtonContainer.createEl("button");
    classFilesSettingsContainerShowButton.addClass("setting-item-control");
    const classFilesSettingsContainer = classFilesSettings.createEl("div");
    new import_obsidian50.Setting(classFilesSettingsContainer).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addSearch((cfs) => {
      new FolderSuggest(this.plugin, cfs.inputEl);
      cfs.setPlaceholder("Folder").setValue(this.plugin.settings.classFilesPath || "").onChange((new_folder) => {
        const newPath = new_folder.endsWith("/") || !new_folder ? new_folder : new_folder + "/";
        this.plugin.settings.classFilesPath = newPath || null;
        this.plugin.saveSettings();
      });
      cfs.containerEl.addClass("metadata-menu-setting-fileClass-search");
    });
    new import_obsidian50.Setting(classFilesSettingsContainer).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value || "fileClass";
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian50.Setting(classFilesSettingsContainer).setName("global fileClass").setDesc("Choose one fileClass to be applicable to all files (even it is not present as a fileClass attribute in their frontmatter). This will override the preset Fields defined above").addSearch((cfs) => {
      new FileSuggest(cfs.inputEl, this.plugin, this.plugin.settings.classFilesPath || "");
      cfs.setPlaceholder("Global fileClass");
      cfs.setValue(this.plugin.settings.globalFileClass ? this.plugin.settings.classFilesPath + this.plugin.settings.globalFileClass + ".md" : "").onChange((newPath) => {
        var _a;
        this.plugin.settings.globalFileClass = newPath ? (_a = newPath.split("\\").pop().split("/").pop()) == null ? void 0 : _a.replace(".md", "") : "";
        this.plugin.saveSettings();
      });
      cfs.containerEl.addClass("metadata-menu-setting-fileClass-search");
    });
    const metadataMenuBtnSettings = classFilesSettingsContainer.createEl("div");
    metadataMenuBtnSettings.createEl("h4", { text: "Show extra button to access metadata menu form:", cls: "metadata-menu-setting-section-header" });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Metadata Menu button icon").setDesc("name of the default icon when not defined in fileClass").addText((text) => {
      text.setValue(this.plugin.settings.buttonIcon).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.buttonIcon = value || "clipboard-list";
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Reading mode links").setDesc("Display an extra button to access metadata menu form after a link in reading mode").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableLinks);
      cb.onChange((value) => {
        this.plugin.settings.enableLinks = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Live preview mode").setDesc("Display an extra button to access metadata menu form after a link in live preview").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableEditor);
      cb.onChange((value) => {
        this.plugin.settings.enableEditor = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Tab header").setDesc("Display an extra button to access metadata menu form in the tab header").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableTabHeader);
      cb.onChange((value) => {
        this.plugin.settings.enableTabHeader = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Backlinks").setDesc("Display an extra button to access metadata menu form in the backlinks panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableBacklinks);
      cb.onChange((value) => {
        this.plugin.settings.enableBacklinks = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Search").setDesc("Display an extra button to access metadata menu form in the search panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableSearch);
      cb.onChange((value) => {
        this.plugin.settings.enableSearch = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("File explorer").setDesc("Display an extra button to access metadata menu form in the file explorer").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableFileExplorer);
      cb.onChange((value) => {
        this.plugin.settings.enableFileExplorer = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian50.Setting(metadataMenuBtnSettings).setName("Starred").setDesc("Display an extra button to access metadata menu form in the starred panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableStarred);
      cb.onChange((value) => {
        this.plugin.settings.enableStarred = value;
        this.plugin.saveSettings();
      });
    });
    const queryFileClassSettings = classFilesSettingsContainer.createEl("div");
    queryFileClassSettings.createEl("h4", { text: "Query based FileClass settings", cls: "metadata-menu-setting-section-header" });
    queryFileClassSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and options for a field matching this query"
    });
    new import_obsidian50.Setting(queryFileClassSettings).setName("Add New Query for fileClass").setDesc("Add a new query and a FileClass that will apply to files matching this query.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FileClassQuerySettingsModal(this.plugin, queryFileClassSettings);
        modal.open();
      }));
    });
    this.plugin.initialFileClassQueries.forEach((query) => {
      const fileClassQuery = new FileClassQuery_default();
      Object.assign(fileClassQuery, query);
      new FileClassQuerySetting(queryFileClassSettings, fileClassQuery, this.plugin);
    });
    classFilesSettingsContainer.isShown() ? (0, import_obsidian50.setIcon)(classFilesSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian50.setIcon)(classFilesSettingsContainerShowButton, "double-down-arrow-glyph");
    classFilesSettingsContainerShowButton.onclick = () => {
      classFilesSettingsContainer.isShown() ? classFilesSettingsContainer.hide() : classFilesSettingsContainer.show();
      classFilesSettingsContainer.isShown() ? (0, import_obsidian50.setIcon)(classFilesSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian50.setIcon)(classFilesSettingsContainerShowButton, "double-down-arrow-glyph");
    };
    const migrateSettings = containerEl.createEl("div");
    migrateSettings.createEl("h4", { text: "Migrate" });
    new import_obsidian50.Setting(migrateSettings).setName("Copy settings from supercharged links plugin").setDesc("Copy settings from supercharged links plugin").addButton((button) => {
      return button.setTooltip("Get settings from supercharged links").setButtonText("Copy").onClick(() => __async(this, null, function* () {
        let modal = new SettingsMigrationConfirmModal(this.plugin, this);
        modal.open();
      }));
    });
  }
};

// src/settings/migrateSetting.ts
var migrateSettingsV1toV2 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (!Object.keys(p).contains("type")) {
      if (p.isMulti)
        p.type = "Multi" /* Multi */;
      else if (p.isCycle)
        p.type = "Cycle" /* Cycle */;
      else if (p.isBoolean)
        p.type = "Boolean" /* Boolean */;
      else if (p.options && Object.keys(p.options).length > 0)
        p.type = "Select" /* Select */;
      else
        p.type = "Input" /* Input */;
    }
    delete p.isMulti;
    delete p.isCycle;
    delete p.isBoolean;
    if (Object.getOwnPropertyDescriptor(p, "values") !== void 0) {
      Object.defineProperty(p, "options", Object.getOwnPropertyDescriptor(p, "values"));
      delete p["values"];
    }
  });
  plugin.settings.settingsVersion = 2;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 2");
});
var migrateSettingsV2toV3 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (["Select" /* Select */, "Multi" /* Multi */].includes(p.type)) {
      const currentOptionKeys = Object.keys(p.options);
      p.options.valuesList = {};
      currentOptionKeys.forEach((key) => p.options.valuesList[key] = p.options[key]);
      if (p.valuesListNotePath) {
        const selectType = "ValuesListNotePath" /* ValuesListNotePath */;
        p.options.sourceType = selectType;
        p.options[Key[selectType]];
      } else {
        p.options.sourceType = "ValuesList" /* ValuesList */;
      }
      p.options.valuesListNotePath = p.valuesListNotePath;
      currentOptionKeys.forEach((key) => delete p.options[key]);
      p.options.valuesFromDVQuery = "";
    }
    delete p.valuesListNotePath;
  });
  plugin.settings.settingsVersion = 3;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 3");
});

// src/suggester/metadataSuggester.ts
var import_obsidian51 = require("obsidian");
var ValueSuggest = class extends import_obsidian51.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.inFrontmatter = false;
    this.inFullLine = false;
    this.inSentence = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(encodeLink(option))) && (!lastValue || !!lastValue && encodeLink(option).includes(lastValue));
    };
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "put a space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  onTrigger(cursor, editor, file) {
    var _a;
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const fullLine = editor.getLine(editor.getCursor().line);
    this.inFrontmatter = !!frontmatter && frontmatter.position.start.line < cursor.line && cursor.line < frontmatter.position.end.line;
    if (this.inFrontmatter) {
      const regex = new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u");
      if (!regex.test(fullLine))
        return null;
    } else if (getLineFields(fullLine).length === 0) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getAlias(tFile) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let alias = void 0;
    if (dvApi && ((_b = this.field) == null ? void 0 : _b.options.customRendering)) {
      alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(tFile.path));
    }
    return alias;
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a, _b, _c, _d, _e;
      const lineNumber = context.start.line;
      const matchField = { attribute: void 0, values: "" };
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (!this.inFrontmatter) {
        const lineFields = getLineFields(encodeLink(context.editor.getLine(lineNumber)));
        const position = context.editor.getCursor().ch;
        const activeLineField = lineFields.find((lineField) => lineField.index <= position && lineField.index + lineField.length >= position);
        if (activeLineField) {
          this.inSentence = activeLineField.index > 0;
          this.inFullLine = activeLineField.index === 0;
          matchField.attribute = activeLineField.attribute;
          matchField.values = activeLineField.values;
        }
      } else {
        const regex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
        const regexResult = context.editor.getRange({ line: lineNumber, ch: 0 }, context.end).match(regex);
        if (regexResult == null ? void 0 : regexResult.groups) {
          matchField.attribute = regexResult.groups.attribute;
          matchField.values = regexResult.groups.values;
        }
      }
      ;
      if (matchField.attribute) {
        const fieldName = matchField.attribute;
        this.field = (_b = this.plugin.fieldIndex.filesFields.get(context.file.path)) == null ? void 0 : _b.find((f) => f.name === fieldName);
        const valuesList = (_c = matchField.values) == null ? void 0 : _c.replace(/^\[|^\s\[|^\(|^\s\(/, "").replace(/\]$|\)$/, "").split(",").map((o) => encodeLink(o.trim()));
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.plugin.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ value: tag.replace(/^#/, "") }));
        }
        if (this.field && ["Cycle" /* Cycle */, "Multi" /* Multi */, "Select" /* Select */].contains(this.field.type)) {
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          return fieldManager.getOptionsList(dvApi.page((_d = this.context) == null ? void 0 : _d.file.path)).filter((option) => this.filterOption(firstValues, lastValue, option)).map((_value) => Object({ value: _value }));
        } else if (this.field && ["File" /* File */, "MultiFile" /* MultiFile */].includes(this.field.type)) {
          const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
            return a.basename < b.basename ? -1 : 1;
          };
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          const files = fieldManager.getFiles((_e = this.context) == null ? void 0 : _e.file).sort(sortingMethod);
          if (lastValue) {
            return files.filter((f) => {
              var _a2;
              return f.basename.toLowerCase().includes(lastValue) || ((_a2 = this.getAlias(f)) == null ? void 0 : _a2.toLowerCase().includes(lastValue));
            }).map((f) => {
              return Object({ value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, this.getAlias(f)) });
            });
          } else {
            return files.map((f) => {
              var _a2;
              let alias = void 0;
              if (dvApi && ((_a2 = this.field) == null ? void 0 : _a2.options.customRendering)) {
                alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(f.path));
              }
              return Object({ value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, alias) });
            });
          }
        } else {
          return [];
        }
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    var _a;
    const [rawValue, alias] = suggestion.value.replace(/^\[\[/, "").replace(/\]\]$/, "").split("|");
    const targetFile = this.plugin.app.metadataCache.getFirstLinkpathDest(rawValue, this.context.file.path);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field && this.field.options.customRendering && targetFile) {
      if (alias) {
        const suggestionContainer = el.createDiv({ cls: "metadata-menu-suggester-item-with-alias" });
        const label = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-label" });
        label.setText(alias);
        const filePath = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-filepath" });
        filePath.setText(rawValue);
      } else {
        el.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(targetFile.path)));
      }
    } else {
      el.setText(rawValue);
    }
  }
  selectSuggestion(suggestion, event) {
    var _a;
    const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian51.MarkdownView);
    if (!activeView) {
      return;
    }
    ;
    const editor = activeView.editor;
    const activeLine = editor.getLine(this.context.start.line);
    if (this.inFrontmatter) {
      try {
        let parsedField = (0, import_obsidian51.parseYaml)(activeLine);
        let [attr, pastValues] = Object.entries(parsedField)[0];
        let newField;
        if (!pastValues) {
          newField = attr + ": " + suggestion.value;
        } else if (typeof pastValues == "string") {
          if (!pastValues.contains(",")) {
            newField = attr + ": " + suggestion.value;
          } else {
            newField = attr + ": [" + pastValues.split(",").map((o) => o.trim()).slice(0, -1).join(", ") + ", " + suggestion.value + "]";
          }
        } else if (Array.isArray(pastValues)) {
          if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
            newField = attr + ": [" + [...pastValues, suggestion.value].join(", ") + "]";
          } else {
            newField = attr + ": [" + [...pastValues.slice(0, -1), suggestion.value].join(", ") + "]";
          }
        } else {
          newField = attr + ": [" + [...pastValues].join(", ") + "]";
        }
        editor.replaceRange(newField, { line: this.context.start.line, ch: 0 }, { line: this.context.start.line, ch: activeLine.length });
        if (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(",")) {
          editor.setCursor({ line: this.context.start.line, ch: newField.length - 1 });
        } else {
          editor.setCursor({ line: this.context.start.line, ch: newField.length });
        }
      } catch (error) {
        new import_obsidian51.Notice("Frontmatter wrongly formatted", 2e3);
        this.close();
        return;
      }
    } else if (this.inFullLine) {
      let cleanedLine = activeLine;
      while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
        cleanedLine = cleanedLine.slice(0, -1);
      }
      editor.replaceRange(`${cleanedLine}${event.shiftKey ? " " : ""}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
    } else if (this.inSentence) {
      const position = ((_a = this.context) == null ? void 0 : _a.editor.getCursor().ch) || 0;
      let beforeCursor = activeLine.slice(0, position);
      let afterCursor = activeLine.slice(position);
      let separatorPos = position;
      let currentValueLength = 0;
      while (!beforeCursor.endsWith("::") && !beforeCursor.endsWith(",") && beforeCursor.length) {
        separatorPos = separatorPos - 1;
        currentValueLength = currentValueLength + 1;
        beforeCursor = beforeCursor.slice(0, -1);
      }
      let nextBracketPos = position;
      while (!encodeLink(afterCursor).match("(\\]|\\)).*") && afterCursor.length) {
        nextBracketPos = nextBracketPos + 1;
        afterCursor = afterCursor.slice(nextBracketPos - position);
      }
      editor.replaceRange(suggestion.value, { line: this.context.start.line, ch: separatorPos }, { line: this.context.start.line, ch: nextBracketPos });
      editor.setCursor({ line: this.context.start.line, ch: nextBracketPos - currentValueLength + suggestion.value.length });
    }
    this.didSelect = true;
    this.close();
  }
};

// src/components/FileTaskManager.ts
var import_obsidian52 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset2 = 0) {
  return (byteToHex[arr[offset2 + 0]] + byteToHex[arr[offset2 + 1]] + byteToHex[arr[offset2 + 2]] + byteToHex[arr[offset2 + 3]] + "-" + byteToHex[arr[offset2 + 4]] + byteToHex[arr[offset2 + 5]] + "-" + byteToHex[arr[offset2 + 6]] + byteToHex[arr[offset2 + 7]] + "-" + byteToHex[arr[offset2 + 8]] + byteToHex[arr[offset2 + 9]] + "-" + byteToHex[arr[offset2 + 10]] + byteToHex[arr[offset2 + 11]] + byteToHex[arr[offset2 + 12]] + byteToHex[arr[offset2 + 13]] + byteToHex[arr[offset2 + 14]] + byteToHex[arr[offset2 + 15]]).toLowerCase();
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset2) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset2 = offset2 || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset2 + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// src/components/FileTaskManager.ts
var Task = class {
  constructor(fn2) {
    this.fn = fn2;
    this.status = "pending";
    this.id = v4_default();
  }
};
var FileTaskManager = class extends import_obsidian52.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.busy = false;
    this.queue = /* @__PURE__ */ new Map();
  }
  onload() {
    return __async(this, null, function* () {
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        this.busy = false;
        yield this.executeNext();
      })));
    });
  }
  pushTask(fn2) {
    return __async(this, null, function* () {
      const task = new Task(fn2);
      this.queue.set(task.id, task);
      if (!this.busy)
        yield this.executeNext();
    });
  }
  executeNext() {
    return __async(this, null, function* () {
      const [firstTaskInQueueId, firstTaskInQueue] = [...this.queue][0] || [void 0, void 0];
      if (firstTaskInQueue && !this.plugin.app.metadataCache.inProgressTaskCount) {
        this.busy = true;
        firstTaskInQueue.status = "ongoing";
        yield firstTaskInQueue.fn();
        firstTaskInQueue.status = "done";
        this.queue.delete(firstTaskInQueueId);
      } else if (this.plugin.app.metadataCache.inProgressTaskCount) {
      } else {
      }
    });
  }
};

// src/options/linkAttributes.ts
var import_obsidian54 = require("obsidian");

// src/components/NoteFields.ts
var import_obsidian53 = require("obsidian");
var FieldOptions = class {
  constructor(container) {
    this.container = container;
  }
  addOption(icon, onclick, tooltip, className) {
    const fieldOptionContainer = this.container.createDiv({ cls: "metadata-menu-note-field-item field-option" });
    const fieldOption = new import_obsidian53.ButtonComponent(fieldOptionContainer);
    fieldOption.setIcon(icon);
    if (className)
      fieldOption.buttonEl.addClass(className);
    fieldOption.onClick(() => onclick());
    if (tooltip)
      fieldOption.setTooltip(tooltip);
  }
};
var FieldsModal = class extends import_obsidian53.Modal {
  constructor(plugin, file) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.fieldContainers = [];
    this.maxOptions = 0;
    this.missingFields = false;
    this.dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.getFields();
    this.containerEl.addClass("metadata-menu-note-fields-modal");
  }
  onOpen() {
    this.titleEl.setText(`Fields of ${this.file.basename}.${this.file.extension}`);
    this.buildFieldsContainer();
  }
  getFields() {
    this.fields = this.plugin.fieldIndex.filesFields.get(this.file.path) || [];
  }
  buildFieldContainer(parentContainer, field, value) {
    const fieldManager = new FieldManager[field.type](this.plugin, field);
    const fieldContainer = parentContainer.createDiv({ cls: "metadata-menu-note-field-container" });
    const fieldNameContainer = fieldContainer.createDiv({ text: `${field.name}`, cls: "metadata-menu-note-field-item field-name" });
    const fileClass = field.fileClassName ? this.plugin.fieldIndex.fileClassesName.get(field.fileClassName) : void 0;
    if (fileClass) {
      fieldNameContainer.addClass(`fileClassField__${fileClass.name.replace("/", "___")}`);
    }
    const fieldSettingContainer = fieldContainer.createDiv({ cls: "metadata-menu-note-field-item field-setting" });
    const fieldSettingBtn = new import_obsidian53.ButtonComponent(fieldSettingContainer);
    fieldSettingBtn.setIcon("gear");
    fieldSettingBtn.setTooltip(`${field.fileClassName ? field.fileClassName + " > " : "Preset Field > "} ${field.name} settings`);
    fieldSettingBtn.onClick(() => {
      const _fileClass = field.fileClassName ? this.plugin.fieldIndex.fileClassesName.get(field.fileClassName) : void 0;
      const fileClassAttribute = _fileClass == null ? void 0 : _fileClass.attributes.find((attr) => attr.name === field.name);
      if (fileClassAttribute && _fileClass) {
        const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, _fileClass, fileClassAttribute);
        fileClassAttributeModal.open();
      }
    });
    const fieldTypeContainer = fieldContainer.createDiv({ cls: `metadata-menu-note-field-item field-type-container` });
    fieldTypeContainer.createDiv({ text: field.type, cls: `field-type ${FieldBackgroundColorClass[field.type]}` });
    const fieldValueContainer = fieldContainer.createDiv({
      cls: value !== void 0 && value !== null ? "metadata-menu-note-field-item field-value" : "metadata-menu-note-field-item field-value emptyfield"
    });
    if (value === null) {
      fieldValueContainer.setText(field.type === "Lookup" /* Lookup */ ? "---auto---" : "<empty>");
    } else if (value === void 0) {
      this.missingFields = true;
      fieldValueContainer.setText("<missing>");
    } else {
      fieldManager.displayValue(fieldValueContainer, this.file, field.name, () => {
        this.close();
      });
    }
    const fieldOptions = new FieldOptions(fieldContainer);
    if (value !== void 0) {
      fieldManager.addFieldOption(field.name, value, this.file, fieldOptions);
    } else {
      const fieldBtnContainer = fieldContainer.createDiv({ cls: "metadata-menu-note-field-item field-option" });
      const fieldBtn = new import_obsidian53.ButtonComponent(fieldBtnContainer);
      fieldBtn.setIcon("list-plus");
      fieldBtn.setTooltip("Add field at section");
      fieldBtn.onClick(() => {
        new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(this.plugin, this.file, field.name, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
      });
    }
    ;
    const optionsCount = fieldContainer.querySelectorAll(".field-option").length;
    if (this.maxOptions < optionsCount)
      this.maxOptions = optionsCount;
    return fieldContainer;
  }
  openInsertMissingFieldsForFileClassModal(fileClass) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      if (dvFile) {
        const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment, fileClass.name));
        modal.open();
      }
    }
  }
  missingFieldsForFileClass(fileClass) {
    var _a, _b;
    const currentFieldsNames = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      if (dvFile) {
        currentFieldsNames.push(...genuineKeys(dvFile));
      }
    }
    ;
    const missingFields = fileClass && this.file ? !((_b = this.plugin.fieldIndex.fileClassesFields.get(fileClass.name)) == null ? void 0 : _b.map((f) => f.name).every((fieldName) => currentFieldsNames.includes(fieldName))) : false;
    return missingFields;
  }
  buildFileClassManager(container) {
    const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
    fileClasses.forEach((fileClass) => {
      const fileClassManagerContainer = container.createDiv({ cls: "metadata-menu-note-fields-inheritance-manager-container" });
      const _ancestors = this.plugin.fieldIndex.fileClassesAncestors.get(fileClass.name) || [];
      const ancestors = [..._ancestors].reverse();
      ancestors.push(fileClass.name);
      ancestors.forEach((fileClassName, i) => {
        const _fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        if (_fileClass) {
          const fileClassOptionsContainer = fileClassManagerContainer.createDiv({ cls: "metadata-menu-note-fields-fileClass-manager-container" });
          const fileClassNameContainer = fileClassOptionsContainer.createDiv({ cls: "metadata-menu-note-fields-fileClass-manager-name", text: _fileClass.name });
          fileClassNameContainer.setAttr("id", `fileClass__${_fileClass.name.replace("/", "___")}`);
          if (this.missingFieldsForFileClass(_fileClass)) {
            const fileClassInsertMissingFieldsBtn = new import_obsidian53.ButtonComponent(fileClassOptionsContainer);
            fileClassInsertMissingFieldsBtn.setIcon("battery-full");
            fileClassInsertMissingFieldsBtn.setTooltip(`Insert missing fields for ${_fileClass.name}`);
            fileClassInsertMissingFieldsBtn.onClick(() => {
              this.openInsertMissingFieldsForFileClassModal(_fileClass);
            });
          }
          const fileClassAddAttributeBtn = new import_obsidian53.ButtonComponent(fileClassOptionsContainer);
          fileClassAddAttributeBtn.setIcon("plus-circle");
          fileClassAddAttributeBtn.setTooltip(`Add field definition in ${_fileClass.name}`);
          fileClassAddAttributeBtn.onClick(() => {
            const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, _fileClass);
            fileClassAttributeModal.open();
          });
          if (i < ancestors.length - 1) {
            fileClassManagerContainer.createDiv({ text: ">", cls: "metadata-menu-note-fields-fileClass-manager-separator" });
          }
          const fileClassFielsContainers = this.containerEl.querySelectorAll(`[class*="fileClassField__${fileClassName.replace("/", "___")}"]`);
          fileClassFielsContainers.forEach((fieldNameContainer) => {
            fieldNameContainer.onmouseover = () => {
              fileClassNameContainer == null ? void 0 : fileClassNameContainer.addClass("active");
            };
            fieldNameContainer.onmouseout = () => {
              fileClassNameContainer == null ? void 0 : fileClassNameContainer.removeClass("active");
            };
          });
          fileClassNameContainer.onmouseover = () => {
            this.containerEl.querySelectorAll(`.metadata-menu-note-field-item.field-name.fileClassField__${fileClassName.replace("/", "___")}`).forEach((cont) => {
              cont.addClass("active");
            });
          };
          fileClassNameContainer.onmouseout = () => {
            this.containerEl.querySelectorAll(`.metadata-menu-note-field-item.field-name.fileClassField__${fileClassName.replace("/", "___")}`).forEach((cont) => {
              cont.removeClass("active");
            });
          };
        }
      });
    });
  }
  formatOptionsColumns(fieldsContainer) {
    const fieldContainers = fieldsContainer.querySelectorAll(".metadata-menu-note-field-container");
    fieldContainers.forEach((field) => {
      var _a, _b;
      const options = field.querySelectorAll(".field-option");
      if (options.length < this.maxOptions) {
        const parent = (_a = options[0]) == null ? void 0 : _a.parentElement;
        if (parent) {
          for (let i = 0; i < this.maxOptions - options.length; i++) {
            const emptyCell = parent.createDiv({ cls: "metadata-menu-note-field-item field-option" });
            (_b = options[0].parentElement) == null ? void 0 : _b.insertBefore(emptyCell, options[0]);
          }
        }
      }
    });
  }
  buildFieldsContainer() {
    this.missingFields = false;
    this.contentEl.replaceChildren();
    this.contentEl.createEl("hr");
    const fieldsContainer = this.contentEl.createDiv({ cls: "metadata-menu-note-fields-container" });
    this.fields.forEach((field) => {
      const value = this.dvApi ? this.dvApi.page(this.file.path)[field.name] : void 0;
      this.fieldContainers.push(this.buildFieldContainer(fieldsContainer, field, value));
    });
    this.formatOptionsColumns(fieldsContainer);
    if (this.missingFields) {
      const insertMissingFieldsContainer = this.contentEl.createDiv({ cls: "metadata-menu-note-fields-container metadata-menu-note-field-insert-all-fields" });
      insertMissingFieldsContainer.createDiv({ text: "Insert missing fields" });
      const insertMissingFieldsBtn = new import_obsidian53.ButtonComponent(insertMissingFieldsContainer);
      insertMissingFieldsBtn.setIcon("battery-full");
      insertMissingFieldsBtn.onClick(() => {
        var _a;
        const dvFile = (_a = this.dvApi) == null ? void 0 : _a.page(this.file.path);
        if (dvFile) {
          new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment)).open();
        }
      });
    }
    this.contentEl.createEl("hr");
    const fileClassManagersContainer = this.contentEl.createDiv({ cls: "metadata-menu-note-fields-container" });
    this.buildFileClassManager(fileClassManagersContainer);
  }
};
var NoteFieldsComponent = class extends import_obsidian53.Component {
  constructor(plugin, cacheVersion, onChange, file) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.file = file;
    this.fieldsModal = new FieldsModal(this.plugin, file);
    this.fieldsModal.onClose = () => {
      this.plugin.removeChild(this);
      this.unload();
    };
  }
  onload() {
    this.plugin.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", () => {
      this.fieldsModal.getFields();
      this.fieldsModal.buildFieldsContainer();
    }));
    this.fieldsModal.open();
  }
};

// src/options/linkAttributes.ts
function clearExtraAttributes(link) {
  Object.values(link.attributes).forEach((attr) => {
    if (attr.name.includes("fileclass-name")) {
      link.removeAttribute(attr.name);
      const el = link.nextElementSibling;
      if (el == null ? void 0 : el.hasClass("fileclass-icon")) {
        el.remove();
      }
    }
  });
}
function setLinkMetadataFormButton(plugin, link, destName, viewTypeName, fileClassName) {
  var _a;
  switch (viewTypeName) {
    case "a.internal-link":
      if (!plugin.settings.enableLinks)
        return;
      break;
    case "tabHeader":
      if (!plugin.settings.enableTabHeader)
        return;
      break;
    case "starred":
      if (!plugin.settings.enableStarred)
        return;
      break;
    case "file-explorer":
      if (!plugin.settings.enableFileExplorer)
        return;
      break;
    case "backlink":
      if (!plugin.settings.enableBacklinks)
        return;
      break;
    case "search":
      if (!plugin.settings.enableSearch)
        return;
      break;
    default:
      return;
  }
  for (const a of link.attributes) {
    if (a.name.includes("fileclass-name") && a.name !== fileClassName) {
      link.removeAttribute(a.name);
      const el = link.nextElementSibling;
      if (el == null ? void 0 : el.hasClass("fileclass-icon")) {
        el.remove();
      }
    }
  }
  if (fileClassName) {
    const fileClass = plugin.fieldIndex.fileClassesName.get(fileClassName);
    if (fileClass) {
      const icon = fileClass.getIcon();
      link.setAttribute("fileclass-name", fileClassName);
      const el = link.nextElementSibling;
      if (!(el == null ? void 0 : el.hasClass("fileclass-icon"))) {
        const metadataMenuBtn = plugin.app.workspace.containerEl.createEl("a", { cls: "fileclass-icon" });
        if (metadataMenuBtn) {
          (0, import_obsidian54.setIcon)(metadataMenuBtn, icon || plugin.settings.buttonIcon);
          (_a = link.parentElement) == null ? void 0 : _a.insertBefore(metadataMenuBtn, link.nextSibling);
          metadataMenuBtn.onclick = (event) => {
            const file = plugin.app.vault.getAbstractFileByPath(`${destName}.md`);
            if (file instanceof import_obsidian54.TFile && file.extension === "md") {
              const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
              }, file);
              plugin.addChild(noteFieldsComponent);
            }
            event.stopPropagation();
          };
        }
      }
    }
  }
}
function updateLinkMetadataMenuFormButton(app2, plugin, link, viewTypeName, source) {
  var _a, _b;
  const linkHref = (_a = link.getAttribute("href")) == null ? void 0 : _a.split("#")[0];
  const dest = linkHref && app2.metadataCache.getFirstLinkpathDest(linkHref, source);
  if (dest) {
    const fileClassName = (_b = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _b.last();
    setLinkMetadataFormButton(plugin, link, dest.path.replace(/(.*).md/, "$1"), viewTypeName, fileClassName);
  }
}
function updateDivExtraAttributes(app2, plugin, link, viewTypeName, sourceName, _linkName) {
  var _a;
  const linkName = _linkName || link.textContent;
  const dest = linkName && app2.metadataCache.getFirstLinkpathDest((0, import_obsidian54.getLinkpath)(linkName), sourceName);
  if (dest) {
    const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _a.last();
    setLinkMetadataFormButton(plugin, link, dest.path.replace(/(.*).md/, "$1"), viewTypeName, fileClassName);
  }
}
function updateElLinks(app2, plugin, el, ctx) {
  const links = el.querySelectorAll("a.internal-link");
  const source = ctx.sourcePath.replace(/(.*).md/, "$1");
  links.forEach((link) => {
    updateLinkMetadataMenuFormButton(app2, plugin, link, "a.internal-link", source);
  });
}
function updateVisibleLinks(app2, plugin) {
  const settings = plugin.settings;
  app2.workspace.iterateRootLeaves((leaf) => {
    if (leaf.view instanceof import_obsidian54.MarkdownView && leaf.view.file) {
      const file = leaf.view.file;
      const cachedFile = app2.metadataCache.getFileCache(file);
      const fileName = file.path.replace(/(.*).md/, "$1");
      const tabHeader = leaf.tabHeaderInnerTitleEl;
      if (settings.enableTabHeader) {
        updateDivExtraAttributes(app2, plugin, tabHeader, "tabHeader", fileName);
      } else {
        clearExtraAttributes(tabHeader);
      }
      if ((cachedFile == null ? void 0 : cachedFile.links) && settings.enableLinks) {
        cachedFile.links.forEach((link) => {
          var _a;
          const dest = app2.metadataCache.getFirstLinkpathDest(link.link, fileName);
          if (dest) {
            const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _a.last();
            const internalLinks = leaf.view.containerEl.querySelectorAll(`a.internal-link[href="${link.link}"]`);
            internalLinks.forEach((internalLink) => setLinkMetadataFormButton(plugin, internalLink, fileName, `a.internal-link`, fileClassName));
          }
        });
      }
    }
  });
}

// main.ts
var import_state2 = require("@codemirror/state");

// src/options/livePreview.ts
var import_obsidian55 = require("obsidian");
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var import_language = require("@codemirror/language");
var import_language2 = require("@codemirror/language");
function buildCMViewPlugin(plugin) {
  class HeaderWidget extends import_view.WidgetType {
    constructor(fileClassName, after, destName) {
      super();
      this.fileClassName = fileClassName;
      this.after = after;
      this.destName = destName;
    }
    toDOM() {
      let metadataMenuBtn = document.createElement("span");
      if (this.fileClassName) {
        metadataMenuBtn.setAttr("fileclass-name", this.fileClassName);
        metadataMenuBtn.addClass("fileclass-icon");
        const fileClass = plugin.fieldIndex.fileClassesName.get(this.fileClassName);
        if (fileClass) {
          const icon = fileClass.getIcon();
          (0, import_obsidian55.setIcon)(metadataMenuBtn, icon || settings.buttonIcon);
          metadataMenuBtn.onclick = (event) => {
            const file = plugin.app.vault.getAbstractFileByPath(`${this.destName}.md`);
            if (file instanceof import_obsidian55.TFile && file.extension === "md") {
              const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
              }, file);
              plugin.addChild(noteFieldsComponent);
            }
            event.stopPropagation();
          };
        }
      }
      return metadataMenuBtn;
    }
    ignoreEvent() {
      return true;
    }
  }
  const settings = plugin.settings;
  const viewPlugin = import_view.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = this.buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = this.buildDecorations(update.view);
      }
    }
    destroy() {
    }
    buildDecorations(view) {
      let builder = new import_state.RangeSetBuilder();
      if (!settings.enableEditor) {
        return builder.finish();
      }
      const mdView = view.state.field(import_obsidian55.editorViewField);
      let lastAttributes = {};
      let iconDecoAfter = null;
      let iconDecoAfterWhere = null;
      let mdAliasFrom = null;
      let mdAliasTo = null;
      for (let { from, to } of view.visibleRanges) {
        (0, import_language.syntaxTree)(view.state).iterate({
          from,
          to,
          enter: (node) => {
            var _a;
            const tokenProps = node.type.prop(import_language2.tokenClassNodeProp);
            if (tokenProps) {
              const props = new Set(tokenProps.split(" "));
              const isLink = props.has("hmd-internal-link");
              const isAlias = props.has("link-alias");
              const isPipe = props.has("link-alias-pipe");
              const isMDLink = props.has("link");
              const isMDUrl = props.has("url");
              const isMDFormatting = props.has("formatting-link");
              if (isMDLink && !isMDFormatting) {
                mdAliasFrom = node.from;
                mdAliasTo = node.to;
              }
              if (!isPipe && !isAlias) {
                if (iconDecoAfter && iconDecoAfterWhere) {
                  builder.add(iconDecoAfterWhere, iconDecoAfterWhere, iconDecoAfter);
                  iconDecoAfter = null;
                  iconDecoAfterWhere = null;
                }
              }
              if (isLink && !isAlias && !isPipe || isMDUrl) {
                let linkText = view.state.doc.sliceString(node.from, node.to);
                linkText = linkText.split("#")[0];
                let file = plugin.app.metadataCache.getFirstLinkpathDest(linkText, mdView.file.basename);
                if (isMDUrl && !file) {
                  try {
                    file = plugin.app.vault.getAbstractFileByPath(decodeURIComponent(linkText));
                  } catch (e) {
                  }
                }
                if (file) {
                  const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(file.path)) == null ? void 0 : _a.last();
                  if (fileClassName) {
                    const attributes = { "fileclass-name": fileClassName };
                    let deco = import_view.Decoration.mark({
                      attributes,
                      class: "fileclass-text"
                    });
                    iconDecoAfter = import_view.Decoration.widget({
                      widget: new HeaderWidget(fileClassName, true, file.path.replace(/(.*).md/, "$1"))
                    });
                    if (isMDUrl && mdAliasFrom && mdAliasTo) {
                      let deco2 = import_view.Decoration.mark({
                        attributes,
                        class: "fileclass-text"
                      });
                      builder.add(mdAliasFrom, mdAliasTo, deco2);
                      if (iconDecoAfter) {
                        builder.add(mdAliasTo, mdAliasTo, iconDecoAfter);
                        iconDecoAfter = null;
                        iconDecoAfterWhere = null;
                        mdAliasFrom = null;
                        mdAliasTo = null;
                      }
                    }
                    builder.add(node.from, node.to, deco);
                    lastAttributes = attributes;
                    iconDecoAfterWhere = node.to;
                  }
                }
              } else if (isLink && isAlias) {
                let deco = import_view.Decoration.mark({
                  attributes: lastAttributes,
                  class: "fileclass-text"
                });
                builder.add(node.from, node.to, deco);
                if (iconDecoAfter) {
                  builder.add(node.to, node.to, iconDecoAfter);
                  iconDecoAfter = null;
                  iconDecoAfterWhere = null;
                }
              }
            }
          }
        });
      }
      return builder.finish();
    }
  }, {
    decorations: (v) => v.decorations
  });
  return viewPlugin;
}

// main.ts
var MetadataMenu = class extends import_obsidian56.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
    this.initialFileClassQueries = [];
    this.modalObservers = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      yield this.loadSettings();
      if (this.settings.settingsVersion === void 0)
        yield migrateSettingsV1toV2(this);
      if (this.settings.settingsVersion === 2)
        yield migrateSettingsV2toV3(this);
      this.classFilesPath = this.settings.classFilesPath;
      this.fieldIndex = this.addChild(new FieldIndex(this, "1", () => {
      }));
      this.fileTaskManager = this.addChild(new FileTaskManager(this, "1", () => {
      }));
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.settings.fileClassQueries.forEach((query) => {
        const fileClassQuery = new FileClassQuery_default();
        Object.assign(fileClassQuery, query);
        this.initialFileClassQueries.push(fileClassQuery);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this));
      this.registerEditorSuggest(new ValueSuggest(this));
      this.api = new MetadataMenuApi(this).make();
      this.registerEvent(this.app.workspace.on("active-leaf-change", (leaf) => {
        const view = leaf == null ? void 0 : leaf.view;
        this.addCommands(view);
      }));
      this.addCommands(this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView));
      new linkContextMenu(this);
      this.registerMarkdownPostProcessor((el, ctx) => {
        updateElLinks(this.app, this, el, ctx);
      });
      const plugin = this;
      const updateLinks = function(_file) {
        updateVisibleLinks(plugin.app, plugin);
        plugin.observers.forEach(([observer, type, own_class]) => {
          const leaves = plugin.app.workspace.getLeavesOfType(type);
          leaves.forEach((leaf) => {
            plugin.updateContainer(leaf.view.containerEl, plugin, own_class, type);
          });
        });
      };
      const ext = import_state2.Prec.lowest(buildCMViewPlugin(this));
      this.registerEditorExtension(ext);
      this.observers = [];
      this.app.workspace.onLayoutReady(() => {
        this.initViewObservers(this);
        this.initModalObservers(this, document);
        updateVisibleLinks(this.app, this);
      });
      this.registerEvent(this.app.workspace.on("window-open", (window2, win) => this.initModalObservers(this, window2.getContainer().doc)));
      this.registerEvent(this.app.metadataCache.on("changed", (0, import_obsidian56.debounce)(updateLinks, 500, true)));
      this.registerEvent(this.app.workspace.on("layout-change", (0, import_obsidian56.debounce)(updateLinks, 10, true)));
      this.registerEvent(this.app.workspace.on("layout-change", () => this.initViewObservers(this)));
      this.registerEvent(this.app.workspace.on("metadata-menu:indexed", () => this.reloadObservers()));
    });
  }
  addFileClassAttributeOptions() {
    this.addCommand({
      id: "fileClassAttr_options",
      name: "fileClass attributes options",
      icon: "gear",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView);
        if (checking) {
          return !!(this.classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(this.classFilesPath));
        }
        if (!!(this.classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(this.classFilesPath))) {
          const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.app);
          const optionsList = new FileClassOptionsList(this, view.file, fieldCommandSuggestModal);
          optionsList.createExtraOptionList();
        }
      }
    });
  }
  addInsertFileClassAttribute() {
    this.addCommand({
      id: "insert_fileClassAttr",
      name: "Insert a new fileClass attribute",
      icon: "list-plus",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView);
        if (checking) {
          return !!(this.classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(this.classFilesPath));
        }
        try {
          const fileClassName = FileClass.getFileClassNameFromPath(this, view.file.path);
          if (fileClassName) {
            const fileClassAttributeModal = new FileClassAttributeModal(this, FileClass.createFileClass(this, fileClassName));
            fileClassAttributeModal.open();
          }
        } catch (error) {
          new import_obsidian56.Notice("This is not a valid fileClass");
        }
      }
    });
  }
  addInsertFieldAtPositionCommand() {
    this.addCommand({
      id: "insert_field_at_cursor",
      name: "insert field at cursor",
      icon: "list-plus",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView);
        if (checking) {
          return !!((view == null ? void 0 : view.file) && (!this.classFilesPath || !view.file.path.startsWith(this.classFilesPath)));
        }
        const optionsList = new OptionsList(this, view.file, "InsertFieldCommand");
        optionsList.createExtraOptionList();
      }
    });
  }
  addFieldOptionsCommand() {
    this.addCommand({
      id: "field_options",
      name: "field options",
      icon: "gear",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView);
        if (checking) {
          return !!((view == null ? void 0 : view.file) && (!this.classFilesPath || !view.file.path.startsWith(this.classFilesPath)));
        }
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.app);
        const optionsList = new OptionsList(this, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    });
  }
  addManageFieldAtCursorCommand() {
    this.addCommand({
      id: "field_at_cursor_options",
      name: "Manage field at cursor",
      icon: "text-cursor-input",
      checkCallback: (checking) => {
        var _a;
        const view = this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView);
        const editor = view == null ? void 0 : view.editor;
        if (checking) {
          const inFile = !!((view == null ? void 0 : view.file) && (!this.classFilesPath || !view.file.path.startsWith(this.classFilesPath)));
          return inFile && editor !== void 0;
        }
        const optionsList = new OptionsList(this, view.file, "ManageAtCursorCommand");
        const frontmatter = (_a = this.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
        if (frontmatter && editor && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
          const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        } else if (editor) {
          const { attribute, values } = getLineFields(editor.getLine(editor.getCursor().line)).find((field) => editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) || {};
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        }
      }
    });
  }
  insertMissingFields() {
    this.addCommand({
      id: "insert_missing_fields",
      name: "Insert missing fields",
      icon: "battery-full",
      checkCallback: (checking) => {
        var _a;
        const view = this.app.workspace.getActiveViewOfType(import_obsidian56.MarkdownView);
        if (checking) {
          const inFile = !!((view == null ? void 0 : view.file) && (!this.classFilesPath || !view.file.path.startsWith(this.classFilesPath)));
          return inFile;
        }
        const dvApi = (_a = this.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        const file = view == null ? void 0 : view.file;
        if (dvApi && file) {
          const currentFieldsNames = genuineKeys(dvApi.page(file.path));
          if (![...this.fieldIndex.filesFields.get(file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
            new chooseSectionModal(this, file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this, file.path, lineNumber, inFrontmatter, after, asList, asComment)).open();
          }
        }
      }
    });
  }
  addUpdateLookups() {
    this.addCommand({
      id: "update_formulas",
      name: "Update formulas fields",
      icon: "function-square",
      checkCallback: (checking) => {
        if (checking)
          return true;
        this.fieldIndex.fullIndex("command", true);
      }
    });
  }
  addCommands(view) {
    if (view && view instanceof import_obsidian56.FileView) {
      const file = this.app.vault.getAbstractFileByPath(view.file.path);
      if (file instanceof import_obsidian56.TFile && file.extension === "md") {
        if (this.classFilesPath && file.path.startsWith(this.classFilesPath)) {
          this.addFileClassAttributeOptions();
          this.addInsertFileClassAttribute();
        } else {
          this.addFieldOptionsCommand();
          this.addInsertFieldAtPositionCommand();
          this.addManageFieldAtCursorCommand();
          this.insertMissingFields();
        }
      }
    }
    this.addUpdateLookups();
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      this.settings.fileClassQueries = this.initialFileClassQueries;
      yield this.saveData(this.settings);
      yield this.fieldIndex.fullIndex("setting", true, false);
      this.reloadObservers();
    });
  }
  initViewObservers(plugin) {
    var _a, _b, _c, _d, _e, _f;
    plugin.observers.forEach(([observer, type]) => {
      observer.disconnect();
    });
    plugin.observers = [];
    plugin.registerViewType("backlink", plugin, ".tree-item-inner", true);
    plugin.registerViewType("outgoing-link", plugin, ".tree-item-inner", true);
    plugin.registerViewType("search", plugin, ".tree-item-inner", true);
    plugin.registerViewType("BC-matrix", plugin, ".BC-Link");
    plugin.registerViewType("BC-ducks", plugin, ".internal-link");
    plugin.registerViewType("BC-tree", plugin, "a.internal-link");
    plugin.registerViewType("graph-analysis", plugin, ".internal-link");
    plugin.registerViewType("starred", plugin, ".nav-file-title-content", true);
    plugin.registerViewType("file-explorer", plugin, ".nav-file-title-content", true);
    plugin.registerViewType("recent-files", plugin, ".nav-file-title-content", true);
    if ((_f = (_e = (_d = (_c = (_b = (_a = plugin.app) == null ? void 0 : _a.internalPlugins) == null ? void 0 : _b.plugins) == null ? void 0 : _c.backlink) == null ? void 0 : _d.instance) == null ? void 0 : _e.options) == null ? void 0 : _f.backlinkInDocument) {
      plugin.registerViewType("markdown", plugin, ".tree-item-inner", true);
    }
  }
  initModalObservers(plugin, doc) {
    var _a;
    const config = {
      subtree: false,
      childList: true,
      attributes: false
    };
    this.modalObservers.push(new MutationObserver((records) => {
      records.forEach((mutation) => {
        if (mutation.type === "childList") {
          mutation.addedNodes.forEach((n) => {
            if ("className" in n && (n.className.includes("modal-container") && plugin.settings.enableQuickSwitcher || n.className.includes("suggestion-container") && plugin.settings.enableSuggestor)) {
              let selector = ".suggestion-title, .suggestion-note, .another-quick-switcher__item__title, .omnisearch-result__title";
              if (n.className.includes("suggestion-container")) {
                selector = ".suggestion-title, .suggestion-note";
              }
              plugin.updateContainer(n, plugin, selector, null);
              plugin._watchContainer(null, n, plugin, selector);
            }
          });
        }
      });
    }));
    (_a = this.modalObservers.last()) == null ? void 0 : _a.observe(doc.body, config);
  }
  registerViewType(viewTypeName, plugin, selector, updateDynamic = false) {
    const leaves = this.app.workspace.getLeavesOfType(viewTypeName);
    if (leaves.length > 1) {
      for (let i = 0; i < leaves.length; i++) {
        const container = leaves[i].view.containerEl;
        if (updateDynamic) {
          plugin._watchContainerDynamic(viewTypeName + i, container, plugin, selector);
        } else {
          plugin._watchContainer(viewTypeName + i, container, plugin, selector);
        }
      }
    } else if (leaves.length < 1)
      return;
    else {
      const container = leaves[0].view.containerEl;
      this.updateContainer(container, plugin, selector, viewTypeName);
      if (updateDynamic) {
        plugin._watchContainerDynamic(viewTypeName, container, plugin, selector);
      } else {
        plugin._watchContainer(viewTypeName, container, plugin, selector);
      }
    }
  }
  updateContainer(container, plugin, selector, viewTypeName) {
    const nodes = container.findAll(selector);
    for (let i = 0; i < nodes.length; ++i) {
      const el = nodes[i];
      updateDivExtraAttributes(plugin.app, plugin, el, viewTypeName, "");
    }
  }
  removeFromContainer(container, selector) {
    const nodes = container.findAll(selector);
    for (let i = 0; i < nodes.length; ++i) {
      const el = nodes[i];
      clearExtraAttributes(el);
    }
  }
  _watchContainer(viewType, container, plugin, selector) {
    let observer = new MutationObserver((records, _) => {
      plugin.updateContainer(container, plugin, selector, viewType);
    });
    observer.observe(container, { subtree: true, childList: true, attributes: false });
    if (viewType) {
      plugin.observers.push([observer, viewType, selector]);
    }
  }
  _watchContainerDynamic(viewType, container, plugin, selector, ownClass = "tree-item-inner", parent_class = "tree-item") {
    let observer = new MutationObserver((records, _) => {
      records.forEach((mutation) => {
        if (mutation.type === "childList") {
          mutation.addedNodes.forEach((n) => {
            if ("className" in n) {
              if (n.className.includes && typeof n.className.includes === "function" && n.className.includes(parent_class)) {
                const fileDivs = n.getElementsByClassName(ownClass);
                for (let i = 0; i < fileDivs.length; ++i) {
                  const link = fileDivs[i];
                  updateDivExtraAttributes(plugin.app, plugin, link, viewType, "");
                }
              }
            }
          });
        }
      });
    });
    observer.observe(container, { subtree: true, childList: true, attributes: false });
    plugin.observers.push([observer, viewType, selector]);
  }
  reloadObservers() {
    this.disconnectObservers();
    this.initModalObservers(this, document);
    this.initViewObservers(this);
    updateVisibleLinks(this.app, this);
  }
  disconnectObservers() {
    this.observers.forEach(([observer, type, own_class]) => {
      observer.disconnect();
      const leaves = this.app.workspace.getLeavesOfType(type);
      leaves.forEach((leaf) => {
        this.removeFromContainer(leaf.view.containerEl, own_class);
      });
    });
    for (const observer of this.modalObservers) {
      observer.disconnect();
    }
  }
  onunload() {
    this.disconnectObservers();
    console.log("Metadata Menu unloaded");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvSW5wdXRGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9JbnB1dE1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL2luc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcy50cyIsICJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlcy50cyIsICJzcmMvdHlwZXMvbG9va3VwVHlwZXMudHMiLCAic3JjL3V0aWxzL2xpc3QudHMiLCAic3JjL3V0aWxzL3BhcnNlci50cyIsICJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlci50cyIsICJzcmMvbW9kYWxzL2luc2VydEZpZWxkU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9tb2RhbHMvYWRkTmV3RmllbGRNb2RhbC50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsLnRzIiwgInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmcudHMiLCAic3JjL21vZGFscy9maWVsZHMvQm9vbGVhbk1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9Cb29sZWFuRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL051bWJlckZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL051bWJlck1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9TZWxlY3RGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9TZWxlY3RNb2RhbC50cyIsICJzcmMvdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXMudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Fic3RyYWN0TGlzdEJhc2VkRmllbGQudHMiLCAic3JjL3N1Z2dlc3Rlci9GaWxlU3VnZ2VzdGVyLnRzIiwgInNyYy9zdWdnZXN0ZXIvc3VnZ2VzdC50cyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2VudW1zLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVOYW1lLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFdpbmRvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21hdGguanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldExheW91dFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvY29udGFpbnMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q29tcHV0ZWRTdHlsZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9pc1RhYmxlRWxlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXREb2N1bWVudEVsZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0UGFyZW50Tm9kZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy93aXRoaW4uanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRGcmVzaFNpZGVPYmplY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9tZXJnZVBhZGRpbmdPYmplY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9leHBhbmRUb0hhc2hNYXAuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvYXJyb3cuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRWYXJpYXRpb24uanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvY29tcHV0ZVN0eWxlcy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9ldmVudExpc3RlbmVycy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE9wcG9zaXRlUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93U2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFdpbmRvd1Njcm9sbEJhclguanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Vmlld3BvcnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldERvY3VtZW50UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9pc1Njcm9sbFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRTY3JvbGxQYXJlbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvbGlzdFNjcm9sbFBhcmVudHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9yZWN0VG9DbGllbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldENsaXBwaW5nUmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2NvbXB1dGVPZmZzZXRzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9jb21wdXRlQXV0b1BsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9mbGlwLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2hpZGUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvb2Zmc2V0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL3BvcHBlck9mZnNldHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRBbHRBeGlzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL3ByZXZlbnRPdmVyZmxvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRIVE1MRWxlbWVudFNjcm9sbC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXROb2RlU2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldENvbXBvc2l0ZVJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9vcmRlck1vZGlmaWVycy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2RlYm91bmNlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZm9ybWF0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvdmFsaWRhdGVNb2RpZmllcnMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy91bmlxdWVCeS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21lcmdlQnlOYW1lLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvY3JlYXRlUG9wcGVyLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvcG9wcGVyLmpzIiwgInNyYy91dGlscy9maWxlVXRpbHMudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0N5Y2xlRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL011bHRpRmllbGQudHMiLCAic3JjL21vZGFscy9maWVsZHMvTXVsdGlTZWxlY3RNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL1NpbmdsZUZpbGVNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRGF0ZUZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL0RhdGVNb2RhbC50cyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3R5cGVzL29wdGlvbnMuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS9sMTBuL2RlZmF1bHQuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9pbmRleC5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL2RvbS5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL2Zvcm1hdHRpbmcuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9kYXRlcy5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL3BvbHlmaWxscy5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL2luZGV4LmpzIiwgInNyYy91dGlscy9kYXRhdmlld1V0aWxzLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NdWx0aUZpbGVGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9NdWx0aUZpbGVNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTG9va3VwRmllbGQudHMiLCAic3JjL2NvbW1hbmRzL3VwZGF0ZUxvb2t1cHMudHMiLCAic3JjL2NvbW1hbmRzL2dldFZhbHVlcy50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRm9ybXVsYUZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vycy50cyIsICJzcmMvdHlwZXMvZmllbGRUeXBlcy50cyIsICJzcmMvZmllbGRzL0ZpZWxkLnRzIiwgInNyYy9jb21wb25lbnRzL0ZpZWxkSW5kZXgudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGUudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3MudHMiLCAic3JjL3V0aWxzL3RleHRVdGlscy50cyIsICJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5LnRzIiwgInNyYy9jb21tYW5kcy9yZXNvbHZlTG9va3Vwcy50cyIsICJzcmMvY29tbWFuZHMvdXBkYXRlRm9ybXVsYXMudHMiLCAic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbC50cyIsICJzcmMvbW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbC50cyIsICJzcmMvY29tbWFuZHMvZmllbGRNb2RpZmllci50cyIsICJzcmMvY29tbWFuZHMvZmlsZUZpZWxkcy50cyIsICJzcmMvY29tbWFuZHMvaW5zZXJ0TWlzc2luZ0ZpZWxkcy50cyIsICJzcmMvTWV0YWRhdGFNZW51QXBpLnRzIiwgInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbC50cyIsICJzcmMvb3B0aW9ucy9GaWxlQ2xhc3NPcHRpb25zTGlzdC50cyIsICJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnUudHMiLCAic3JjL29wdGlvbnMvT3B0aW9uc0xpc3QudHMiLCAic3JjL21vZGFscy9hZGROZXdGaWxlQ2xhc3NNb2RhbC50cyIsICJzcmMvY29tbWFuZHMvY3JlYXRlRmlsZUNsYXNzLnRzIiwgInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5ncy50cyIsICJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYi50cyIsICJzcmMvc3VnZ2VzdGVyL0ZvbGRlclN1Z2dlc3Rlci50cyIsICJzcmMvc2V0dGluZ3MvRmlsZUNsYXNzUXVlcnlTZXR0aW5nTW9kYWwudHMiLCAic3JjL3NldHRpbmdzL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZy50cyIsICJzcmMvc2V0dGluZ3MvbWlncmF0ZVNldHRpbmcudHMiLCAic3JjL3N1Z2dlc3Rlci9tZXRhZGF0YVN1Z2dlc3Rlci50cyIsICJzcmMvY29tcG9uZW50cy9GaWxlVGFza01hbmFnZXIudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsICJzcmMvb3B0aW9ucy9saW5rQXR0cmlidXRlcy50cyIsICJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzLnRzIiwgInNyYy9vcHRpb25zL2xpdmVQcmV2aWV3LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBGaWxlVmlldywgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFBsdWdpbiwgVEZpbGUsIFZpZXcsIGRlYm91bmNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEZpZWxkIGZyb20gJ3NyYy9maWVsZHMvRmllbGQnO1xuaW1wb3J0IEZpZWxkSW5kZXggZnJvbSAnc3JjL2NvbXBvbmVudHMvRmllbGRJbmRleCc7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tICdzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzcyc7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCB9IGZyb20gJ3NyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwnO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gJ3NyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnknO1xuaW1wb3J0IHR5cGUgeyBJTWV0YWRhdGFNZW51QXBpIH0gZnJvbSAnc3JjL01ldGFkYXRhTWVudUFwaSc7XG5pbXBvcnQgeyBNZXRhZGF0YU1lbnVBcGkgfSBmcm9tICdzcmMvTWV0YWRhdGFNZW51QXBpJztcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSAnc3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsJztcbmltcG9ydCBGaWxlQ2xhc3NPcHRpb25zTGlzdCBmcm9tICdzcmMvb3B0aW9ucy9GaWxlQ2xhc3NPcHRpb25zTGlzdCc7XG5pbXBvcnQgbGlua0NvbnRleHRNZW51IGZyb20gXCJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnVcIjtcbmltcG9ydCBPcHRpb25zTGlzdCBmcm9tICdzcmMvb3B0aW9ucy9PcHRpb25zTGlzdCc7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBNZXRhZGF0YU1lbnVTZXR0aW5ncyB9IGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ3NcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYlwiO1xuaW1wb3J0ICogYXMgU2V0dGluZ3NNaWdyYXRpb24gZnJvbSAnc3JjL3NldHRpbmdzL21pZ3JhdGVTZXR0aW5nJztcbmltcG9ydCBWYWx1ZVN1Z2dlc3QgZnJvbSBcInNyYy9zdWdnZXN0ZXIvbWV0YWRhdGFTdWdnZXN0ZXJcIjtcbmltcG9ydCB7IGZyb250TWF0dGVyTGluZUZpZWxkLCBnZXRMaW5lRmllbGRzIH0gZnJvbSAnc3JjL3V0aWxzL3BhcnNlcic7XG5pbXBvcnQgeyBGaWxlVGFza01hbmFnZXIgfSBmcm9tICdzcmMvY29tcG9uZW50cy9GaWxlVGFza01hbmFnZXInO1xuaW1wb3J0IHtcblx0dXBkYXRlRWxMaW5rcyxcblx0dXBkYXRlVmlzaWJsZUxpbmtzLFxuXHRjbGVhckV4dHJhQXR0cmlidXRlcyxcblx0dXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzLFxufSBmcm9tIFwic3JjL29wdGlvbnMvbGlua0F0dHJpYnV0ZXNcIlxuaW1wb3J0IHsgUHJlYyB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgYnVpbGRDTVZpZXdQbHVnaW4gfSBmcm9tIFwic3JjL29wdGlvbnMvbGl2ZVByZXZpZXdcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSAnc3JjL3V0aWxzL2RhdGF2aWV3VXRpbHMnO1xuaW1wb3J0IGNob29zZVNlY3Rpb25Nb2RhbCBmcm9tICdzcmMvbW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbCc7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSAnc3JjL2NvbW1hbmRzL2luc2VydE1pc3NpbmdGaWVsZHMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhZGF0YU1lbnUgZXh0ZW5kcyBQbHVnaW4ge1xuXHRwdWJsaWMgYXBpOiBJTWV0YWRhdGFNZW51QXBpO1xuXHRwdWJsaWMgc2V0dGluZ3M6IE1ldGFkYXRhTWVudVNldHRpbmdzO1xuXHRwdWJsaWMgaW5pdGlhbFByb3BlcnRpZXM6IEFycmF5PEZpZWxkPiA9IFtdO1xuXHRwdWJsaWMgaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXM6IEFycmF5PEZpbGVDbGFzc1F1ZXJ5PiA9IFtdO1xuXHRwdWJsaWMgc2V0dGluZ1RhYjogTWV0YWRhdGFNZW51U2V0dGluZ1RhYjtcblx0cHVibGljIGZpZWxkSW5kZXg6IEZpZWxkSW5kZXg7XG5cdHB1YmxpYyBmaWxlVGFza01hbmFnZXI6IEZpbGVUYXNrTWFuYWdlcjtcblx0cHJpdmF0ZSBvYnNlcnZlcnM6IFtNdXRhdGlvbk9ic2VydmVyLCBzdHJpbmcsIHN0cmluZ11bXTtcblx0cHJpdmF0ZSBtb2RhbE9ic2VydmVyczogTXV0YXRpb25PYnNlcnZlcltdID0gW107XG5cdHByaXZhdGUgY2xhc3NGaWxlc1BhdGg6IHN0cmluZyB8IG51bGw7XG5cblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc29sZS5sb2coJ01ldGFkYXRhIE1lbnUgbG9hZGVkJyk7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5zZXR0aW5nc1ZlcnNpb24gPT09IHVuZGVmaW5lZCkgYXdhaXQgU2V0dGluZ3NNaWdyYXRpb24ubWlncmF0ZVNldHRpbmdzVjF0b1YyKHRoaXMpXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID09PSAyKSBhd2FpdCBTZXR0aW5nc01pZ3JhdGlvbi5taWdyYXRlU2V0dGluZ3NWMnRvVjModGhpcylcblx0XHR0aGlzLmNsYXNzRmlsZXNQYXRoID0gdGhpcy5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuXG5cdFx0dGhpcy5maWVsZEluZGV4ID0gdGhpcy5hZGRDaGlsZChuZXcgRmllbGRJbmRleCh0aGlzLCBcIjFcIiwgKCkgPT4geyB9KSlcblx0XHR0aGlzLmZpbGVUYXNrTWFuYWdlciA9IHRoaXMuYWRkQ2hpbGQobmV3IEZpbGVUYXNrTWFuYWdlcih0aGlzLCBcIjFcIiwgKCkgPT4geyB9KSlcblxuXHRcdHRoaXMuc2V0dGluZ3MucHJlc2V0RmllbGRzLmZvckVhY2gocHJvcCA9PiB7XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuXHRcdFx0T2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG5cdFx0XHR0aGlzLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2gocHJvcGVydHkpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZXR0aW5ncy5maWxlQ2xhc3NRdWVyaWVzLmZvckVhY2gocXVlcnkgPT4ge1xuXHRcdFx0Y29uc3QgZmlsZUNsYXNzUXVlcnkgPSBuZXcgRmlsZUNsYXNzUXVlcnkoKTtcblx0XHRcdE9iamVjdC5hc3NpZ24oZmlsZUNsYXNzUXVlcnksIHF1ZXJ5KTtcblx0XHRcdHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMucHVzaChmaWxlQ2xhc3NRdWVyeSk7XG5cdFx0fSlcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWV0YWRhdGFNZW51U2V0dGluZ1RhYih0aGlzKSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRWRpdG9yU3VnZ2VzdChuZXcgVmFsdWVTdWdnZXN0KHRoaXMpKTtcblx0XHR0aGlzLmFwaSA9IG5ldyBNZXRhZGF0YU1lbnVBcGkodGhpcykubWFrZSgpO1xuXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAobGVhZikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZj8udmlld1xuXHRcdFx0XHR0aGlzLmFkZENvbW1hbmRzKHZpZXcpXG5cdFx0XHR9KVxuXHRcdClcblxuXHRcdHRoaXMuYWRkQ29tbWFuZHModGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KSlcblxuXHRcdG5ldyBsaW5rQ29udGV4dE1lbnUodGhpcyk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XG5cdFx0XHR1cGRhdGVFbExpbmtzKHRoaXMuYXBwLCB0aGlzLCBlbCwgY3R4KVxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgcGx1Z2luID0gdGhpcztcblx0XHRjb25zdCB1cGRhdGVMaW5rcyA9IGZ1bmN0aW9uIChfZmlsZTogVEZpbGUpIHtcblx0XHRcdHVwZGF0ZVZpc2libGVMaW5rcyhwbHVnaW4uYXBwLCBwbHVnaW4pO1xuXHRcdFx0cGx1Z2luLm9ic2VydmVycy5mb3JFYWNoKChbb2JzZXJ2ZXIsIHR5cGUsIG93bl9jbGFzc106IFthbnksIGFueSwgYW55XSkgPT4ge1xuXHRcdFx0XHRjb25zdCBsZWF2ZXMgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUodHlwZSk7XG5cdFx0XHRcdGxlYXZlcy5mb3JFYWNoKChsZWFmOiBhbnkpID0+IHtcblx0XHRcdFx0XHRwbHVnaW4udXBkYXRlQ29udGFpbmVyKGxlYWYudmlldy5jb250YWluZXJFbCwgcGx1Z2luLCBvd25fY2xhc3MsIHR5cGUpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gTGl2ZSBwcmV2aWV3XG5cdFx0Y29uc3QgZXh0ID0gUHJlYy5sb3dlc3QoYnVpbGRDTVZpZXdQbHVnaW4odGhpcykpO1xuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oZXh0KTtcblxuXHRcdHRoaXMub2JzZXJ2ZXJzID0gW107XG5cblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG5cdFx0XHR0aGlzLmluaXRWaWV3T2JzZXJ2ZXJzKHRoaXMpO1xuXHRcdFx0dGhpcy5pbml0TW9kYWxPYnNlcnZlcnModGhpcywgZG9jdW1lbnQpO1xuXHRcdFx0dXBkYXRlVmlzaWJsZUxpbmtzKHRoaXMuYXBwLCB0aGlzKTtcblx0XHR9KTtcblxuXHRcdC8vIEluaXRpYWxpemF0aW9uXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbihcIndpbmRvdy1vcGVuXCIsICh3aW5kb3csIHdpbikgPT4gdGhpcy5pbml0TW9kYWxPYnNlcnZlcnModGhpcywgd2luZG93LmdldENvbnRhaW5lcigpIS5kb2MpKSk7XG5cblx0XHQvLyBVcGRhdGUgd2hlblxuXHRcdC8vIERlYm91bmNlZCB0byBwcmV2ZW50IGxhZyB3aGVuIHdyaXRpbmdcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCBkZWJvdW5jZSh1cGRhdGVMaW5rcywgNTAwLCB0cnVlKSkpO1xuXG5cdFx0Ly8gVXBkYXRlIHdoZW4gbGF5b3V0IGNoYW5nZXNcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImxheW91dC1jaGFuZ2VcIiwgZGVib3VuY2UodXBkYXRlTGlua3MsIDEwLCB0cnVlKSkpO1xuXHRcdC8vIFVwZGF0ZSBwbHVnaW4gdmlld3Mgd2hlbiBsYXlvdXQgY2hhbmdlc1xuXHRcdC8vIFRPRE86IFRoaXMgaXMgYW4gZXhwZW5zaXZlIG9wZXJhdGlvbiB0aGF0IHNlZW1zIGxpa2UgaXQgaXMgY2FsbGVkIGZhaXJseSBmcmVxdWVudGx5LiBNYXliZSB3ZSBjYW4gZG8gdGhpcyBtb3JlIGVmZmljaWVudGx5P1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsICgpID0+IHRoaXMuaW5pdFZpZXdPYnNlcnZlcnModGhpcykpKTtcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFwibWV0YWRhdGEtbWVudTppbmRleGVkXCIsICgpID0+IHRoaXMucmVsb2FkT2JzZXJ2ZXJzKCkpKTtcblx0fTtcblxuXHQvKlxuXHQtLS0tLS0tLS0tXG5cdENvbW1hbmRzXG5cdC0tLS0tLS0tLS1cblx0Ki9cblxuXHRwcml2YXRlIGFkZEZpbGVDbGFzc0F0dHJpYnV0ZU9wdGlvbnMoKSB7XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImZpbGVDbGFzc0F0dHJfb3B0aW9uc1wiLFxuXHRcdFx0bmFtZTogXCJmaWxlQ2xhc3MgYXR0cmlidXRlcyBvcHRpb25zXCIsXG5cdFx0XHRpY29uOiBcImdlYXJcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodGhpcy5jbGFzc0ZpbGVzUGF0aCAmJiAhISh2aWV3Py5maWxlKSAmJiB2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuY2xhc3NGaWxlc1BhdGgpKVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghISh0aGlzLmNsYXNzRmlsZXNQYXRoICYmICEhKHZpZXc/LmZpbGUpICYmIHZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgodGhpcy5jbGFzc0ZpbGVzUGF0aCkpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsID0gbmV3IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCh0aGlzLmFwcClcblx0XHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBGaWxlQ2xhc3NPcHRpb25zTGlzdCh0aGlzLCB2aWV3IS5maWxlLCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpO1xuXHRcdFx0XHRcdG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRJbnNlcnRGaWxlQ2xhc3NBdHRyaWJ1dGUoKSB7XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImluc2VydF9maWxlQ2xhc3NBdHRyXCIsXG5cdFx0XHRuYW1lOiBcIkluc2VydCBhIG5ldyBmaWxlQ2xhc3MgYXR0cmlidXRlXCIsXG5cdFx0XHRpY29uOiBcImxpc3QtcGx1c1wiLFxuXHRcdFx0Y2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG5cdFx0XHRcdGlmIChjaGVja2luZykge1xuXHRcdFx0XHRcdHJldHVybiAhISh0aGlzLmNsYXNzRmlsZXNQYXRoICYmICEhKHZpZXc/LmZpbGUpICYmIHZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgodGhpcy5jbGFzc0ZpbGVzUGF0aCkpXG5cdFx0XHRcdH1cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLCB2aWV3IS5maWxlLnBhdGgpXG5cdFx0XHRcdFx0aWYgKGZpbGVDbGFzc05hbWUpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMsIEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3ModGhpcywgZmlsZUNsYXNzTmFtZSkpXG5cdFx0XHRcdFx0XHRmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbC5vcGVuKClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIlRoaXMgaXMgbm90IGEgdmFsaWQgZmlsZUNsYXNzXCIpXG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFkZEluc2VydEZpZWxkQXRQb3NpdGlvbkNvbW1hbmQoKSB7XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImluc2VydF9maWVsZF9hdF9jdXJzb3JcIixcblx0XHRcdG5hbWU6IFwiaW5zZXJ0IGZpZWxkIGF0IGN1cnNvclwiLFxuXHRcdFx0aWNvbjogXCJsaXN0LXBsdXNcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSAmJiAoIXRoaXMuY2xhc3NGaWxlc1BhdGggfHwgIXZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgodGhpcy5jbGFzc0ZpbGVzUGF0aCkpKVxuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHRoaXMsIHZpZXchLmZpbGUsIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIpO1xuXHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcblx0XHRcdH1cblx0XHR9KVxuXHR9XG5cblx0cHJpdmF0ZSBhZGRGaWVsZE9wdGlvbnNDb21tYW5kKCkge1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJmaWVsZF9vcHRpb25zXCIsXG5cdFx0XHRuYW1lOiBcImZpZWxkIG9wdGlvbnNcIixcblx0XHRcdGljb246IFwiZ2VhclwiLFxuXHRcdFx0Y2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG5cdFx0XHRcdGlmIChjaGVja2luZykge1xuXHRcdFx0XHRcdHJldHVybiAhISh2aWV3Py5maWxlICYmICghdGhpcy5jbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLmNsYXNzRmlsZXNQYXRoKSkpXG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsID0gbmV3IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCh0aGlzLmFwcClcblx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcywgdmlldyEuZmlsZSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTtcblx0XHRcdFx0b3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRNYW5hZ2VGaWVsZEF0Q3Vyc29yQ29tbWFuZCgpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiZmllbGRfYXRfY3Vyc29yX29wdGlvbnNcIixcblx0XHRcdG5hbWU6IFwiTWFuYWdlIGZpZWxkIGF0IGN1cnNvclwiLFxuXHRcdFx0aWNvbjogXCJ0ZXh0LWN1cnNvci1pbnB1dFwiLFxuXHRcdFx0Y2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0XHRjb25zdCBlZGl0b3IgPSB2aWV3Py5lZGl0b3I7XG5cdFx0XHRcdGlmIChjaGVja2luZykge1xuXHRcdFx0XHRcdGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCF0aGlzLmNsYXNzRmlsZXNQYXRoIHx8ICF2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuY2xhc3NGaWxlc1BhdGgpKSlcblx0XHRcdFx0XHRyZXR1cm4gaW5GaWxlICYmIGVkaXRvciAhPT0gdW5kZWZpbmVkXG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcywgdmlldyEuZmlsZSwgXCJNYW5hZ2VBdEN1cnNvckNvbW1hbmRcIilcblx0XHRcdFx0Y29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3IS5maWxlKT8uZnJvbnRtYXR0ZXI7XG5cdFx0XHRcdGlmIChmcm9udG1hdHRlciAmJiBlZGl0b3Jcblx0XHRcdFx0XHQmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSA+IGZyb250bWF0dGVyLnBvc2l0aW9uLnN0YXJ0LmxpbmVcblx0XHRcdFx0XHQmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSA8IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lKSB7XG5cdFx0XHRcdFx0Y29uc3QgYXR0cmlidXRlID0gZnJvbnRNYXR0ZXJMaW5lRmllbGQoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKVxuXHRcdFx0XHRcdGlmIChhdHRyaWJ1dGUpIG9wdGlvbnNMaXN0LmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGF0dHJpYnV0ZSlcblx0XHRcdFx0fSBlbHNlIGlmIChlZGl0b3IpIHtcblx0XHRcdFx0XHRjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBnZXRMaW5lRmllbGRzKGVkaXRvci5nZXRMaW5lKGVkaXRvci5nZXRDdXJzb3IoKS5saW5lKSkuZmluZChmaWVsZCA9PlxuXHRcdFx0XHRcdFx0ZWRpdG9yLmdldEN1cnNvcigpLmNoIDw9IGZpZWxkLmluZGV4ICsgZmllbGQubGVuZ3RoXG5cdFx0XHRcdFx0XHQmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPj0gZmllbGQuaW5kZXgpIHx8IHt9O1xuXHRcdFx0XHRcdGlmIChhdHRyaWJ1dGUpIG9wdGlvbnNMaXN0LmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGF0dHJpYnV0ZSlcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0fSlcblx0fVxuXG5cdHByaXZhdGUgaW5zZXJ0TWlzc2luZ0ZpZWxkcygpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiaW5zZXJ0X21pc3NpbmdfZmllbGRzXCIsXG5cdFx0XHRuYW1lOiBcIkluc2VydCBtaXNzaW5nIGZpZWxkc1wiLFxuXHRcdFx0aWNvbjogXCJiYXR0ZXJ5LWZ1bGxcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdFx0aWYgKGNoZWNraW5nKSB7XG5cdFx0XHRcdFx0Y29uc3QgaW5GaWxlID0gISEodmlldz8uZmlsZSAmJiAoIXRoaXMuY2xhc3NGaWxlc1BhdGggfHwgIXZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgodGhpcy5jbGFzc0ZpbGVzUGF0aCkpKVxuXHRcdFx0XHRcdHJldHVybiBpbkZpbGVcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBkdkFwaSA9IHRoaXMuYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpO1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdmlldz8uZmlsZVxuXHRcdFx0XHRpZiAoZHZBcGkgJiYgZmlsZSkge1xuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWVsZHNOYW1lcyA9IGdlbnVpbmVLZXlzKGR2QXBpLnBhZ2UoZmlsZS5wYXRoKSlcblx0XHRcdFx0XHRpZiAoIVsuLi50aGlzLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCkgfHwgW11dLm1hcChmaWVsZCA9PiBmaWVsZC5uYW1lKS5ldmVyeShmaWVsZE5hbWUgPT4gY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkTmFtZSkpKSB7XG5cdFx0XHRcdFx0XHRuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuXHRcdFx0XHRcdFx0XHR0aGlzLFxuXHRcdFx0XHRcdFx0XHRmaWxlLFxuXHRcdFx0XHRcdFx0XHQoXG5cdFx0XHRcdFx0XHRcdFx0bGluZU51bWJlcjogbnVtYmVyLFxuXHRcdFx0XHRcdFx0XHRcdGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdFx0XHRcdFx0YWZ0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdFx0XHRcdFx0YXNMaXN0OiBib29sZWFuLFxuXHRcdFx0XHRcdFx0XHRcdGFzQ29tbWVudDogYm9vbGVhblxuXHRcdFx0XHRcdFx0XHQpID0+IGluc2VydE1pc3NpbmdGaWVsZHMoXG5cdFx0XHRcdFx0XHRcdFx0dGhpcyxcblx0XHRcdFx0XHRcdFx0XHRmaWxlLnBhdGgsXG5cdFx0XHRcdFx0XHRcdFx0bGluZU51bWJlcixcblx0XHRcdFx0XHRcdFx0XHRpbkZyb250bWF0dGVyLFxuXHRcdFx0XHRcdFx0XHRcdGFmdGVyLFxuXHRcdFx0XHRcdFx0XHRcdGFzTGlzdCxcblx0XHRcdFx0XHRcdFx0XHRhc0NvbW1lbnRcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KS5vcGVuKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSlcblx0fVxuXG5cdHByaXZhdGUgYWRkVXBkYXRlTG9va3VwcygpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwidXBkYXRlX2Zvcm11bGFzXCIsXG5cdFx0XHRuYW1lOiBcIlVwZGF0ZSBmb3JtdWxhcyBmaWVsZHNcIixcblx0XHRcdGljb246IFwiZnVuY3Rpb24tc3F1YXJlXCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0aWYgKGNoZWNraW5nKSByZXR1cm4gdHJ1ZTtcblx0XHRcdFx0dGhpcy5maWVsZEluZGV4LmZ1bGxJbmRleChcImNvbW1hbmRcIiwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fSlcblx0fVxuXG5cdHByaXZhdGUgYWRkQ29tbWFuZHModmlldzogVmlldyB8IHVuZGVmaW5lZCB8IG51bGwpIHtcblx0XHRpZiAodmlldyAmJiB2aWV3IGluc3RhbmNlb2YgRmlsZVZpZXcpIHtcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodmlldy5maWxlLnBhdGgpXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNsYXNzRmlsZXNQYXRoICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuY2xhc3NGaWxlc1BhdGgpKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRGaWxlQ2xhc3NBdHRyaWJ1dGVPcHRpb25zKCk7XG5cdFx0XHRcdFx0dGhpcy5hZGRJbnNlcnRGaWxlQ2xhc3NBdHRyaWJ1dGUoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmFkZEZpZWxkT3B0aW9uc0NvbW1hbmQoKTtcblx0XHRcdFx0XHR0aGlzLmFkZEluc2VydEZpZWxkQXRQb3NpdGlvbkNvbW1hbmQoKTtcblx0XHRcdFx0XHR0aGlzLmFkZE1hbmFnZUZpZWxkQXRDdXJzb3JDb21tYW5kKCk7XG5cdFx0XHRcdFx0dGhpcy5pbnNlcnRNaXNzaW5nRmllbGRzKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5hZGRVcGRhdGVMb29rdXBzKClcblx0fVxuXG5cdC8qXG5cdC0tLS0tLS0tLS0tLVxuXHRTZXR0aW5nc1xuXHQtLS0tLS0tLS0tLS1cblx0Ki9cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH07XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MucHJlc2V0RmllbGRzID0gdGhpcy5pbml0aWFsUHJvcGVydGllcztcblx0XHR0aGlzLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMgPSB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdFx0YXdhaXQgdGhpcy5maWVsZEluZGV4LmZ1bGxJbmRleChcInNldHRpbmdcIiwgdHJ1ZSwgZmFsc2UpO1xuXHRcdHRoaXMucmVsb2FkT2JzZXJ2ZXJzKCk7XG5cdH07XG5cblx0Lypcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdE1ldGFkYXRhIE1lbnUgYnV0dG9uc1xuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Ki9cblxuXHRwcml2YXRlIGluaXRWaWV3T2JzZXJ2ZXJzKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG5cdFx0Ly8gUmVzZXQgb2JzZXJ2ZXJzXG5cdFx0cGx1Z2luLm9ic2VydmVycy5mb3JFYWNoKChbb2JzZXJ2ZXIsIHR5cGVdKSA9PiB7XG5cdFx0XHRvYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0fSk7XG5cdFx0cGx1Z2luLm9ic2VydmVycyA9IFtdO1xuXG5cdFx0Ly8gUmVnaXN0ZXIgbmV3IG9ic2VydmVyc1xuXHRcdHBsdWdpbi5yZWdpc3RlclZpZXdUeXBlKCdiYWNrbGluaycsIHBsdWdpbiwgXCIudHJlZS1pdGVtLWlubmVyXCIsIHRydWUpO1xuXHRcdHBsdWdpbi5yZWdpc3RlclZpZXdUeXBlKCdvdXRnb2luZy1saW5rJywgcGx1Z2luLCBcIi50cmVlLWl0ZW0taW5uZXJcIiwgdHJ1ZSk7XG5cdFx0cGx1Z2luLnJlZ2lzdGVyVmlld1R5cGUoJ3NlYXJjaCcsIHBsdWdpbiwgXCIudHJlZS1pdGVtLWlubmVyXCIsIHRydWUpO1xuXHRcdHBsdWdpbi5yZWdpc3RlclZpZXdUeXBlKCdCQy1tYXRyaXgnLCBwbHVnaW4sICcuQkMtTGluaycpO1xuXHRcdHBsdWdpbi5yZWdpc3RlclZpZXdUeXBlKCdCQy1kdWNrcycsIHBsdWdpbiwgJy5pbnRlcm5hbC1saW5rJyk7XG5cdFx0cGx1Z2luLnJlZ2lzdGVyVmlld1R5cGUoJ0JDLXRyZWUnLCBwbHVnaW4sICdhLmludGVybmFsLWxpbmsnKTtcblx0XHRwbHVnaW4ucmVnaXN0ZXJWaWV3VHlwZSgnZ3JhcGgtYW5hbHlzaXMnLCBwbHVnaW4sICcuaW50ZXJuYWwtbGluaycpO1xuXHRcdHBsdWdpbi5yZWdpc3RlclZpZXdUeXBlKCdzdGFycmVkJywgcGx1Z2luLCAnLm5hdi1maWxlLXRpdGxlLWNvbnRlbnQnLCB0cnVlKTtcblx0XHRwbHVnaW4ucmVnaXN0ZXJWaWV3VHlwZSgnZmlsZS1leHBsb3JlcicsIHBsdWdpbiwgJy5uYXYtZmlsZS10aXRsZS1jb250ZW50JywgdHJ1ZSk7XG5cdFx0cGx1Z2luLnJlZ2lzdGVyVmlld1R5cGUoJ3JlY2VudC1maWxlcycsIHBsdWdpbiwgJy5uYXYtZmlsZS10aXRsZS1jb250ZW50JywgdHJ1ZSk7XG5cdFx0Ly8gSWYgYmFja2xpbmtzIGluIGVkaXRvciBpcyBvblxuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRpZiAocGx1Z2luLmFwcD8uaW50ZXJuYWxQbHVnaW5zPy5wbHVnaW5zPy5iYWNrbGluaz8uaW5zdGFuY2U/Lm9wdGlvbnM/LmJhY2tsaW5rSW5Eb2N1bWVudCkge1xuXHRcdFx0cGx1Z2luLnJlZ2lzdGVyVmlld1R5cGUoJ21hcmtkb3duJywgcGx1Z2luLCAnLnRyZWUtaXRlbS1pbm5lcicsIHRydWUpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaW5pdE1vZGFsT2JzZXJ2ZXJzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBkb2M6IERvY3VtZW50KSB7XG5cdFx0Y29uc3QgY29uZmlnID0ge1xuXHRcdFx0c3VidHJlZTogZmFsc2UsXG5cdFx0XHRjaGlsZExpc3Q6IHRydWUsXG5cdFx0XHRhdHRyaWJ1dGVzOiBmYWxzZVxuXHRcdH07XG5cblx0XHR0aGlzLm1vZGFsT2JzZXJ2ZXJzLnB1c2gobmV3IE11dGF0aW9uT2JzZXJ2ZXIocmVjb3JkcyA9PiB7XG5cdFx0XHRyZWNvcmRzLmZvckVhY2goKG11dGF0aW9uKSA9PiB7XG5cdFx0XHRcdGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuXHRcdFx0XHRcdG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaChuID0+IHtcblx0XHRcdFx0XHRcdGlmICgnY2xhc3NOYW1lJyBpbiBuICYmXG5cdFx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHRcdFx0KG4uY2xhc3NOYW1lLmluY2x1ZGVzKCdtb2RhbC1jb250YWluZXInKSAmJiBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlUXVpY2tTd2l0Y2hlclxuXHRcdFx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHRcdFx0XHR8fCBuLmNsYXNzTmFtZS5pbmNsdWRlcygnc3VnZ2VzdGlvbi1jb250YWluZXInKSAmJiBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlU3VnZ2VzdG9yKSkge1xuXHRcdFx0XHRcdFx0XHRsZXQgc2VsZWN0b3IgPSBcIi5zdWdnZXN0aW9uLXRpdGxlLCAuc3VnZ2VzdGlvbi1ub3RlLCAuYW5vdGhlci1xdWljay1zd2l0Y2hlcl9faXRlbV9fdGl0bGUsIC5vbW5pc2VhcmNoLXJlc3VsdF9fdGl0bGVcIjtcblx0XHRcdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdFx0XHRpZiAobi5jbGFzc05hbWUuaW5jbHVkZXMoJ3N1Z2dlc3Rpb24tY29udGFpbmVyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxlY3RvciA9IFwiLnN1Z2dlc3Rpb24tdGl0bGUsIC5zdWdnZXN0aW9uLW5vdGVcIjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRwbHVnaW4udXBkYXRlQ29udGFpbmVyKG4gYXMgSFRNTEVsZW1lbnQsIHBsdWdpbiwgc2VsZWN0b3IsIG51bGwpO1xuXHRcdFx0XHRcdFx0XHRwbHVnaW4uX3dhdGNoQ29udGFpbmVyKG51bGwsIG4gYXMgSFRNTEVsZW1lbnQsIHBsdWdpbiwgc2VsZWN0b3IpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KSk7XG5cdFx0dGhpcy5tb2RhbE9ic2VydmVycy5sYXN0KCk/Lm9ic2VydmUoZG9jLmJvZHksIGNvbmZpZyk7XG5cdH1cblxuXHRwcml2YXRlIHJlZ2lzdGVyVmlld1R5cGUodmlld1R5cGVOYW1lOiBzdHJpbmcsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBzZWxlY3Rvcjogc3RyaW5nLCB1cGRhdGVEeW5hbWljID0gZmFsc2UpIHtcblx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKHZpZXdUeXBlTmFtZSk7XG5cdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxlYXZlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRjb25zdCBjb250YWluZXIgPSBsZWF2ZXNbaV0udmlldy5jb250YWluZXJFbDtcblx0XHRcdFx0aWYgKHVwZGF0ZUR5bmFtaWMpIHtcblx0XHRcdFx0XHRwbHVnaW4uX3dhdGNoQ29udGFpbmVyRHluYW1pYyh2aWV3VHlwZU5hbWUgKyBpLCBjb250YWluZXIsIHBsdWdpbiwgc2VsZWN0b3IpXG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0cGx1Z2luLl93YXRjaENvbnRhaW5lcih2aWV3VHlwZU5hbWUgKyBpLCBjb250YWluZXIsIHBsdWdpbiwgc2VsZWN0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2UgaWYgKGxlYXZlcy5sZW5ndGggPCAxKSByZXR1cm47XG5cdFx0ZWxzZSB7XG5cdFx0XHRjb25zdCBjb250YWluZXIgPSBsZWF2ZXNbMF0udmlldy5jb250YWluZXJFbDtcblx0XHRcdHRoaXMudXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lciwgcGx1Z2luLCBzZWxlY3Rvciwgdmlld1R5cGVOYW1lKTtcblx0XHRcdGlmICh1cGRhdGVEeW5hbWljKSB7XG5cdFx0XHRcdHBsdWdpbi5fd2F0Y2hDb250YWluZXJEeW5hbWljKHZpZXdUeXBlTmFtZSwgY29udGFpbmVyLCBwbHVnaW4sIHNlbGVjdG9yKVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5fd2F0Y2hDb250YWluZXIodmlld1R5cGVOYW1lLCBjb250YWluZXIsIHBsdWdpbiwgc2VsZWN0b3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBzZWxlY3Rvcjogc3RyaW5nLCB2aWV3VHlwZU5hbWU6IHN0cmluZyB8IG51bGwpIHtcblx0XHRjb25zdCBub2RlcyA9IGNvbnRhaW5lci5maW5kQWxsKHNlbGVjdG9yKTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRjb25zdCBlbCA9IG5vZGVzW2ldIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0dXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzKHBsdWdpbi5hcHAsIHBsdWdpbiwgZWwsIHZpZXdUeXBlTmFtZSwgXCJcIik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSByZW1vdmVGcm9tQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcpIHtcblx0XHRjb25zdCBub2RlcyA9IGNvbnRhaW5lci5maW5kQWxsKHNlbGVjdG9yKTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRjb25zdCBlbCA9IG5vZGVzW2ldIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0Y2xlYXJFeHRyYUF0dHJpYnV0ZXMoZWwpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgX3dhdGNoQ29udGFpbmVyKHZpZXdUeXBlOiBzdHJpbmcgfCBudWxsLCBjb250YWluZXI6IEhUTUxFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgc2VsZWN0b3I6IHN0cmluZykge1xuXHRcdGxldCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChyZWNvcmRzLCBfKSA9PiB7XG5cdFx0XHRwbHVnaW4udXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lciwgcGx1Z2luLCBzZWxlY3Rvciwgdmlld1R5cGUpO1xuXHRcdH0pO1xuXHRcdG9ic2VydmVyLm9ic2VydmUoY29udGFpbmVyLCB7IHN1YnRyZWU6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgYXR0cmlidXRlczogZmFsc2UgfSk7XG5cdFx0aWYgKHZpZXdUeXBlKSB7XG5cdFx0XHRwbHVnaW4ub2JzZXJ2ZXJzLnB1c2goW29ic2VydmVyLCB2aWV3VHlwZSwgc2VsZWN0b3JdKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIF93YXRjaENvbnRhaW5lckR5bmFtaWModmlld1R5cGU6IHN0cmluZywgY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHNlbGVjdG9yOiBzdHJpbmcsIG93bkNsYXNzID0gJ3RyZWUtaXRlbS1pbm5lcicsIHBhcmVudF9jbGFzcyA9ICd0cmVlLWl0ZW0nKSB7XG5cdFx0Ly8gVXNlZCBmb3IgZWZmaWNpZW50IHVwZGF0aW5nIG9mIHRoZSBiYWNrbGlua3MgcGFuZWxcblx0XHQvLyBPbmx5IGxvb3BzIHRocm91Z2ggbmV3bHkgYWRkZWQgRE9NIG5vZGVzIGluc3RlYWQgb2YgY2hhbmdpbmcgYWxsIG9mIHRoZW1cblx0XHRsZXQgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigocmVjb3JkcywgXykgPT4ge1xuXHRcdFx0cmVjb3Jkcy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuXHRcdFx0XHRpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcblx0XHRcdFx0XHRtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2goKG4pID0+IHtcblx0XHRcdFx0XHRcdGlmICgnY2xhc3NOYW1lJyBpbiBuKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHRcdFx0aWYgKG4uY2xhc3NOYW1lLmluY2x1ZGVzICYmIHR5cGVvZiBuLmNsYXNzTmFtZS5pbmNsdWRlcyA9PT0gJ2Z1bmN0aW9uJyAmJiBuLmNsYXNzTmFtZS5pbmNsdWRlcyhwYXJlbnRfY2xhc3MpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgZmlsZURpdnMgPSAobiBhcyBIVE1MRWxlbWVudCkuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShvd25DbGFzcyk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlRGl2cy5sZW5ndGg7ICsraSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgbGluayA9IGZpbGVEaXZzW2ldIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdFx0XHRcdFx0dXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzKHBsdWdpbi5hcHAsIHBsdWdpbiwgbGluaywgdmlld1R5cGUsIFwiXCIpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0XHRvYnNlcnZlci5vYnNlcnZlKGNvbnRhaW5lciwgeyBzdWJ0cmVlOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIGF0dHJpYnV0ZXM6IGZhbHNlIH0pO1xuXHRcdHBsdWdpbi5vYnNlcnZlcnMucHVzaChbb2JzZXJ2ZXIsIHZpZXdUeXBlLCBzZWxlY3Rvcl0pO1xuXHR9XG5cblx0cmVsb2FkT2JzZXJ2ZXJzKCkge1xuXHRcdHRoaXMuZGlzY29ubmVjdE9ic2VydmVycygpO1xuXHRcdHRoaXMuaW5pdE1vZGFsT2JzZXJ2ZXJzKHRoaXMsIGRvY3VtZW50KTtcblx0XHR0aGlzLmluaXRWaWV3T2JzZXJ2ZXJzKHRoaXMpO1xuXHRcdHVwZGF0ZVZpc2libGVMaW5rcyh0aGlzLmFwcCwgdGhpcyk7XG5cdH1cblxuXHRwcml2YXRlIGRpc2Nvbm5lY3RPYnNlcnZlcnMoKSB7XG5cdFx0dGhpcy5vYnNlcnZlcnMuZm9yRWFjaCgoW29ic2VydmVyLCB0eXBlLCBvd25fY2xhc3NdKSA9PiB7XG5cdFx0XHRvYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKHR5cGUpO1xuXHRcdFx0bGVhdmVzLmZvckVhY2gobGVhZiA9PiB7XG5cdFx0XHRcdHRoaXMucmVtb3ZlRnJvbUNvbnRhaW5lcihsZWFmLnZpZXcuY29udGFpbmVyRWwsIG93bl9jbGFzcyk7XG5cdFx0XHR9KVxuXHRcdH0pO1xuXHRcdGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgdGhpcy5tb2RhbE9ic2VydmVycykge1xuXHRcdFx0b2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuXHRcdH1cblx0fVxuXG5cdC8qXG5cdC0tLS0tLS0tLS0tLVxuXHRVbmxvYWRcblx0LS0tLS0tLS0tLS0tXG5cdCovXG5cblx0b251bmxvYWQoKSB7XG5cdFx0dGhpcy5kaXNjb25uZWN0T2JzZXJ2ZXJzKCk7XG5cdFx0Y29uc29sZS5sb2coJ01ldGFkYXRhIE1lbnUgdW5sb2FkZWQnKTtcblx0fTtcbn1cbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IElucHV0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL0lucHV0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnB1dEZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLklucHV0KVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGVcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgSW5wdXRNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUpO1xuICAgICAgICBtb2RhbC50aXRsZUVsLnNldFRleHQoYENoYW5nZSBWYWx1ZSBmb3IgPCR7bmFtZX0+YCk7XG4gICAgICAgIGNvbnN0IGljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5JbnB1dF07XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9ICgpID0+IG1vZGFsLm9wZW4oKTtcbiAgICAgICAgaWYgKElucHV0RmllbGQuaXNNZW51KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSA8JHtuYW1lfT5gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oaWNvbk5hbWUpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChJbnB1dEZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBpY29uTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoSW5wdXRGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihGaWVsZEljb25bRmllbGRUeXBlLklucHV0XSwgYWN0aW9uLCBgVXBkYXRlICR7bmFtZX0ncyB2YWx1ZWApO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0ZW1wbGF0ZUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlRlbXBsYXRlXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KVxuICAgICAgICBjb25zdCB0ZW1wbGF0ZVZhbHVlID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHRlbXBsYXRlQ29udGFpbmVyKVxuICAgICAgICB0ZW1wbGF0ZVZhbHVlLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICB0ZW1wbGF0ZVZhbHVlLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRlbXBsYXRlVmFsdWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlIHx8IFwiXCIpXG4gICAgICAgIHRlbXBsYXRlVmFsdWUub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZSA9IHZhbHVlO1xuXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgLy9hbHdheXMgdHJ1ZSBzaW5jZSB0aGVyZSBhcmUgbm8gb3B0aW9uc1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBJbnB1dE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycylcbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpXG4gICAgICAgIGlucHV0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtaW5wdXRcIilcbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5wdXQpXG4gICAgICAgIGlucHV0LnZhbHVlID0gcFt0aGlzLmZpZWxkLm5hbWVdXG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgICAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIilcbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKGJ1dHRvbiwgRmllbGRJY29uW0ZpZWxkVHlwZS5JbnB1dF0pXG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGJ1dHRvbi5oaWRlKClcbiAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zaG93KClcbiAgICAgICAgICAgICAgICBzcGFjZXIuaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5oaWRlKClcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB2YWxpZGF0ZUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24odmFsaWRhdGVJY29uLCBcImNoZWNrbWFya1wiKVxuICAgICAgICB2YWxpZGF0ZUljb24uc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgdmFsaWRhdGVJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgSW5wdXRGaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodmFsaWRhdGVJY29uKVxuICAgICAgICBjb25zdCBjYW5jZWxJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBjYW5jZWxJY29uLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24oY2FuY2VsSWNvbiwgXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsSWNvbi5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSlcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChjYW5jZWxJY29uKVxuICAgICAgICBpbnB1dC5mb2N1cygpXG5cbiAgICAgICAgaW5wdXQub25rZXlkb3duID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgSW5wdXRGaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGJ1dHRvbiBvbiBjbGljayA6IHJlbW92ZSBidXR0b24gYW5kIGZpZWxkIGFuZCBkaXNwbGF5IGlucHV0IGZpZWxkKi9cbiAgICAgICAgYnV0dG9uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXRNb2RhbCA9IG5ldyBJbnB1dE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZmllbGRWYWx1ZSlcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChidXR0b24pXG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc3BhY2VyKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbilcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSlcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQsIE1vZGFsLCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIHRlbXBsYXRlVmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgcHJpdmF0ZSByZW5kZXJlZFZhbHVlOiBUZXh0QXJlYUNvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7IHN1cGVyKHBsdWdpbi5hcHApOyB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCBpbnB1dERpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZUZpZWxkUmVnZXggPSBuZXcgUmVnRXhwKGBcXFxce1xcXFx7KD88ZmllbGQ+W15cXFxcfV0rPylcXFxcfVxcXFx9YCwgXCJndVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHRGID0gdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlLm1hdGNoQWxsKHRlbXBsYXRlRmllbGRSZWdleClcbiAgICAgICAgICAgIGxldCBuZXh0ID0gdEYubmV4dCgpO1xuICAgICAgICAgICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBuZXh0LnZhbHVlLmdyb3Vwcy5maWVsZFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBbbmFtZSwgb3B0aW9uc1N0cmluZ10gPSB2YWx1ZS5zcGxpdCgvOiguKikvcykubWFwKCh2OiBzdHJpbmcpID0+IHYudHJpbSgpKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlVmFsdWVzW25hbWVdID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnNTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnNTdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZFRlbXBsYXRlU2VsZWN0SXRlbShpbnB1dERpdiwgbmFtZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkVGVtcGxhdGVJbnB1dEl0ZW0oaW5wdXREaXYsIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5leHQgPSB0Ri5uZXh0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYnVpbGRSZXN1bHRQcmV2aWV3KGlucHV0RGl2KTtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRTYXZlQnRuKGlucHV0RGl2KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRJbnB1dEVsKGlucHV0RGl2KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIHJlbmRlclZhbHVlKCkge1xuICAgICAgICBsZXQgcmVuZGVyZWRTdHJpbmcgPSB0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGUuc2xpY2UoKVxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnRlbXBsYXRlVmFsdWVzKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmllbGRSZWdleCA9IG5ldyBSZWdFeHAoYFxcXFx7XFxcXHske2sucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKX0oOlteXFxcXH1dKik/XFxcXH1cXFxcfWAsIFwidVwiKVxuICAgICAgICAgICAgcmVuZGVyZWRTdHJpbmcgPSByZW5kZXJlZFN0cmluZy5yZXBsYWNlKGZpZWxkUmVnZXgsIHRoaXMudGVtcGxhdGVWYWx1ZXNba10pXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlLnNldFZhbHVlKHJlbmRlcmVkU3RyaW5nKVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRUZW1wbGF0ZUlucHV0SXRlbShpbnB1dERpdjogSFRNTERpdkVsZW1lbnQsIG5hbWU6IHN0cmluZykge1xuICAgICAgICBpbnB1dERpdi5jcmVhdGVEaXYoeyB0ZXh0OiBuYW1lLCBjbHM6IFwibWV0YWRhdGEtbWVudS1pbnB1dC1sYWJlbFwiIH0pO1xuICAgICAgICBjb25zdCBpbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQoaW5wdXREaXYpO1xuICAgICAgICBpbnB1dEVsLnNldFBsYWNlaG9sZGVyKGBFbnRlciBhIHZhbHVlIGZvciAke25hbWV9YCk7XG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpO1xuICAgICAgICBpbnB1dEVsLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVWYWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVmFsdWUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFRlbXBsYXRlU2VsZWN0SXRlbShpbnB1dERpdjogSFRNTERpdkVsZW1lbnQsIG5hbWU6IHN0cmluZywgb3B0aW9uczogc3RyaW5nW10pIHtcbiAgICAgICAgaW5wdXREaXYuY3JlYXRlRGl2KHsgdGV4dDogbmFtZSwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtaW5wdXQtbGFiZWxcIiB9KTtcbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoaW5wdXREaXYpO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCItLXNlbGVjdC0tXCIpXG4gICAgICAgIG9wdGlvbnMuZm9yRWFjaChvID0+IHNlbGVjdEVsLmFkZE9wdGlvbihvLCBvKSk7XG4gICAgICAgIHNlbGVjdEVsLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVWYWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVmFsdWUoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkUmVzdWx0UHJldmlldyhpbnB1dERpdjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgaW5wdXREaXYuY3JlYXRlRWwoXCJoclwiKVxuICAgICAgICBpbnB1dERpdi5jcmVhdGVEaXYoeyB0ZXh0OiBcIlJlc3VsdCBwcmV2aWV3XCIsIGNsczogXCJtZXRhZGF0YS1tZW51LWlucHV0LWxhYmVsXCIgfSk7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVkVmFsdWVDb250YWluZXIgPSBpbnB1dERpdi5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHJlbmRlcmVkVmFsdWVDb250YWluZXIpXG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZS5pbnB1dEVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1wcm9tcHQtaW5wdXRcIik7XG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZS5pbnB1dEVsLnJvd3MgPSAzO1xuICAgICAgICB0aGlzLnJlbmRlcmVkVmFsdWUuc2V0VmFsdWUodGhpcy52YWx1ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFNhdmVCdG4oaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgICAgIGlucHV0RGl2LmNyZWF0ZUVsKFwiaHJcIilcbiAgICAgICAgY29uc3Qgc2F2ZUJ0bkNvbnRhaW5lciA9IGlucHV0RGl2LmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXRleHRhcmVhLWJ1dHRvbnNcIiB9KVxuICAgICAgICBjb25zdCBzYXZlQnRuID0gc2F2ZUJ0bkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKHNhdmVCdG4sIFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnRuLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZSA9IHRoaXMucmVuZGVyZWRWYWx1ZS5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KSB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkSW5wdXRFbChpbnB1dERpdjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZm9ybSA9IGlucHV0RGl2LmNyZWF0ZUVsKFwiZm9ybVwiKTtcbiAgICAgICAgZm9ybS50eXBlID0gXCJzdWJtaXRcIjtcblxuICAgICAgICBjb25zdCBpbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQoZm9ybSk7XG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5mb2N1cygpO1xuXG4gICAgICAgIGlucHV0RWwuc2V0VmFsdWUoYCR7dGhpcy52YWx1ZX1gKTtcblxuICAgICAgICBpbnB1dEVsLmlucHV0RWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXByb21wdC1pbnB1dFwiKTtcblxuICAgICAgICBmb3JtLm9uc3VibWl0ID0gYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0RWwuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0VmFsdWUpIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHMgfSBmcm9tIFwiLi9pbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydFZhbHVlcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgdmFsdWU6IHN0cmluZyxcbiAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLFxuICAgIGFmdGVyOiBib29sZWFuID0gdHJ1ZSxcbiAgICBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPckZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlclxuICAgIGlmIChpbkZyb250bWF0dGVyICYmIGxpbmVOdW1iZXIgPT0gLTIgJiYgIWZyb250bWF0dGVyKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgZmllbGROYW1lOiB2YWx1ZSB9XG4gICAgICAgIGF3YWl0IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyhwbHVnaW4sIGZpbGUsIGZpZWxkcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCB0YXJnZXRMaW5lTnVtYmVyID0gaW5Gcm9udG1hdHRlciAmJiBsaW5lTnVtYmVyID09IC0yICYmIGZyb250bWF0dGVyID9cbiAgICAgICAgICAgIGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lIDogbGluZU51bWJlclxuICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IHtcbiAgICAgICAgICAgIGlmIChfbGluZU51bWJlciA9PSB0YXJnZXRMaW5lTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFmdGVyKSBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3TGluZSA9IGAkeyFpbkZyb250bWF0dGVyICYmIGFzQ29tbWVudCA/IFwiPlwiIDogXCJcIn0keyFpbkZyb250bWF0dGVyICYmIGFzTGlzdCA/IFwiLSBcIiA6IFwiXCJ9JHtmaWVsZE5hbWV9JHtpbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7dmFsdWV9YDtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobmV3TGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFhZnRlcikgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgICAgICBjb25zdCBlZGl0b3IgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvclxuICAgICAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmVcbiAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSwgY2g6IGVkaXRvci5nZXRMaW5lKGxpbmVOdW1iZXIpLmxlbmd0aCB9KVxuICAgICAgICB9XG4gICAgfVxuXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsXG4gICAgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPckZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gXCItLS1cXG5cIiArIE9iamVjdC5lbnRyaWVzKGZpZWxkcykubWFwKChbZmllbGROYW1lLCB2YWx1ZV0pID0+IGAke2ZpZWxkTmFtZX06ICR7dmFsdWV9YCkuam9pbihcIlxcblwiKSArIChcIlxcbi0tLVxcblwiKVxuXG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgZnJvbnRtYXR0ZXIgKyBjb250ZW50KTtcbiAgICBjb25zdCBlZGl0b3IgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvclxuICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lXG4gICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSwgY2g6IGVkaXRvci5nZXRMaW5lKGxpbmVOdW1iZXIpLmxlbmd0aCB9KVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0ICogYXMgTG9va3VwIGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgZ2V0TGlzdEJvdW5kcyB9IGZyb20gXCJzcmMvdXRpbHMvbGlzdFwiO1xuaW1wb3J0IHsgZmllbGRDb21wb25lbnRzLCBpbmxpbmVGaWVsZFJlZ2V4LCBlbmNvZGVMaW5rLCBkZWNvZGVMaW5rIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuY29uc3QgZW51bSBMb2NhdGlvbiB7XG4gICAgJ2Z1bGxMaW5lJyA9ICdmdWxsTGluZScsXG4gICAgJ2JyYWNrZXRzJyA9ICdicmFja2V0cycsXG4gICAgJ3BhcmVudGhlc2lzJyA9ICdwYXJlbnRoZXNpcydcbn1cblxuY29uc3QgTG9jYXRpb25XcmFwcGVyOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIExvY2F0aW9uLCB7IHN0YXJ0OiBcIlwiIHwgXCJbXCIgfCBcIihcIiwgZW5kOiBcIlwiIHwgXCJdXCIgfCBcIilcIiB9PiA9IHtcbiAgICBcImZ1bGxMaW5lXCI6IHsgc3RhcnQ6IFwiXCIsIGVuZDogXCJcIiB9LFxuICAgIFwiYnJhY2tldHNcIjogeyBzdGFydDogXCJbXCIsIGVuZDogXCJdXCIgfSxcbiAgICBcInBhcmVudGhlc2lzXCI6IHsgc3RhcnQ6IFwiKFwiLCBlbmQ6IFwiKVwiIH1cbn1cblxudHlwZSBGaWVsZFJlcGxhY2UgPSB7XG4gICAgb2xkRmllbGQ6IHN0cmluZyxcbiAgICBuZXdGaWVsZDogc3RyaW5nLFxufVxuXG5leHBvcnQgY29uc3QgbWF0Y2hJbmxpbmVGaWVsZHMgPSAocmVnZXg6IFJlZ0V4cCwgbGluZTogc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZywgbG9jYXRpb246IGtleW9mIHR5cGVvZiBMb2NhdGlvbiA9IFwiZnVsbExpbmVcIik6IEZpZWxkUmVwbGFjZVtdID0+IHtcbiAgICBjb25zdCBzUiA9IGxpbmUubWF0Y2hBbGwocmVnZXgpO1xuICAgIGxldCBuZXh0ID0gc1IubmV4dCgpO1xuICAgIGNvbnN0IG5ld0ZpZWxkczogRmllbGRSZXBsYWNlW10gPSBbXTtcbiAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICBjb25zdCBtYXRjaCA9IG5leHQudmFsdWU7XG4gICAgICAgIGlmIChtYXRjaC5ncm91cHMgJiYgT2JqZWN0LmtleXMobWF0Y2guZ3JvdXBzKS5ldmVyeShqID0+IGZpZWxkQ29tcG9uZW50cy5pbmNsdWRlcyhqKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgaW5MaXN0LCBpblF1b3RlLCBzdGFydFN0eWxlLCBlbmRTdHlsZSwgYmVmb3JlU2VwYXJhdG9yU3BhY2VyLCBhZnRlclNlcGFyYXRvclNwYWNlciwgdmFsdWVzIH0gPSBtYXRjaC5ncm91cHNcbiAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykgOiBbXCJcIl07XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IGlucHV0QXJyYXkubGVuZ3RoID09IDEgPyBpbnB1dEFycmF5WzBdIDogYCR7aW5wdXRBcnJheS5qb2luKCcsICcpfWA7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IExvY2F0aW9uV3JhcHBlcltsb2NhdGlvbl0uc3RhcnQ7XG4gICAgICAgICAgICBjb25zdCBlbmQgPSBMb2NhdGlvbldyYXBwZXJbbG9jYXRpb25dLmVuZDtcbiAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBvbGRGaWVsZDogbWF0Y2hbMF0sXG4gICAgICAgICAgICAgICAgbmV3RmllbGQ6IGAke2luUXVvdGUgfHwgXCJcIn0ke3N0YXJ0fSR7aW5MaXN0IHx8IFwiXCJ9JHtzdGFydFN0eWxlfSR7YXR0cmlidXRlfSR7ZW5kU3R5bGV9JHtiZWZvcmVTZXBhcmF0b3JTcGFjZXJ9Ojoke2FmdGVyU2VwYXJhdG9yU3BhY2VyfSR7bmV3VmFsdWV9JHtlbmR9YCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgbmV4dCA9IHNSLm5leHQoKVxuICAgIH1cbiAgICByZXR1cm4gbmV3RmllbGRzXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBsYWNlVmFsdWVzKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZyxcbiAgICBhdHRyaWJ1dGU6IHN0cmluZyxcbiAgICBpbnB1dDogc3RyaW5nLFxuICAgIHByZXZpb3VzSXRlbXNDb3VudDogbnVtYmVyID0gMFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPckZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IChhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyO1xuICAgIC8vZmlyc3QgbG9vayBmb3IgbG9va3VwIGxpc3RzXG5cbiAgICBjb25zdCBza2lwcGVkTGluZXM6IG51bWJlcltdID0gW11cblxuICAgIGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlciA/IGZyb250bWF0dGVyIDogeyBwb3NpdGlvbjogeyBzdGFydDogdW5kZWZpbmVkLCBlbmQ6IHVuZGVmaW5lZCB9IH07XG4gICAgY29uc3QgbmV3Q29udGVudCA9IGNvbnRlbnQubWFwKChsaW5lLCBpKSA9PiB7XG4gICAgICAgIGlmIChzdGFydCAmJiBlbmQgJiYgaSA+PSBzdGFydC5saW5lICYmIGkgPD0gZW5kLmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7YXR0cmlidXRlfTpgLCAndScpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IGlucHV0ID8gaW5wdXQucmVwbGFjZSgvKFxcLFxccyspL2csICcsJykuc3BsaXQoJywnKSA6IFtcIlwiXTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IGlucHV0QXJyYXkubGVuZ3RoID09IDEgPyBpbnB1dEFycmF5WzBdIDogYFske2lucHV0QXJyYXkuam9pbignLCAnKX1dYDtcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7YXR0cmlidXRlfTogJHtuZXdWYWx1ZX1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVuY29kZWRJbnB1dCA9IGVuY29kZUxpbmsoaW5wdXQpXG4gICAgICAgICAgICBsZXQgZW5jb2RlZExpbmUgPSBlbmNvZGVMaW5rKGxpbmUpXG4gICAgICAgICAgICBjb25zdCBmdWxsTGluZVJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfSg/PHZhbHVlcz5bXlxcXFxdXSopYCwgXCJ1XCIpO1xuICAgICAgICAgICAgY29uc3QgZlIgPSBlbmNvZGVkTGluZS5tYXRjaChmdWxsTGluZVJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChmUj8uZ3JvdXBzICYmIE9iamVjdC5rZXlzKGZSLmdyb3VwcykuZXZlcnkoaiA9PiBmaWVsZENvbXBvbmVudHMuaW5jbHVkZXMoaikpKSB7XG4gICAgICAgICAgICAgICAgLy9jaGVjayBpZiB0aGlzIGZpZWxkIGlzIGEgbG9va3VwIGFuZCBnZXQgbGlzdCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmID0+IGYubmFtZSA9PT0gYXR0cmlidXRlKVxuICAgICAgICAgICAgICAgIGlmIChmaWVsZD8udHlwZSA9PT0gRmllbGRUeXBlLkxvb2t1cCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocHJldmlvdXNJdGVtc0NvdW50KVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBib3VuZHMgPSBnZXRMaXN0Qm91bmRzKHBsdWdpbiwgZmlsZSwgaSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdW5kcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSBib3VuZHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnQgKyAxOyBqIDwgc3RhcnQgKyBwcmV2aW91c0l0ZW1zQ291bnQgKyAxICYmIGogPCBlbmQgKyAxOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkTGluZXMucHVzaChqKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHsgaW5MaXN0LCBpblF1b3RlLCBzdGFydFN0eWxlLCBlbmRTdHlsZSwgYmVmb3JlU2VwYXJhdG9yU3BhY2VyLCBhZnRlclNlcGFyYXRvclNwYWNlciwgdmFsdWVzIH0gPSBmUi5ncm91cHNcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpLnNvcnQoKSA6IFtdO1xuICAgICAgICAgICAgICAgIGxldCBuZXdWYWx1ZTogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCBoaWRkZW5WYWx1ZSA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmllbGQ/LnR5cGUgPT09IEZpZWxkVHlwZS5Mb29rdXAgJiYgTG9va3VwLmJ1bGxldExpc3RMb29rdXBUeXBlcy5pbmNsdWRlcyhmaWVsZD8ub3B0aW9ucy5vdXRwdXRUeXBlIGFzIExvb2t1cC5UeXBlKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IGlucHV0QXJyYXkubGVuZ3RoID09IDEgPyBcIlxcbi0gXCIgKyBpbnB1dEFycmF5WzBdIDogYCR7aW5wdXRBcnJheS5sZW5ndGggPiAwID8gXCJcXG5cIiA6IFwiXCJ9JHtpbnB1dEFycmF5Lm1hcChpdGVtID0+IFwiLSBcIiArIGl0ZW0pLmpvaW4oJ1xcbicpfWA7XG4gICAgICAgICAgICAgICAgICAgIC8vIGhpZGUgdGhlIHZhbHVlcyBuZXh0IHRvIHRoZSBmaWVsZCBzbyB0aGF0IHRoZXkgYXJlIHJlYWRhYmxlIGJ5IGdldFZhbHVlcy4gXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgZ2V0VmFsdWVzIGluc3RlYWQgb2YgZHYucGFnZSB0byBoYXZlIHRoZSByYXdWYWx1ZSBiZWNhdXNlIGR2IGlzIHRyYW5zZm9ybWluZyBkYXRhLCBtYWtpbmcgY29tcGFyaXNvbiBpbXBvc3NpYmxlXG4gICAgICAgICAgICAgICAgICAgIGhpZGRlblZhbHVlID0gYDxkaXYgaGlkZGVuIGlkPVwiJHtmaWVsZC5uYW1lfV92YWx1ZXNcIj4ke2lucHV0fTwvZGl2PmBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IGlucHV0QXJyYXkubGVuZ3RoID09IDEgPyBpbnB1dEFycmF5WzBdIDogYCR7aW5wdXRBcnJheS5qb2luKCcsICcpfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgJHtpblF1b3RlIHx8IFwiXCJ9JHtpbkxpc3QgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHthdHRyaWJ1dGV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXJ9JHtoaWRkZW5WYWx1ZSArIG5ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkczogRmllbGRSZXBsYWNlW10gPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluU2VudGVuY2VSZWdleFBhciA9IG5ldyBSZWdFeHAoYFxcXFwoJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKC4uLm1hdGNoSW5saW5lRmllbGRzKGluU2VudGVuY2VSZWdleEJyYWNrZXRzLCBlbmNvZGVkTGluZSwgYXR0cmlidXRlLCBlbmNvZGVkSW5wdXQsIExvY2F0aW9uLmJyYWNrZXRzKSlcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5tYXRjaElubGluZUZpZWxkcyhpblNlbnRlbmNlUmVnZXhQYXIsIGVuY29kZWRMaW5lLCBhdHRyaWJ1dGUsIGVuY29kZWRJbnB1dCwgTG9jYXRpb24ucGFyZW50aGVzaXMpKVxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRSZWdleCA9IG5ldyBSZWdFeHAoZmllbGQub2xkRmllbGQucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKSwgXCJ1XCIpXG4gICAgICAgICAgICAgICAgICAgIGVuY29kZWRMaW5lID0gZW5jb2RlZExpbmUucmVwbGFjZShmaWVsZFJlZ2V4LCBmaWVsZC5uZXdGaWVsZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlTGluayhlbmNvZGVkTGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvL2NvbnNvbGUubG9nKFwic3RhcnRlZCB3cml0aW5nLi4uXCIsIGlucHV0KVxuICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuZmlsdGVyKChsaW5lLCBpKSA9PiAhc2tpcHBlZExpbmVzLmluY2x1ZGVzKGkpKS5qb2luKCdcXG4nKSk7XG4gICAgLy9jb25zb2xlLmxvZyhcImZpbmlzaGVkIHdyaXRpbmcuLi5cIiwgaW5wdXQpXG4gICAgY29uc3QgZWRpdG9yID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3JcbiAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZVxuICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogZWRpdG9yLmdldEN1cnNvcigpLmxpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShsaW5lTnVtYmVyKS5sZW5ndGggfSlcbiAgICB9XG59IiwgImV4cG9ydCBlbnVtIEJ1aWx0aW5TdW1tYXJpemluZyB7XG4gICAgXCJTdW1cIiA9IFwiU3VtXCIsXG4gICAgXCJDb3VudFwiID0gXCJDb3VudFwiLFxuICAgIFwiQ291bnRBbGxcIiA9IFwiQ291bnRBbGxcIixcbiAgICBcIkF2ZXJhZ2VcIiA9IFwiQXZlcmFnZVwiLFxuICAgIFwiTWF4XCIgPSBcIk1heFwiLFxuICAgIFwiTWluXCIgPSBcIk1pblwiXG59XG5cbmV4cG9ydCBjb25zdCBCdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbkRlc2NyaXB0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEJ1aWx0aW5TdW1tYXJpemluZywgc3RyaW5nPiA9IHtcbiAgICBcIlN1bVwiOiBcIlJldHVybnMgdGhlIHN1bSBvZiA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGZpZWxkcyBpbiB0aGUgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5XCIsXG4gICAgXCJDb3VudFwiOiBcIkNvdW50cyBhbGwgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5IHdoZXJlIDx7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fT4gaXMgbm9uIGVtcHR5XCIsXG4gICAgXCJDb3VudEFsbFwiOiBcIkNvdW50cyBhbGwgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5IChpbmNsdWRpbmcgZW1wdHkgZmllbGRzKVwiLFxuICAgIFwiQXZlcmFnZVwiOiBcIlJldHVybnMgdGhlIGF2ZXJhZ2UgdmFsdWUgb2YgPHt7c3VtbWFyaXplZEZpZWxkTmFtZX19PiBmaWVsZHMgaW4gdGhlIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeVwiLFxuICAgIFwiTWF4XCI6IFwiUmV0dXJucyB0aGUgbWF4aW11bSB2YWx1ZSBvZiA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGZpZWxkcyBpbiB0aGUgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5XCIsXG4gICAgXCJNaW5cIjogXCJSZXR1cm5zIHRoZSBtaW5pbXVtIHZhbHVlIG9mIDx7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fT4gZmllbGRzIGluIHRoZSBwYWdlcyBtYXRjaGluZyB0aGUgcXVlcnlcIixcbn1cblxuZXhwb3J0IGNvbnN0IEJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEJ1aWx0aW5TdW1tYXJpemluZywgc3RyaW5nPiA9IHtcbiAgICBcIlN1bVwiOiBcImNvbnN0IGk9MDtjb25zdCBzdW0gPSBwYWdlcy5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdLCBpKTsgcmV0dXJuIHN1bVwiLFxuICAgIFwiQ291bnRBbGxcIjogXCJyZXR1cm4gcGFnZXMubGVuZ3RoXCIsXG4gICAgXCJDb3VudFwiOiBcInJldHVybiBwYWdlcy5maWx0ZXIocCA9PiAhIXBbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0pLmxlbmd0aFwiLFxuICAgIFwiQXZlcmFnZVwiOiBcImNvbnN0IGk9MC4wO2NvbnN0IHN1bSA9IHBhZ2VzLnJlZHVjZSgocCwgYykgPT4gcCArIGNbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0sIGkpOyByZXR1cm4gc3VtIC8gcGFnZXMubGVuZ3RoXCIsXG4gICAgXCJNYXhcIjogXCJyZXR1cm4gcGFnZXMucmVkdWNlKChwLGMpID0+IHBbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0gPj0gY1tcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSA/IHAgOiBjKVtcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXVwiLFxuICAgIFwiTWluXCI6IFwicmV0dXJuIHBhZ2VzLnJlZHVjZSgocCxjKSA9PiBwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdIT09bnVsbCAmJiBwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdIDw9IGNbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0gPyBwIDogYylbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl1cIlxufVxuXG5leHBvcnQgZW51bSBUeXBlIHtcbiAgICBcIkxpbmtzTGlzdFwiID0gXCJMaW5rc0xpc3RcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiID0gXCJMaW5rc0J1bGxldExpc3RcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiID0gXCJCdWlsdGluU3VtbWFyaXppbmdcIixcbiAgICBcIkN1c3RvbUxpc3RcIiA9IFwiQ3VzdG9tTGlzdFwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiID0gXCJDdXN0b21CdWxsZXRMaXN0XCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiID0gXCJDdXN0b21TdW1tYXJpemluZ1wiXG59XG5cbmV4cG9ydCBjb25zdCBTaG9ydERlc2NyaXB0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJJbmxpbmUgbGlzdCBvZiBsaW5rc1wiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiQnVsbGV0IGxpc3Qgb2YgbGlua3NcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIlwiLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBcIklubGluZSBsaXN0IG9mIGN1c3RvbWl6ZWQgbGlua3NcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJCdWxsZXQgbGlzdCBvZiBjdXN0b21pemVkIGxpbmtzXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcIkN1c3RvbSBzdW1tYXJpemluZyBmdW5jdGlvblwiXG59XG5cbmV4cG9ydCBjb25zdCBNYXBwaW5nTGFiZWw6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgVHlwZT4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogVHlwZS5MaW5rc0xpc3QsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogVHlwZS5MaW5rc0J1bGxldExpc3QsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogVHlwZS5CdWlsdGluU3VtbWFyaXppbmcsXG4gICAgXCJDdXN0b21MaXN0XCI6IFR5cGUuQ3VzdG9tTGlzdCxcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogVHlwZS5DdXN0b21CdWxsZXRMaXN0LFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogVHlwZS5DdXN0b21TdW1tYXJpemluZ1xufVxuXG5leHBvcnQgY29uc3QgRGVzY3JpcHRpb246IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIkxpbmtzTGlzdFwiOiBcIkxpc3Qgb2YgcmVsYXRlZCBsaW5rcyBkaXNwbGF5ZWQgaW5saW5lXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJMaXN0IG9mIHJlbGF0ZWQgbGlua3MgZGlzcGxheWVkIGJlbG93IHRoZSBmaWVsZFwiLFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IFwiQnVpbHQtaW4gc3VtbWFyaXppbmcgZnVuY3Rpb25cIixcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJDdXN0b20gbGlzdCByZW5kZXJpbmcgZnVuY3Rpb24gZGlzcGxheWVkIGlubGluZVwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcIkN1c3RvbSBsaXN0IHJlbmRlcmluZyBmdW5jdGlvbiBkaXNwbGF5ZWQgYmVsb3cgdGhlIGZpZWxkXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcIkN1c3RvbSBzdW1tYXJpemluZyBmdW5jdGlvblwiXG59XG5cbmV4cG9ydCBjb25zdCBPcHRpb25MYWJlbDogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIkJ1aWx0LWluIHN1bW1hcml6ZSBmdW5jdGlvbjpcIixcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJRdWVyeSdzIHJlc3VsdHMnIGxpc3QncyByZW5kZXJpbmcgZnVuY3Rpb246XCIsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IFwiUXVlcnkncyByZXN1bHRzJyBsaXN0J3MgcmVuZGVyaW5nIGZ1bmN0aW9uOlwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJRdWVyeSdzIHJlc3VsdHMnIGxpc3QncyBzdW1tYXJpemluZyBmdW5jdGlvbjpcIlxufVxuXG5cbmV4cG9ydCBjb25zdCBPcHRpb25TdWJMYWJlbDogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIlwiLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWAsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YCxcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YFxufVxuXG5leHBvcnQgY29uc3QgSGVscGVyOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiOiBcIlwiLFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IFwiXCIsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwiSmF2YXNjcmlwdCBzdHJpbmcsIFwiICtcbiAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgXCJleGFtcGxlIDE6IHBhZ2UuZmlsZS5uYW1lXFxuZXhhbXBsZSAyOiBgJHtwYWdlLmZpbGUubmFtZX0gb2YgZ2VuZGVyICR7cGFnZS5nZW5kZXJ9YFwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcIkphdmFzY3JpcHQgc3RyaW5nLCBcIiArXG4gICAgICAgIFwidGhlIFxcXCJwYWdlXFxcIiAoZGF0YXZpZXcgcGFnZSB0eXBlKSB2YXJpYWJsZSBpcyBhdmFpbGFibGVcXG5cIiArXG4gICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIixcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IFwiSmF2YXNjcmlwdCBzdHJpbmcsIHRoZSBcXFwicGFnZXNcXFwiIChkYXRhdmlldyBwYWdlcyB0eXBlKSBcIiArXG4gICAgICAgIFwidmFyaWFibGUgaXMgYXZhaWxhYmxlXFxuZXhhbXBsZTogXCIgK1xuICAgICAgICBcIlxcbmNvbnN0IGluaXRpYWxWYWx1ZSA9IDA7XFxuY29uc3Qgc3VtV2l0aEluaXRpYWwgPSBwYWdlcy5yZWR1Y2UoXFxuXCIgK1xuICAgICAgICBcIiAgICAocHJldmlvdXNWYWx1ZSwgY3VycmVudFZhbHVlKSA9PiBwcmV2aW91c1ZhbHVlICsgY3VycmVudFZhbHVlLFxcblwiICtcbiAgICAgICAgXCIgICAgaW5pdGlhbFZhbHVlXFxuKTtcXG5yZXR1cm4gYCR7c3VtV2l0aEluaXRpYWx9YFxcblwiXG59XG5cbmV4cG9ydCBjb25zdCBEZWZhdWx0OiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiOiBcIlwiLFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IEJ1aWx0aW5TdW1tYXJpemluZy5Db3VudCxcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJwYWdlLmZpbGUubmFtZVwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcInBhZ2UuZmlsZS5uYW1lXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcInJldHVybiBwYWdlcy5sZW5ndGhcIlxufVxuXG5leHBvcnQgY29uc3QgYnVsbGV0TGlzdExvb2t1cFR5cGVzID0gW1xuICAgIFR5cGUuTGlua3NCdWxsZXRMaXN0LFxuICAgIFR5cGUuQ3VzdG9tQnVsbGV0TGlzdFxuXVxuXG5leHBvcnQgZW51bSBTdGF0dXMge1xuICAgIFwiY2hhbmdlZFwiID0gXCJjaGFuZ2VkXCIsXG4gICAgXCJ1cFRvRGF0ZVwiID0gXCJ1cFRvRGF0ZVwiXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IExpc3RJdGVtQ2FjaGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaXN0Qm91bmRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgcGFyZW50OiBudW1iZXIpOiB7IHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyIH0gfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IGxpc3RJdGVtczogTGlzdEl0ZW1DYWNoZVtdID0gKHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/Lmxpc3RJdGVtcyB8fCBbXSlcbiAgICByZXR1cm4gZ2V0TGlzdEJvdW5kc0Zyb21MaXN0SXRlbUNhY2hlTGlzdChsaXN0SXRlbXMsIHBhcmVudClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RCb3VuZHNGcm9tTGlzdEl0ZW1DYWNoZUxpc3QoXG4gICAgbGlzdEl0ZW1zOiBMaXN0SXRlbUNhY2hlW10sXG4gICAgcGFyZW50OiBudW1iZXJcbik6IHsgc3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIgfSB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3Qgc3ViUGFyZW50c0xpbmVzID0gWy1wYXJlbnQgLSAxXTtcbiAgICBsZXQgc3RhcnQ6IG51bWJlciA9IHBhcmVudDtcbiAgICBsZXQgZW5kOiBudW1iZXIgPSAtMTtcbiAgICBsZXQgb3V0T2ZMaXN0OiBib29sZWFuID0gZmFsc2U7XG4gICAgbGlzdEl0ZW1zXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLnBvc2l0aW9uLnN0YXJ0LmxpbmUgLSBiLnBvc2l0aW9uLnN0YXJ0LmxpbmUpXG4gICAgICAgIC5mb3JFYWNoKGxpc3RJdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChzdWJQYXJlbnRzTGluZXMuaW5jbHVkZXMobGlzdEl0ZW0ucGFyZW50KSAmJiAhb3V0T2ZMaXN0KSB7XG4gICAgICAgICAgICAgICAgc3ViUGFyZW50c0xpbmVzLnB1c2gobGlzdEl0ZW0ucG9zaXRpb24uc3RhcnQubGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID4gbGlzdEl0ZW0ucG9zaXRpb24uc3RhcnQubGluZSkgc3RhcnQgPSBsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lO1xuICAgICAgICAgICAgICAgIGlmIChlbmQgPD0gbGlzdEl0ZW0ucG9zaXRpb24uZW5kLmxpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RJdGVtLnBvc2l0aW9uLmVuZC5saW5lID09IGxpc3RJdGVtLnBvc2l0aW9uLnN0YXJ0LmxpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IGxpc3RJdGVtLnBvc2l0aW9uLmVuZC5saW5lO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gbGlzdEl0ZW0ucG9zaXRpb24uc3RhcnQubGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dE9mTGlzdCA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICBpZiAoZW5kID49IDApIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQgfSlcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCB9XG4gICAgfVxuICAgIHJldHVyblxufSIsICJleHBvcnQgY29uc3QgZmllbGRDb21wb25lbnRzID0gWydpblF1b3RlJywgJ2luTGlzdCcsICdzdGFydFN0eWxlJywgJ2F0dHJpYnV0ZScsICdlbmRTdHlsZScsICdiZWZvcmVTZXBhcmF0b3JTcGFjZXInLCAnYWZ0ZXJTZXBhcmF0b3JTcGFjZXInLCAndmFsdWVzJ11cblxuZXhwb3J0IGNvbnN0IGdlbmVyaWNGaWVsZFJlZ2V4ID0gXCIoPzxpblF1b3RlPlxcPihcXFxccyspPyk/KD88aW5MaXN0Pi0gKT8oPzxzdGFydFN0eWxlPltfXFxcXCp+YF0qKSg/PGF0dHJpYnV0ZT5bMC05XFxcXHdcXFxccHtMZXR0ZXJ9XFxcXHB7RW1vamlfUHJlc2VudGF0aW9ufV1bLTAtOVxcXFx3XFxcXHB7TGV0dGVyfVxcXFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1cXFxcc10qKSg/PGVuZFN0eWxlPltfXFxcXCp+YF0qKSg/PGJlZm9yZVNlcGFyYXRvclNwYWNlcj5cXFxccyopXCI7XG5cbmV4cG9ydCBjb25zdCBpbmxpbmVGaWVsZFJlZ2V4ID0gKGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBgKD88aW5RdW90ZT5cXD4oXFxcXHMrKT8pPyg/PGluTGlzdD4tICk/KD88c3RhcnRTdHlsZT5bX1xcXFwqflxcYF0qKSg/PGF0dHJpYnV0ZT4ke2F0dHJpYnV0ZX0pKD88ZW5kU3R5bGU+W19cXFxcKn5cXGBdKikoPzxiZWZvcmVTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKTo6KD88YWZ0ZXJTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKWA7XG5cbmV4cG9ydCBjb25zdCBmdWxsTGluZVJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjpcXFxccyooPzx2YWx1ZXM+LiopP2AsIFwidVwiKTtcblxuZXhwb3J0IGNvbnN0IGluU2VudGVuY2VSZWdleEJyYWNrZXRzID0gbmV3IFJlZ0V4cChgXFxcXFske2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxcXHMqKD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuXG5leHBvcnQgY29uc3QgaW5TZW50ZW5jZVJlZ2V4UGFyID0gbmV3IFJlZ0V4cChgXFxcXCgke2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxcXHMqKD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuXG5leHBvcnQgY29uc3QgZW5jb2RlTGluayA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICAvKiByZXBsYWNlIGxpbmsgYnJhY2tldHMgYnkgXCJpbXBvc3NpYmxlXCIgY29tYmluYXRpb24gb2YgY2hhcmFjdGVycyBzbyB0aGF0IHRoZXkgd29uJ3QgYmUgbWl4ZWQgdXAgd2l0aCBpblNlbnRlbmNlIGZpZWxkIGJyYWNrZXRzIHdoZW4gc2VhY2hpbmcgd2l0aCByZWdleCovXG4gICAgcmV0dXJuIHZhbHVlID8gdmFsdWVcbiAgICAgICAgLnJlcGxhY2UoL1xcW1xcWy9nLCBcIlx1RDgzRFx1REQyN1x1RDgzRFx1REMwMFwiKVxuICAgICAgICAucmVwbGFjZSgvXFxdXFxdL2csIFwiXHVEODNEXHVEQzEzXHVEODNEXHVERDRDXCIpIDogdmFsdWVcbn1cblxuZXhwb3J0IGNvbnN0IGRlY29kZUxpbmsgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgLyogcmVwbGFjZSBsaW5rIGJyYWNrZXRzIGJ5IFwiaW1wb3NzaWJsZVwiIGNvbWJpbmF0aW9uIG9mIGNoYXJhY3RlcnMgc28gdGhhdCB0aGV5IHdvbid0IGJlIG1peGVkIHVwIHdpdGggaW5TZW50ZW5jZSBmaWVsZCBicmFja2V0cyB3aGVuIHNlYWNoaW5nIHdpdGggcmVnZXgqL1xuICAgIHJldHVybiB2YWx1ZSA/IHZhbHVlXG4gICAgICAgIC5yZXBsYWNlKC9cdUQ4M0RcdUREMjdcdUQ4M0RcdURDMDAvZ3UsIFwiW1tcIilcbiAgICAgICAgLnJlcGxhY2UoL1x1RDgzRFx1REMxM1x1RDgzRFx1REQ0Qy9ndSwgXCJdXVwiKSA6IHZhbHVlXG59XG5cbmV4cG9ydCBjb25zdCBmcm9udE1hdHRlckxpbmVGaWVsZCA9IChsaW5lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICAgIGNvbnN0IGZyb250TWF0dGVyUmVnZXggPSBuZXcgUmVnRXhwKC8oPzxhdHRyaWJ1dGU+WzAtOVxcd1xccHtMZXR0ZXJ9XFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1dWy0wLTlcXHdcXHB7TGV0dGVyfVxccHtFbW9qaV9QcmVzZW50YXRpb259XFxzXSpbXlxcc10pKD88YmVmb3JlU2VwYXJhdG9yU3BhY2VyPlxccyopOig/PGFmdGVyU2VwYXJhdG9yU3BhY2VyPlxccyopKD88dmFsdWVzPi4qKS91KVxuICAgIGNvbnN0IGZSID0gbGluZS5tYXRjaChmcm9udE1hdHRlclJlZ2V4KTtcblxuICAgIGlmIChmUj8uZ3JvdXBzKSB7XG4gICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IGZSPy5ncm91cHNcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldExpbmVGaWVsZHMgPSAobGluZTogc3RyaW5nKTogeyBhdHRyaWJ1dGU6IHN0cmluZywgdmFsdWVzOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyIH1bXSA9PiB7XG4gICAgY29uc3QgZmllbGRzOiB7IGF0dHJpYnV0ZTogc3RyaW5nLCB2YWx1ZXM6IHN0cmluZywgaW5kZXg6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIgfVtdID0gW11cbiAgICBjb25zdCBmUiA9IGxpbmUubWF0Y2goZnVsbExpbmVSZWdleCk7XG4gICAgaWYgKGZSPy5ncm91cHMpIHtcbiAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gZlI/Lmdyb3Vwc1xuICAgICAgICBmaWVsZHMucHVzaCh7IGF0dHJpYnV0ZSwgdmFsdWVzLCBpbmRleDogMCwgbGVuZ3RoOiBsaW5lLmxlbmd0aCB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHNSQmsgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleEJyYWNrZXRzKTtcbiAgICAgICAgbGV0IG5leHQgPSBzUkJrLm5leHQoKTtcbiAgICAgICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3Vwcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IG5leHQudmFsdWUuZ3JvdXBzO1xuICAgICAgICAgICAgICAgIGZpZWxkcy5wdXNoKHsgYXR0cmlidXRlLCB2YWx1ZXM6IGRlY29kZUxpbmsodmFsdWVzKSwgaW5kZXg6IG5leHQudmFsdWUuaW5kZXggfHwgMCwgbGVuZ3RoOiBuZXh0LnZhbHVlWzBdLmxlbmd0aCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHQgPSBzUkJrLm5leHQoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzUkJjID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhQYXIpO1xuICAgICAgICBuZXh0ID0gc1JCYy5uZXh0KCk7XG4gICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBuZXh0LnZhbHVlLmdyb3VwcztcbiAgICAgICAgICAgICAgICBmaWVsZHMucHVzaCh7IGF0dHJpYnV0ZSwgdmFsdWVzOiBkZWNvZGVMaW5rKHZhbHVlcyksIGluZGV4OiBuZXh0LnZhbHVlLmluZGV4IHx8IDAsIGxlbmd0aDogbmV4dC52YWx1ZVswXS5sZW5ndGggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXh0ID0gc1JCYy5uZXh0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmllbGRzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgaWYgKGEuaW5kZXggPCBiLmluZGV4KSByZXR1cm4gLTE7XG4gICAgICAgIGlmIChhLmluZGV4ID4gYi5pbmRleCkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiAwXG4gICAgfSlcbiAgICByZXR1cm4gZmllbGRzXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRkNTTSBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IEluc2VydEZpZWxkU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2luc2VydEZpZWxkU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuL0ZpZWxkXCI7XG5cbmV4cG9ydCBjb25zdCBlbnVtIFNldHRpbmdMb2NhdGlvbiB7XG4gICAgXCJQbHVnaW5TZXR0aW5nc1wiLFxuICAgIFwiRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3NcIlxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRmllbGRNYW5hZ2VyIHtcblxuICAgIGFic3RyYWN0IGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IHZvaWQ7XG4gICAgYWJzdHJhY3QgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW47XG4gICAgYWJzdHJhY3QgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkO1xuICAgIGFic3RyYWN0IGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHtcbiAgICAgICAgICAgIGNscz86IHN0cmluZyxcbiAgICAgICAgICAgIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuICAgICAgICAgICAgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgICAgICAgfVxuICAgICk6IHZvaWRcbiAgICBhYnN0cmFjdCBnZXRPcHRpb25zU3RyKCk6IHN0cmluZztcbiAgICBhYnN0cmFjdCBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkO1xuICAgIHB1YmxpYyBzaG93TW9kYWxPcHRpb246IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LCBwdWJsaWMgZmllbGQ6IEZpZWxkLCBwdWJsaWMgdHlwZTogRmllbGRUeXBlKSB7XG4gICAgICAgIGlmIChmaWVsZC50eXBlICE9PSB0eXBlKSB0aHJvdyBFcnJvcihgVGhpcyBmaWVsZCBpcyBub3Qgb2YgdHlwZSAke3R5cGV9YClcbiAgICB9XG5cbiAgICBzdGF0aWMgYnVpbGRNYXJrRG93bkxpbmsocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBwYXRoOiBzdHJpbmcsIGFsaWFzPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZGVzdEZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZGVzdEZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKFxuICAgICAgICAgICAgICAgIGRlc3RGaWxlLFxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgYWxpYXMsXG4gICAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFwiXCJcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVOYW1lKHRleHRJbnB1dDogVGV4dENvbXBvbmVudCwgaW5zZXJ0QWZ0ZXI6IEVsZW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2U7XG4gICAgICAgIGlmICgvXlsjPi1dLy50ZXN0KHRoaXMuZmllbGQubmFtZSkpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGV4dElucHV0LCBpbnNlcnRBZnRlcixcbiAgICAgICAgICAgICAgICBcIkZpZWxkIG5hbWUgY2Fubm90IHN0YXJ0IHdpdGggIywgPiwgLVwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5maWVsZC5uYW1lID09IFwiXCIpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGV4dElucHV0LCBpbnNlcnRBZnRlcixcbiAgICAgICAgICAgICAgICBcIkZpZWxkIG5hbWUgY2FuIG5vdCBiZSBFbXB0eVwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gIWVycm9yXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHJlcGxhY2VWYWx1ZXMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHBhdGg6IHN0cmluZywgZmllbGROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyhwbHVnaW4sIGZpbGUsIGZpZWxkTmFtZSwgdmFsdWUpIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpc01lbnUobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIE1lbnUge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIE1lbnUpLmFkZEl0ZW0gIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBpc1N1Z2dlc3QobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIEZDU00ge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIEZDU00pLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIHN0cmluZykgPT09IFwiSW5zZXJ0RmllbGRDb21tYW5kXCI7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGQ1NNIHwgRmllbGRPcHRpb25zKTogbG9jYXRpb24gaXMgRmllbGRPcHRpb25zIHtcbiAgICAgICAgcmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZE9wdGlvbnMpLmFkZE9wdGlvbiAhPT0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlQW5kT3Blbk1vZGFsKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICBmaWVsZDogRmllbGQgfCB1bmRlZmluZWQsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBpbkZyb250bWF0dGVyPzogYm9vbGVhbixcbiAgICAgICAgYWZ0ZXI/OiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q/OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ/OiBib29sZWFuXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZNW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGUsIGZpZWxkTmFtZSwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBGaWVsZE1hbmFnZXIuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSEpO1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGUsIGZpZWxkTmFtZSEsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBvcGVuRmllbGRNb2RhbChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBmaWVsZE5hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ6IGJvb2xlYW5cbiAgICApIHtcbiAgICAgICAgaWYgKCFmaWVsZE5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEluc2VydEZpZWxkU3VnZ2VzdE1vZGFsKHBsdWdpbiwgZmlsZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIpO1xuICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBmaWVsZE5hbWUpXG4gICAgICAgICAgICBpZiAoZmllbGQpIHRoaXMuY3JlYXRlQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBmaWVsZCwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZURlZmF1bHQocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZyk6IEZpZWxkTWFuYWdlciB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gRmllbGQuY3JlYXRlRGVmYXVsdChuYW1lKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGTVtmaWVsZC50eXBlXShwbHVnaW4sIGZpZWxkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHN0cmluZ1RvQm9vbGVhbih2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB0b0Jvb2xlYW5WYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICBpZiAoaXNCb29sZWFuKHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmICgvdHJ1ZS9pLnRlc3QodmFsdWUpIHx8IC8xLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKC9mYWxzZS9pLnRlc3QodmFsdWUpIHx8IC8wLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRvQm9vbGVhblZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQgPSAoKSA9PiB7IH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IHZhbHVlVGV4dDogc3RyaW5nO1xuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdmFsdWVUZXh0ID0gXCJcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBudWxsOiB2YWx1ZVRleHQgPSBcIlwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZhbHNlOiB2YWx1ZVRleHQgPSBcImZhbHNlXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMDogdmFsdWVUZXh0ID0gXCIwXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHZhbHVlVGV4dCA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVUZXh0ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWVUZXh0IH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGdXp6eU1hdGNoLCBGdXp6eVN1Z2dlc3RNb2RhbCwgc2V0SWNvbiwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUsIEZpZWxkVHlwZVRhZ0NsYXNzIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgYWRkTmV3RmllbGRNb2RhbCBmcm9tIFwiLi9hZGROZXdGaWVsZE1vZGFsXCI7XG5cblxuaW50ZXJmYWNlIE9wdGlvbiB7XG4gICAgYWN0aW9uTGFiZWw6IHN0cmluZyxcbiAgICB0eXBlPzogRmllbGRUeXBlXG59XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5zZXJ0RmllbGRTdWdnZXN0TW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxPcHRpb24+IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuLFxuICAgICkgeyBzdXBlcihwbHVnaW4uYXBwKTsgfTtcblxuICAgIGdldEl0ZW1zKCk6IE9wdGlvbltdIHtcbiAgICAgICAgcmV0dXJuIFt7IGFjdGlvbkxhYmVsOiAnKytOZXcrKycgfV1cbiAgICAgICAgICAgIC5jb25jYXQodGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkc1xuICAgICAgICAgICAgICAgIC5nZXQodGhpcy5maWxlLnBhdGgpPy5tYXAoZmllbGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBhY3Rpb25MYWJlbDogZmllbGQubmFtZSwgdHlwZTogZmllbGQudHlwZSB9XG4gICAgICAgICAgICAgICAgfSkgfHwgW11cbiAgICAgICAgICAgICk7XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQoaXRlbTogT3B0aW9uKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYWN0aW9uTGFiZWw7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihpdGVtOiBGdXp6eU1hdGNoPE9wdGlvbj4sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWl0ZW1cIilcbiAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIgfSlcbiAgICAgICAgaXRlbS5pdGVtLnR5cGUgPyBzZXRJY29uKGljb25Db250YWluZXIsIEZpZWxkSWNvbltpdGVtLml0ZW0udHlwZV0pIDogc2V0SWNvbihpY29uQ29udGFpbmVyLCBcInBsdXMtd2l0aC1jaXJjbGVcIilcbiAgICAgICAgZWwuY3JlYXRlRGl2KHsgdGV4dDogaXRlbS5pdGVtLmFjdGlvbkxhYmVsLCBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtYWN0aW9uLWxhYmVsXCIgfSlcbiAgICAgICAgZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LXNwYWNlclwiIH0pXG4gICAgICAgIGlmIChpdGVtLml0ZW0udHlwZSkge1xuICAgICAgICAgICAgY29uc3QgdHlwZUNvbnRhaW5lciA9IGVsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgICAgICB0eXBlQ29udGFpbmVyLnNldEF0dHIoXCJjbGFzc1wiLCBgbWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW0taW5mby10eXBlICR7RmllbGRUeXBlVGFnQ2xhc3NbaXRlbS5pdGVtLnR5cGVdfWApXG4gICAgICAgICAgICB0eXBlQ29udGFpbmVyLnNldFRleHQoaXRlbS5pdGVtLnR5cGUpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNob29zZUl0ZW0oaXRlbTogT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmIChpdGVtLmFjdGlvbkxhYmVsID09PSBcIisrTmV3KytcIikge1xuICAgICAgICAgICAgY29uc3QgbmV3RmllbGRNb2RhbCA9IG5ldyBhZGROZXdGaWVsZE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuZmlsZSwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyKTtcbiAgICAgICAgICAgIG5ld0ZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gaXRlbS5hY3Rpb25MYWJlbClcbiAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICBmaWVsZE1hbmFnZXIuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwodGhpcy5maWxlLCBpdGVtLmFjdGlvbkxhYmVsLCBcIlwiLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlciwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgTW9kYWwsIFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBhZGROZXdGaWVsZE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW5cbiAgICApIHsgc3VwZXIocGx1Z2luLmFwcCkgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkluc2VydCBuZXcgZmllbGRcIik7XG4gICAgICAgIGNvbnN0IGFkZE5ld0ZpZWxkQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dENvbnRhaW5lciA9IGFkZE5ld0ZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgbmFtZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJGaWVsZCBOYW1lOiBcIik7XG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQobmFtZUlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgbmFtZUlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpXG4gICAgICAgIG5hbWVJbnB1dEVsLnNldFBsYWNlaG9sZGVyKFwiRmllbGQgbmFtZVwiKTtcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dENvbnRhaW5lciA9IGFkZE5ld0ZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdmFsdWVJbnB1dENvbnRhaW5lci5zZXRUZXh0KFwiRmllbGQgdmFsdWU6IFwiKTtcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQodmFsdWVJbnB1dENvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlSW5wdXRFbC5pbnB1dEVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1wcm9tcHQtaW5wdXRcIilcbiAgICAgICAgdmFsdWVJbnB1dEVsLnNldFBsYWNlaG9sZGVyKFwiRmllbGQgdmFsdWVcIik7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiAnbWV0YWRhdGEtbWVudS10ZXh0YXJlYS1idXR0b25zJ1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBuYW1lSW5wdXRFbC5nZXRWYWx1ZSgpLCB2YWx1ZUlucHV0RWwuZ2V0VmFsdWUoKSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG5cblxuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgTW9kYWwsIE5vdGljZSwgU2V0dGluZywgVGV4dENvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUsIEZpZWxkVHlwZUxhYmVsTWFwcGluZywgRmllbGRUeXBlVG9vbHRpcCB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZFNldHRpbmdzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSBuYW1lUHJvbXB0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgc2F2ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIGluaXRpYWxGaWVsZDogRmllbGQ7XG4gICAgcHJpdmF0ZSBuZXc6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGZpZWxkTWFuYWdlcjogRjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmdDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmc/OiBGaWVsZFNldHRpbmcsXG4gICAgICAgIGZpZWxkPzogRmllbGRcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbEZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgdGhpcy5uZXcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZDtcbiAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWVsZCwgdGhpcy5maWVsZClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBuZXdJZCA9IDE7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChwcm9wLmlkKSAmJiBwYXJzZUludChwcm9wLmlkKSA+PSBuZXdJZCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdJZCA9IHBhcnNlSW50KHByb3AuaWQpICsgMTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbEZpZWxkLmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWZpZWxkLXNldHRpbmctbW9kYWxcIilcbiAgICAgICAgaWYgKHRoaXMuZmllbGQubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgQWRkIGEgZmllbGQgYW5kIGRlZmluZSBvcHRpb25zYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHNldHRpbmdzIG9wdGlvbnMgZm9yICR7dGhpcy5maWVsZC5uYW1lfWApO1xuICAgICAgICB9O1xuICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUZvcm0oKTtcbiAgICB9O1xuXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpZWxkLCB0aGlzLmluaXRpYWxGaWVsZCk7XG4gICAgICAgIGlmICghdGhpcy5uZXcgJiYgdGhpcy5wYXJlbnRTZXR0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmcuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zYXZlZCkge1xuICAgICAgICAgICAgbmV3IEZpZWxkU2V0dGluZyh0aGlzLnBhcmVudFNldHRpbmdDb250YWluZXIsIHRoaXMuZmllbGQsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVuYW1lSW5wdXRDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3QgZmllbGROYW1lQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBmaWVsZE5hbWVDb250YWluZXJMYWJlbC5zZXRUZXh0KGBGaWVsZCBOYW1lOmApO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5maWVsZC5uYW1lO1xuICAgICAgICBpbnB1dC5zZXRWYWx1ZShuYW1lKTtcbiAgICAgICAgaW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJOYW1lIG9mIHRoZSBmaWVsZFwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHByZWRlZmluZWQgb3B0aW9ucyBmb3IgJHt0aGlzLmZpZWxkLm5hbWV9YCk7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVUeXBlU2VsZWN0b3JDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdG9yQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICB0eXBlU2VsZWN0b3JDb250YWluZXJMYWJlbC5zZXRUZXh0KGBGaWVsZCB0eXBlOmApO1xuICAgICAgICBjb25zdCBzZWxlY3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIE9iamVjdC5rZXlzKEZpZWxkVHlwZUxhYmVsTWFwcGluZykuZm9yRWFjaCgoZjoga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSkgPT4gc2VsZWN0LmFkZE9wdGlvbihmLCBGaWVsZFR5cGVUb29sdGlwW2ZdKSlcbiAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSkge1xuICAgICAgICAgICAgc2VsZWN0LnNldFZhbHVlKHRoaXMuZmllbGQudHlwZSlcbiAgICAgICAgfVxuICAgICAgICBzZWxlY3Qub25DaGFuZ2UoKHR5cGVMYWJlbDoga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSA9IHRoaXMubmFtZVByb21wdENvbXBvbmVudC5nZXRWYWx1ZSgpXG4gICAgICAgICAgICB0aGlzLmZpZWxkLnR5cGUgPSBGaWVsZFR5cGVMYWJlbE1hcHBpbmdbdHlwZUxhYmVsXTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkLnR5cGUgIT09IHRoaXMuaW5pdGlhbEZpZWxkLnR5cGUgJiZcbiAgICAgICAgICAgICAgICAhW3RoaXMuZmllbGQudHlwZSwgdGhpcy5pbml0aWFsRmllbGQudHlwZV0uZXZlcnkoZmllbGRUeXBlID0+XG4gICAgICAgICAgICAgICAgICAgIFtGaWVsZFR5cGUuTXVsdGksIEZpZWxkVHlwZS5TZWxlY3QsIEZpZWxkVHlwZS5DeWNsZV0uaW5jbHVkZXMoZmllbGRUeXBlKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyA9IHt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZSAodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLnJlbW92ZUNoaWxkKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLlBsdWdpblNldHRpbmdzKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlRm9ybSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWRpdlwiIH0pO1xuICAgICAgICBjb25zdCBtYWluRGl2ID0gZGl2LmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1mb3JtXCIgfSk7XG5cbiAgICAgICAgLyogU2VjdGlvbnMgKi9cbiAgICAgICAgY29uc3QgbmFtZUNvbnRhaW5lciA9IG1haW5EaXYuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMubmFtZVByb21wdENvbXBvbmVudCA9IHRoaXMuY3JlYXRlbmFtZUlucHV0Q29udGFpbmVyKG5hbWVDb250YWluZXIpO1xuICAgICAgICBtYWluRGl2LmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpXG4gICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKVxuXG4gICAgICAgIC8qIGZvb3RlciBidXR0b25zKi9cbiAgICAgICAgY29uc3QgZm9vdGVyRWwgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgZm9vdGVyQnV0dG9ucyA9IG5ldyBTZXR0aW5nKGZvb3RlckVsKTtcbiAgICAgICAgZm9vdGVyQnV0dG9ucy5hZGRCdXR0b24oKGIpID0+IHRoaXMuY3JlYXRlU2F2ZUJ1dHRvbihiKSk7XG4gICAgICAgIGZvb3RlckJ1dHRvbnMuYWRkRXh0cmFCdXR0b24oKGIpID0+IHRoaXMuY3JlYXRlQ2FuY2VsQnV0dG9uKGIpKTtcblxuICAgICAgICAvKiBpbml0IHN0YXRlICovXG4gICAgICAgIHRoaXMuY3JlYXRlVHlwZVNlbGVjdG9yQ29udGFpbmVyKHR5cGVTZWxlY3RDb250YWluZXIpXG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uUGx1Z2luU2V0dGluZ3MpXG4gICAgfTtcblxuICAgIHByaXZhdGUgdmFsaWRhdGVGaWVsZHMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU5hbWUoXG4gICAgICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQsXG4gICAgICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQuaW5wdXRFbFxuICAgICAgICApICYmXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU9wdGlvbnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVNhdmVCdXR0b24oYjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50IHtcbiAgICAgICAgYi5zZXRUb29sdGlwKFwiU2F2ZVwiKTtcbiAgICAgICAgYi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBiLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGVycm9yID0gIXRoaXMudmFsaWRhdGVGaWVsZHMoKTtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGaXggZXJyb3JzIGJlZm9yZSBzYXZpbmcuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNhdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpZWxkID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKVswXTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eShjdXJyZW50RXhpc3RpbmdGaWVsZCwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2godGhpcy5maWVsZCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50U2V0dGluZykgRmllbGQuY29weVByb3BlcnR5KHRoaXMucGFyZW50U2V0dGluZy5maWVsZCwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmc/LnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVDYW5jZWxCdXR0b24oYjogRXh0cmFCdXR0b25Db21wb25lbnQpOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCB7XG4gICAgICAgIGIuc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcChcIkNhbmNlbFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvKiByZXNldCBvcHRpb25zIGZyb20gc2V0dGluZ3MgKi9cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsRmllbGQubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH07XG5cbiAgICAvKiB1dGlscyBmdW5jdGlvbnMgKi9cblxuICAgIHB1YmxpYyBzdGF0aWMgc2V0VmFsaWRhdGlvbkVycm9yKHRleHRJbnB1dDogVGV4dENvbXBvbmVudCwgaW5zZXJ0QWZ0ZXI6IEVsZW1lbnQsIG1lc3NhZ2U/OiBzdHJpbmcpIHtcbiAgICAgICAgdGV4dElucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJpcy1pbnZhbGlkXCIpO1xuICAgICAgICBpZiAobWVzc2FnZSAmJiB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG5cbiAgICAgICAgICAgIGxldCBtRGl2ID0gdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgIFwiLmludmFsaWQtZmVlZGJhY2tcIlxuICAgICAgICAgICAgKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgICAgICAgICAgaWYgKCFtRGl2KSB7XG4gICAgICAgICAgICAgICAgbURpdiA9IGNyZWF0ZURpdih7IGNsczogXCJpbnZhbGlkLWZlZWRiYWNrXCIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtRGl2LmlubmVyVGV4dCA9IG1lc3NhZ2U7XG4gICAgICAgICAgICBtRGl2Lmluc2VydEFmdGVyKGluc2VydEFmdGVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIHJlbW92ZVZhbGlkYXRpb25FcnJvcih0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQgfCBUZXh0QXJlYUNvbXBvbmVudCkge1xuICAgICAgICBpZiAodGV4dElucHV0LmlucHV0RWwuaGFzQ2xhc3MoXCJpcy1pbnZhbGlkXCIpICYmIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChcbiAgICAgICAgICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGRcbiAgICAgICAgICAgICk7XG4gICAgICAgIH07XG4gICAgfTtcbn07IiwgImltcG9ydCB7IFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlVGFnQ2xhc3MgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkU2V0dGluZyBleHRlbmRzIFNldHRpbmcge1xuICAgIHByaXZhdGUgZmllbGROYW1lQ29udGFpbmVyOiBIVE1MU3BhbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSB0eXBlQ29udGFpbmVyOiBIVE1MU3BhbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBmaWVsZE9wdGlvbnNDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICAgICAgcHVibGljIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudVxuICAgICkge1xuICAgICAgICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcbiAgICB9O1xuXG4gICAgcHVibGljIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG5cbiAgICAgICAgY29uc3QgbWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCkgYXMgRjtcbiAgICAgICAgdGhpcy5pbmZvRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB0aGlzLmluZm9FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtXCIpXG4gICAgICAgIHRoaXMuZmllbGROYW1lQ29udGFpbmVyID0gdGhpcy5pbmZvRWwuY3JlYXRlRWwoXCJkaXZcIiwgXCJtZXRhZGF0YS1tZW51LXNldHRpbmctaXRlbS1uYW1lXCIpXG4gICAgICAgIHRoaXMuZmllbGROYW1lQ29udGFpbmVyLnNldFRleHQodGhpcy5maWVsZC5uYW1lKVxuICAgICAgICB0aGlzLnR5cGVDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiKVxuICAgICAgICB0aGlzLnR5cGVDb250YWluZXIuc2V0QXR0cihcImNsYXNzXCIsIGBtZXRhZGF0YS1tZW51LXNldHRpbmctaXRlbS1pbmZvLXR5cGUgJHtGaWVsZFR5cGVUYWdDbGFzc1t0aGlzLmZpZWxkLnR5cGVdfWApXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lci5zZXRUZXh0KHRoaXMuZmllbGQudHlwZSlcbiAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiKVxuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5zZXRUZXh0KGAke21hbmFnZXIuZ2V0T3B0aW9uc1N0cigpfWApXG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRWRpdFwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5jb250YWluZXJFbCwgdGhpcywgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRGVsZXRlQnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkRlbGV0ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nUHJvcGVydHkgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maWx0ZXIocCA9PiBwLmlkID09IHRoaXMuZmllbGQuaWQpWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnJlbW92ZShjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ0VsLnBhcmVudEVsZW1lbnQ/LnJlbW92ZUNoaWxkKHRoaXMuc2V0dGluZ0VsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldFZhbHVlc0xpc3RGcm9tTm90ZShwbHVnaW46IE1ldGFkYXRhTWVudSwgbm90ZVBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgbGV0IHZhbHVlczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZVBhdGgpO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgICAgICByZXN1bHQuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKC9eKC4qKSQvLnRlc3QobGluZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gobGluZS50cmltKCkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH07XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1vZGFsLCBUb2dnbGVDb21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm9vbGVhbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIHZhbHVlOiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250bWF0dGVyO1xuICAgICAgICB0aGlzLmFmdGVyID0gYWZ0ZXI7XG4gICAgICAgIHRoaXMuYXNMaXN0ID0gYXNMaXN0O1xuICAgICAgICB0aGlzLmFzQ29tbWVudCA9IGFzQ29tbWVudDtcbiAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkXG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdG9nZ2xlclwiXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkVG9nZ2xlRWwoaW5wdXREaXYpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGJ1aWxkVG9nZ2xlRWwoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRvZ2dsZUVsID0gbmV3IFRvZ2dsZUNvbXBvbmVudChpbnB1dERpdik7XG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3Rlcik7XG4gICAgICAgIHRvZ2dsZUVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICB0b2dnbGVFbC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICBzYXZlQnV0dG9uLmJ1dHRvbkVsLmZvY3VzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZS50b1N0cmluZygpXG4gICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIlxuaW1wb3J0IEJvb2xlYW5Nb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvQm9vbGVhbk1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkSWNvbiB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb29sZWFuRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuQm9vbGVhbik7XG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2VcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSk7XG4gICAgICAgIGNvbnN0IGljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5Cb29sZWFuXVxuICAgICAgICBjb25zdCBhY3Rpb24gPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIG5hbWUsICghYlZhbHVlKS50b1N0cmluZygpKSB9KVxuICAgICAgICBpZiAoQm9vbGVhbkZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gJHtiVmFsdWUgPyBcIlx1MjcwNSBcdTI1QjcgXHUyNzRDXCIgOiBcIlx1Mjc0QyBcdTI1QjcgXHUyNzA1XCJ9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKGljb25OYW1lKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj48Yj4ke25hbWV9PC9iPiAke2JWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBpY29uTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFxuICAgICAgICAgICAgICAgIGJWYWx1ZSA/IFwieC1zcXVhcmVcIiA6IFwiY2hlY2stc3F1YXJlXCIsXG4gICAgICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgICAgIGJWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIik7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIC8vbm8gbmVlZCBvZiBzZXR0aW5ncyBmb3IgYm9vbGVhbiBmaWVsZFxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGJWYWx1ZSA9IEJvb2xlYW5GaWVsZC5zdHJpbmdUb0Jvb2xlYW4odmFsdWUpXG4gICAgICAgICAgICByZXR1cm4gaXNCb29sZWFuKGJWYWx1ZSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgLy9hbHdheXMgdHJ1ZSBzaW5jZSB0aGVyZSBhcmUgbm8gb3B0aW9uc1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSB8fCBcImZhbHNlXCIpO1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IEJvb2xlYW5Nb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgYlZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZXQgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQgPSBkdi5lbChcImlucHV0XCIsIFwiXCIsIHsgLi4uYXR0cnMsIFwidHlwZVwiOiBcImNoZWNrYm94XCIgfSlcbiAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChjaGVja2JveClcbiAgICAgICAgY2hlY2tib3gub25jaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIEJvb2xlYW5GaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBjaGVja2JveC5jaGVja2VkLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgTnVtYmVyTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL051bWJlck1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTnVtYmVyRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBudW1iZXJWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJTdGVwVmFsdWU6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJNaW5WYWx1ZTogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIG51bWJlck1heFZhbHVlOiBUZXh0Q29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTnVtYmVyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBvcHRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpLmZvckVhY2goKGspID0+IHsgaWYgKHRoaXMuZmllbGQub3B0aW9uc1trXSkgb3B0aW9ucy5wdXNoKGAke2t9OiAke3RoaXMuZmllbGQub3B0aW9uc1trXX1gKSB9KVxuICAgICAgICByZXR1cm4gb3B0aW9ucy5qb2luKFwiIHwgXCIpXG4gICAgfVxuXG4gICAgcHVibGljIGNhbkRlY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWluIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1pbiA9IHBhcnNlRmxvYXQobWluKTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWluKSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSAtIGZTdGVwIDwgZk1pbiB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSAtIDEgPCBmTWluXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIGNhbkluY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWF4KSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIGZTdGVwID4gZk1heCB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIDEgPiBmTWF4XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbik7XG4gICAgICAgIGNvbnN0IGZNYXggPSBwYXJzZUZsb2F0KG1heCk7XG4gICAgICAgIGNvbnN0IGZWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgIWlzTmFOKGZWYWx1ZSkgJiYgKGlzTmFOKGZNaW4pIHx8IGZWYWx1ZSA+PSBmTWluKSAmJiAoaXNOYU4oZk1heCkgfHwgZlZhbHVlIDw9IGZNYXgpXG4gICAgICAgIClcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgTnVtYmVyTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4LCBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbilcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KVxuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgY29uc3QgZlZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSlcbiAgICAgICAgY29uc3QgY2FuRGVjcmVhc2UgPSAhaXNOYU4oZk1pbikgJiYgZlZhbHVlIC0gZlN0ZXAgPj0gZk1pbjtcbiAgICAgICAgY29uc3QgY2FuSW5jcmVhc2UgPSAhaXNOYU4oZk1heCkgJiYgZlZhbHVlICsgZlN0ZXAgPD0gZk1heDtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGNvbnN0IGRlY3JlYXNlID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCBuYW1lLCAoZlZhbHVlIC0gZlN0ZXApLnRvU3RyaW5nKCkpIH0pO1xuICAgICAgICBjb25zdCBpbmNyZWFzZSA9IGFzeW5jICgpID0+IGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgKGZWYWx1ZSArIGZTdGVwKS50b1N0cmluZygpKSB9KTtcbiAgICAgICAgaWYgKE51bWJlckZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTnVtYmVyXSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpZiAoZlN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuRGVjcmVhc2UpXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcIm1pbnVzLXNxdWFyZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYDwke25hbWV9PiBcdTIxOThcdUZFMEYgJHtmVmFsdWUgLSBmU3RlcH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhkZWNyZWFzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpZiAoY2FuSW5jcmVhc2UpXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcInBsdXMtc3F1YXJlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgPCR7bmFtZX0+IFx1MjE5N1x1RkUwRiAke2ZWYWx1ZSArIGZTdGVwfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGluY3JlYXNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKE51bWJlckZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE51bWJlckZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgaWYgKHN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuRGVjcmVhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFwibWludXMtc3F1YXJlXCIsIGRlY3JlYXNlLCBgRGVjcmVhc2UgJHtuYW1lfSBieSAke3N0ZXB9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYW5JbmNyZWFzZSkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oXCJwbHVzLXNxdWFyZVwiLCBpbmNyZWFzZSwgYEluY3JlYXNlICR7bmFtZX0gYnkgJHtzdGVwfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl0sIGFjdGlvbiwgYFVwZGF0ZSAke25hbWV9J3MgdmFsdWVgKVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZU51bWJlckNvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbnVtYmVyU3RlcFZhbHVlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU3RlcCAob3B0aW9uYWwpXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KVxuICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lcilcbiAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnN0ZXAgfHwgXCJcIilcblxuICAgICAgICBjb25zdCBudW1iZXJNaW5WYWx1ZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbnVtYmVyTWluVmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJNaW4gdmFsdWUgKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlck1pblZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5taW4gfHwgXCJcIilcblxuICAgICAgICBjb25zdCBudW1iZXJNYXhWYWx1ZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbnVtYmVyTWF4VmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJNYXggdmFsdWUgKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlck1heFZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5tYXggfHwgXCJcIilcbiAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnN0ZXAgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5udW1iZXJTdGVwVmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5taW4gPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5udW1iZXJNaW5WYWx1ZSk7XG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLm1heCA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcih0aGlzLm51bWJlck1heFZhbHVlKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSk6IHZvaWQge1xuICAgICAgICB0aGlzLm51bWJlclZhbGlkYXRvckZpZWxkID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW51bWJlci1vcHRpb25zXCIgfSlcbiAgICAgICAgdGhpcy5jcmVhdGVOdW1iZXJDb250YWluZXIodGhpcy5udW1iZXJWYWxpZGF0b3JGaWVsZClcbiAgICAgICAgdGhpcy5udW1iZXJWYWxpZGF0b3JGaWVsZC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLnN0ZXAgJiYgaXNOYU4ocGFyc2VGbG9hdCh0aGlzLmZpZWxkLm9wdGlvbnMuc3RlcCkpKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlLCB0aGlzLm51bWJlclN0ZXBWYWx1ZS5pbnB1dEVsLFxuICAgICAgICAgICAgICAgIFwiVmFsdWVzIG11c3QgYmUgbnVtZXJpYy5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLm1pbiAmJiBpc05hTihwYXJzZUZsb2F0KHRoaXMuZmllbGQub3B0aW9ucy5taW4pKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLCB0aGlzLm51bWJlck1pblZhbHVlLmlucHV0RWwsXG4gICAgICAgICAgICAgICAgXCJWYWx1ZXMgbXVzdCBiZSBudW1lcmljLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMubWF4ICYmIGlzTmFOKHBhcnNlRmxvYXQodGhpcy5maWVsZC5vcHRpb25zLm1heCkpKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUsIHRoaXMubnVtYmVyTWF4VmFsdWUuaW5wdXRFbCxcbiAgICAgICAgICAgICAgICBcIlZhbHVlcyBtdXN0IGJlIG51bWVyaWMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFlcnJvclxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBOdW1iZXJNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUgfHwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdG46IEhUTUxCdXR0b25FbGVtZW50LCBpbmNyZW1lbnRCdG46IEhUTUxCdXR0b25FbGVtZW50LCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbkRlY3JlbWVudCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ0bi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jYW5JbmNyZW1lbnQodmFsdWUpKSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdG4uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IHZvaWQge1xuXG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICAgIGlucHV0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtaW5wdXRcIik7XG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSBwW3RoaXMuZmllbGQubmFtZV07XG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3QgdHJpcGxlU3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdHJpcGxlU3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtdHJpcGxlLXNwYWNlclwiKTtcblxuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgICAgICBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbihlZGl0QnV0dG9uLCBGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl0pO1xuICAgICAgICBlZGl0QnV0dG9uLnNldEF0dHIoJ2NsYXNzJywgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcblxuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGRlY3JlbWVudEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oZGVjcmVtZW50QnV0dG9uLCBcImxlZnQtYXJyb3dcIik7XG4gICAgICAgIGRlY3JlbWVudEJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG5cblxuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgICAgICBjb25zdCBpbmNyZW1lbnRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGluY3JlbWVudEJ1dHRvbiwgXCJyaWdodC1hcnJvd1wiKVxuICAgICAgICBpbmNyZW1lbnRCdXR0b24uc2V0QXR0cignY2xhc3MnLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBlZGl0QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgdHJpcGxlU3BhY2VyLnNob3coKTtcblxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZWRpdEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgZGVjcmVtZW50QnV0dG9uLnNob3coKTtcbiAgICAgICAgICAgICAgICBpbmNyZW1lbnRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgICAgIHRyaXBsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB0cmlwbGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmFsaWRhdGVJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcbiAgICAgICAgc2V0SWNvbih2YWxpZGF0ZUljb24sIFwiY2hlY2ttYXJrXCIpXG4gICAgICAgIHZhbGlkYXRlSWNvbi5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICB2YWxpZGF0ZUljb24ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0LnZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIGlucHV0LnZhbHVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodmFsaWRhdGVJY29uKVxuICAgICAgICBjb25zdCBjYW5jZWxJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcbiAgICAgICAgY2FuY2VsSWNvbi5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKGNhbmNlbEljb24sIFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGNhbmNlbEljb24pO1xuICAgICAgICBpbnB1dC5mb2N1cygpO1xuXG4gICAgICAgIGlucHV0Lm9ua2V5dXAgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuYWRkQ2xhc3MoJ2lzLWludmFsaWQnKTtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUljb24uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0LnJlbW92ZUNsYXNzKCdpcy1pbnZhbGlkJyk7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVJY29uLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaW5wdXQub25rZXlkb3duID0gYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVWYWx1ZShpbnB1dC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0LnZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBpbnB1dC52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5jcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGVkaXRCdXR0b24gb24gY2xpY2sgOiByZW1vdmUgYnV0dG9uIGFuZCBmaWVsZCBhbmQgZGlzcGxheSBpbnB1dCBmaWVsZCovXG4gICAgICAgIGVkaXRCdXR0b24ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5jcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHRyaXBsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgICAgICBpbnB1dC5mb2N1cygpXG4gICAgICAgIH1cblxuICAgICAgICAvKiBkZWNyZW1lbnQgYnV0dG9uIG9uIGNsaWNrOiBkZWNyZW1lbnQgYnkgc3RlcCBvciBieSAxICovXG4gICAgICAgIGRlY3JlbWVudEJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuRGVjcmVtZW50KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAoISFmU3RlcCA/IHBbdGhpcy5maWVsZC5uYW1lXSAtIGZTdGVwIDogcFt0aGlzLmZpZWxkLm5hbWVdIC0gMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbmNyZW1lbnQgYnV0dG9uIG9uIGNsaWNrOiBpbmNyZW1lbnQgYnkgc3RlcCBvciBieSAxICovXG4gICAgICAgIGluY3JlbWVudEJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuSW5jcmVtZW50KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAoISFmU3RlcCA/IHBbdGhpcy5maWVsZC5uYW1lXSArIGZTdGVwIDogcFt0aGlzLmZpZWxkLm5hbWVdICsgMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5jcmVtZW50QnV0dG9uKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodHJpcGxlU3BhY2VyKTtcbiAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIHBbdGhpcy5maWVsZC5uYW1lXSk7XG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNb2RhbCwgVGV4dENvbXBvbmVudCwgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IE51bWJlckZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTnVtYmVyRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOdW1iZXJNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgZmllbGRNYW5hZ2VyOiBOdW1iZXJGaWVsZDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCBpbnB1dERpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmJ1aWxkSW5wdXRFbChpbnB1dERpdik7XG4gICAgfTtcblxuICAgIHByaXZhdGUgZGVjcmVtZW50KGlucHV0RWw6IFRleHRDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgaWYgKCFpc05hTihmU3RlcCkpIHtcbiAgICAgICAgICAgIGlucHV0RWwuc2V0VmFsdWUoKHBhcnNlRmxvYXQoaW5wdXRFbC5nZXRWYWx1ZSgpKSAtIGZTdGVwKS50b1N0cmluZygpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0RWwuc2V0VmFsdWUoKHBhcnNlRmxvYXQoaW5wdXRFbC5nZXRWYWx1ZSgpKSAtIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbmNyZW1lbnQoaW5wdXRFbDogVGV4dENvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgaWYgKCFpc05hTihmU3RlcCkpIHtcbiAgICAgICAgICAgIGlucHV0RWwuc2V0VmFsdWUoKHBhcnNlRmxvYXQoaW5wdXRFbC5nZXRWYWx1ZSgpKSArIGZTdGVwKS50b1N0cmluZygpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0RWwuc2V0VmFsdWUoKHBhcnNlRmxvYXQoaW5wdXRFbC5nZXRWYWx1ZSgpKSArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB0b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG46IEJ1dHRvbkNvbXBvbmVudCwgcGx1c0J0bjogQnV0dG9uQ29tcG9uZW50LCBpbnB1dEVsOiBUZXh0Q29tcG9uZW50KTogdm9pZCB7XG4gICAgICAgIG1pbnVzQnRuLnNldERpc2FibGVkKCF0aGlzLmZpZWxkTWFuYWdlci5jYW5EZWNyZW1lbnQoaW5wdXRFbC5nZXRWYWx1ZSgpKSk7XG4gICAgICAgIHBsdXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGRNYW5hZ2VyLmNhbkRlY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKSB7XG4gICAgICAgICAgICBtaW51c0J0bi5zZXRDdGEoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1pbnVzQnRuLnJlbW92ZUN0YSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpZWxkTWFuYWdlci5jYW5JbmNyZW1lbnQoaW5wdXRFbC5nZXRWYWx1ZSgpKSkge1xuICAgICAgICAgICAgcGx1c0J0bi5zZXRDdGEoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBsdXNCdG4ucmVtb3ZlQ3RhKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkSW5wdXRFbChpbnB1dERpdjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnNcblxuICAgICAgICBjb25zdCBmb3JtID0gaW5wdXREaXYuY3JlYXRlRWwoXCJmb3JtXCIpO1xuICAgICAgICBmb3JtLnR5cGUgPSBcInN1Ym1pdFwiO1xuXG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gZm9ybS5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlLXdpdGgtYnRuXCIgfSlcblxuICAgICAgICBjb25zdCBpbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBpbnB1dEVsLmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZShgJHt0aGlzLnZhbHVlfWApO1xuXG4gICAgICAgIGNvbnN0IG1pbnVzQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZENvbnRhaW5lcik7XG4gICAgICAgIG1pbnVzQnRuLnNldEJ1dHRvblRleHQoYC0gJHshIXN0ZXAgPyBzdGVwIDogMX1gKTtcbiAgICAgICAgbWludXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkRlY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKTtcblxuICAgICAgICBjb25zdCBwbHVzQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZENvbnRhaW5lcik7XG4gICAgICAgIHBsdXNCdG4uc2V0QnV0dG9uVGV4dChgKyAkeyEhc3RlcCA/IHN0ZXAgOiAxfWApO1xuICAgICAgICBwbHVzQnRuLnNldERpc2FibGVkKCF0aGlzLmZpZWxkTWFuYWdlci5jYW5JbmNyZW1lbnQoaW5wdXRFbC5nZXRWYWx1ZSgpKSk7XG5cbiAgICAgICAgY29uc3QgZXJyb3JGaWVsZCA9IGZvcm0uY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZS13aXRoLWJ0bi1lcnJvci1maWVsZFwiIH0pXG4gICAgICAgIGVycm9yRmllbGQuaGlkZSgpXG5cbiAgICAgICAgY29uc3QgZm9vdGVyID0gZm9ybS5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSlcblxuICAgICAgICBjb25zdCB2YWxpZGF0ZUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgdmFsaWRhdGVCdG4uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcblxuICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3Rlcik7XG4gICAgICAgIGNhbmNlbEJ0bi5zZXRJY29uKFwiY3Jvc3NcIik7XG5cblxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0biwgcGx1c0J0biwgaW5wdXRFbCk7XG5cbiAgICAgICAgLy9ldmVudCBoYW5kbGVyc1xuICAgICAgICBpbnB1dEVsLm9uQ2hhbmdlKCgpID0+IHtcbiAgICAgICAgICAgIGlucHV0RWwuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgIGVycm9yRmllbGQuaGlkZSgpO1xuICAgICAgICAgICAgZXJyb3JGaWVsZC5zZXRUZXh0KFwiXCIpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIGlucHV0RWwpXG4gICAgICAgIH0pXG5cbiAgICAgICAgcGx1c0J0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmluY3JlbWVudChpbnB1dEVsKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBpbnB1dEVsKTtcbiAgICAgICAgfSlcblxuICAgICAgICBtaW51c0J0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmRlY3JlbWVudChpbnB1dEVsKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBpbnB1dEVsKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjYW5jZWxCdG4ub25DbGljaygoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH0pXG5cbiAgICAgICAgZm9ybS5vbnN1Ym1pdCA9IGFzeW5jIChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbGV0IGlucHV0VmFsdWUgPSBpbnB1dEVsLmdldFZhbHVlKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUoaW5wdXRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnNcbiAgICAgICAgICAgICAgICBlcnJvckZpZWxkLnNob3coKTtcbiAgICAgICAgICAgICAgICBlcnJvckZpZWxkLnNldFRleHQoYHZhbHVlIG11c3QgYmUgbnVtZXJpYyR7bWluID8gXCIgYW5kID49IFwiICsgbWluIDogXCJcIn0gJHttYXggPyBcIiBhbmQgPD0gXCIgKyBtYXggOiBcIlwifWApXG4gICAgICAgICAgICAgICAgaW5wdXRFbC5pbnB1dEVsLnNldEF0dHIoXCJjbGFzc1wiLCBcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0VmFsdWUpIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL1NlbGVjdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcIi4vQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VsZWN0RmllbGQgZXh0ZW5kcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIHtcblxuICAgIHZhbHVlc1Byb21wdENvbXBvbmVudHM6IEFycmF5PFRleHRDb21wb25lbnQ+ID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5TZWxlY3QpXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB2YWx1ZSwgdGhpcy5maWVsZCk7XG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZVwiKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChTZWxlY3RGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlICR7bmFtZX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5TZWxlY3RdKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKFNlbGVjdEZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLlNlbGVjdF1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKFNlbGVjdEZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdmFsdWUgfHwgXCJcIiwgdGhpcy5maWVsZCwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCBvcHRpb24gZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpOztcbiAgICAgICAgY29uc3QgdmFsdWVMYWJlbCA9IGR2LmVsKFwic3BhblwiLCBwW3RoaXMuZmllbGQubmFtZV0gfHwgXCJcIik7XG4gICAgICAgIHZhbHVlQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlTGFiZWwpO1xuICAgICAgICBjb25zdCBkcm9wRG93bkJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oZHJvcERvd25CdXR0b24sIFwiZG93bi1jaGV2cm9uLWdseXBoXCIpO1xuICAgICAgICBkcm9wRG93bkJ1dHRvbi5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZChkcm9wRG93bkJ1dHRvbik7XG5cblxuICAgICAgICBjb25zdCBzZWxlY3RDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3Quc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1zZWxlY3RcIik7XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxlY3QpO1xuICAgICAgICBjb25zdCBkaXNtaXNzQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbihkaXNtaXNzQnRuLCBcImNyb3NzXCIpO1xuICAgICAgICBkaXNtaXNzQnRuLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChkaXNtaXNzQnRuKTtcbiAgICAgICAgY29uc3QgbnVsbE9wdGlvbiA9IG5ldyBPcHRpb24oXCItLXNlbGVjdC0tXCIsIHVuZGVmaW5lZCk7XG4gICAgICAgIHNlbGVjdC5hZGQobnVsbE9wdGlvbik7XG5cbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5nZXRPcHRpb25zTGlzdCgpO1xuICAgICAgICB2YWx1ZXMuZm9yRWFjaCh2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV3IE9wdGlvbih2LCB2KVxuICAgICAgICAgICAgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSA9PT0gdiB8fFxuICAgICAgICAgICAgICAgIHBbdGhpcy5maWVsZC5uYW1lXSAmJlxuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBbdGhpcy5maWVsZC5uYW1lXSkuaW5jbHVkZXMoXCJwYXRoXCIpICYmXG4gICAgICAgICAgICAgICAgYFtbJHtwW3RoaXMuZmllbGQubmFtZV0ucGF0aC5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpfV1dYCA9PT0gdlxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUuc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZWN0LmFkZCh2YWx1ZSk7XG4gICAgICAgICAgICBzZWxlY3Qub25jaGFuZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBzZWxlY3QudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHNlbGVjdENvbnRhaW5lcilcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUNvbnRhaW5lcilcbiAgICAgICAgICAgICAgICBTZWxlY3RGaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgZHJvcERvd25CdXR0b24ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGVjdENvbnRhaW5lcik7XG4gICAgICAgIH1cblxuICAgICAgICBkaXNtaXNzQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVDb250YWluZXIpXG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBURmlsZSwgU3VnZ2VzdE1vZGFsLCBCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIHNlbGVjdFZhbHVlc1NvdXJjZSBmcm9tIFwic3JjL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzXCJcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZhbHVlU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz57XG5cbiAgICBwcml2YXRlIGFkZEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1pbnB1dC1jb250YWluZXJcIiB9KVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmlucHV0RWwpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZmluZChcIi5wcm9tcHRcIikucHJlcGVuZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYWN0aW9uc1wiIH0pXG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYWN0aW9ucy1zcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBpbmZvQ29udGFpbmVyID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1pbmZvXCIgfSlcbiAgICAgICAgaW5mb0NvbnRhaW5lci5zZXRUZXh0KFwiU2hpZnQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvLyBhZGRCdXR0b25cbiAgICAgICAgdGhpcy5hZGRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRJY29uKFwicGx1c1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuYWRkTmV3VmFsdWVUb1NldHRpbmdzKCkpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYnV0dG9uXCIpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLnNldEN0YSgpO1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgdmFsdWUgdG8gdGhpcyBmaWVsZCBzZXR0aW5nc1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgIC8vY2FuY2VsIGJ1dHRvblxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKVxuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmNsb3NlKCkpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICBjYW5jZWxCdXR0b24uc2V0VG9vbHRpcChcIkNhbmNlbFwiKVxuICAgICAgICAvL2NsZWFyIHZhbHVlIGJ1dHRvblxuICAgICAgICBjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjbGVhckJ1dHRvbi5zZXRJY29uKFwiZXJhc2VyXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jbGVhclZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcImRhbmdlclwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5zZXRUb29sdGlwKFwiQ2xlYXIgdGhlIGZpZWxkIHZhbHVlXCIpXG4gICAgICAgIHRoaXMubW9kYWxFbC5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXIpO1xuICAgIH1cblxuICAgIGFzeW5jIGFkZE5ld1ZhbHVlVG9TZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB0aGlzLmlucHV0RWwudmFsdWU7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKT8uZmlsZUNsYXNzTmFtZVxuICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3M/LmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcyAmJiBmaWxlQ2xhc3NBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3T3B0aW9uczogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gWy4uLmZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLCBuZXdWYWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnNbYCR7T2JqZWN0LmtleXMoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdCkubGVuZ3RofWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB2YWx1ZXNGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKS5sZW5ndGh9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwcmVzZXRGaWVsZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IHRoaXMuZmllbGQubmFtZSlcbiAgICAgICAgICAgIGlmIChwcmVzZXRGaWVsZD8ub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwcmVzZXRGaWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aClcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh2YWx1ZXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlc2V0RmllbGQ/Lm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpZWxkID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmluZChwID0+IHAuaWQgPT0gdGhpcy5maWVsZC5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBjdXJyZW50RXhpc3RpbmdGaWVsZC5vcHRpb25zLnZhbHVlc0xpc3RcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzTGlzdFtgJHtPYmplY3Qua2V5cyh2YWx1ZXNMaXN0KS5sZW5ndGggKyAxfWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlSXRlbShuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhclZhbHVlcygpIHtcbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGR2RmlsZTogYW55O1xuICAgICAgICBpZiAoZHZBcGkpIGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCkgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZE1hbmFnZXIuZ2V0T3B0aW9uc0xpc3QoZHZGaWxlKS5maWx0ZXIobyA9PiBvLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgIGlmICh0aGlzLmFkZEJ1dHRvbikge1xuICAgICAgICAgICAgKHZhbHVlcy5zb21lKHAgPT4gcCA9PT0gcXVlcnkpIHx8IHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5IHx8ICFxdWVyeSkgP1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuc2hvdygpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLnZhbHVlKSBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0ZWRcIilcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVJdGVtKGl0ZW06IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaXRlbS50b1N0cmluZygpKSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGl0ZW0udG9TdHJpbmcoKSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKGl0ZW06IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB0aGlzLnNhdmVJdGVtKGl0ZW0pXG4gICAgfVxufSIsICJleHBvcnQgZW51bSBUeXBlIHtcbiAgICBcIlZhbHVlc0xpc3RcIiA9IFwiVmFsdWVzTGlzdFwiLFxuICAgIFwiVmFsdWVzTGlzdE5vdGVQYXRoXCIgPSBcIlZhbHVlc0xpc3ROb3RlUGF0aFwiLFxuICAgIFwiVmFsdWVzRnJvbURWUXVlcnlcIiA9IFwiVmFsdWVzRnJvbURWUXVlcnlcIlxufVxuXG5leHBvcnQgY29uc3QgS2V5OiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJWYWx1ZXNMaXN0XCI6IFwidmFsdWVzTGlzdFwiLFxuICAgIFwiVmFsdWVzTGlzdE5vdGVQYXRoXCI6IFwidmFsdWVzTGlzdE5vdGVQYXRoXCIsXG4gICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiOiBcInZhbHVlc0Zyb21EVlF1ZXJ5XCJcbn1cblxuZXhwb3J0IGNvbnN0IHR5cGVEaXNwbGF5OiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJWYWx1ZXNMaXN0XCI6IFwiVmFsdWVzIGRlZmluZWQgaW4gdGhlc2Ugc2V0dGluZ3NcIixcbiAgICBcIlZhbHVlc0xpc3ROb3RlUGF0aFwiOiBcIlZhbHVlcyBmcm9tIGEgbm90ZVwiLFxuICAgIFwiVmFsdWVzRnJvbURWUXVlcnlcIjogXCJWYWx1ZXMgcmV0dXJuZWQgZnJvbSBhIGRhdGF2aWV3IHF1ZXJ5XCJcbn0iLCAiaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgc2V0SWNvbiwgRHJvcGRvd25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlU3VnZ2VzdCB9IGZyb20gXCJzcmMvc3VnZ2VzdGVyL0ZpbGVTdWdnZXN0ZXJcIjtcbmltcG9ydCAqIGFzIHNlbGVjdFZhbHVlc1NvdXJjZSBmcm9tIFwic3JjL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzXCJcblxuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBhYnN0cmFjdCB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQsIHR5cGU6IEZpZWxkVHlwZSkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCB0eXBlKVxuICAgIH1cblxuICAgIC8vU2V0dGluZ3NcbiAgICBwcml2YXRlIHNldFZhbHVlTGlzdFRleHQoaGVhZGVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBoZWFkZXIuc2V0VGV4dChgUHJlc2V0IG9wdGlvbnM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkuam9pbignLCAnKX1gKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVMaXN0Tm90ZVBhdGhDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXIgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7fSk7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlQ29udGFpbmVyTGFiZWwgPSB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1maWxlQ2xhc3Mtc2VhcmNoXCIgfSk7XG4gICAgICAgIGxpc3ROb3RlQ29udGFpbmVyTGFiZWwuc2V0VGV4dChgUGF0aCBvZiB0aGUgbm90ZSBjb250YWluaW5nIHRoZSB2YWx1ZXM6YCk7XG5cbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXIpO1xuXG4gICAgICAgIG5ldyBGaWxlU3VnZ2VzdChcbiAgICAgICAgICAgIGlucHV0LmlucHV0RWwsXG4gICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICBcIi9cIlxuICAgICAgICApXG4gICAgICAgIGNvbnN0IGxpc3ROb3RlUGF0aCA9IHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGg7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKGxpc3ROb3RlUGF0aCB8fCBcIlwiKTtcbiAgICAgICAgaW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJQYXRoL29mL3RoZS9ub3RlLm1kXCIpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoID0gdmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVtb3ZlUHJlc2V0VmFsdWUoa2V5OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgbGV0IG5ld1ZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgICAgICBmb3IgKGxldCBfa2V5IGluIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICBpZiAoa2V5ICE9PSBfa2V5KSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWVzW19rZXldID0gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3RbX2tleV07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCA9IG5ld1ZhbHVlcztcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVWYWx1ZXNMaXN0Q29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IHByZXNldFZhbHVlc0ZpZWxkcyA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKVxuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0ID0gcHJlc2V0VmFsdWVzRmllbGRzLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0SGVhZGVyID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb25cIiB9KTtcbiAgICAgICAgdmFsdWVzTGlzdEhlYWRlci5jcmVhdGVFbChcImgyXCIpO1xuICAgICAgICB2YWx1ZXNMaXN0SGVhZGVyLnNldFRleHQoYFByZXNldCBvcHRpb25zOiAke09iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3RCb2R5ID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5wdXNoKHRoaXMuY3JlYXRlVmFsdWVDb250YWluZXIodmFsdWVzTGlzdEJvZHksIHZhbHVlc0xpc3RIZWFkZXIsIGtleSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVBZGRCdXR0b24odmFsdWVzTGlzdCwgdmFsdWVzTGlzdEJvZHksIHZhbHVlc0xpc3RIZWFkZXIpXG4gICAgICAgIHJldHVybiBwcmVzZXRWYWx1ZXNGaWVsZHM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVWYWx1ZUNvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCwgaGVhZGVyOiBIVE1MRGl2RWxlbWVudCwga2V5OiBzdHJpbmcpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QgfHwge307XG4gICAgICAgIGNvbnN0IHByZXNldFZhbHVlID0gdmFsdWVzW2tleV07XG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiAnbWV0YWRhdGEtbWVudS1wcm9tcHQtY29udGFpbmVyJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMucHVzaChpbnB1dClcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUocHJlc2V0VmFsdWUpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnNldFZhbHVlTGlzdFRleHQoaGVhZGVyKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVSZW1vdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgdmFsdWVSZW1vdmVCdXR0b24uc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0O1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlUHJlc2V0VmFsdWUoa2V5KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbHVlTGlzdFRleHQoaGVhZGVyKTtcbiAgICAgICAgICAgICAgICBwYXJlbnROb2RlLnJlbW92ZUNoaWxkKHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMucmVtb3ZlKGlucHV0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBpZiAoa2V5ICE9IE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucylbMF0pIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlVXBncmFkZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQodmFsdWVDb250YWluZXIpO1xuICAgICAgICAgICAgc2V0SWNvbih2YWx1ZVVwZ3JhZGVCdXR0b24uYnV0dG9uRWwsIFwidXAtY2hldnJvbi1nbHlwaFwiKTtcbiAgICAgICAgICAgIHZhbHVlVXBncmFkZUJ1dHRvbi5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aGlzVmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEluZGV4ID0gdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmluZGV4T2YoaW5wdXQpXG4gICAgICAgICAgICAgICAgY29uc3QgdXBwZXJDb21wb25lbnQgPSBpbnB1dEluZGV4ICE9PSAtMSA/IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50c1tpbnB1dEluZGV4IC0gMV0gOiB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMubGFzdCgpO1xuICAgICAgICAgICAgICAgIGlmICh1cHBlckNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cHBlclZhbHVlID0gdXBwZXJDb21wb25lbnQuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBwZXJLZXkgPSBPYmplY3Qua2V5cyh2YWx1ZXMpLmZpbHRlcihrID0+IHZhbHVlc1trXSA9PSB1cHBlclZhbHVlKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVwcGVyS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW3VwcGVyS2V5XSA9IHRoaXNWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNldFZhbHVlKHVwcGVyVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB1cHBlclZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIC8vdG9kbyA6IG1hbmFnZSBib3RoIHJhdyBsaW5rcyBhbmQgZHYgTGluayBvYmplY3RzXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0OlxuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNGcm9tRFZRdWVyeTpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zTGlzdChkdkZpbGU6IGFueSA9IHVuZGVmaW5lZCk6IHN0cmluZ1tdIHtcbiAgICAgICAgbGV0IHZhbHVlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5maWVsZC5vcHRpb25zKSkge1xuICAgICAgICAgICAgdmFsdWVzID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSkge1xuICAgICAgICAgICAgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdDpcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoOlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LnZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgLmdldCh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKSB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNGcm9tRFZRdWVyeTpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IG5ldyBGdW5jdGlvbihcImR2XCIsIFwiY3VycmVudFwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5fWApKGR2QXBpLCBkdkZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2U7XG4gICAgICAgIHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgICAgIGlmICgvWyxdL2d1LnRlc3QoaW5wdXQuaW5wdXRFbC52YWx1ZSkgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQsIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkLFxuICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW5ub3QgY29udGFpbiBhIGNvbW1hXCJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoaW5wdXQuaW5wdXRFbC52YWx1ZSA9PSBcIlwiICYmIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudD8ubGFzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgIGlucHV0LCBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgXCJWYWx1ZXMgY2FuJ3QgYmUgbnVsbC5cIlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUFkZEJ1dHRvbih2YWx1ZXNMaXN0OiBIVE1MRGl2RWxlbWVudCwgdmFsdWVzTGlzdEJvZHk6IEhUTUxEaXZFbGVtZW50LCB2YWx1ZXNMaXN0SGVhZGVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Rm9vdGVyID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgYWRkVmFsdWUgPSB2YWx1ZXNMaXN0Rm9vdGVyLmNyZWF0ZUVsKCdidXR0b24nKTtcbiAgICAgICAgYWRkVmFsdWUudHlwZSA9ICdidXR0b24nO1xuICAgICAgICBhZGRWYWx1ZS50ZXh0Q29udGVudCA9ICdBZGQnO1xuICAgICAgICBhZGRWYWx1ZS5vbkNsaWNrRXZlbnQoYXN5bmMgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0O1xuXG4gICAgICAgICAgICBsZXQgbmV3S2V5TnVtYmVyID0gMTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KGtleSkgJiYgcGFyc2VJbnQoa2V5KSA+PSBuZXdLZXlOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3S2V5TnVtYmVyID0gcGFyc2VJbnQoa2V5KSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgbmV3S2V5ID0gbmV3S2V5TnVtYmVyLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFtuZXdLZXldID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVmFsdWVDb250YWluZXIodmFsdWVzTGlzdEJvZHksIHZhbHVlc0xpc3RIZWFkZXIsIG5ld0tleSlcbiAgICAgICAgfSk7XG4gICAgICAgIHZhbHVlc0xpc3QuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVWYWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoe30pXG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGF0YXZpZXcgZnVuY3Rpb25cIiwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSk7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGF0YXZpZXcgcXVlcnkgcmV0dXJuaW5nIGEgbGlzdCBvZiBzdHJpbmcgKDxkdj4gb2JqZWN0IGlzIGF2YWlsYWJsZSlcIiwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXN1YnRleHRcIiB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVzRnJvbURWUXVlcnkgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIpO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuaW5wdXRFbC5yb3dzID0gODtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuc2V0UGxhY2Vob2xkZXIoXCJleDogZHYucGFnZXMoJyNzdHVkZW50JykubWFwKHAgPT4gcC5uYW1lKVwiKVxuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnkgfHwgXCJcIik7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5ID0gdmFsdWVcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIHZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgZGlzcGxheVNlbGVjdGVkVHlwZUNvbnRhaW5lcihvcHRpb25Db250YWluZXJzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLCBIVE1MRGl2RWxlbWVudD4sIHZhbHVlOiBrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpIHtcbiAgICAgICAgT2JqZWN0LmtleXMob3B0aW9uQ29udGFpbmVycykuZm9yRWFjaCgoa2V5OiBrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpID0+IHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uQ29udGFpbmVyc1trZXldLnNob3coKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRpb25Db250YWluZXJzW2tleV0uaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIC8vc3RydWN0dXJlOlxuICAgICAgICAvL3NlbGVjdGV1ciBkZSB0eXBlIGF2ZWMgZGVmYXV0bCBzdXIgdmFsdWVzTGlzdFxuICAgICAgICAvL3ZhbHVlc0NvbnRhaW5lciBxdWkgZGlzcGxheSBsZSBib24gaW5wdXQgZW4gZm9uY3Rpb24gZGUgbGEgdmFsZXVyIGRlIHZhbHVlc1R5cGVTZWxlY3RcbiAgICAgICAgY29uc3Qgc291cmNlVHlwZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgc291cmNlVHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIlNlbGVjdCB0aGUgc291cmNlIG9mIHZhbHVlcyBmb3IgdGhpcyBmaWVsZFwiLCBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb25cIiB9KVxuICAgICAgICBjb25zdCBzb3VyY2VUeXBlID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHNvdXJjZVR5cGVDb250YWluZXIpO1xuICAgICAgICAvL21hbmFnZSBuZXcgZmllbGQgYW5kIGZpbGVDbGFzcyBsZWdhY3kgZmllbGRcbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSkge1xuICAgICAgICAgICAgLy90aGlzIGlzIGEgbmV3IGZpZWxkIG9yIGZpbGVDbGFzcyBsZWdhY3kgZmllbGRcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5maWVsZC5vcHRpb25zID09PSBcIm9iamVjdFwiICYmIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucykuZXZlcnkoa2V5ID0+ICFpc05hTihwYXJzZUludChrZXkpKSkpIHtcbiAgICAgICAgICAgICAgICAvL3RoaXMgaXMgYSBmaWxlQ2xhc3MgbGVnYWN5IGZpZWxkXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5mb3JFYWNoKChrZXk6IHN0cmluZykgPT4gdmFsdWVzTGlzdFtrZXldID0gdGhpcy5maWVsZC5vcHRpb25zW2tleV0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyA9IHt9XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QgPSB2YWx1ZXNMaXN0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMgPSB7fVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgPSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0O1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnkgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5rZXlzKHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKS5mb3JFYWNoKChvcHRpb246IGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSkgPT4gc291cmNlVHlwZS5hZGRPcHRpb24ob3B0aW9uLCBzZWxlY3RWYWx1ZXNTb3VyY2UudHlwZURpc3BsYXlbb3B0aW9uXSkpXG4gICAgICAgIHNvdXJjZVR5cGUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgfHwgc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdClcblxuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXIgPSB0aGlzLmNyZWF0ZUxpc3ROb3RlUGF0aENvbnRhaW5lcihwYXJlbnRDb250YWluZXIsIHBsdWdpbik7XG4gICAgICAgIGNvbnN0IHByZXNldFZhbHVlc0ZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY3JlYXRlVmFsdWVzTGlzdENvbnRhaW5lcihwYXJlbnRDb250YWluZXIpO1xuICAgICAgICBjb25zdCB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lciA9IHRoaXMuY3JlYXRlVmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIocGFyZW50Q29udGFpbmVyKTtcblxuICAgICAgICBjb25zdCB2YWx1ZXNDb250YWluZXJzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLCBIVE1MRGl2RWxlbWVudD4gPSB7XG4gICAgICAgICAgICBcIlZhbHVlc0xpc3RcIjogcHJlc2V0VmFsdWVzRmllbGRzQ29udGFpbmVyLFxuICAgICAgICAgICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIjogdmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyLFxuICAgICAgICAgICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiOiB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lclxuICAgICAgICB9XG5cbiAgICAgICAgc291cmNlVHlwZS5vbkNoYW5nZSgodmFsdWU6IGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVNlbGVjdGVkVHlwZUNvbnRhaW5lcih2YWx1ZXNDb250YWluZXJzLCB2YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZFR5cGVDb250YWluZXIodmFsdWVzQ29udGFpbmVycywgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoXCJzcGFuXCIsIHBbdGhpcy5maWVsZC5uYW1lXSk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgIH1cbn0iLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcblxuaW1wb3J0IHsgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRleHRJbnB1dFN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0XCI7XG5pbXBvcnQgeyBnZXRfdGZpbGVzX2Zyb21fZm9sZGVyIH0gZnJvbSBcIi4uL3V0aWxzL2ZpbGVVdGlsc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgY2xhc3MgRmlsZVN1Z2dlc3QgZXh0ZW5kcyBUZXh0SW5wdXRTdWdnZXN0PFRGaWxlPiB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwdWJsaWMgZm9sZGVyOiBzdHJpbmdcbiAgICApIHtcbiAgICAgICAgc3VwZXIoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRfc3RyOiBzdHJpbmcpOiBURmlsZVtdIHtcbiAgICAgICAgY29uc3QgYWxsX2ZpbGVzID0gW11cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGFsbF9maWxlcy5wdXNoKC4uLmdldF90ZmlsZXNfZnJvbV9mb2xkZXIodGhpcy5wbHVnaW4sIHRoaXMuZm9sZGVyKSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpbGVzOiBURmlsZVtdID0gW107XG4gICAgICAgIGNvbnN0IGxvd2VyX2lucHV0X3N0ciA9IGlucHV0X3N0ci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGFsbF9maWxlcy5mb3JFYWNoKChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmXG4gICAgICAgICAgICAgICAgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIiAmJlxuICAgICAgICAgICAgICAgIGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKGxvd2VyX2lucHV0X3N0cilcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmaWxlcztcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuc2V0VGV4dChmaWxlLnBhdGgpO1xuICAgIH1cblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oZmlsZTogVEZpbGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gZmlsZS5wYXRoO1xuICAgICAgICB0aGlzLmlucHV0RWwudHJpZ2dlcihcImlucHV0XCIpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIiwgIi8vIENyZWRpdHMgZ28gdG8gTGlhbSdzIFBlcmlvZGljIE5vdGVzIFBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLXBlcmlvZGljLW5vdGVzXG5cbmltcG9ydCB7IElTdWdnZXN0T3duZXIsIFNjb3BlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBjcmVhdGVQb3BwZXIsIEluc3RhbmNlIGFzIFBvcHBlckluc3RhbmNlIH0gZnJvbSBcIkBwb3BwZXJqcy9jb3JlXCI7XG5cbmNvbnN0IHdyYXBBcm91bmQgPSAodmFsdWU6IG51bWJlciwgc2l6ZTogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgICByZXR1cm4gKCh2YWx1ZSAlIHNpemUpICsgc2l6ZSkgJSBzaXplO1xufTtcblxuY2xhc3MgU3VnZ2VzdDxUPiB7XG4gICAgcHJpdmF0ZSB2YWx1ZXM6IFRbXTtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25zOiBIVE1MRGl2RWxlbWVudFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRJdGVtOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBvd25lcjogSVN1Z2dlc3RPd25lcjxUPixcbiAgICAgICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIHNjb3BlOiBTY29wZVxuICAgICkge1xuXG4gICAgICAgIGNvbnRhaW5lckVsLm9uKFxuICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbkNsaWNrLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgY29udGFpbmVyRWwub24oXG4gICAgICAgICAgICBcIm1vdXNlbW92ZVwiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbk1vdXNlb3Zlci5iaW5kKHRoaXMpXG4gICAgICAgICk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dVcFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSh0aGlzLnNlbGVjdGVkSXRlbSAtIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dEb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKHRoaXMuc2VsZWN0ZWRJdGVtICsgMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZVNlbGVjdGVkSXRlbShldmVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvblN1Z2dlc3Rpb25DbGljayhldmVudDogTW91c2VFdmVudCwgZWw6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvbnMuaW5kZXhPZihlbCk7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKGl0ZW0sIGZhbHNlKTtcbiAgICAgICAgdGhpcy51c2VTZWxlY3RlZEl0ZW0oZXZlbnQpO1xuICAgIH1cblxuICAgIG9uU3VnZ2VzdGlvbk1vdXNlb3ZlcihfZXZlbnQ6IE1vdXNlRXZlbnQsIGVsOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zdWdnZXN0aW9ucy5pbmRleE9mKGVsKTtcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oaXRlbSwgZmFsc2UpO1xuICAgIH1cblxuICAgIHNldFN1Z2dlc3Rpb25zKHZhbHVlczogVFtdKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsczogSFRNTERpdkVsZW1lbnRbXSA9IFtdO1xuXG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoXCJzdWdnZXN0aW9uLWl0ZW1cIik7XG4gICAgICAgICAgICB0aGlzLm93bmVyLnJlbmRlclN1Z2dlc3Rpb24odmFsdWUsIHN1Z2dlc3Rpb25FbCk7XG4gICAgICAgICAgICBzdWdnZXN0aW9uRWxzLnB1c2goc3VnZ2VzdGlvbkVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9uRWxzO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSgwLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgdXNlU2VsZWN0ZWRJdGVtKGV2ZW50OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnZhbHVlc1t0aGlzLnNlbGVjdGVkSXRlbV07XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMub3duZXIuc2VsZWN0U3VnZ2VzdGlvbihjdXJyZW50VmFsdWUsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFNlbGVjdGVkSXRlbShzZWxlY3RlZEluZGV4OiBudW1iZXIsIHNjcm9sbEludG9WaWV3OiBib29sZWFuKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJbmRleCA9IHdyYXBBcm91bmQoXG4gICAgICAgICAgICBzZWxlY3RlZEluZGV4LFxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGhcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdGlvbnNbdGhpcy5zZWxlY3RlZEl0ZW1dO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3Rpb25zW25vcm1hbGl6ZWRJbmRleF07XG5cbiAgICAgICAgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbj8ucmVtb3ZlQ2xhc3MoXCJpcy1zZWxlY3RlZFwiKTtcbiAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uPy5hZGRDbGFzcyhcImlzLXNlbGVjdGVkXCIpO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbm9ybWFsaXplZEluZGV4O1xuXG4gICAgICAgIGlmIChzY3JvbGxJbnRvVmlldykge1xuICAgICAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uLnNjcm9sbEludG9WaWV3KGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRleHRJbnB1dFN1Z2dlc3Q8VD4gaW1wbGVtZW50cyBJU3VnZ2VzdE93bmVyPFQ+IHtcbiAgICBwcm90ZWN0ZWQgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgICBwcml2YXRlIHBvcHBlcjogUG9wcGVySW5zdGFuY2U7XG4gICAgcHJpdmF0ZSBzY29wZTogU2NvcGU7XG4gICAgcHJpdmF0ZSBzdWdnZXN0RWw6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgc3VnZ2VzdDogU3VnZ2VzdDxUPjtcblxuICAgIGNvbnN0cnVjdG9yKGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IGlucHV0RWw7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBuZXcgU2NvcGUoKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3RFbCA9IGNyZWF0ZURpdihcInN1Z2dlc3Rpb24tY29udGFpbmVyXCIpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uID0gdGhpcy5zdWdnZXN0RWwuY3JlYXRlRGl2KFwic3VnZ2VzdGlvblwiKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0ID0gbmV3IFN1Z2dlc3QodGhpcywgc3VnZ2VzdGlvbiwgdGhpcy5zY29wZSk7XG5cbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFc2NhcGVcIiwgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIHRoaXMub25JbnB1dENoYW5nZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgdGhpcy5vbklucHV0Q2hhbmdlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuc3VnZ2VzdEVsLm9uKFxuICAgICAgICAgICAgXCJtb3VzZWRvd25cIixcbiAgICAgICAgICAgIFwiLnN1Z2dlc3Rpb24tY29udGFpbmVyXCIsXG4gICAgICAgICAgICAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIG9uSW5wdXRDaGFuZ2VkKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpbnB1dFN0ciA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKGlucHV0U3RyKTtcblxuICAgICAgICBpZiAoIXN1Z2dlc3Rpb25zKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0LnNldFN1Z2dlc3Rpb25zKHN1Z2dlc3Rpb25zKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLm9wZW4oKDxhbnk+YXBwKS5kb20uYXBwQ29udGFpbmVyRWwsIHRoaXMuaW5wdXRFbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvcGVuKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlucHV0RWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICg8YW55PmFwcCkua2V5bWFwLnB1c2hTY29wZSh0aGlzLnNjb3BlKTtcblxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5zdWdnZXN0RWwpO1xuICAgICAgICB0aGlzLnBvcHBlciA9IGNyZWF0ZVBvcHBlcihpbnB1dEVsLCB0aGlzLnN1Z2dlc3RFbCwge1xuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbS1zdGFydFwiLFxuICAgICAgICAgICAgbW9kaWZpZXJzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInNhbWVXaWR0aFwiLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBmbjogKHsgc3RhdGUsIGluc3RhbmNlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGU6IHBvc2l0aW9uaW5nIG5lZWRzIHRvIGJlIGNhbGN1bGF0ZWQgdHdpY2UgLVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmlyc3QgcGFzcyAtIHBvc2l0aW9uaW5nIGl0IGFjY29yZGluZyB0byB0aGUgd2lkdGggb2YgdGhlIHBvcHBlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2Vjb25kIHBhc3MgLSBwb3NpdGlvbiBpdCB3aXRoIHRoZSB3aWR0aCBib3VuZCB0byB0aGUgcmVmZXJlbmNlIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZWFybHkgZXhpdCB0byBhdm9pZCBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRXaWR0aCA9IGAke3N0YXRlLnJlY3RzLnJlZmVyZW5jZS53aWR0aH1weGA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuc3R5bGVzLnBvcHBlci53aWR0aCA9PT0gdGFyZ2V0V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5zdHlsZXMucG9wcGVyLndpZHRoID0gdGFyZ2V0V2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcGhhc2U6IFwiYmVmb3JlV3JpdGVcIixcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZXM6IFtcImNvbXB1dGVTdHlsZXNcIl0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNsb3NlKCk6IHZvaWQge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAoPGFueT5hcHApLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3Quc2V0U3VnZ2VzdGlvbnMoW10pO1xuICAgICAgICBpZiAodGhpcy5wb3BwZXIpIHRoaXMucG9wcGVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0RWwuZGV0YWNoKCk7XG4gICAgfVxuXG4gICAgYWJzdHJhY3QgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHI6IHN0cmluZyk6IFRbXTtcbiAgICBhYnN0cmFjdCByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IFQsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQ7XG4gICAgYWJzdHJhY3Qgc2VsZWN0U3VnZ2VzdGlvbihpdGVtOiBUKTogdm9pZDtcbn1cbiIsICJleHBvcnQgdmFyIHRvcCA9ICd0b3AnO1xuZXhwb3J0IHZhciBib3R0b20gPSAnYm90dG9tJztcbmV4cG9ydCB2YXIgcmlnaHQgPSAncmlnaHQnO1xuZXhwb3J0IHZhciBsZWZ0ID0gJ2xlZnQnO1xuZXhwb3J0IHZhciBhdXRvID0gJ2F1dG8nO1xuZXhwb3J0IHZhciBiYXNlUGxhY2VtZW50cyA9IFt0b3AsIGJvdHRvbSwgcmlnaHQsIGxlZnRdO1xuZXhwb3J0IHZhciBzdGFydCA9ICdzdGFydCc7XG5leHBvcnQgdmFyIGVuZCA9ICdlbmQnO1xuZXhwb3J0IHZhciBjbGlwcGluZ1BhcmVudHMgPSAnY2xpcHBpbmdQYXJlbnRzJztcbmV4cG9ydCB2YXIgdmlld3BvcnQgPSAndmlld3BvcnQnO1xuZXhwb3J0IHZhciBwb3BwZXIgPSAncG9wcGVyJztcbmV4cG9ydCB2YXIgcmVmZXJlbmNlID0gJ3JlZmVyZW5jZSc7XG5leHBvcnQgdmFyIHZhcmlhdGlvblBsYWNlbWVudHMgPSAvKiNfX1BVUkVfXyovYmFzZVBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50ICsgXCItXCIgKyBzdGFydCwgcGxhY2VtZW50ICsgXCItXCIgKyBlbmRdKTtcbn0sIFtdKTtcbmV4cG9ydCB2YXIgcGxhY2VtZW50cyA9IC8qI19fUFVSRV9fKi9bXS5jb25jYXQoYmFzZVBsYWNlbWVudHMsIFthdXRvXSkucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50LCBwbGFjZW1lbnQgKyBcIi1cIiArIHN0YXJ0LCBwbGFjZW1lbnQgKyBcIi1cIiArIGVuZF0pO1xufSwgW10pOyAvLyBtb2RpZmllcnMgdGhhdCBuZWVkIHRvIHJlYWQgdGhlIERPTVxuXG5leHBvcnQgdmFyIGJlZm9yZVJlYWQgPSAnYmVmb3JlUmVhZCc7XG5leHBvcnQgdmFyIHJlYWQgPSAncmVhZCc7XG5leHBvcnQgdmFyIGFmdGVyUmVhZCA9ICdhZnRlclJlYWQnOyAvLyBwdXJlLWxvZ2ljIG1vZGlmaWVyc1xuXG5leHBvcnQgdmFyIGJlZm9yZU1haW4gPSAnYmVmb3JlTWFpbic7XG5leHBvcnQgdmFyIG1haW4gPSAnbWFpbic7XG5leHBvcnQgdmFyIGFmdGVyTWFpbiA9ICdhZnRlck1haW4nOyAvLyBtb2RpZmllciB3aXRoIHRoZSBwdXJwb3NlIHRvIHdyaXRlIHRvIHRoZSBET00gKG9yIHdyaXRlIGludG8gYSBmcmFtZXdvcmsgc3RhdGUpXG5cbmV4cG9ydCB2YXIgYmVmb3JlV3JpdGUgPSAnYmVmb3JlV3JpdGUnO1xuZXhwb3J0IHZhciB3cml0ZSA9ICd3cml0ZSc7XG5leHBvcnQgdmFyIGFmdGVyV3JpdGUgPSAnYWZ0ZXJXcml0ZSc7XG5leHBvcnQgdmFyIG1vZGlmaWVyUGhhc2VzID0gW2JlZm9yZVJlYWQsIHJlYWQsIGFmdGVyUmVhZCwgYmVmb3JlTWFpbiwgbWFpbiwgYWZ0ZXJNYWluLCBiZWZvcmVXcml0ZSwgd3JpdGUsIGFmdGVyV3JpdGVdOyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlTmFtZShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50ID8gKGVsZW1lbnQubm9kZU5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCkgOiBudWxsO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3cobm9kZSkge1xuICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuXG4gIGlmIChub2RlLnRvU3RyaW5nKCkgIT09ICdbb2JqZWN0IFdpbmRvd10nKSB7XG4gICAgdmFyIG93bmVyRG9jdW1lbnQgPSBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgcmV0dXJuIG93bmVyRG9jdW1lbnQgPyBvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3IHx8IHdpbmRvdyA6IHdpbmRvdztcbiAgfVxuXG4gIHJldHVybiBub2RlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5FbGVtZW50O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGlzSFRNTEVsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5IVE1MRWxlbWVudDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaXNTaGFkb3dSb290KG5vZGUpIHtcbiAgLy8gSUUgMTEgaGFzIG5vIFNoYWRvd1Jvb3RcbiAgaWYgKHR5cGVvZiBTaGFkb3dSb290ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLlNoYWRvd1Jvb3Q7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgU2hhZG93Um9vdDtcbn1cblxuZXhwb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfTsiLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjsgLy8gVGhpcyBtb2RpZmllciB0YWtlcyB0aGUgc3R5bGVzIHByZXBhcmVkIGJ5IHRoZSBgY29tcHV0ZVN0eWxlc2AgbW9kaWZpZXJcbi8vIGFuZCBhcHBsaWVzIHRoZW0gdG8gdGhlIEhUTUxFbGVtZW50cyBzdWNoIGFzIHBvcHBlciBhbmQgYXJyb3dcblxuZnVuY3Rpb24gYXBwbHlTdHlsZXMoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlO1xuICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgIHZhciBzdHlsZSA9IHN0YXRlLnN0eWxlc1tuYW1lXSB8fCB7fTtcbiAgICB2YXIgYXR0cmlidXRlcyA9IHN0YXRlLmF0dHJpYnV0ZXNbbmFtZV0gfHwge307XG4gICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTsgLy8gYXJyb3cgaXMgb3B0aW9uYWwgKyB2aXJ0dWFsIGVsZW1lbnRzXG5cbiAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBGbG93IGRvZXNuJ3Qgc3VwcG9ydCB0byBleHRlbmQgdGhpcyBwcm9wZXJ0eSwgYnV0IGl0J3MgdGhlIG1vc3RcbiAgICAvLyBlZmZlY3RpdmUgd2F5IHRvIGFwcGx5IHN0eWxlcyB0byBhbiBIVE1MRWxlbWVudFxuICAgIC8vICRGbG93Rml4TWVbY2Fubm90LXdyaXRlXVxuXG5cbiAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlKTtcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuXG4gICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUgPT09IHRydWUgPyAnJyA6IHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZTtcbiAgdmFyIGluaXRpYWxTdHlsZXMgPSB7XG4gICAgcG9wcGVyOiB7XG4gICAgICBwb3NpdGlvbjogc3RhdGUub3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIGxlZnQ6ICcwJyxcbiAgICAgIHRvcDogJzAnLFxuICAgICAgbWFyZ2luOiAnMCdcbiAgICB9LFxuICAgIGFycm93OiB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICAgIH0sXG4gICAgcmVmZXJlbmNlOiB7fVxuICB9O1xuICBPYmplY3QuYXNzaWduKHN0YXRlLmVsZW1lbnRzLnBvcHBlci5zdHlsZSwgaW5pdGlhbFN0eWxlcy5wb3BwZXIpO1xuICBzdGF0ZS5zdHlsZXMgPSBpbml0aWFsU3R5bGVzO1xuXG4gIGlmIChzdGF0ZS5lbGVtZW50cy5hcnJvdykge1xuICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuZWxlbWVudHMuYXJyb3cuc3R5bGUsIGluaXRpYWxTdHlsZXMuYXJyb3cpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTtcbiAgICAgIHZhciBhdHRyaWJ1dGVzID0gc3RhdGUuYXR0cmlidXRlc1tuYW1lXSB8fCB7fTtcbiAgICAgIHZhciBzdHlsZVByb3BlcnRpZXMgPSBPYmplY3Qua2V5cyhzdGF0ZS5zdHlsZXMuaGFzT3duUHJvcGVydHkobmFtZSkgPyBzdGF0ZS5zdHlsZXNbbmFtZV0gOiBpbml0aWFsU3R5bGVzW25hbWVdKTsgLy8gU2V0IGFsbCB2YWx1ZXMgdG8gYW4gZW1wdHkgc3RyaW5nIHRvIHVuc2V0IHRoZW1cblxuICAgICAgdmFyIHN0eWxlID0gc3R5bGVQcm9wZXJ0aWVzLnJlZHVjZShmdW5jdGlvbiAoc3R5bGUsIHByb3BlcnR5KSB7XG4gICAgICAgIHN0eWxlW3Byb3BlcnR5XSA9ICcnO1xuICAgICAgICByZXR1cm4gc3R5bGU7XG4gICAgICB9LCB7fSk7IC8vIGFycm93IGlzIG9wdGlvbmFsICsgdmlydHVhbCBlbGVtZW50c1xuXG4gICAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZSk7XG4gICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXBwbHlTdHlsZXMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3dyaXRlJyxcbiAgZm46IGFwcGx5U3R5bGVzLFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgcmVxdWlyZXM6IFsnY29tcHV0ZVN0eWxlcyddXG59OyIsICJpbXBvcnQgeyBhdXRvIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMF07XG59IiwgImV4cG9ydCB2YXIgbWF4ID0gTWF0aC5tYXg7XG5leHBvcnQgdmFyIG1pbiA9IE1hdGgubWluO1xuZXhwb3J0IHZhciByb3VuZCA9IE1hdGgucm91bmQ7IiwgImltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgaW5jbHVkZVNjYWxlKSB7XG4gIGlmIChpbmNsdWRlU2NhbGUgPT09IHZvaWQgMCkge1xuICAgIGluY2x1ZGVTY2FsZSA9IGZhbHNlO1xuICB9XG5cbiAgdmFyIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB2YXIgc2NhbGVYID0gMTtcbiAgdmFyIHNjYWxlWSA9IDE7XG5cbiAgaWYgKGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgJiYgaW5jbHVkZVNjYWxlKSB7XG4gICAgdmFyIG9mZnNldEhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgIHZhciBvZmZzZXRXaWR0aCA9IGVsZW1lbnQub2Zmc2V0V2lkdGg7IC8vIERvIG5vdCBhdHRlbXB0IHRvIGRpdmlkZSBieSAwLCBvdGhlcndpc2Ugd2UgZ2V0IGBJbmZpbml0eWAgYXMgc2NhbGVcbiAgICAvLyBGYWxsYmFjayB0byAxIGluIGNhc2UgYm90aCB2YWx1ZXMgYXJlIGAwYFxuXG4gICAgaWYgKG9mZnNldFdpZHRoID4gMCkge1xuICAgICAgc2NhbGVYID0gcm91bmQocmVjdC53aWR0aCkgLyBvZmZzZXRXaWR0aCB8fCAxO1xuICAgIH1cblxuICAgIGlmIChvZmZzZXRIZWlnaHQgPiAwKSB7XG4gICAgICBzY2FsZVkgPSByb3VuZChyZWN0LmhlaWdodCkgLyBvZmZzZXRIZWlnaHQgfHwgMTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiByZWN0LndpZHRoIC8gc2NhbGVYLFxuICAgIGhlaWdodDogcmVjdC5oZWlnaHQgLyBzY2FsZVksXG4gICAgdG9wOiByZWN0LnRvcCAvIHNjYWxlWSxcbiAgICByaWdodDogcmVjdC5yaWdodCAvIHNjYWxlWCxcbiAgICBib3R0b206IHJlY3QuYm90dG9tIC8gc2NhbGVZLFxuICAgIGxlZnQ6IHJlY3QubGVmdCAvIHNjYWxlWCxcbiAgICB4OiByZWN0LmxlZnQgLyBzY2FsZVgsXG4gICAgeTogcmVjdC50b3AgLyBzY2FsZVlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjsgLy8gUmV0dXJucyB0aGUgbGF5b3V0IHJlY3Qgb2YgYW4gZWxlbWVudCByZWxhdGl2ZSB0byBpdHMgb2Zmc2V0UGFyZW50LiBMYXlvdXRcbi8vIG1lYW5zIGl0IGRvZXNuJ3QgdGFrZSBpbnRvIGFjY291bnQgdHJhbnNmb3Jtcy5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0TGF5b3V0UmVjdChlbGVtZW50KSB7XG4gIHZhciBjbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpOyAvLyBVc2UgdGhlIGNsaWVudFJlY3Qgc2l6ZXMgaWYgaXQncyBub3QgYmVlbiB0cmFuc2Zvcm1lZC5cbiAgLy8gRml4ZXMgaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMjIzXG5cbiAgdmFyIHdpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgdmFyIGhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuXG4gIGlmIChNYXRoLmFicyhjbGllbnRSZWN0LndpZHRoIC0gd2lkdGgpIDw9IDEpIHtcbiAgICB3aWR0aCA9IGNsaWVudFJlY3Qud2lkdGg7XG4gIH1cblxuICBpZiAoTWF0aC5hYnMoY2xpZW50UmVjdC5oZWlnaHQgLSBoZWlnaHQpIDw9IDEpIHtcbiAgICBoZWlnaHQgPSBjbGllbnRSZWN0LmhlaWdodDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgeDogZWxlbWVudC5vZmZzZXRMZWZ0LFxuICAgIHk6IGVsZW1lbnQub2Zmc2V0VG9wLFxuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb250YWlucyhwYXJlbnQsIGNoaWxkKSB7XG4gIHZhciByb290Tm9kZSA9IGNoaWxkLmdldFJvb3ROb2RlICYmIGNoaWxkLmdldFJvb3ROb2RlKCk7IC8vIEZpcnN0LCBhdHRlbXB0IHdpdGggZmFzdGVyIG5hdGl2ZSBtZXRob2RcblxuICBpZiAocGFyZW50LmNvbnRhaW5zKGNoaWxkKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IC8vIHRoZW4gZmFsbGJhY2sgdG8gY3VzdG9tIGltcGxlbWVudGF0aW9uIHdpdGggU2hhZG93IERPTSBzdXBwb3J0XG4gIGVsc2UgaWYgKHJvb3ROb2RlICYmIGlzU2hhZG93Um9vdChyb290Tm9kZSkpIHtcbiAgICAgIHZhciBuZXh0ID0gY2hpbGQ7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKG5leHQgJiYgcGFyZW50LmlzU2FtZU5vZGUobmV4dCkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ106IG5lZWQgYSBiZXR0ZXIgd2F5IHRvIGhhbmRsZSB0aGlzLi4uXG5cblxuICAgICAgICBuZXh0ID0gbmV4dC5wYXJlbnROb2RlIHx8IG5leHQuaG9zdDtcbiAgICAgIH0gd2hpbGUgKG5leHQpO1xuICAgIH0gLy8gR2l2ZSB1cCwgdGhlIHJlc3VsdCBpcyBmYWxzZVxuXG5cbiAgcmV0dXJuIGZhbHNlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB7XG4gIHJldHVybiBnZXRXaW5kb3coZWxlbWVudCkuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbn0iLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1RhYmxlRWxlbWVudChlbGVtZW50KSB7XG4gIHJldHVybiBbJ3RhYmxlJywgJ3RkJywgJ3RoJ10uaW5kZXhPZihnZXROb2RlTmFtZShlbGVtZW50KSkgPj0gMDtcbn0iLCAiaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpIHtcbiAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICByZXR1cm4gKChpc0VsZW1lbnQoZWxlbWVudCkgPyBlbGVtZW50Lm93bmVyRG9jdW1lbnQgOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgZWxlbWVudC5kb2N1bWVudCkgfHwgd2luZG93LmRvY3VtZW50KS5kb2N1bWVudEVsZW1lbnQ7XG59IiwgImltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCB7IGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFBhcmVudE5vZGUoZWxlbWVudCkge1xuICBpZiAoZ2V0Tm9kZU5hbWUoZWxlbWVudCkgPT09ICdodG1sJykge1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG5cbiAgcmV0dXJuICgvLyB0aGlzIGlzIGEgcXVpY2tlciAoYnV0IGxlc3MgdHlwZSBzYWZlKSB3YXkgdG8gc2F2ZSBxdWl0ZSBzb21lIGJ5dGVzIGZyb20gdGhlIGJ1bmRsZVxuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl1cbiAgICAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICBlbGVtZW50LmFzc2lnbmVkU2xvdCB8fCAvLyBzdGVwIGludG8gdGhlIHNoYWRvdyBET00gb2YgdGhlIHBhcmVudCBvZiBhIHNsb3R0ZWQgbm9kZVxuICAgIGVsZW1lbnQucGFyZW50Tm9kZSB8fCAoIC8vIERPTSBFbGVtZW50IGRldGVjdGVkXG4gICAgaXNTaGFkb3dSb290KGVsZW1lbnQpID8gZWxlbWVudC5ob3N0IDogbnVsbCkgfHwgLy8gU2hhZG93Um9vdCBkZXRlY3RlZFxuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBIVE1MRWxlbWVudCBpcyBhIE5vZGVcbiAgICBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkgLy8gZmFsbGJhY2tcblxuICApO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgaXNUYWJsZUVsZW1lbnQgZnJvbSBcIi4vaXNUYWJsZUVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcblxuZnVuY3Rpb24gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50KSB7XG4gIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAvLyBodHRwczovL2dpdGh1Yi5jb20vcG9wcGVyanMvcG9wcGVyLWNvcmUvaXNzdWVzLzgzN1xuICBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLnBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudC5vZmZzZXRQYXJlbnQ7XG59IC8vIGAub2Zmc2V0UGFyZW50YCByZXBvcnRzIGBudWxsYCBmb3IgZml4ZWQgZWxlbWVudHMsIHdoaWxlIGFic29sdXRlIGVsZW1lbnRzXG4vLyByZXR1cm4gdGhlIGNvbnRhaW5pbmcgYmxvY2tcblxuXG5mdW5jdGlvbiBnZXRDb250YWluaW5nQmxvY2soZWxlbWVudCkge1xuICB2YXIgaXNGaXJlZm94ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2ZpcmVmb3gnKSAhPT0gLTE7XG4gIHZhciBpc0lFID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdUcmlkZW50JykgIT09IC0xO1xuXG4gIGlmIChpc0lFICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAvLyBJbiBJRSA5LCAxMCBhbmQgMTEgZml4ZWQgZWxlbWVudHMgY29udGFpbmluZyBibG9jayBpcyBhbHdheXMgZXN0YWJsaXNoZWQgYnkgdGhlIHZpZXdwb3J0XG4gICAgdmFyIGVsZW1lbnRDc3MgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xuXG4gICAgaWYgKGVsZW1lbnRDc3MucG9zaXRpb24gPT09ICdmaXhlZCcpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHZhciBjdXJyZW50Tm9kZSA9IGdldFBhcmVudE5vZGUoZWxlbWVudCk7XG5cbiAgaWYgKGlzU2hhZG93Um9vdChjdXJyZW50Tm9kZSkpIHtcbiAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLmhvc3Q7XG4gIH1cblxuICB3aGlsZSAoaXNIVE1MRWxlbWVudChjdXJyZW50Tm9kZSkgJiYgWydodG1sJywgJ2JvZHknXS5pbmRleE9mKGdldE5vZGVOYW1lKGN1cnJlbnROb2RlKSkgPCAwKSB7XG4gICAgdmFyIGNzcyA9IGdldENvbXB1dGVkU3R5bGUoY3VycmVudE5vZGUpOyAvLyBUaGlzIGlzIG5vbi1leGhhdXN0aXZlIGJ1dCBjb3ZlcnMgdGhlIG1vc3QgY29tbW9uIENTUyBwcm9wZXJ0aWVzIHRoYXRcbiAgICAvLyBjcmVhdGUgYSBjb250YWluaW5nIGJsb2NrLlxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9Db250YWluaW5nX2Jsb2NrI2lkZW50aWZ5aW5nX3RoZV9jb250YWluaW5nX2Jsb2NrXG5cbiAgICBpZiAoY3NzLnRyYW5zZm9ybSAhPT0gJ25vbmUnIHx8IGNzcy5wZXJzcGVjdGl2ZSAhPT0gJ25vbmUnIHx8IGNzcy5jb250YWluID09PSAncGFpbnQnIHx8IFsndHJhbnNmb3JtJywgJ3BlcnNwZWN0aXZlJ10uaW5kZXhPZihjc3Mud2lsbENoYW5nZSkgIT09IC0xIHx8IGlzRmlyZWZveCAmJiBjc3Mud2lsbENoYW5nZSA9PT0gJ2ZpbHRlcicgfHwgaXNGaXJlZm94ICYmIGNzcy5maWx0ZXIgJiYgY3NzLmZpbHRlciAhPT0gJ25vbmUnKSB7XG4gICAgICByZXR1cm4gY3VycmVudE5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn0gLy8gR2V0cyB0aGUgY2xvc2VzdCBhbmNlc3RvciBwb3NpdGlvbmVkIGVsZW1lbnQuIEhhbmRsZXMgc29tZSBlZGdlIGNhc2VzLFxuLy8gc3VjaCBhcyB0YWJsZSBhbmNlc3RvcnMgYW5kIGNyb3NzIGJyb3dzZXIgYnVncy5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkge1xuICB2YXIgd2luZG93ID0gZ2V0V2luZG93KGVsZW1lbnQpO1xuICB2YXIgb2Zmc2V0UGFyZW50ID0gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50KTtcblxuICB3aGlsZSAob2Zmc2V0UGFyZW50ICYmIGlzVGFibGVFbGVtZW50KG9mZnNldFBhcmVudCkgJiYgZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgIG9mZnNldFBhcmVudCA9IGdldFRydWVPZmZzZXRQYXJlbnQob2Zmc2V0UGFyZW50KTtcbiAgfVxuXG4gIGlmIChvZmZzZXRQYXJlbnQgJiYgKGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgPT09ICdodG1sJyB8fCBnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpID09PSAnYm9keScgJiYgZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG5cbiAgcmV0dXJuIG9mZnNldFBhcmVudCB8fCBnZXRDb250YWluaW5nQmxvY2soZWxlbWVudCkgfHwgd2luZG93O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBbJ3RvcCcsICdib3R0b20nXS5pbmRleE9mKHBsYWNlbWVudCkgPj0gMCA/ICd4JyA6ICd5Jztcbn0iLCAiaW1wb3J0IHsgbWF4IGFzIG1hdGhNYXgsIG1pbiBhcyBtYXRoTWluIH0gZnJvbSBcIi4vbWF0aC5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhpbihtaW4sIHZhbHVlLCBtYXgpIHtcbiAgcmV0dXJuIG1hdGhNYXgobWluLCBtYXRoTWluKHZhbHVlLCBtYXgpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB3aXRoaW5NYXhDbGFtcChtaW4sIHZhbHVlLCBtYXgpIHtcbiAgdmFyIHYgPSB3aXRoaW4obWluLCB2YWx1ZSwgbWF4KTtcbiAgcmV0dXJuIHYgPiBtYXggPyBtYXggOiB2O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRGcmVzaFNpZGVPYmplY3QoKSB7XG4gIHJldHVybiB7XG4gICAgdG9wOiAwLFxuICAgIHJpZ2h0OiAwLFxuICAgIGJvdHRvbTogMCxcbiAgICBsZWZ0OiAwXG4gIH07XG59IiwgImltcG9ydCBnZXRGcmVzaFNpZGVPYmplY3QgZnJvbSBcIi4vZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtZXJnZVBhZGRpbmdPYmplY3QocGFkZGluZ09iamVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZ2V0RnJlc2hTaWRlT2JqZWN0KCksIHBhZGRpbmdPYmplY3QpO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBleHBhbmRUb0hhc2hNYXAodmFsdWUsIGtleXMpIHtcbiAgcmV0dXJuIGtleXMucmVkdWNlKGZ1bmN0aW9uIChoYXNoTWFwLCBrZXkpIHtcbiAgICBoYXNoTWFwW2tleV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gaGFzaE1hcDtcbiAgfSwge30pO1xufSIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzXCI7XG5pbXBvcnQgY29udGFpbnMgZnJvbSBcIi4uL2RvbS11dGlscy9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB3aXRoaW4gfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgbWVyZ2VQYWRkaW5nT2JqZWN0IGZyb20gXCIuLi91dGlscy9tZXJnZVBhZGRpbmdPYmplY3QuanNcIjtcbmltcG9ydCBleHBhbmRUb0hhc2hNYXAgZnJvbSBcIi4uL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qc1wiO1xuaW1wb3J0IHsgbGVmdCwgcmlnaHQsIGJhc2VQbGFjZW1lbnRzLCB0b3AsIGJvdHRvbSB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciB0b1BhZGRpbmdPYmplY3QgPSBmdW5jdGlvbiB0b1BhZGRpbmdPYmplY3QocGFkZGluZywgc3RhdGUpIHtcbiAgcGFkZGluZyA9IHR5cGVvZiBwYWRkaW5nID09PSAnZnVuY3Rpb24nID8gcGFkZGluZyhPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHBhZGRpbmc7XG4gIHJldHVybiBtZXJnZVBhZGRpbmdPYmplY3QodHlwZW9mIHBhZGRpbmcgIT09ICdudW1iZXInID8gcGFkZGluZyA6IGV4cGFuZFRvSGFzaE1hcChwYWRkaW5nLCBiYXNlUGxhY2VtZW50cykpO1xufTtcblxuZnVuY3Rpb24gYXJyb3coX3JlZikge1xuICB2YXIgX3N0YXRlJG1vZGlmaWVyc0RhdGEkO1xuXG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICB2YXIgcG9wcGVyT2Zmc2V0cyA9IHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cztcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciBheGlzID0gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KGJhc2VQbGFjZW1lbnQpO1xuICB2YXIgaXNWZXJ0aWNhbCA9IFtsZWZ0LCByaWdodF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwO1xuICB2YXIgbGVuID0gaXNWZXJ0aWNhbCA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICBpZiAoIWFycm93RWxlbWVudCB8fCAhcG9wcGVyT2Zmc2V0cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBwYWRkaW5nT2JqZWN0ID0gdG9QYWRkaW5nT2JqZWN0KG9wdGlvbnMucGFkZGluZywgc3RhdGUpO1xuICB2YXIgYXJyb3dSZWN0ID0gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpO1xuICB2YXIgbWluUHJvcCA9IGF4aXMgPT09ICd5JyA/IHRvcCA6IGxlZnQ7XG4gIHZhciBtYXhQcm9wID0gYXhpcyA9PT0gJ3knID8gYm90dG9tIDogcmlnaHQ7XG4gIHZhciBlbmREaWZmID0gc3RhdGUucmVjdHMucmVmZXJlbmNlW2xlbl0gKyBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbYXhpc10gLSBwb3BwZXJPZmZzZXRzW2F4aXNdIC0gc3RhdGUucmVjdHMucG9wcGVyW2xlbl07XG4gIHZhciBzdGFydERpZmYgPSBwb3BwZXJPZmZzZXRzW2F4aXNdIC0gc3RhdGUucmVjdHMucmVmZXJlbmNlW2F4aXNdO1xuICB2YXIgYXJyb3dPZmZzZXRQYXJlbnQgPSBnZXRPZmZzZXRQYXJlbnQoYXJyb3dFbGVtZW50KTtcbiAgdmFyIGNsaWVudFNpemUgPSBhcnJvd09mZnNldFBhcmVudCA/IGF4aXMgPT09ICd5JyA/IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudEhlaWdodCB8fCAwIDogYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50V2lkdGggfHwgMCA6IDA7XG4gIHZhciBjZW50ZXJUb1JlZmVyZW5jZSA9IGVuZERpZmYgLyAyIC0gc3RhcnREaWZmIC8gMjsgLy8gTWFrZSBzdXJlIHRoZSBhcnJvdyBkb2Vzbid0IG92ZXJmbG93IHRoZSBwb3BwZXIgaWYgdGhlIGNlbnRlciBwb2ludCBpc1xuICAvLyBvdXRzaWRlIG9mIHRoZSBwb3BwZXIgYm91bmRzXG5cbiAgdmFyIG1pbiA9IHBhZGRpbmdPYmplY3RbbWluUHJvcF07XG4gIHZhciBtYXggPSBjbGllbnRTaXplIC0gYXJyb3dSZWN0W2xlbl0gLSBwYWRkaW5nT2JqZWN0W21heFByb3BdO1xuICB2YXIgY2VudGVyID0gY2xpZW50U2l6ZSAvIDIgLSBhcnJvd1JlY3RbbGVuXSAvIDIgKyBjZW50ZXJUb1JlZmVyZW5jZTtcbiAgdmFyIG9mZnNldCA9IHdpdGhpbihtaW4sIGNlbnRlciwgbWF4KTsgLy8gUHJldmVudHMgYnJlYWtpbmcgc3ludGF4IGhpZ2hsaWdodGluZy4uLlxuXG4gIHZhciBheGlzUHJvcCA9IGF4aXM7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSAoX3N0YXRlJG1vZGlmaWVyc0RhdGEkID0ge30sIF9zdGF0ZSRtb2RpZmllcnNEYXRhJFtheGlzUHJvcF0gPSBvZmZzZXQsIF9zdGF0ZSRtb2RpZmllcnNEYXRhJC5jZW50ZXJPZmZzZXQgPSBvZmZzZXQgLSBjZW50ZXIsIF9zdGF0ZSRtb2RpZmllcnNEYXRhJCk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkZWxlbWVudCA9IG9wdGlvbnMuZWxlbWVudCxcbiAgICAgIGFycm93RWxlbWVudCA9IF9vcHRpb25zJGVsZW1lbnQgPT09IHZvaWQgMCA/ICdbZGF0YS1wb3BwZXItYXJyb3ddJyA6IF9vcHRpb25zJGVsZW1lbnQ7XG5cbiAgaWYgKGFycm93RWxlbWVudCA9PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIENTUyBzZWxlY3RvclxuXG5cbiAgaWYgKHR5cGVvZiBhcnJvd0VsZW1lbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgYXJyb3dFbGVtZW50ID0gc3RhdGUuZWxlbWVudHMucG9wcGVyLnF1ZXJ5U2VsZWN0b3IoYXJyb3dFbGVtZW50KTtcblxuICAgIGlmICghYXJyb3dFbGVtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGlmICghaXNIVE1MRWxlbWVudChhcnJvd0VsZW1lbnQpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBcImFycm93XCIgZWxlbWVudCBtdXN0IGJlIGFuIEhUTUxFbGVtZW50IChub3QgYW4gU1ZHRWxlbWVudCkuJywgJ1RvIHVzZSBhbiBTVkcgYXJyb3csIHdyYXAgaXQgaW4gYW4gSFRNTEVsZW1lbnQgdGhhdCB3aWxsIGJlIHVzZWQgYXMnLCAndGhlIGFycm93LiddLmpvaW4oJyAnKSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFjb250YWlucyhzdGF0ZS5lbGVtZW50cy5wb3BwZXIsIGFycm93RWxlbWVudCkpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBcImFycm93XCIgbW9kaWZpZXJcXCdzIGBlbGVtZW50YCBtdXN0IGJlIGEgY2hpbGQgb2YgdGhlIHBvcHBlcicsICdlbGVtZW50LiddLmpvaW4oJyAnKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc3RhdGUuZWxlbWVudHMuYXJyb3cgPSBhcnJvd0VsZW1lbnQ7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdhcnJvdycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBhcnJvdyxcbiAgZWZmZWN0OiBlZmZlY3QsXG4gIHJlcXVpcmVzOiBbJ3BvcHBlck9mZnNldHMnXSxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydwcmV2ZW50T3ZlcmZsb3cnXVxufTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMV07XG59IiwgImltcG9ydCB7IHRvcCwgbGVmdCwgcmlnaHQsIGJvdHRvbSwgZW5kIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuLi91dGlscy9nZXRWYXJpYXRpb24uanNcIjtcbmltcG9ydCB7IHJvdW5kIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgdW5zZXRTaWRlcyA9IHtcbiAgdG9wOiAnYXV0bycsXG4gIHJpZ2h0OiAnYXV0bycsXG4gIGJvdHRvbTogJ2F1dG8nLFxuICBsZWZ0OiAnYXV0bydcbn07IC8vIFJvdW5kIHRoZSBvZmZzZXRzIHRvIHRoZSBuZWFyZXN0IHN1aXRhYmxlIHN1YnBpeGVsIGJhc2VkIG9uIHRoZSBEUFIuXG4vLyBab29taW5nIGNhbiBjaGFuZ2UgdGhlIERQUiwgYnV0IGl0IHNlZW1zIHRvIHJlcG9ydCBhIHZhbHVlIHRoYXQgd2lsbFxuLy8gY2xlYW5seSBkaXZpZGUgdGhlIHZhbHVlcyBpbnRvIHRoZSBhcHByb3ByaWF0ZSBzdWJwaXhlbHMuXG5cbmZ1bmN0aW9uIHJvdW5kT2Zmc2V0c0J5RFBSKF9yZWYpIHtcbiAgdmFyIHggPSBfcmVmLngsXG4gICAgICB5ID0gX3JlZi55O1xuICB2YXIgd2luID0gd2luZG93O1xuICB2YXIgZHByID0gd2luLmRldmljZVBpeGVsUmF0aW8gfHwgMTtcbiAgcmV0dXJuIHtcbiAgICB4OiByb3VuZCh4ICogZHByKSAvIGRwciB8fCAwLFxuICAgIHk6IHJvdW5kKHkgKiBkcHIpIC8gZHByIHx8IDBcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcFRvU3R5bGVzKF9yZWYyKSB7XG4gIHZhciBfT2JqZWN0JGFzc2lnbjI7XG5cbiAgdmFyIHBvcHBlciA9IF9yZWYyLnBvcHBlcixcbiAgICAgIHBvcHBlclJlY3QgPSBfcmVmMi5wb3BwZXJSZWN0LFxuICAgICAgcGxhY2VtZW50ID0gX3JlZjIucGxhY2VtZW50LFxuICAgICAgdmFyaWF0aW9uID0gX3JlZjIudmFyaWF0aW9uLFxuICAgICAgb2Zmc2V0cyA9IF9yZWYyLm9mZnNldHMsXG4gICAgICBwb3NpdGlvbiA9IF9yZWYyLnBvc2l0aW9uLFxuICAgICAgZ3B1QWNjZWxlcmF0aW9uID0gX3JlZjIuZ3B1QWNjZWxlcmF0aW9uLFxuICAgICAgYWRhcHRpdmUgPSBfcmVmMi5hZGFwdGl2ZSxcbiAgICAgIHJvdW5kT2Zmc2V0cyA9IF9yZWYyLnJvdW5kT2Zmc2V0cyxcbiAgICAgIGlzRml4ZWQgPSBfcmVmMi5pc0ZpeGVkO1xuICB2YXIgX29mZnNldHMkeCA9IG9mZnNldHMueCxcbiAgICAgIHggPSBfb2Zmc2V0cyR4ID09PSB2b2lkIDAgPyAwIDogX29mZnNldHMkeCxcbiAgICAgIF9vZmZzZXRzJHkgPSBvZmZzZXRzLnksXG4gICAgICB5ID0gX29mZnNldHMkeSA9PT0gdm9pZCAwID8gMCA6IF9vZmZzZXRzJHk7XG5cbiAgdmFyIF9yZWYzID0gdHlwZW9mIHJvdW5kT2Zmc2V0cyA9PT0gJ2Z1bmN0aW9uJyA/IHJvdW5kT2Zmc2V0cyh7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH0pIDoge1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xuXG4gIHggPSBfcmVmMy54O1xuICB5ID0gX3JlZjMueTtcbiAgdmFyIGhhc1ggPSBvZmZzZXRzLmhhc093blByb3BlcnR5KCd4Jyk7XG4gIHZhciBoYXNZID0gb2Zmc2V0cy5oYXNPd25Qcm9wZXJ0eSgneScpO1xuICB2YXIgc2lkZVggPSBsZWZ0O1xuICB2YXIgc2lkZVkgPSB0b3A7XG4gIHZhciB3aW4gPSB3aW5kb3c7XG5cbiAgaWYgKGFkYXB0aXZlKSB7XG4gICAgdmFyIG9mZnNldFBhcmVudCA9IGdldE9mZnNldFBhcmVudChwb3BwZXIpO1xuICAgIHZhciBoZWlnaHRQcm9wID0gJ2NsaWVudEhlaWdodCc7XG4gICAgdmFyIHdpZHRoUHJvcCA9ICdjbGllbnRXaWR0aCc7XG5cbiAgICBpZiAob2Zmc2V0UGFyZW50ID09PSBnZXRXaW5kb3cocG9wcGVyKSkge1xuICAgICAgb2Zmc2V0UGFyZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KHBvcHBlcik7XG5cbiAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gIT09ICdzdGF0aWMnICYmIHBvc2l0aW9uID09PSAnYWJzb2x1dGUnKSB7XG4gICAgICAgIGhlaWdodFByb3AgPSAnc2Nyb2xsSGVpZ2h0JztcbiAgICAgICAgd2lkdGhQcm9wID0gJ3Njcm9sbFdpZHRoJztcbiAgICAgIH1cbiAgICB9IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhc3RdOiBmb3JjZSB0eXBlIHJlZmluZW1lbnQsIHdlIGNvbXBhcmUgb2Zmc2V0UGFyZW50IHdpdGggd2luZG93IGFib3ZlLCBidXQgRmxvdyBkb2Vzbid0IGRldGVjdCBpdFxuXG5cbiAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQ7XG5cbiAgICBpZiAocGxhY2VtZW50ID09PSB0b3AgfHwgKHBsYWNlbWVudCA9PT0gbGVmdCB8fCBwbGFjZW1lbnQgPT09IHJpZ2h0KSAmJiB2YXJpYXRpb24gPT09IGVuZCkge1xuICAgICAgc2lkZVkgPSBib3R0b207XG4gICAgICB2YXIgb2Zmc2V0WSA9IGlzRml4ZWQgJiYgb2Zmc2V0UGFyZW50ID09PSB3aW4gJiYgd2luLnZpc3VhbFZpZXdwb3J0ID8gd2luLnZpc3VhbFZpZXdwb3J0LmhlaWdodCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgICAgb2Zmc2V0UGFyZW50W2hlaWdodFByb3BdO1xuICAgICAgeSAtPSBvZmZzZXRZIC0gcG9wcGVyUmVjdC5oZWlnaHQ7XG4gICAgICB5ICo9IGdwdUFjY2VsZXJhdGlvbiA/IDEgOiAtMTtcbiAgICB9XG5cbiAgICBpZiAocGxhY2VtZW50ID09PSBsZWZ0IHx8IChwbGFjZW1lbnQgPT09IHRvcCB8fCBwbGFjZW1lbnQgPT09IGJvdHRvbSkgJiYgdmFyaWF0aW9uID09PSBlbmQpIHtcbiAgICAgIHNpZGVYID0gcmlnaHQ7XG4gICAgICB2YXIgb2Zmc2V0WCA9IGlzRml4ZWQgJiYgb2Zmc2V0UGFyZW50ID09PSB3aW4gJiYgd2luLnZpc3VhbFZpZXdwb3J0ID8gd2luLnZpc3VhbFZpZXdwb3J0LndpZHRoIDogLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gICAgICBvZmZzZXRQYXJlbnRbd2lkdGhQcm9wXTtcbiAgICAgIHggLT0gb2Zmc2V0WCAtIHBvcHBlclJlY3Qud2lkdGg7XG4gICAgICB4ICo9IGdwdUFjY2VsZXJhdGlvbiA/IDEgOiAtMTtcbiAgICB9XG4gIH1cblxuICB2YXIgY29tbW9uU3R5bGVzID0gT2JqZWN0LmFzc2lnbih7XG4gICAgcG9zaXRpb246IHBvc2l0aW9uXG4gIH0sIGFkYXB0aXZlICYmIHVuc2V0U2lkZXMpO1xuXG4gIHZhciBfcmVmNCA9IHJvdW5kT2Zmc2V0cyA9PT0gdHJ1ZSA/IHJvdW5kT2Zmc2V0c0J5RFBSKHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfSkgOiB7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH07XG5cbiAgeCA9IF9yZWY0Lng7XG4gIHkgPSBfcmVmNC55O1xuXG4gIGlmIChncHVBY2NlbGVyYXRpb24pIHtcbiAgICB2YXIgX09iamVjdCRhc3NpZ247XG5cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCAoX09iamVjdCRhc3NpZ24gPSB7fSwgX09iamVjdCRhc3NpZ25bc2lkZVldID0gaGFzWSA/ICcwJyA6ICcnLCBfT2JqZWN0JGFzc2lnbltzaWRlWF0gPSBoYXNYID8gJzAnIDogJycsIF9PYmplY3QkYXNzaWduLnRyYW5zZm9ybSA9ICh3aW4uZGV2aWNlUGl4ZWxSYXRpbyB8fCAxKSA8PSAxID8gXCJ0cmFuc2xhdGUoXCIgKyB4ICsgXCJweCwgXCIgKyB5ICsgXCJweClcIiA6IFwidHJhbnNsYXRlM2QoXCIgKyB4ICsgXCJweCwgXCIgKyB5ICsgXCJweCwgMClcIiwgX09iamVjdCRhc3NpZ24pKTtcbiAgfVxuXG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIChfT2JqZWN0JGFzc2lnbjIgPSB7fSwgX09iamVjdCRhc3NpZ24yW3NpZGVZXSA9IGhhc1kgPyB5ICsgXCJweFwiIDogJycsIF9PYmplY3QkYXNzaWduMltzaWRlWF0gPSBoYXNYID8geCArIFwicHhcIiA6ICcnLCBfT2JqZWN0JGFzc2lnbjIudHJhbnNmb3JtID0gJycsIF9PYmplY3QkYXNzaWduMikpO1xufVxuXG5mdW5jdGlvbiBjb21wdXRlU3R5bGVzKF9yZWY1KSB7XG4gIHZhciBzdGF0ZSA9IF9yZWY1LnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWY1Lm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRncHVBY2NlbGVyYXQgPSBvcHRpb25zLmdwdUFjY2VsZXJhdGlvbixcbiAgICAgIGdwdUFjY2VsZXJhdGlvbiA9IF9vcHRpb25zJGdwdUFjY2VsZXJhdCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJGdwdUFjY2VsZXJhdCxcbiAgICAgIF9vcHRpb25zJGFkYXB0aXZlID0gb3B0aW9ucy5hZGFwdGl2ZSxcbiAgICAgIGFkYXB0aXZlID0gX29wdGlvbnMkYWRhcHRpdmUgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRhZGFwdGl2ZSxcbiAgICAgIF9vcHRpb25zJHJvdW5kT2Zmc2V0cyA9IG9wdGlvbnMucm91bmRPZmZzZXRzLFxuICAgICAgcm91bmRPZmZzZXRzID0gX29wdGlvbnMkcm91bmRPZmZzZXRzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkcm91bmRPZmZzZXRzO1xuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICB2YXIgdHJhbnNpdGlvblByb3BlcnR5ID0gZ2V0Q29tcHV0ZWRTdHlsZShzdGF0ZS5lbGVtZW50cy5wb3BwZXIpLnRyYW5zaXRpb25Qcm9wZXJ0eSB8fCAnJztcblxuICAgIGlmIChhZGFwdGl2ZSAmJiBbJ3RyYW5zZm9ybScsICd0b3AnLCAncmlnaHQnLCAnYm90dG9tJywgJ2xlZnQnXS5zb21lKGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgcmV0dXJuIHRyYW5zaXRpb25Qcm9wZXJ0eS5pbmRleE9mKHByb3BlcnR5KSA+PSAwO1xuICAgIH0pKSB7XG4gICAgICBjb25zb2xlLndhcm4oWydQb3BwZXI6IERldGVjdGVkIENTUyB0cmFuc2l0aW9ucyBvbiBhdCBsZWFzdCBvbmUgb2YgdGhlIGZvbGxvd2luZycsICdDU1MgcHJvcGVydGllczogXCJ0cmFuc2Zvcm1cIiwgXCJ0b3BcIiwgXCJyaWdodFwiLCBcImJvdHRvbVwiLCBcImxlZnRcIi4nLCAnXFxuXFxuJywgJ0Rpc2FibGUgdGhlIFwiY29tcHV0ZVN0eWxlc1wiIG1vZGlmaWVyXFwncyBgYWRhcHRpdmVgIG9wdGlvbiB0byBhbGxvdycsICdmb3Igc21vb3RoIHRyYW5zaXRpb25zLCBvciByZW1vdmUgdGhlc2UgcHJvcGVydGllcyBmcm9tIHRoZSBDU1MnLCAndHJhbnNpdGlvbiBkZWNsYXJhdGlvbiBvbiB0aGUgcG9wcGVyIGVsZW1lbnQgaWYgb25seSB0cmFuc2l0aW9uaW5nJywgJ29wYWNpdHkgb3IgYmFja2dyb3VuZC1jb2xvciBmb3IgZXhhbXBsZS4nLCAnXFxuXFxuJywgJ1dlIHJlY29tbWVuZCB1c2luZyB0aGUgcG9wcGVyIGVsZW1lbnQgYXMgYSB3cmFwcGVyIGFyb3VuZCBhbiBpbm5lcicsICdlbGVtZW50IHRoYXQgY2FuIGhhdmUgYW55IENTUyBwcm9wZXJ0eSB0cmFuc2l0aW9uZWQgZm9yIGFuaW1hdGlvbnMuJ10uam9pbignICcpKTtcbiAgICB9XG4gIH1cblxuICB2YXIgY29tbW9uU3R5bGVzID0ge1xuICAgIHBsYWNlbWVudDogZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5wbGFjZW1lbnQpLFxuICAgIHZhcmlhdGlvbjogZ2V0VmFyaWF0aW9uKHN0YXRlLnBsYWNlbWVudCksXG4gICAgcG9wcGVyOiBzdGF0ZS5lbGVtZW50cy5wb3BwZXIsXG4gICAgcG9wcGVyUmVjdDogc3RhdGUucmVjdHMucG9wcGVyLFxuICAgIGdwdUFjY2VsZXJhdGlvbjogZ3B1QWNjZWxlcmF0aW9uLFxuICAgIGlzRml4ZWQ6IHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3kgPT09ICdmaXhlZCdcbiAgfTtcblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzICE9IG51bGwpIHtcbiAgICBzdGF0ZS5zdHlsZXMucG9wcGVyID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuc3R5bGVzLnBvcHBlciwgbWFwVG9TdHlsZXMoT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCB7XG4gICAgICBvZmZzZXRzOiBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMsXG4gICAgICBwb3NpdGlvbjogc3RhdGUub3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIGFkYXB0aXZlOiBhZGFwdGl2ZSxcbiAgICAgIHJvdW5kT2Zmc2V0czogcm91bmRPZmZzZXRzXG4gICAgfSkpKTtcbiAgfVxuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhLmFycm93ICE9IG51bGwpIHtcbiAgICBzdGF0ZS5zdHlsZXMuYXJyb3cgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5zdHlsZXMuYXJyb3csIG1hcFRvU3R5bGVzKE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywge1xuICAgICAgb2Zmc2V0czogc3RhdGUubW9kaWZpZXJzRGF0YS5hcnJvdyxcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgYWRhcHRpdmU6IGZhbHNlLFxuICAgICAgcm91bmRPZmZzZXRzOiByb3VuZE9mZnNldHNcbiAgICB9KSkpO1xuICB9XG5cbiAgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciwge1xuICAgICdkYXRhLXBvcHBlci1wbGFjZW1lbnQnOiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdjb21wdXRlU3R5bGVzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdiZWZvcmVXcml0ZScsXG4gIGZuOiBjb21wdXRlU3R5bGVzLFxuICBkYXRhOiB7fVxufTsiLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldFdpbmRvdy5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciBwYXNzaXZlID0ge1xuICBwYXNzaXZlOiB0cnVlXG59O1xuXG5mdW5jdGlvbiBlZmZlY3QoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgaW5zdGFuY2UgPSBfcmVmLmluc3RhbmNlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgdmFyIF9vcHRpb25zJHNjcm9sbCA9IG9wdGlvbnMuc2Nyb2xsLFxuICAgICAgc2Nyb2xsID0gX29wdGlvbnMkc2Nyb2xsID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkc2Nyb2xsLFxuICAgICAgX29wdGlvbnMkcmVzaXplID0gb3B0aW9ucy5yZXNpemUsXG4gICAgICByZXNpemUgPSBfb3B0aW9ucyRyZXNpemUgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRyZXNpemU7XG4gIHZhciB3aW5kb3cgPSBnZXRXaW5kb3coc3RhdGUuZWxlbWVudHMucG9wcGVyKTtcbiAgdmFyIHNjcm9sbFBhcmVudHMgPSBbXS5jb25jYXQoc3RhdGUuc2Nyb2xsUGFyZW50cy5yZWZlcmVuY2UsIHN0YXRlLnNjcm9sbFBhcmVudHMucG9wcGVyKTtcblxuICBpZiAoc2Nyb2xsKSB7XG4gICAgc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzY3JvbGxQYXJlbnQpIHtcbiAgICAgIHNjcm9sbFBhcmVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHJlc2l6ZSkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoc2Nyb2xsKSB7XG4gICAgICBzY3JvbGxQYXJlbnRzLmZvckVhY2goZnVuY3Rpb24gKHNjcm9sbFBhcmVudCkge1xuICAgICAgICBzY3JvbGxQYXJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChyZXNpemUpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICAgIH1cbiAgfTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2V2ZW50TGlzdGVuZXJzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICd3cml0ZScsXG4gIGZuOiBmdW5jdGlvbiBmbigpIHt9LFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgZGF0YToge31cbn07IiwgInZhciBoYXNoID0ge1xuICBsZWZ0OiAncmlnaHQnLFxuICByaWdodDogJ2xlZnQnLFxuICBib3R0b206ICd0b3AnLFxuICB0b3A6ICdib3R0b20nXG59O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQucmVwbGFjZSgvbGVmdHxyaWdodHxib3R0b218dG9wL2csIGZ1bmN0aW9uIChtYXRjaGVkKSB7XG4gICAgcmV0dXJuIGhhc2hbbWF0Y2hlZF07XG4gIH0pO1xufSIsICJ2YXIgaGFzaCA9IHtcbiAgc3RhcnQ6ICdlbmQnLFxuICBlbmQ6ICdzdGFydCdcbn07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5yZXBsYWNlKC9zdGFydHxlbmQvZywgZnVuY3Rpb24gKG1hdGNoZWQpIHtcbiAgICByZXR1cm4gaGFzaFttYXRjaGVkXTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGwobm9kZSkge1xuICB2YXIgd2luID0gZ2V0V2luZG93KG5vZGUpO1xuICB2YXIgc2Nyb2xsTGVmdCA9IHdpbi5wYWdlWE9mZnNldDtcbiAgdmFyIHNjcm9sbFRvcCA9IHdpbi5wYWdlWU9mZnNldDtcbiAgcmV0dXJuIHtcbiAgICBzY3JvbGxMZWZ0OiBzY3JvbGxMZWZ0LFxuICAgIHNjcm9sbFRvcDogc2Nyb2xsVG9wXG4gIH07XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFdpbmRvd1Njcm9sbEJhclgoZWxlbWVudCkge1xuICAvLyBJZiA8aHRtbD4gaGFzIGEgQ1NTIHdpZHRoIGdyZWF0ZXIgdGhhbiB0aGUgdmlld3BvcnQsIHRoZW4gdGhpcyB3aWxsIGJlXG4gIC8vIGluY29ycmVjdCBmb3IgUlRMLlxuICAvLyBQb3BwZXIgMSBpcyBicm9rZW4gaW4gdGhpcyBjYXNlIGFuZCBuZXZlciBoYWQgYSBidWcgcmVwb3J0IHNvIGxldCdzIGFzc3VtZVxuICAvLyBpdCdzIG5vdCBhbiBpc3N1ZS4gSSBkb24ndCB0aGluayBhbnlvbmUgZXZlciBzcGVjaWZpZXMgd2lkdGggb24gPGh0bWw+XG4gIC8vIGFueXdheS5cbiAgLy8gQnJvd3NlcnMgd2hlcmUgdGhlIGxlZnQgc2Nyb2xsYmFyIGRvZXNuJ3QgY2F1c2UgYW4gaXNzdWUgcmVwb3J0IGAwYCBmb3JcbiAgLy8gdGhpcyAoZS5nLiBFZGdlIDIwMTksIElFMTEsIFNhZmFyaSlcbiAgcmV0dXJuIGdldEJvdW5kaW5nQ2xpZW50UmVjdChnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkpLmxlZnQgKyBnZXRXaW5kb3dTY3JvbGwoZWxlbWVudCkuc2Nyb2xsTGVmdDtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRWaWV3cG9ydFJlY3QoZWxlbWVudCkge1xuICB2YXIgd2luID0gZ2V0V2luZG93KGVsZW1lbnQpO1xuICB2YXIgaHRtbCA9IGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KTtcbiAgdmFyIHZpc3VhbFZpZXdwb3J0ID0gd2luLnZpc3VhbFZpZXdwb3J0O1xuICB2YXIgd2lkdGggPSBodG1sLmNsaWVudFdpZHRoO1xuICB2YXIgaGVpZ2h0ID0gaHRtbC5jbGllbnRIZWlnaHQ7XG4gIHZhciB4ID0gMDtcbiAgdmFyIHkgPSAwOyAvLyBOQjogVGhpcyBpc24ndCBzdXBwb3J0ZWQgb24gaU9TIDw9IDEyLiBJZiB0aGUga2V5Ym9hcmQgaXMgb3BlbiwgdGhlIHBvcHBlclxuICAvLyBjYW4gYmUgb2JzY3VyZWQgdW5kZXJuZWF0aCBpdC5cbiAgLy8gQWxzbywgYGh0bWwuY2xpZW50SGVpZ2h0YCBhZGRzIHRoZSBib3R0b20gYmFyIGhlaWdodCBpbiBTYWZhcmkgaU9TLCBldmVuXG4gIC8vIGlmIGl0IGlzbid0IG9wZW4sIHNvIGlmIHRoaXMgaXNuJ3QgYXZhaWxhYmxlLCB0aGUgcG9wcGVyIHdpbGwgYmUgZGV0ZWN0ZWRcbiAgLy8gdG8gb3ZlcmZsb3cgdGhlIGJvdHRvbSBvZiB0aGUgc2NyZWVuIHRvbyBlYXJseS5cblxuICBpZiAodmlzdWFsVmlld3BvcnQpIHtcbiAgICB3aWR0aCA9IHZpc3VhbFZpZXdwb3J0LndpZHRoO1xuICAgIGhlaWdodCA9IHZpc3VhbFZpZXdwb3J0LmhlaWdodDsgLy8gVXNlcyBMYXlvdXQgVmlld3BvcnQgKGxpa2UgQ2hyb21lOyBTYWZhcmkgZG9lcyBub3QgY3VycmVudGx5KVxuICAgIC8vIEluIENocm9tZSwgaXQgcmV0dXJucyBhIHZhbHVlIHZlcnkgY2xvc2UgdG8gMCAoKy8tKSBidXQgY29udGFpbnMgcm91bmRpbmdcbiAgICAvLyBlcnJvcnMgZHVlIHRvIGZsb2F0aW5nIHBvaW50IG51bWJlcnMsIHNvIHdlIG5lZWQgdG8gY2hlY2sgcHJlY2lzaW9uLlxuICAgIC8vIFNhZmFyaSByZXR1cm5zIGEgbnVtYmVyIDw9IDAsIHVzdWFsbHkgPCAtMSB3aGVuIHBpbmNoLXpvb21lZFxuICAgIC8vIEZlYXR1cmUgZGV0ZWN0aW9uIGZhaWxzIGluIG1vYmlsZSBlbXVsYXRpb24gbW9kZSBpbiBDaHJvbWUuXG4gICAgLy8gTWF0aC5hYnMod2luLmlubmVyV2lkdGggLyB2aXN1YWxWaWV3cG9ydC5zY2FsZSAtIHZpc3VhbFZpZXdwb3J0LndpZHRoKSA8XG4gICAgLy8gMC4wMDFcbiAgICAvLyBGYWxsYmFjayBoZXJlOiBcIk5vdCBTYWZhcmlcIiB1c2VyQWdlbnRcblxuICAgIGlmICghL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgeCA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldExlZnQ7XG4gICAgICB5ID0gdmlzdWFsVmlld3BvcnQub2Zmc2V0VG9wO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHg6IHggKyBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpLFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5pbXBvcnQgeyBtYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiOyAvLyBHZXRzIHRoZSBlbnRpcmUgc2l6ZSBvZiB0aGUgc2Nyb2xsYWJsZSBkb2N1bWVudCBhcmVhLCBldmVuIGV4dGVuZGluZyBvdXRzaWRlXG4vLyBvZiB0aGUgYDxodG1sPmAgYW5kIGA8Ym9keT5gIHJlY3QgYm91bmRzIGlmIGhvcml6b250YWxseSBzY3JvbGxhYmxlXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERvY3VtZW50UmVjdChlbGVtZW50KSB7XG4gIHZhciBfZWxlbWVudCRvd25lckRvY3VtZW47XG5cbiAgdmFyIGh0bWwgPSBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7XG4gIHZhciB3aW5TY3JvbGwgPSBnZXRXaW5kb3dTY3JvbGwoZWxlbWVudCk7XG4gIHZhciBib2R5ID0gKF9lbGVtZW50JG93bmVyRG9jdW1lbiA9IGVsZW1lbnQub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9lbGVtZW50JG93bmVyRG9jdW1lbi5ib2R5O1xuICB2YXIgd2lkdGggPSBtYXgoaHRtbC5zY3JvbGxXaWR0aCwgaHRtbC5jbGllbnRXaWR0aCwgYm9keSA/IGJvZHkuc2Nyb2xsV2lkdGggOiAwLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApO1xuICB2YXIgaGVpZ2h0ID0gbWF4KGh0bWwuc2Nyb2xsSGVpZ2h0LCBodG1sLmNsaWVudEhlaWdodCwgYm9keSA/IGJvZHkuc2Nyb2xsSGVpZ2h0IDogMCwgYm9keSA/IGJvZHkuY2xpZW50SGVpZ2h0IDogMCk7XG4gIHZhciB4ID0gLXdpblNjcm9sbC5zY3JvbGxMZWZ0ICsgZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KTtcbiAgdmFyIHkgPSAtd2luU2Nyb2xsLnNjcm9sbFRvcDtcblxuICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShib2R5IHx8IGh0bWwpLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICB4ICs9IG1heChodG1sLmNsaWVudFdpZHRoLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApIC0gd2lkdGg7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNTY3JvbGxQYXJlbnQoZWxlbWVudCkge1xuICAvLyBGaXJlZm94IHdhbnRzIHVzIHRvIGNoZWNrIGAteGAgYW5kIGAteWAgdmFyaWF0aW9ucyBhcyB3ZWxsXG4gIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCksXG4gICAgICBvdmVyZmxvdyA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93LFxuICAgICAgb3ZlcmZsb3dYID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dYLFxuICAgICAgb3ZlcmZsb3dZID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dZO1xuXG4gIHJldHVybiAvYXV0b3xzY3JvbGx8b3ZlcmxheXxoaWRkZW4vLnRlc3Qob3ZlcmZsb3cgKyBvdmVyZmxvd1kgKyBvdmVyZmxvd1gpO1xufSIsICJpbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNjcm9sbFBhcmVudChub2RlKSB7XG4gIGlmIChbJ2h0bWwnLCAnYm9keScsICcjZG9jdW1lbnQnXS5pbmRleE9mKGdldE5vZGVOYW1lKG5vZGUpKSA+PSAwKSB7XG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQuYm9keTtcbiAgfVxuXG4gIGlmIChpc0hUTUxFbGVtZW50KG5vZGUpICYmIGlzU2Nyb2xsUGFyZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICByZXR1cm4gZ2V0U2Nyb2xsUGFyZW50KGdldFBhcmVudE5vZGUobm9kZSkpO1xufSIsICJpbXBvcnQgZ2V0U2Nyb2xsUGFyZW50IGZyb20gXCIuL2dldFNjcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuLypcbmdpdmVuIGEgRE9NIGVsZW1lbnQsIHJldHVybiB0aGUgbGlzdCBvZiBhbGwgc2Nyb2xsIHBhcmVudHMsIHVwIHRoZSBsaXN0IG9mIGFuY2Vzb3JzXG51bnRpbCB3ZSBnZXQgdG8gdGhlIHRvcCB3aW5kb3cgb2JqZWN0LiBUaGlzIGxpc3QgaXMgd2hhdCB3ZSBhdHRhY2ggc2Nyb2xsIGxpc3RlbmVyc1xudG8sIGJlY2F1c2UgaWYgYW55IG9mIHRoZXNlIHBhcmVudCBlbGVtZW50cyBzY3JvbGwsIHdlJ2xsIG5lZWQgdG8gcmUtY2FsY3VsYXRlIHRoZVxucmVmZXJlbmNlIGVsZW1lbnQncyBwb3NpdGlvbi5cbiovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxpc3RTY3JvbGxQYXJlbnRzKGVsZW1lbnQsIGxpc3QpIHtcbiAgdmFyIF9lbGVtZW50JG93bmVyRG9jdW1lbjtcblxuICBpZiAobGlzdCA9PT0gdm9pZCAwKSB7XG4gICAgbGlzdCA9IFtdO1xuICB9XG5cbiAgdmFyIHNjcm9sbFBhcmVudCA9IGdldFNjcm9sbFBhcmVudChlbGVtZW50KTtcbiAgdmFyIGlzQm9keSA9IHNjcm9sbFBhcmVudCA9PT0gKChfZWxlbWVudCRvd25lckRvY3VtZW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZWxlbWVudCRvd25lckRvY3VtZW4uYm9keSk7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coc2Nyb2xsUGFyZW50KTtcbiAgdmFyIHRhcmdldCA9IGlzQm9keSA/IFt3aW5dLmNvbmNhdCh3aW4udmlzdWFsVmlld3BvcnQgfHwgW10sIGlzU2Nyb2xsUGFyZW50KHNjcm9sbFBhcmVudCkgPyBzY3JvbGxQYXJlbnQgOiBbXSkgOiBzY3JvbGxQYXJlbnQ7XG4gIHZhciB1cGRhdGVkTGlzdCA9IGxpc3QuY29uY2F0KHRhcmdldCk7XG4gIHJldHVybiBpc0JvZHkgPyB1cGRhdGVkTGlzdCA6IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBpc0JvZHkgdGVsbHMgdXMgdGFyZ2V0IHdpbGwgYmUgYW4gSFRNTEVsZW1lbnQgaGVyZVxuICB1cGRhdGVkTGlzdC5jb25jYXQobGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZSh0YXJnZXQpKSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlY3RUb0NsaWVudFJlY3QocmVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcmVjdCwge1xuICAgIGxlZnQ6IHJlY3QueCxcbiAgICB0b3A6IHJlY3QueSxcbiAgICByaWdodDogcmVjdC54ICsgcmVjdC53aWR0aCxcbiAgICBib3R0b206IHJlY3QueSArIHJlY3QuaGVpZ2h0XG4gIH0pO1xufSIsICJpbXBvcnQgeyB2aWV3cG9ydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZpZXdwb3J0UmVjdCBmcm9tIFwiLi9nZXRWaWV3cG9ydFJlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudFJlY3QgZnJvbSBcIi4vZ2V0RG9jdW1lbnRSZWN0LmpzXCI7XG5pbXBvcnQgbGlzdFNjcm9sbFBhcmVudHMgZnJvbSBcIi4vbGlzdFNjcm9sbFBhcmVudHMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4vZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBjb250YWlucyBmcm9tIFwiLi9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgcmVjdFRvQ2xpZW50UmVjdCBmcm9tIFwiLi4vdXRpbHMvcmVjdFRvQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IHsgbWF4LCBtaW4gfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBnZXRJbm5lckJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50KSB7XG4gIHZhciByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpO1xuICByZWN0LnRvcCA9IHJlY3QudG9wICsgZWxlbWVudC5jbGllbnRUb3A7XG4gIHJlY3QubGVmdCA9IHJlY3QubGVmdCArIGVsZW1lbnQuY2xpZW50TGVmdDtcbiAgcmVjdC5ib3R0b20gPSByZWN0LnRvcCArIGVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICByZWN0LnJpZ2h0ID0gcmVjdC5sZWZ0ICsgZWxlbWVudC5jbGllbnRXaWR0aDtcbiAgcmVjdC53aWR0aCA9IGVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHJlY3QuaGVpZ2h0ID0gZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gIHJlY3QueCA9IHJlY3QubGVmdDtcbiAgcmVjdC55ID0gcmVjdC50b3A7XG4gIHJldHVybiByZWN0O1xufVxuXG5mdW5jdGlvbiBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBjbGlwcGluZ1BhcmVudCkge1xuICByZXR1cm4gY2xpcHBpbmdQYXJlbnQgPT09IHZpZXdwb3J0ID8gcmVjdFRvQ2xpZW50UmVjdChnZXRWaWV3cG9ydFJlY3QoZWxlbWVudCkpIDogaXNFbGVtZW50KGNsaXBwaW5nUGFyZW50KSA/IGdldElubmVyQm91bmRpbmdDbGllbnRSZWN0KGNsaXBwaW5nUGFyZW50KSA6IHJlY3RUb0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSkpO1xufSAvLyBBIFwiY2xpcHBpbmcgcGFyZW50XCIgaXMgYW4gb3ZlcmZsb3dhYmxlIGNvbnRhaW5lciB3aXRoIHRoZSBjaGFyYWN0ZXJpc3RpYyBvZlxuLy8gY2xpcHBpbmcgKG9yIGhpZGluZykgb3ZlcmZsb3dpbmcgZWxlbWVudHMgd2l0aCBhIHBvc2l0aW9uIGRpZmZlcmVudCBmcm9tXG4vLyBgaW5pdGlhbGBcblxuXG5mdW5jdGlvbiBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkge1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gbGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZShlbGVtZW50KSk7XG4gIHZhciBjYW5Fc2NhcGVDbGlwcGluZyA9IFsnYWJzb2x1dGUnLCAnZml4ZWQnXS5pbmRleE9mKGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkucG9zaXRpb24pID49IDA7XG4gIHZhciBjbGlwcGVyRWxlbWVudCA9IGNhbkVzY2FwZUNsaXBwaW5nICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgPyBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkgOiBlbGVtZW50O1xuXG4gIGlmICghaXNFbGVtZW50KGNsaXBwZXJFbGVtZW50KSkge1xuICAgIHJldHVybiBbXTtcbiAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svZmxvdy9pc3N1ZXMvMTQxNFxuXG5cbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50cy5maWx0ZXIoZnVuY3Rpb24gKGNsaXBwaW5nUGFyZW50KSB7XG4gICAgcmV0dXJuIGlzRWxlbWVudChjbGlwcGluZ1BhcmVudCkgJiYgY29udGFpbnMoY2xpcHBpbmdQYXJlbnQsIGNsaXBwZXJFbGVtZW50KSAmJiBnZXROb2RlTmFtZShjbGlwcGluZ1BhcmVudCkgIT09ICdib2R5JztcbiAgfSk7XG59IC8vIEdldHMgdGhlIG1heGltdW0gYXJlYSB0aGF0IHRoZSBlbGVtZW50IGlzIHZpc2libGUgaW4gZHVlIHRvIGFueSBudW1iZXIgb2Zcbi8vIGNsaXBwaW5nIHBhcmVudHNcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDbGlwcGluZ1JlY3QoZWxlbWVudCwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSkge1xuICB2YXIgbWFpbkNsaXBwaW5nUGFyZW50cyA9IGJvdW5kYXJ5ID09PSAnY2xpcHBpbmdQYXJlbnRzJyA/IGdldENsaXBwaW5nUGFyZW50cyhlbGVtZW50KSA6IFtdLmNvbmNhdChib3VuZGFyeSk7XG4gIHZhciBjbGlwcGluZ1BhcmVudHMgPSBbXS5jb25jYXQobWFpbkNsaXBwaW5nUGFyZW50cywgW3Jvb3RCb3VuZGFyeV0pO1xuICB2YXIgZmlyc3RDbGlwcGluZ1BhcmVudCA9IGNsaXBwaW5nUGFyZW50c1swXTtcbiAgdmFyIGNsaXBwaW5nUmVjdCA9IGNsaXBwaW5nUGFyZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjY1JlY3QsIGNsaXBwaW5nUGFyZW50KSB7XG4gICAgdmFyIHJlY3QgPSBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBjbGlwcGluZ1BhcmVudCk7XG4gICAgYWNjUmVjdC50b3AgPSBtYXgocmVjdC50b3AsIGFjY1JlY3QudG9wKTtcbiAgICBhY2NSZWN0LnJpZ2h0ID0gbWluKHJlY3QucmlnaHQsIGFjY1JlY3QucmlnaHQpO1xuICAgIGFjY1JlY3QuYm90dG9tID0gbWluKHJlY3QuYm90dG9tLCBhY2NSZWN0LmJvdHRvbSk7XG4gICAgYWNjUmVjdC5sZWZ0ID0gbWF4KHJlY3QubGVmdCwgYWNjUmVjdC5sZWZ0KTtcbiAgICByZXR1cm4gYWNjUmVjdDtcbiAgfSwgZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgZmlyc3RDbGlwcGluZ1BhcmVudCkpO1xuICBjbGlwcGluZ1JlY3Qud2lkdGggPSBjbGlwcGluZ1JlY3QucmlnaHQgLSBjbGlwcGluZ1JlY3QubGVmdDtcbiAgY2xpcHBpbmdSZWN0LmhlaWdodCA9IGNsaXBwaW5nUmVjdC5ib3R0b20gLSBjbGlwcGluZ1JlY3QudG9wO1xuICBjbGlwcGluZ1JlY3QueCA9IGNsaXBwaW5nUmVjdC5sZWZ0O1xuICBjbGlwcGluZ1JlY3QueSA9IGNsaXBwaW5nUmVjdC50b3A7XG4gIHJldHVybiBjbGlwcGluZ1JlY3Q7XG59IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0LCBzdGFydCwgZW5kIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb21wdXRlT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciByZWZlcmVuY2UgPSBfcmVmLnJlZmVyZW5jZSxcbiAgICAgIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQsXG4gICAgICBwbGFjZW1lbnQgPSBfcmVmLnBsYWNlbWVudDtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBwbGFjZW1lbnQgPyBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgdmFyaWF0aW9uID0gcGxhY2VtZW50ID8gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgY29tbW9uWCA9IHJlZmVyZW5jZS54ICsgcmVmZXJlbmNlLndpZHRoIC8gMiAtIGVsZW1lbnQud2lkdGggLyAyO1xuICB2YXIgY29tbW9uWSA9IHJlZmVyZW5jZS55ICsgcmVmZXJlbmNlLmhlaWdodCAvIDIgLSBlbGVtZW50LmhlaWdodCAvIDI7XG4gIHZhciBvZmZzZXRzO1xuXG4gIHN3aXRjaCAoYmFzZVBsYWNlbWVudCkge1xuICAgIGNhc2UgdG9wOlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogY29tbW9uWCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnkgLSBlbGVtZW50LmhlaWdodFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBib3R0b206XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiBjb21tb25YLFxuICAgICAgICB5OiByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHRcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgcmlnaHQ6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCxcbiAgICAgICAgeTogY29tbW9uWVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBsZWZ0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLnggLSBlbGVtZW50LndpZHRoLFxuICAgICAgICB5OiBjb21tb25ZXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLngsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55XG4gICAgICB9O1xuICB9XG5cbiAgdmFyIG1haW5BeGlzID0gYmFzZVBsYWNlbWVudCA/IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KSA6IG51bGw7XG5cbiAgaWYgKG1haW5BeGlzICE9IG51bGwpIHtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHN3aXRjaCAodmFyaWF0aW9uKSB7XG4gICAgICBjYXNlIHN0YXJ0OlxuICAgICAgICBvZmZzZXRzW21haW5BeGlzXSA9IG9mZnNldHNbbWFpbkF4aXNdIC0gKHJlZmVyZW5jZVtsZW5dIC8gMiAtIGVsZW1lbnRbbGVuXSAvIDIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBlbmQ6XG4gICAgICAgIG9mZnNldHNbbWFpbkF4aXNdID0gb2Zmc2V0c1ttYWluQXhpc10gKyAocmVmZXJlbmNlW2xlbl0gLyAyIC0gZWxlbWVudFtsZW5dIC8gMik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvZmZzZXRzO1xufSIsICJpbXBvcnQgZ2V0Q2xpcHBpbmdSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgY29tcHV0ZU9mZnNldHMgZnJvbSBcIi4vY29tcHV0ZU9mZnNldHMuanNcIjtcbmltcG9ydCByZWN0VG9DbGllbnRSZWN0IGZyb20gXCIuL3JlY3RUb0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCB7IGNsaXBwaW5nUGFyZW50cywgcmVmZXJlbmNlLCBwb3BwZXIsIGJvdHRvbSwgdG9wLCByaWdodCwgYmFzZVBsYWNlbWVudHMsIHZpZXdwb3J0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBtZXJnZVBhZGRpbmdPYmplY3QgZnJvbSBcIi4vbWVyZ2VQYWRkaW5nT2JqZWN0LmpzXCI7XG5pbXBvcnQgZXhwYW5kVG9IYXNoTWFwIGZyb20gXCIuL2V4cGFuZFRvSGFzaE1hcC5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRldGVjdE92ZXJmbG93KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgX29wdGlvbnMkcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMkcGxhY2VtZW50ID09PSB2b2lkIDAgPyBzdGF0ZS5wbGFjZW1lbnQgOiBfb3B0aW9ucyRwbGFjZW1lbnQsXG4gICAgICBfb3B0aW9ucyRib3VuZGFyeSA9IF9vcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucyRib3VuZGFyeSA9PT0gdm9pZCAwID8gY2xpcHBpbmdQYXJlbnRzIDogX29wdGlvbnMkYm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRyb290Qm91bmRhcnkgPSBfb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBfb3B0aW9ucyRyb290Qm91bmRhcnkgPT09IHZvaWQgMCA/IHZpZXdwb3J0IDogX29wdGlvbnMkcm9vdEJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkZWxlbWVudENvbnRlID0gX29wdGlvbnMuZWxlbWVudENvbnRleHQsXG4gICAgICBlbGVtZW50Q29udGV4dCA9IF9vcHRpb25zJGVsZW1lbnRDb250ZSA9PT0gdm9pZCAwID8gcG9wcGVyIDogX29wdGlvbnMkZWxlbWVudENvbnRlLFxuICAgICAgX29wdGlvbnMkYWx0Qm91bmRhcnkgPSBfb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gX29wdGlvbnMkYWx0Qm91bmRhcnkgPT09IHZvaWQgMCA/IGZhbHNlIDogX29wdGlvbnMkYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRwYWRkaW5nID0gX29wdGlvbnMucGFkZGluZyxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucyRwYWRkaW5nID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkcGFkZGluZztcbiAgdmFyIHBhZGRpbmdPYmplY3QgPSBtZXJnZVBhZGRpbmdPYmplY3QodHlwZW9mIHBhZGRpbmcgIT09ICdudW1iZXInID8gcGFkZGluZyA6IGV4cGFuZFRvSGFzaE1hcChwYWRkaW5nLCBiYXNlUGxhY2VtZW50cykpO1xuICB2YXIgYWx0Q29udGV4dCA9IGVsZW1lbnRDb250ZXh0ID09PSBwb3BwZXIgPyByZWZlcmVuY2UgOiBwb3BwZXI7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW2FsdEJvdW5kYXJ5ID8gYWx0Q29udGV4dCA6IGVsZW1lbnRDb250ZXh0XTtcbiAgdmFyIGNsaXBwaW5nQ2xpZW50UmVjdCA9IGdldENsaXBwaW5nUmVjdChpc0VsZW1lbnQoZWxlbWVudCkgPyBlbGVtZW50IDogZWxlbWVudC5jb250ZXh0RWxlbWVudCB8fCBnZXREb2N1bWVudEVsZW1lbnQoc3RhdGUuZWxlbWVudHMucG9wcGVyKSwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSk7XG4gIHZhciByZWZlcmVuY2VDbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KHN0YXRlLmVsZW1lbnRzLnJlZmVyZW5jZSk7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gY29tcHV0ZU9mZnNldHMoe1xuICAgIHJlZmVyZW5jZTogcmVmZXJlbmNlQ2xpZW50UmVjdCxcbiAgICBlbGVtZW50OiBwb3BwZXJSZWN0LFxuICAgIHN0cmF0ZWd5OiAnYWJzb2x1dGUnLFxuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pO1xuICB2YXIgcG9wcGVyQ2xpZW50UmVjdCA9IHJlY3RUb0NsaWVudFJlY3QoT2JqZWN0LmFzc2lnbih7fSwgcG9wcGVyUmVjdCwgcG9wcGVyT2Zmc2V0cykpO1xuICB2YXIgZWxlbWVudENsaWVudFJlY3QgPSBlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyID8gcG9wcGVyQ2xpZW50UmVjdCA6IHJlZmVyZW5jZUNsaWVudFJlY3Q7IC8vIHBvc2l0aXZlID0gb3ZlcmZsb3dpbmcgdGhlIGNsaXBwaW5nIHJlY3RcbiAgLy8gMCBvciBuZWdhdGl2ZSA9IHdpdGhpbiB0aGUgY2xpcHBpbmcgcmVjdFxuXG4gIHZhciBvdmVyZmxvd09mZnNldHMgPSB7XG4gICAgdG9wOiBjbGlwcGluZ0NsaWVudFJlY3QudG9wIC0gZWxlbWVudENsaWVudFJlY3QudG9wICsgcGFkZGluZ09iamVjdC50b3AsXG4gICAgYm90dG9tOiBlbGVtZW50Q2xpZW50UmVjdC5ib3R0b20gLSBjbGlwcGluZ0NsaWVudFJlY3QuYm90dG9tICsgcGFkZGluZ09iamVjdC5ib3R0b20sXG4gICAgbGVmdDogY2xpcHBpbmdDbGllbnRSZWN0LmxlZnQgLSBlbGVtZW50Q2xpZW50UmVjdC5sZWZ0ICsgcGFkZGluZ09iamVjdC5sZWZ0LFxuICAgIHJpZ2h0OiBlbGVtZW50Q2xpZW50UmVjdC5yaWdodCAtIGNsaXBwaW5nQ2xpZW50UmVjdC5yaWdodCArIHBhZGRpbmdPYmplY3QucmlnaHRcbiAgfTtcbiAgdmFyIG9mZnNldERhdGEgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldDsgLy8gT2Zmc2V0cyBjYW4gYmUgYXBwbGllZCBvbmx5IHRvIHRoZSBwb3BwZXIgZWxlbWVudFxuXG4gIGlmIChlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyICYmIG9mZnNldERhdGEpIHtcbiAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0RGF0YVtwbGFjZW1lbnRdO1xuICAgIE9iamVjdC5rZXlzKG92ZXJmbG93T2Zmc2V0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB2YXIgbXVsdGlwbHkgPSBbcmlnaHQsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAxIDogLTE7XG4gICAgICB2YXIgYXhpcyA9IFt0b3AsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAneScgOiAneCc7XG4gICAgICBvdmVyZmxvd09mZnNldHNba2V5XSArPSBvZmZzZXRbYXhpc10gKiBtdWx0aXBseTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBvdmVyZmxvd09mZnNldHM7XG59IiwgImltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyB2YXJpYXRpb25QbGFjZW1lbnRzLCBiYXNlUGxhY2VtZW50cywgcGxhY2VtZW50cyBhcyBhbGxQbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4vZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbXB1dGVBdXRvUGxhY2VtZW50KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucy5mbGlwVmFyaWF0aW9ucyxcbiAgICAgIF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9IF9vcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cyxcbiAgICAgIGFsbG93ZWRBdXRvUGxhY2VtZW50cyA9IF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9PT0gdm9pZCAwID8gYWxsUGxhY2VtZW50cyA6IF9vcHRpb25zJGFsbG93ZWRBdXRvUDtcbiAgdmFyIHZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpO1xuICB2YXIgcGxhY2VtZW50cyA9IHZhcmlhdGlvbiA/IGZsaXBWYXJpYXRpb25zID8gdmFyaWF0aW9uUGxhY2VtZW50cyA6IHZhcmlhdGlvblBsYWNlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHZhcmlhdGlvbjtcbiAgfSkgOiBiYXNlUGxhY2VtZW50cztcbiAgdmFyIGFsbG93ZWRQbGFjZW1lbnRzID0gcGxhY2VtZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgIHJldHVybiBhbGxvd2VkQXV0b1BsYWNlbWVudHMuaW5kZXhPZihwbGFjZW1lbnQpID49IDA7XG4gIH0pO1xuXG4gIGlmIChhbGxvd2VkUGxhY2VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBhbGxvd2VkUGxhY2VtZW50cyA9IHBsYWNlbWVudHM7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBUaGUgYGFsbG93ZWRBdXRvUGxhY2VtZW50c2Agb3B0aW9uIGRpZCBub3QgYWxsb3cgYW55JywgJ3BsYWNlbWVudHMuIEVuc3VyZSB0aGUgYHBsYWNlbWVudGAgb3B0aW9uIG1hdGNoZXMgdGhlIHZhcmlhdGlvbicsICdvZiB0aGUgYWxsb3dlZCBwbGFjZW1lbnRzLicsICdGb3IgZXhhbXBsZSwgXCJhdXRvXCIgY2Fubm90IGJlIHVzZWQgdG8gYWxsb3cgXCJib3R0b20tc3RhcnRcIi4nLCAnVXNlIFwiYXV0by1zdGFydFwiIGluc3RlYWQuJ10uam9pbignICcpKTtcbiAgICB9XG4gIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtdHlwZV06IEZsb3cgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtcyB3aXRoIHR3byBhcnJheSB1bmlvbnMuLi5cblxuXG4gIHZhciBvdmVyZmxvd3MgPSBhbGxvd2VkUGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgYWNjW3BsYWNlbWVudF0gPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICB9KVtnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCldO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG92ZXJmbG93cykuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBvdmVyZmxvd3NbYV0gLSBvdmVyZmxvd3NbYl07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0T3Bwb3NpdGVQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE9wcG9zaXRlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGNvbXB1dGVBdXRvUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9jb21wdXRlQXV0b1BsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgYm90dG9tLCB0b3AsIHN0YXJ0LCByaWdodCwgbGVmdCwgYXV0byB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZnVuY3Rpb24gZ2V0RXhwYW5kZWRGYWxsYmFja1BsYWNlbWVudHMocGxhY2VtZW50KSB7XG4gIGlmIChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICB2YXIgb3Bwb3NpdGVQbGFjZW1lbnQgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpO1xuICByZXR1cm4gW2dldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KHBsYWNlbWVudCksIG9wcG9zaXRlUGxhY2VtZW50LCBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChvcHBvc2l0ZVBsYWNlbWVudCldO1xufVxuXG5mdW5jdGlvbiBmbGlwKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdLl9za2lwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIF9vcHRpb25zJG1haW5BeGlzID0gb3B0aW9ucy5tYWluQXhpcyxcbiAgICAgIGNoZWNrTWFpbkF4aXMgPSBfb3B0aW9ucyRtYWluQXhpcyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJG1haW5BeGlzLFxuICAgICAgX29wdGlvbnMkYWx0QXhpcyA9IG9wdGlvbnMuYWx0QXhpcyxcbiAgICAgIGNoZWNrQWx0QXhpcyA9IF9vcHRpb25zJGFsdEF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRhbHRBeGlzLFxuICAgICAgc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzID0gb3B0aW9ucy5mYWxsYmFja1BsYWNlbWVudHMsXG4gICAgICBwYWRkaW5nID0gb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgYm91bmRhcnkgPSBvcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IG9wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPSBvcHRpb25zLmZsaXBWYXJpYXRpb25zLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRmbGlwVmFyaWF0aW8sXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHMgPSBvcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cztcbiAgdmFyIHByZWZlcnJlZFBsYWNlbWVudCA9IHN0YXRlLm9wdGlvbnMucGxhY2VtZW50O1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocHJlZmVycmVkUGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9IGJhc2VQbGFjZW1lbnQgPT09IHByZWZlcnJlZFBsYWNlbWVudDtcbiAgdmFyIGZhbGxiYWNrUGxhY2VtZW50cyA9IHNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyB8fCAoaXNCYXNlUGxhY2VtZW50IHx8ICFmbGlwVmFyaWF0aW9ucyA/IFtnZXRPcHBvc2l0ZVBsYWNlbWVudChwcmVmZXJyZWRQbGFjZW1lbnQpXSA6IGdldEV4cGFuZGVkRmFsbGJhY2tQbGFjZW1lbnRzKHByZWZlcnJlZFBsYWNlbWVudCkpO1xuICB2YXIgcGxhY2VtZW50cyA9IFtwcmVmZXJyZWRQbGFjZW1lbnRdLmNvbmNhdChmYWxsYmFja1BsYWNlbWVudHMpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8gPyBjb21wdXRlQXV0b1BsYWNlbWVudChzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgICBmbGlwVmFyaWF0aW9uczogZmxpcFZhcmlhdGlvbnMsXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHM6IGFsbG93ZWRBdXRvUGxhY2VtZW50c1xuICAgIH0pIDogcGxhY2VtZW50KTtcbiAgfSwgW10pO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBjaGVja3NNYXAgPSBuZXcgTWFwKCk7XG4gIHZhciBtYWtlRmFsbGJhY2tDaGVja3MgPSB0cnVlO1xuICB2YXIgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gcGxhY2VtZW50c1swXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcGxhY2VtZW50ID0gcGxhY2VtZW50c1tpXTtcblxuICAgIHZhciBfYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcblxuICAgIHZhciBpc1N0YXJ0VmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHN0YXJ0O1xuICAgIHZhciBpc1ZlcnRpY2FsID0gW3RvcCwgYm90dG9tXS5pbmRleE9mKF9iYXNlUGxhY2VtZW50KSA+PSAwO1xuICAgIHZhciBsZW4gPSBpc1ZlcnRpY2FsID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICAgIHZhciBvdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnk6IGFsdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZzogcGFkZGluZ1xuICAgIH0pO1xuICAgIHZhciBtYWluVmFyaWF0aW9uU2lkZSA9IGlzVmVydGljYWwgPyBpc1N0YXJ0VmFyaWF0aW9uID8gcmlnaHQgOiBsZWZ0IDogaXNTdGFydFZhcmlhdGlvbiA/IGJvdHRvbSA6IHRvcDtcblxuICAgIGlmIChyZWZlcmVuY2VSZWN0W2xlbl0gPiBwb3BwZXJSZWN0W2xlbl0pIHtcbiAgICAgIG1haW5WYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIH1cblxuICAgIHZhciBhbHRWYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIHZhciBjaGVja3MgPSBbXTtcblxuICAgIGlmIChjaGVja01haW5BeGlzKSB7XG4gICAgICBjaGVja3MucHVzaChvdmVyZmxvd1tfYmFzZVBsYWNlbWVudF0gPD0gMCk7XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrQWx0QXhpcykge1xuICAgICAgY2hlY2tzLnB1c2gob3ZlcmZsb3dbbWFpblZhcmlhdGlvblNpZGVdIDw9IDAsIG92ZXJmbG93W2FsdFZhcmlhdGlvblNpZGVdIDw9IDApO1xuICAgIH1cblxuICAgIGlmIChjaGVja3MuZXZlcnkoZnVuY3Rpb24gKGNoZWNrKSB7XG4gICAgICByZXR1cm4gY2hlY2s7XG4gICAgfSkpIHtcbiAgICAgIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudDtcbiAgICAgIG1ha2VGYWxsYmFja0NoZWNrcyA9IGZhbHNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY2hlY2tzTWFwLnNldChwbGFjZW1lbnQsIGNoZWNrcyk7XG4gIH1cblxuICBpZiAobWFrZUZhbGxiYWNrQ2hlY2tzKSB7XG4gICAgLy8gYDJgIG1heSBiZSBkZXNpcmVkIGluIHNvbWUgY2FzZXMgXHUyMDEzIHJlc2VhcmNoIGxhdGVyXG4gICAgdmFyIG51bWJlck9mQ2hlY2tzID0gZmxpcFZhcmlhdGlvbnMgPyAzIDogMTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKF9pKSB7XG4gICAgICB2YXIgZml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudHMuZmluZChmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgICAgIHZhciBjaGVja3MgPSBjaGVja3NNYXAuZ2V0KHBsYWNlbWVudCk7XG5cbiAgICAgICAgaWYgKGNoZWNrcykge1xuICAgICAgICAgIHJldHVybiBjaGVja3Muc2xpY2UoMCwgX2kpLmV2ZXJ5KGZ1bmN0aW9uIChjaGVjaykge1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGZpdHRpbmdQbGFjZW1lbnQpIHtcbiAgICAgICAgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gZml0dGluZ1BsYWNlbWVudDtcbiAgICAgICAgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm9yICh2YXIgX2kgPSBudW1iZXJPZkNoZWNrczsgX2kgPiAwOyBfaS0tKSB7XG4gICAgICB2YXIgX3JldCA9IF9sb29wKF9pKTtcblxuICAgICAgaWYgKF9yZXQgPT09IFwiYnJlYWtcIikgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKHN0YXRlLnBsYWNlbWVudCAhPT0gZmlyc3RGaXR0aW5nUGxhY2VtZW50KSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXS5fc2tpcCA9IHRydWU7XG4gICAgc3RhdGUucGxhY2VtZW50ID0gZmlyc3RGaXR0aW5nUGxhY2VtZW50O1xuICAgIHN0YXRlLnJlc2V0ID0gdHJ1ZTtcbiAgfVxufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnZmxpcCcsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBmbGlwLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddLFxuICBkYXRhOiB7XG4gICAgX3NraXA6IGZhbHNlXG4gIH1cbn07IiwgImltcG9ydCB7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuXG5mdW5jdGlvbiBnZXRTaWRlT2Zmc2V0cyhvdmVyZmxvdywgcmVjdCwgcHJldmVudGVkT2Zmc2V0cykge1xuICBpZiAocHJldmVudGVkT2Zmc2V0cyA9PT0gdm9pZCAwKSB7XG4gICAgcHJldmVudGVkT2Zmc2V0cyA9IHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdG9wOiBvdmVyZmxvdy50b3AgLSByZWN0LmhlaWdodCAtIHByZXZlbnRlZE9mZnNldHMueSxcbiAgICByaWdodDogb3ZlcmZsb3cucmlnaHQgLSByZWN0LndpZHRoICsgcHJldmVudGVkT2Zmc2V0cy54LFxuICAgIGJvdHRvbTogb3ZlcmZsb3cuYm90dG9tIC0gcmVjdC5oZWlnaHQgKyBwcmV2ZW50ZWRPZmZzZXRzLnksXG4gICAgbGVmdDogb3ZlcmZsb3cubGVmdCAtIHJlY3Qud2lkdGggLSBwcmV2ZW50ZWRPZmZzZXRzLnhcbiAgfTtcbn1cblxuZnVuY3Rpb24gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKG92ZXJmbG93KSB7XG4gIHJldHVybiBbdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0XS5zb21lKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgcmV0dXJuIG92ZXJmbG93W3NpZGVdID49IDA7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoaWRlKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHByZXZlbnRlZE9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnByZXZlbnRPdmVyZmxvdztcbiAgdmFyIHJlZmVyZW5jZU92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBlbGVtZW50Q29udGV4dDogJ3JlZmVyZW5jZSdcbiAgfSk7XG4gIHZhciBwb3BwZXJBbHRPdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgYWx0Qm91bmRhcnk6IHRydWVcbiAgfSk7XG4gIHZhciByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMgPSBnZXRTaWRlT2Zmc2V0cyhyZWZlcmVuY2VPdmVyZmxvdywgcmVmZXJlbmNlUmVjdCk7XG4gIHZhciBwb3BwZXJFc2NhcGVPZmZzZXRzID0gZ2V0U2lkZU9mZnNldHMocG9wcGVyQWx0T3ZlcmZsb3csIHBvcHBlclJlY3QsIHByZXZlbnRlZE9mZnNldHMpO1xuICB2YXIgaXNSZWZlcmVuY2VIaWRkZW4gPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzKTtcbiAgdmFyIGhhc1BvcHBlckVzY2FwZWQgPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocG9wcGVyRXNjYXBlT2Zmc2V0cyk7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSB7XG4gICAgcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzOiByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMsXG4gICAgcG9wcGVyRXNjYXBlT2Zmc2V0czogcG9wcGVyRXNjYXBlT2Zmc2V0cyxcbiAgICBpc1JlZmVyZW5jZUhpZGRlbjogaXNSZWZlcmVuY2VIaWRkZW4sXG4gICAgaGFzUG9wcGVyRXNjYXBlZDogaGFzUG9wcGVyRXNjYXBlZFxuICB9O1xuICBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyLCB7XG4gICAgJ2RhdGEtcG9wcGVyLXJlZmVyZW5jZS1oaWRkZW4nOiBpc1JlZmVyZW5jZUhpZGRlbixcbiAgICAnZGF0YS1wb3BwZXItZXNjYXBlZCc6IGhhc1BvcHBlckVzY2FwZWRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdoaWRlJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydwcmV2ZW50T3ZlcmZsb3cnXSxcbiAgZm46IGhpZGVcbn07IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBwbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RhbmNlQW5kU2tpZGRpbmdUb1hZKHBsYWNlbWVudCwgcmVjdHMsIG9mZnNldCkge1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcbiAgdmFyIGludmVydERpc3RhbmNlID0gW2xlZnQsIHRvcF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwID8gLTEgOiAxO1xuXG4gIHZhciBfcmVmID0gdHlwZW9mIG9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IG9mZnNldChPYmplY3QuYXNzaWduKHt9LCByZWN0cywge1xuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pKSA6IG9mZnNldCxcbiAgICAgIHNraWRkaW5nID0gX3JlZlswXSxcbiAgICAgIGRpc3RhbmNlID0gX3JlZlsxXTtcblxuICBza2lkZGluZyA9IHNraWRkaW5nIHx8IDA7XG4gIGRpc3RhbmNlID0gKGRpc3RhbmNlIHx8IDApICogaW52ZXJ0RGlzdGFuY2U7XG4gIHJldHVybiBbbGVmdCwgcmlnaHRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMCA/IHtcbiAgICB4OiBkaXN0YW5jZSxcbiAgICB5OiBza2lkZGluZ1xuICB9IDoge1xuICAgIHg6IHNraWRkaW5nLFxuICAgIHk6IGRpc3RhbmNlXG4gIH07XG59XG5cbmZ1bmN0aW9uIG9mZnNldChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYyLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRvZmZzZXQgPSBvcHRpb25zLm9mZnNldCxcbiAgICAgIG9mZnNldCA9IF9vcHRpb25zJG9mZnNldCA9PT0gdm9pZCAwID8gWzAsIDBdIDogX29wdGlvbnMkb2Zmc2V0O1xuICB2YXIgZGF0YSA9IHBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIGFjY1twbGFjZW1lbnRdID0gZGlzdGFuY2VBbmRTa2lkZGluZ1RvWFkocGxhY2VtZW50LCBzdGF0ZS5yZWN0cywgb2Zmc2V0KTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHZhciBfZGF0YSRzdGF0ZSRwbGFjZW1lbnQgPSBkYXRhW3N0YXRlLnBsYWNlbWVudF0sXG4gICAgICB4ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50LngsXG4gICAgICB5ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50Lnk7XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLnggKz0geDtcbiAgICBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMueSArPSB5O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdvZmZzZXQnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIGZuOiBvZmZzZXRcbn07IiwgImltcG9ydCBjb21wdXRlT2Zmc2V0cyBmcm9tIFwiLi4vdXRpbHMvY29tcHV0ZU9mZnNldHMuanNcIjtcblxuZnVuY3Rpb24gcG9wcGVyT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICAvLyBPZmZzZXRzIGFyZSB0aGUgYWN0dWFsIHBvc2l0aW9uIHRoZSBwb3BwZXIgbmVlZHMgdG8gaGF2ZSB0byBiZVxuICAvLyBwcm9wZXJseSBwb3NpdGlvbmVkIG5lYXIgaXRzIHJlZmVyZW5jZSBlbGVtZW50XG4gIC8vIFRoaXMgaXMgdGhlIG1vc3QgYmFzaWMgcGxhY2VtZW50LCBhbmQgd2lsbCBiZSBhZGp1c3RlZCBieVxuICAvLyB0aGUgbW9kaWZpZXJzIGluIHRoZSBuZXh0IHN0ZXBcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGNvbXB1dGVPZmZzZXRzKHtcbiAgICByZWZlcmVuY2U6IHN0YXRlLnJlY3RzLnJlZmVyZW5jZSxcbiAgICBlbGVtZW50OiBzdGF0ZS5yZWN0cy5wb3BwZXIsXG4gICAgc3RyYXRlZ3k6ICdhYnNvbHV0ZScsXG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwb3BwZXJPZmZzZXRzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdyZWFkJyxcbiAgZm46IHBvcHBlck9mZnNldHMsXG4gIGRhdGE6IHt9XG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRBbHRBeGlzKGF4aXMpIHtcbiAgcmV0dXJuIGF4aXMgPT09ICd4JyA/ICd5JyA6ICd4Jztcbn0iLCAiaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgYm90dG9tLCBzdGFydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldEFsdEF4aXMgZnJvbSBcIi4uL3V0aWxzL2dldEFsdEF4aXMuanNcIjtcbmltcG9ydCB7IHdpdGhpbiwgd2l0aGluTWF4Q2xhbXAgfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IGdldEZyZXNoU2lkZU9iamVjdCBmcm9tIFwiLi4vdXRpbHMvZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5pbXBvcnQgeyBtaW4gYXMgbWF0aE1pbiwgbWF4IGFzIG1hdGhNYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBwcmV2ZW50T3ZlcmZsb3coX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRtYWluQXhpcyA9IG9wdGlvbnMubWFpbkF4aXMsXG4gICAgICBjaGVja01haW5BeGlzID0gX29wdGlvbnMkbWFpbkF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRtYWluQXhpcyxcbiAgICAgIF9vcHRpb25zJGFsdEF4aXMgPSBvcHRpb25zLmFsdEF4aXMsXG4gICAgICBjaGVja0FsdEF4aXMgPSBfb3B0aW9ucyRhbHRBeGlzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJGFsdEF4aXMsXG4gICAgICBib3VuZGFyeSA9IG9wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBvcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBvcHRpb25zLnBhZGRpbmcsXG4gICAgICBfb3B0aW9ucyR0ZXRoZXIgPSBvcHRpb25zLnRldGhlcixcbiAgICAgIHRldGhlciA9IF9vcHRpb25zJHRldGhlciA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHRldGhlcixcbiAgICAgIF9vcHRpb25zJHRldGhlck9mZnNldCA9IG9wdGlvbnMudGV0aGVyT2Zmc2V0LFxuICAgICAgdGV0aGVyT2Zmc2V0ID0gX29wdGlvbnMkdGV0aGVyT2Zmc2V0ID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkdGV0aGVyT2Zmc2V0O1xuICB2YXIgb3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgIGFsdEJvdW5kYXJ5OiBhbHRCb3VuZGFyeVxuICB9KTtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciB2YXJpYXRpb24gPSBnZXRWYXJpYXRpb24oc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9ICF2YXJpYXRpb247XG4gIHZhciBtYWluQXhpcyA9IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KTtcbiAgdmFyIGFsdEF4aXMgPSBnZXRBbHRBeGlzKG1haW5BeGlzKTtcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHM7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHRldGhlck9mZnNldFZhbHVlID0gdHlwZW9mIHRldGhlck9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IHRldGhlck9mZnNldChPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHRldGhlck9mZnNldDtcbiAgdmFyIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZSA9IHR5cGVvZiB0ZXRoZXJPZmZzZXRWYWx1ZSA9PT0gJ251bWJlcicgPyB7XG4gICAgbWFpbkF4aXM6IHRldGhlck9mZnNldFZhbHVlLFxuICAgIGFsdEF4aXM6IHRldGhlck9mZnNldFZhbHVlXG4gIH0gOiBPYmplY3QuYXNzaWduKHtcbiAgICBtYWluQXhpczogMCxcbiAgICBhbHRBeGlzOiAwXG4gIH0sIHRldGhlck9mZnNldFZhbHVlKTtcbiAgdmFyIG9mZnNldE1vZGlmaWVyU3RhdGUgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldCA/IHN0YXRlLm1vZGlmaWVyc0RhdGEub2Zmc2V0W3N0YXRlLnBsYWNlbWVudF0gOiBudWxsO1xuICB2YXIgZGF0YSA9IHtcbiAgICB4OiAwLFxuICAgIHk6IDBcbiAgfTtcblxuICBpZiAoIXBvcHBlck9mZnNldHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY2hlY2tNYWluQXhpcykge1xuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQ7XG5cbiAgICB2YXIgbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gdG9wIDogbGVmdDtcbiAgICB2YXIgYWx0U2lkZSA9IG1haW5BeGlzID09PSAneScgPyBib3R0b20gOiByaWdodDtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcbiAgICB2YXIgb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1ttYWluQXhpc107XG4gICAgdmFyIG1pbiA9IG9mZnNldCArIG92ZXJmbG93W21haW5TaWRlXTtcbiAgICB2YXIgbWF4ID0gb2Zmc2V0IC0gb3ZlcmZsb3dbYWx0U2lkZV07XG4gICAgdmFyIGFkZGl0aXZlID0gdGV0aGVyID8gLXBvcHBlclJlY3RbbGVuXSAvIDIgOiAwO1xuICAgIHZhciBtaW5MZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gcmVmZXJlbmNlUmVjdFtsZW5dIDogcG9wcGVyUmVjdFtsZW5dO1xuICAgIHZhciBtYXhMZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gLXBvcHBlclJlY3RbbGVuXSA6IC1yZWZlcmVuY2VSZWN0W2xlbl07IC8vIFdlIG5lZWQgdG8gaW5jbHVkZSB0aGUgYXJyb3cgaW4gdGhlIGNhbGN1bGF0aW9uIHNvIHRoZSBhcnJvdyBkb2Vzbid0IGdvXG4gICAgLy8gb3V0c2lkZSB0aGUgcmVmZXJlbmNlIGJvdW5kc1xuXG4gICAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICAgIHZhciBhcnJvd1JlY3QgPSB0ZXRoZXIgJiYgYXJyb3dFbGVtZW50ID8gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpIDoge1xuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICAgIHZhciBhcnJvd1BhZGRpbmdPYmplY3QgPSBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10gPyBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10ucGFkZGluZyA6IGdldEZyZXNoU2lkZU9iamVjdCgpO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNaW4gPSBhcnJvd1BhZGRpbmdPYmplY3RbbWFpblNpZGVdO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNYXggPSBhcnJvd1BhZGRpbmdPYmplY3RbYWx0U2lkZV07IC8vIElmIHRoZSByZWZlcmVuY2UgbGVuZ3RoIGlzIHNtYWxsZXIgdGhhbiB0aGUgYXJyb3cgbGVuZ3RoLCB3ZSBkb24ndCB3YW50XG4gICAgLy8gdG8gaW5jbHVkZSBpdHMgZnVsbCBzaXplIGluIHRoZSBjYWxjdWxhdGlvbi4gSWYgdGhlIHJlZmVyZW5jZSBpcyBzbWFsbFxuICAgIC8vIGFuZCBuZWFyIHRoZSBlZGdlIG9mIGEgYm91bmRhcnksIHRoZSBwb3BwZXIgY2FuIG92ZXJmbG93IGV2ZW4gaWYgdGhlXG4gICAgLy8gcmVmZXJlbmNlIGlzIG5vdCBvdmVyZmxvd2luZyBhcyB3ZWxsIChlLmcuIHZpcnR1YWwgZWxlbWVudHMgd2l0aCBub1xuICAgIC8vIHdpZHRoIG9yIGhlaWdodClcblxuICAgIHZhciBhcnJvd0xlbiA9IHdpdGhpbigwLCByZWZlcmVuY2VSZWN0W2xlbl0sIGFycm93UmVjdFtsZW5dKTtcbiAgICB2YXIgbWluT2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gcmVmZXJlbmNlUmVjdFtsZW5dIC8gMiAtIGFkZGl0aXZlIC0gYXJyb3dMZW4gLSBhcnJvd1BhZGRpbmdNaW4gLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXMgOiBtaW5MZW4gLSBhcnJvd0xlbiAtIGFycm93UGFkZGluZ01pbiAtIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcztcbiAgICB2YXIgbWF4T2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gLXJlZmVyZW5jZVJlY3RbbGVuXSAvIDIgKyBhZGRpdGl2ZSArIGFycm93TGVuICsgYXJyb3dQYWRkaW5nTWF4ICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzIDogbWF4TGVuICsgYXJyb3dMZW4gKyBhcnJvd1BhZGRpbmdNYXggKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXM7XG4gICAgdmFyIGFycm93T2Zmc2V0UGFyZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3cgJiYgZ2V0T2Zmc2V0UGFyZW50KHN0YXRlLmVsZW1lbnRzLmFycm93KTtcbiAgICB2YXIgY2xpZW50T2Zmc2V0ID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBtYWluQXhpcyA9PT0gJ3knID8gYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50VG9wIHx8IDAgOiBhcnJvd09mZnNldFBhcmVudC5jbGllbnRMZWZ0IHx8IDAgOiAwO1xuICAgIHZhciBvZmZzZXRNb2RpZmllclZhbHVlID0gKF9vZmZzZXRNb2RpZmllclN0YXRlJCA9IG9mZnNldE1vZGlmaWVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IG9mZnNldE1vZGlmaWVyU3RhdGVbbWFpbkF4aXNdKSAhPSBudWxsID8gX29mZnNldE1vZGlmaWVyU3RhdGUkIDogMDtcbiAgICB2YXIgdGV0aGVyTWluID0gb2Zmc2V0ICsgbWluT2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZSAtIGNsaWVudE9mZnNldDtcbiAgICB2YXIgdGV0aGVyTWF4ID0gb2Zmc2V0ICsgbWF4T2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZTtcbiAgICB2YXIgcHJldmVudGVkT2Zmc2V0ID0gd2l0aGluKHRldGhlciA/IG1hdGhNaW4obWluLCB0ZXRoZXJNaW4pIDogbWluLCBvZmZzZXQsIHRldGhlciA/IG1hdGhNYXgobWF4LCB0ZXRoZXJNYXgpIDogbWF4KTtcbiAgICBwb3BwZXJPZmZzZXRzW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldDtcbiAgICBkYXRhW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldCAtIG9mZnNldDtcbiAgfVxuXG4gIGlmIChjaGVja0FsdEF4aXMpIHtcbiAgICB2YXIgX29mZnNldE1vZGlmaWVyU3RhdGUkMjtcblxuICAgIHZhciBfbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3gnID8gdG9wIDogbGVmdDtcblxuICAgIHZhciBfYWx0U2lkZSA9IG1haW5BeGlzID09PSAneCcgPyBib3R0b20gOiByaWdodDtcblxuICAgIHZhciBfb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1thbHRBeGlzXTtcblxuICAgIHZhciBfbGVuID0gYWx0QXhpcyA9PT0gJ3knID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gICAgdmFyIF9taW4gPSBfb2Zmc2V0ICsgb3ZlcmZsb3dbX21haW5TaWRlXTtcblxuICAgIHZhciBfbWF4ID0gX29mZnNldCAtIG92ZXJmbG93W19hbHRTaWRlXTtcblxuICAgIHZhciBpc09yaWdpblNpZGUgPSBbdG9wLCBsZWZ0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpICE9PSAtMTtcblxuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJWYWx1ZSA9IChfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyID0gb2Zmc2V0TW9kaWZpZXJTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogb2Zmc2V0TW9kaWZpZXJTdGF0ZVthbHRBeGlzXSkgIT0gbnVsbCA/IF9vZmZzZXRNb2RpZmllclN0YXRlJDIgOiAwO1xuXG4gICAgdmFyIF90ZXRoZXJNaW4gPSBpc09yaWdpblNpZGUgPyBfbWluIDogX29mZnNldCAtIHJlZmVyZW5jZVJlY3RbX2xlbl0gLSBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcztcblxuICAgIHZhciBfdGV0aGVyTWF4ID0gaXNPcmlnaW5TaWRlID8gX29mZnNldCArIHJlZmVyZW5jZVJlY3RbX2xlbl0gKyBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcyA6IF9tYXg7XG5cbiAgICB2YXIgX3ByZXZlbnRlZE9mZnNldCA9IHRldGhlciAmJiBpc09yaWdpblNpZGUgPyB3aXRoaW5NYXhDbGFtcChfdGV0aGVyTWluLCBfb2Zmc2V0LCBfdGV0aGVyTWF4KSA6IHdpdGhpbih0ZXRoZXIgPyBfdGV0aGVyTWluIDogX21pbiwgX29mZnNldCwgdGV0aGVyID8gX3RldGhlck1heCA6IF9tYXgpO1xuXG4gICAgcG9wcGVyT2Zmc2V0c1thbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQ7XG4gICAgZGF0YVthbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQgLSBfb2Zmc2V0O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwcmV2ZW50T3ZlcmZsb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogcHJldmVudE92ZXJmbG93LFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddXG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRIVE1MRWxlbWVudFNjcm9sbChlbGVtZW50KSB7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogZWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgIHNjcm9sbFRvcDogZWxlbWVudC5zY3JvbGxUb3BcbiAgfTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEhUTUxFbGVtZW50U2Nyb2xsIGZyb20gXCIuL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlU2Nyb2xsKG5vZGUpIHtcbiAgaWYgKG5vZGUgPT09IGdldFdpbmRvdyhub2RlKSB8fCAhaXNIVE1MRWxlbWVudChub2RlKSkge1xuICAgIHJldHVybiBnZXRXaW5kb3dTY3JvbGwobm9kZSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGdldEhUTUxFbGVtZW50U2Nyb2xsKG5vZGUpO1xuICB9XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZVNjcm9sbCBmcm9tIFwiLi9nZXROb2RlU2Nyb2xsLmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5cbmZ1bmN0aW9uIGlzRWxlbWVudFNjYWxlZChlbGVtZW50KSB7XG4gIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIHNjYWxlWCA9IHJvdW5kKHJlY3Qud2lkdGgpIC8gZWxlbWVudC5vZmZzZXRXaWR0aCB8fCAxO1xuICB2YXIgc2NhbGVZID0gcm91bmQocmVjdC5oZWlnaHQpIC8gZWxlbWVudC5vZmZzZXRIZWlnaHQgfHwgMTtcbiAgcmV0dXJuIHNjYWxlWCAhPT0gMSB8fCBzY2FsZVkgIT09IDE7XG59IC8vIFJldHVybnMgdGhlIGNvbXBvc2l0ZSByZWN0IG9mIGFuIGVsZW1lbnQgcmVsYXRpdmUgdG8gaXRzIG9mZnNldFBhcmVudC5cbi8vIENvbXBvc2l0ZSBtZWFucyBpdCB0YWtlcyBpbnRvIGFjY291bnQgdHJhbnNmb3JtcyBhcyB3ZWxsIGFzIGxheW91dC5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDb21wb3NpdGVSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnQsIGlzRml4ZWQpIHtcbiAgaWYgKGlzRml4ZWQgPT09IHZvaWQgMCkge1xuICAgIGlzRml4ZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBpc09mZnNldFBhcmVudEFuRWxlbWVudCA9IGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIG9mZnNldFBhcmVudElzU2NhbGVkID0gaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGlzRWxlbWVudFNjYWxlZChvZmZzZXRQYXJlbnQpO1xuICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KG9mZnNldFBhcmVudCk7XG4gIHZhciByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnRJc1NjYWxlZCk7XG4gIHZhciBzY3JvbGwgPSB7XG4gICAgc2Nyb2xsTGVmdDogMCxcbiAgICBzY3JvbGxUb3A6IDBcbiAgfTtcbiAgdmFyIG9mZnNldHMgPSB7XG4gICAgeDogMCxcbiAgICB5OiAwXG4gIH07XG5cbiAgaWYgKGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50IHx8ICFpc09mZnNldFBhcmVudEFuRWxlbWVudCAmJiAhaXNGaXhlZCkge1xuICAgIGlmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpICE9PSAnYm9keScgfHwgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMDc4XG4gICAgaXNTY3JvbGxQYXJlbnQoZG9jdW1lbnRFbGVtZW50KSkge1xuICAgICAgc2Nyb2xsID0gZ2V0Tm9kZVNjcm9sbChvZmZzZXRQYXJlbnQpO1xuICAgIH1cblxuICAgIGlmIChpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCkpIHtcbiAgICAgIG9mZnNldHMgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3Qob2Zmc2V0UGFyZW50LCB0cnVlKTtcbiAgICAgIG9mZnNldHMueCArPSBvZmZzZXRQYXJlbnQuY2xpZW50TGVmdDtcbiAgICAgIG9mZnNldHMueSArPSBvZmZzZXRQYXJlbnQuY2xpZW50VG9wO1xuICAgIH0gZWxzZSBpZiAoZG9jdW1lbnRFbGVtZW50KSB7XG4gICAgICBvZmZzZXRzLnggPSBnZXRXaW5kb3dTY3JvbGxCYXJYKGRvY3VtZW50RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB4OiByZWN0LmxlZnQgKyBzY3JvbGwuc2Nyb2xsTGVmdCAtIG9mZnNldHMueCxcbiAgICB5OiByZWN0LnRvcCArIHNjcm9sbC5zY3JvbGxUb3AgLSBvZmZzZXRzLnksXG4gICAgd2lkdGg6IHJlY3Qud2lkdGgsXG4gICAgaGVpZ2h0OiByZWN0LmhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBzb3VyY2U6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzQ5ODc1MjU1XG5cbmZ1bmN0aW9uIG9yZGVyKG1vZGlmaWVycykge1xuICB2YXIgbWFwID0gbmV3IE1hcCgpO1xuICB2YXIgdmlzaXRlZCA9IG5ldyBTZXQoKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBtYXAuc2V0KG1vZGlmaWVyLm5hbWUsIG1vZGlmaWVyKTtcbiAgfSk7IC8vIE9uIHZpc2l0aW5nIG9iamVjdCwgY2hlY2sgZm9yIGl0cyBkZXBlbmRlbmNpZXMgYW5kIHZpc2l0IHRoZW0gcmVjdXJzaXZlbHlcblxuICBmdW5jdGlvbiBzb3J0KG1vZGlmaWVyKSB7XG4gICAgdmlzaXRlZC5hZGQobW9kaWZpZXIubmFtZSk7XG4gICAgdmFyIHJlcXVpcmVzID0gW10uY29uY2F0KG1vZGlmaWVyLnJlcXVpcmVzIHx8IFtdLCBtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzIHx8IFtdKTtcbiAgICByZXF1aXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChkZXApIHtcbiAgICAgIGlmICghdmlzaXRlZC5oYXMoZGVwKSkge1xuICAgICAgICB2YXIgZGVwTW9kaWZpZXIgPSBtYXAuZ2V0KGRlcCk7XG5cbiAgICAgICAgaWYgKGRlcE1vZGlmaWVyKSB7XG4gICAgICAgICAgc29ydChkZXBNb2RpZmllcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXN1bHQucHVzaChtb2RpZmllcik7XG4gIH1cblxuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBpZiAoIXZpc2l0ZWQuaGFzKG1vZGlmaWVyLm5hbWUpKSB7XG4gICAgICAvLyBjaGVjayBmb3IgdmlzaXRlZCBvYmplY3RcbiAgICAgIHNvcnQobW9kaWZpZXIpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9yZGVyTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICAvLyBvcmRlciBiYXNlZCBvbiBkZXBlbmRlbmNpZXNcbiAgdmFyIG9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcihtb2RpZmllcnMpOyAvLyBvcmRlciBiYXNlZCBvbiBwaGFzZVxuXG4gIHJldHVybiBtb2RpZmllclBoYXNlcy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGhhc2UpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgIHJldHVybiBtb2RpZmllci5waGFzZSA9PT0gcGhhc2U7XG4gICAgfSkpO1xuICB9LCBbXSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRlYm91bmNlKGZuKSB7XG4gIHZhciBwZW5kaW5nO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmICghcGVuZGluZykge1xuICAgICAgcGVuZGluZyA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHBlbmRpbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgcmVzb2x2ZShmbigpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGVuZGluZztcbiAgfTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZm9ybWF0KHN0cikge1xuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gW10uY29uY2F0KGFyZ3MpLnJlZHVjZShmdW5jdGlvbiAocCwgYykge1xuICAgIHJldHVybiBwLnJlcGxhY2UoLyVzLywgYyk7XG4gIH0sIHN0cik7XG59IiwgImltcG9ydCBmb3JtYXQgZnJvbSBcIi4vZm9ybWF0LmpzXCI7XG5pbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xudmFyIElOVkFMSURfTU9ESUZJRVJfRVJST1IgPSAnUG9wcGVyOiBtb2RpZmllciBcIiVzXCIgcHJvdmlkZWQgYW4gaW52YWxpZCAlcyBwcm9wZXJ0eSwgZXhwZWN0ZWQgJXMgYnV0IGdvdCAlcyc7XG52YXIgTUlTU0lOR19ERVBFTkRFTkNZX0VSUk9SID0gJ1BvcHBlcjogbW9kaWZpZXIgXCIlc1wiIHJlcXVpcmVzIFwiJXNcIiwgYnV0IFwiJXNcIiBtb2RpZmllciBpcyBub3QgYXZhaWxhYmxlJztcbnZhciBWQUxJRF9QUk9QRVJUSUVTID0gWyduYW1lJywgJ2VuYWJsZWQnLCAncGhhc2UnLCAnZm4nLCAnZWZmZWN0JywgJ3JlcXVpcmVzJywgJ29wdGlvbnMnXTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHZhbGlkYXRlTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBbXS5jb25jYXQoT2JqZWN0LmtleXMobW9kaWZpZXIpLCBWQUxJRF9QUk9QRVJUSUVTKSAvLyBJRTExLWNvbXBhdGlibGUgcmVwbGFjZW1lbnQgZm9yIGBuZXcgU2V0KGl0ZXJhYmxlKWBcbiAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgsIHNlbGYpIHtcbiAgICAgIHJldHVybiBzZWxmLmluZGV4T2YodmFsdWUpID09PSBpbmRleDtcbiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJ25hbWUnOlxuICAgICAgICAgIGlmICh0eXBlb2YgbW9kaWZpZXIubmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIFN0cmluZyhtb2RpZmllci5uYW1lKSwgJ1wibmFtZVwiJywgJ1wic3RyaW5nXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5uYW1lKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZW5hYmxlZCc6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5lbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImVuYWJsZWRcIicsICdcImJvb2xlYW5cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmVuYWJsZWQpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdwaGFzZSc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyUGhhc2VzLmluZGV4T2YobW9kaWZpZXIucGhhc2UpIDwgMCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicGhhc2VcIicsIFwiZWl0aGVyIFwiICsgbW9kaWZpZXJQaGFzZXMuam9pbignLCAnKSwgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIucGhhc2UpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdmbic6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5mbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wiZm5cIicsICdcImZ1bmN0aW9uXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5mbikgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2VmZmVjdCc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyLmVmZmVjdCAhPSBudWxsICYmIHR5cGVvZiBtb2RpZmllci5lZmZlY3QgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImVmZmVjdFwiJywgJ1wiZnVuY3Rpb25cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmZuKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAncmVxdWlyZXMnOlxuICAgICAgICAgIGlmIChtb2RpZmllci5yZXF1aXJlcyAhPSBudWxsICYmICFBcnJheS5pc0FycmF5KG1vZGlmaWVyLnJlcXVpcmVzKSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicmVxdWlyZXNcIicsICdcImFycmF5XCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5yZXF1aXJlcykgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3JlcXVpcmVzSWZFeGlzdHMnOlxuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzKSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicmVxdWlyZXNJZkV4aXN0c1wiJywgJ1wiYXJyYXlcIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLnJlcXVpcmVzSWZFeGlzdHMpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdvcHRpb25zJzpcbiAgICAgICAgY2FzZSAnZGF0YSc6XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUG9wcGVySlM6IGFuIGludmFsaWQgcHJvcGVydHkgaGFzIGJlZW4gcHJvdmlkZWQgdG8gdGhlIFxcXCJcIiArIG1vZGlmaWVyLm5hbWUgKyBcIlxcXCIgbW9kaWZpZXIsIHZhbGlkIHByb3BlcnRpZXMgYXJlIFwiICsgVkFMSURfUFJPUEVSVElFUy5tYXAoZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlxcXCJcIiArIHMgKyBcIlxcXCJcIjtcbiAgICAgICAgICB9KS5qb2luKCcsICcpICsgXCI7IGJ1dCBcXFwiXCIgKyBrZXkgKyBcIlxcXCIgd2FzIHByb3ZpZGVkLlwiKTtcbiAgICAgIH1cblxuICAgICAgbW9kaWZpZXIucmVxdWlyZXMgJiYgbW9kaWZpZXIucmVxdWlyZXMuZm9yRWFjaChmdW5jdGlvbiAocmVxdWlyZW1lbnQpIHtcbiAgICAgICAgaWYgKG1vZGlmaWVycy5maW5kKGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICByZXR1cm4gbW9kLm5hbWUgPT09IHJlcXVpcmVtZW50O1xuICAgICAgICB9KSA9PSBudWxsKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoTUlTU0lOR19ERVBFTkRFTkNZX0VSUk9SLCBTdHJpbmcobW9kaWZpZXIubmFtZSksIHJlcXVpcmVtZW50LCByZXF1aXJlbWVudCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVuaXF1ZUJ5KGFyciwgZm4pIHtcbiAgdmFyIGlkZW50aWZpZXJzID0gbmV3IFNldCgpO1xuICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBpZGVudGlmaWVyID0gZm4oaXRlbSk7XG5cbiAgICBpZiAoIWlkZW50aWZpZXJzLmhhcyhpZGVudGlmaWVyKSkge1xuICAgICAgaWRlbnRpZmllcnMuYWRkKGlkZW50aWZpZXIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWVyZ2VCeU5hbWUobW9kaWZpZXJzKSB7XG4gIHZhciBtZXJnZWQgPSBtb2RpZmllcnMucmVkdWNlKGZ1bmN0aW9uIChtZXJnZWQsIGN1cnJlbnQpIHtcbiAgICB2YXIgZXhpc3RpbmcgPSBtZXJnZWRbY3VycmVudC5uYW1lXTtcbiAgICBtZXJnZWRbY3VycmVudC5uYW1lXSA9IGV4aXN0aW5nID8gT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmcsIGN1cnJlbnQsIHtcbiAgICAgIG9wdGlvbnM6IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLm9wdGlvbnMsIGN1cnJlbnQub3B0aW9ucyksXG4gICAgICBkYXRhOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZy5kYXRhLCBjdXJyZW50LmRhdGEpXG4gICAgfSkgOiBjdXJyZW50O1xuICAgIHJldHVybiBtZXJnZWQ7XG4gIH0sIHt9KTsgLy8gSUUxMSBkb2VzIG5vdCBzdXBwb3J0IE9iamVjdC52YWx1ZXNcblxuICByZXR1cm4gT2JqZWN0LmtleXMobWVyZ2VkKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiBtZXJnZWRba2V5XTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRDb21wb3NpdGVSZWN0IGZyb20gXCIuL2RvbS11dGlscy9nZXRDb21wb3NpdGVSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGxpc3RTY3JvbGxQYXJlbnRzIGZyb20gXCIuL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IG9yZGVyTW9kaWZpZXJzIGZyb20gXCIuL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzXCI7XG5pbXBvcnQgZGVib3VuY2UgZnJvbSBcIi4vdXRpbHMvZGVib3VuY2UuanNcIjtcbmltcG9ydCB2YWxpZGF0ZU1vZGlmaWVycyBmcm9tIFwiLi91dGlscy92YWxpZGF0ZU1vZGlmaWVycy5qc1wiO1xuaW1wb3J0IHVuaXF1ZUJ5IGZyb20gXCIuL3V0aWxzL3VuaXF1ZUJ5LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgbWVyZ2VCeU5hbWUgZnJvbSBcIi4vdXRpbHMvbWVyZ2VCeU5hbWUuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCB7IGF1dG8gfSBmcm9tIFwiLi9lbnVtcy5qc1wiO1xudmFyIElOVkFMSURfRUxFTUVOVF9FUlJPUiA9ICdQb3BwZXI6IEludmFsaWQgcmVmZXJlbmNlIG9yIHBvcHBlciBhcmd1bWVudCBwcm92aWRlZC4gVGhleSBtdXN0IGJlIGVpdGhlciBhIERPTSBlbGVtZW50IG9yIHZpcnR1YWwgZWxlbWVudC4nO1xudmFyIElORklOSVRFX0xPT1BfRVJST1IgPSAnUG9wcGVyOiBBbiBpbmZpbml0ZSBsb29wIGluIHRoZSBtb2RpZmllcnMgY3ljbGUgaGFzIGJlZW4gZGV0ZWN0ZWQhIFRoZSBjeWNsZSBoYXMgYmVlbiBpbnRlcnJ1cHRlZCB0byBwcmV2ZW50IGEgYnJvd3NlciBjcmFzaC4nO1xudmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgcGxhY2VtZW50OiAnYm90dG9tJyxcbiAgbW9kaWZpZXJzOiBbXSxcbiAgc3RyYXRlZ3k6ICdhYnNvbHV0ZSdcbn07XG5cbmZ1bmN0aW9uIGFyZVZhbGlkRWxlbWVudHMoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gIWFyZ3Muc29tZShmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHJldHVybiAhKGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ID09PSAnZnVuY3Rpb24nKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3BwZXJHZW5lcmF0b3IoZ2VuZXJhdG9yT3B0aW9ucykge1xuICBpZiAoZ2VuZXJhdG9yT3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgZ2VuZXJhdG9yT3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9nZW5lcmF0b3JPcHRpb25zID0gZ2VuZXJhdG9yT3B0aW9ucyxcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZiA9IF9nZW5lcmF0b3JPcHRpb25zLmRlZmF1bHRNb2RpZmllcnMsXG4gICAgICBkZWZhdWx0TW9kaWZpZXJzID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmID09PSB2b2lkIDAgPyBbXSA6IF9nZW5lcmF0b3JPcHRpb25zJGRlZixcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZjIgPSBfZ2VuZXJhdG9yT3B0aW9ucy5kZWZhdWx0T3B0aW9ucyxcbiAgICAgIGRlZmF1bHRPcHRpb25zID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmMiA9PT0gdm9pZCAwID8gREVGQVVMVF9PUFRJT05TIDogX2dlbmVyYXRvck9wdGlvbnMkZGVmMjtcbiAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZVBvcHBlcihyZWZlcmVuY2UsIHBvcHBlciwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICB9XG5cbiAgICB2YXIgc3RhdGUgPSB7XG4gICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxuICAgICAgb3JkZXJlZE1vZGlmaWVyczogW10sXG4gICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX09QVElPTlMsIGRlZmF1bHRPcHRpb25zKSxcbiAgICAgIG1vZGlmaWVyc0RhdGE6IHt9LFxuICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgcmVmZXJlbmNlOiByZWZlcmVuY2UsXG4gICAgICAgIHBvcHBlcjogcG9wcGVyXG4gICAgICB9LFxuICAgICAgYXR0cmlidXRlczoge30sXG4gICAgICBzdHlsZXM6IHt9XG4gICAgfTtcbiAgICB2YXIgZWZmZWN0Q2xlYW51cEZucyA9IFtdO1xuICAgIHZhciBpc0Rlc3Ryb3llZCA9IGZhbHNlO1xuICAgIHZhciBpbnN0YW5jZSA9IHtcbiAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uIHNldE9wdGlvbnMoc2V0T3B0aW9uc0FjdGlvbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBzZXRPcHRpb25zQWN0aW9uID09PSAnZnVuY3Rpb24nID8gc2V0T3B0aW9uc0FjdGlvbihzdGF0ZS5vcHRpb25zKSA6IHNldE9wdGlvbnNBY3Rpb247XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgc3RhdGUub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBzdGF0ZS5vcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgc3RhdGUuc2Nyb2xsUGFyZW50cyA9IHtcbiAgICAgICAgICByZWZlcmVuY2U6IGlzRWxlbWVudChyZWZlcmVuY2UpID8gbGlzdFNjcm9sbFBhcmVudHMocmVmZXJlbmNlKSA6IHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCA/IGxpc3RTY3JvbGxQYXJlbnRzKHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCkgOiBbXSxcbiAgICAgICAgICBwb3BwZXI6IGxpc3RTY3JvbGxQYXJlbnRzKHBvcHBlcilcbiAgICAgICAgfTsgLy8gT3JkZXJzIHRoZSBtb2RpZmllcnMgYmFzZWQgb24gdGhlaXIgZGVwZW5kZW5jaWVzIGFuZCBgcGhhc2VgXG4gICAgICAgIC8vIHByb3BlcnRpZXNcblxuICAgICAgICB2YXIgb3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyTW9kaWZpZXJzKG1lcmdlQnlOYW1lKFtdLmNvbmNhdChkZWZhdWx0TW9kaWZpZXJzLCBzdGF0ZS5vcHRpb25zLm1vZGlmaWVycykpKTsgLy8gU3RyaXAgb3V0IGRpc2FibGVkIG1vZGlmaWVyc1xuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobSkge1xuICAgICAgICAgIHJldHVybiBtLmVuYWJsZWQ7XG4gICAgICAgIH0pOyAvLyBWYWxpZGF0ZSB0aGUgcHJvdmlkZWQgbW9kaWZpZXJzIHNvIHRoYXQgdGhlIGNvbnN1bWVyIHdpbGwgZ2V0IHdhcm5lZFxuICAgICAgICAvLyBpZiBvbmUgb2YgdGhlIG1vZGlmaWVycyBpcyBpbnZhbGlkIGZvciBhbnkgcmVhc29uXG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgIHZhciBtb2RpZmllcnMgPSB1bmlxdWVCeShbXS5jb25jYXQob3JkZXJlZE1vZGlmaWVycywgc3RhdGUub3B0aW9ucy5tb2RpZmllcnMpLCBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBfcmVmLm5hbWU7XG4gICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YWxpZGF0ZU1vZGlmaWVycyhtb2RpZmllcnMpO1xuXG4gICAgICAgICAgaWYgKGdldEJhc2VQbGFjZW1lbnQoc3RhdGUub3B0aW9ucy5wbGFjZW1lbnQpID09PSBhdXRvKSB7XG4gICAgICAgICAgICB2YXIgZmxpcE1vZGlmaWVyID0gc3RhdGUub3JkZXJlZE1vZGlmaWVycy5maW5kKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgICAgICAgICB2YXIgbmFtZSA9IF9yZWYyLm5hbWU7XG4gICAgICAgICAgICAgIHJldHVybiBuYW1lID09PSAnZmxpcCc7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFmbGlwTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhdXRvXCIgcGxhY2VtZW50cyByZXF1aXJlIHRoZSBcImZsaXBcIiBtb2RpZmllciBiZScsICdwcmVzZW50IGFuZCBlbmFibGVkIHRvIHdvcmsuJ10uam9pbignICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgX2dldENvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHBvcHBlciksXG4gICAgICAgICAgICAgIG1hcmdpblRvcCA9IF9nZXRDb21wdXRlZFN0eWxlLm1hcmdpblRvcCxcbiAgICAgICAgICAgICAgbWFyZ2luUmlnaHQgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5tYXJnaW5SaWdodCxcbiAgICAgICAgICAgICAgbWFyZ2luQm90dG9tID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luQm90dG9tLFxuICAgICAgICAgICAgICBtYXJnaW5MZWZ0ID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luTGVmdDsgLy8gV2Ugbm8gbG9uZ2VyIHRha2UgaW50byBhY2NvdW50IGBtYXJnaW5zYCBvbiB0aGUgcG9wcGVyLCBhbmQgaXQgY2FuXG4gICAgICAgICAgLy8gY2F1c2UgYnVncyB3aXRoIHBvc2l0aW9uaW5nLCBzbyB3ZSdsbCB3YXJuIHRoZSBjb25zdW1lclxuXG5cbiAgICAgICAgICBpZiAoW21hcmdpblRvcCwgbWFyZ2luUmlnaHQsIG1hcmdpbkJvdHRvbSwgbWFyZ2luTGVmdF0uc29tZShmdW5jdGlvbiAobWFyZ2luKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChtYXJnaW4pO1xuICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oWydQb3BwZXI6IENTUyBcIm1hcmdpblwiIHN0eWxlcyBjYW5ub3QgYmUgdXNlZCB0byBhcHBseSBwYWRkaW5nJywgJ2JldHdlZW4gdGhlIHBvcHBlciBhbmQgaXRzIHJlZmVyZW5jZSBlbGVtZW50IG9yIGJvdW5kYXJ5LicsICdUbyByZXBsaWNhdGUgbWFyZ2luLCB1c2UgdGhlIGBvZmZzZXRgIG1vZGlmaWVyLCBhcyB3ZWxsIGFzJywgJ3RoZSBgcGFkZGluZ2Agb3B0aW9uIGluIHRoZSBgcHJldmVudE92ZXJmbG93YCBhbmQgYGZsaXBgJywgJ21vZGlmaWVycy4nXS5qb2luKCcgJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bk1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICB9LFxuICAgICAgLy8gU3luYyB1cGRhdGUgXHUyMDEzIGl0IHdpbGwgYWx3YXlzIGJlIGV4ZWN1dGVkLCBldmVuIGlmIG5vdCBuZWNlc3NhcnkuIFRoaXNcbiAgICAgIC8vIGlzIHVzZWZ1bCBmb3IgbG93IGZyZXF1ZW5jeSB1cGRhdGVzIHdoZXJlIHN5bmMgYmVoYXZpb3Igc2ltcGxpZmllcyB0aGVcbiAgICAgIC8vIGxvZ2ljLlxuICAgICAgLy8gRm9yIGhpZ2ggZnJlcXVlbmN5IHVwZGF0ZXMgKGUuZy4gYHJlc2l6ZWAgYW5kIGBzY3JvbGxgIGV2ZW50cyksIGFsd2F5c1xuICAgICAgLy8gcHJlZmVyIHRoZSBhc3luYyBQb3BwZXIjdXBkYXRlIG1ldGhvZFxuICAgICAgZm9yY2VVcGRhdGU6IGZ1bmN0aW9uIGZvcmNlVXBkYXRlKCkge1xuICAgICAgICBpZiAoaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3N0YXRlJGVsZW1lbnRzID0gc3RhdGUuZWxlbWVudHMsXG4gICAgICAgICAgICByZWZlcmVuY2UgPSBfc3RhdGUkZWxlbWVudHMucmVmZXJlbmNlLFxuICAgICAgICAgICAgcG9wcGVyID0gX3N0YXRlJGVsZW1lbnRzLnBvcHBlcjsgLy8gRG9uJ3QgcHJvY2VlZCBpZiBgcmVmZXJlbmNlYCBvciBgcG9wcGVyYCBhcmUgbm90IHZhbGlkIGVsZW1lbnRzXG4gICAgICAgIC8vIGFueW1vcmVcblxuICAgICAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihJTlZBTElEX0VMRU1FTlRfRVJST1IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBTdG9yZSB0aGUgcmVmZXJlbmNlIGFuZCBwb3BwZXIgcmVjdHMgdG8gYmUgcmVhZCBieSBtb2RpZmllcnNcblxuXG4gICAgICAgIHN0YXRlLnJlY3RzID0ge1xuICAgICAgICAgIHJlZmVyZW5jZTogZ2V0Q29tcG9zaXRlUmVjdChyZWZlcmVuY2UsIGdldE9mZnNldFBhcmVudChwb3BwZXIpLCBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnKSxcbiAgICAgICAgICBwb3BwZXI6IGdldExheW91dFJlY3QocG9wcGVyKVxuICAgICAgICB9OyAvLyBNb2RpZmllcnMgaGF2ZSB0aGUgYWJpbGl0eSB0byByZXNldCB0aGUgY3VycmVudCB1cGRhdGUgY3ljbGUuIFRoZVxuICAgICAgICAvLyBtb3N0IGNvbW1vbiB1c2UgY2FzZSBmb3IgdGhpcyBpcyB0aGUgYGZsaXBgIG1vZGlmaWVyIGNoYW5naW5nIHRoZVxuICAgICAgICAvLyBwbGFjZW1lbnQsIHdoaWNoIHRoZW4gbmVlZHMgdG8gcmUtcnVuIGFsbCB0aGUgbW9kaWZpZXJzLCBiZWNhdXNlIHRoZVxuICAgICAgICAvLyBsb2dpYyB3YXMgcHJldmlvdXNseSByYW4gZm9yIHRoZSBwcmV2aW91cyBwbGFjZW1lbnQgYW5kIGlzIHRoZXJlZm9yZVxuICAgICAgICAvLyBzdGFsZS9pbmNvcnJlY3RcblxuICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5wbGFjZW1lbnQgPSBzdGF0ZS5vcHRpb25zLnBsYWNlbWVudDsgLy8gT24gZWFjaCB1cGRhdGUgY3ljbGUsIHRoZSBgbW9kaWZpZXJzRGF0YWAgcHJvcGVydHkgZm9yIGVhY2ggbW9kaWZpZXJcbiAgICAgICAgLy8gaXMgZmlsbGVkIHdpdGggdGhlIGluaXRpYWwgZGF0YSBzcGVjaWZpZWQgYnkgdGhlIG1vZGlmaWVyLiBUaGlzIG1lYW5zXG4gICAgICAgIC8vIGl0IGRvZXNuJ3QgcGVyc2lzdCBhbmQgaXMgZnJlc2ggb24gZWFjaCB1cGRhdGUuXG4gICAgICAgIC8vIFRvIGVuc3VyZSBwZXJzaXN0ZW50IGRhdGEsIHVzZSBgJHtuYW1lfSNwZXJzaXN0ZW50YFxuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgICAgICByZXR1cm4gc3RhdGUubW9kaWZpZXJzRGF0YVttb2RpZmllci5uYW1lXSA9IE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVyLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIF9fZGVidWdfbG9vcHNfXyA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHN0YXRlLm9yZGVyZWRNb2RpZmllcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgICAgX19kZWJ1Z19sb29wc19fICs9IDE7XG5cbiAgICAgICAgICAgIGlmIChfX2RlYnVnX2xvb3BzX18gPiAxMDApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihJTkZJTklURV9MT09QX0VSUk9SKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHN0YXRlLnJlc2V0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICAgICAgaW5kZXggPSAtMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBfc3RhdGUkb3JkZXJlZE1vZGlmaWUgPSBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzW2luZGV4XSxcbiAgICAgICAgICAgICAgZm4gPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUuZm4sXG4gICAgICAgICAgICAgIF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUub3B0aW9ucyxcbiAgICAgICAgICAgICAgX29wdGlvbnMgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyID09PSB2b2lkIDAgPyB7fSA6IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIsXG4gICAgICAgICAgICAgIG5hbWUgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUubmFtZTtcblxuICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHN0YXRlID0gZm4oe1xuICAgICAgICAgICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IF9vcHRpb25zLFxuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2VcbiAgICAgICAgICAgIH0pIHx8IHN0YXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIEFzeW5jIGFuZCBvcHRpbWlzdGljYWxseSBvcHRpbWl6ZWQgdXBkYXRlIFx1MjAxMyBpdCB3aWxsIG5vdCBiZSBleGVjdXRlZCBpZlxuICAgICAgLy8gbm90IG5lY2Vzc2FyeSAoZGVib3VuY2VkIHRvIHJ1biBhdCBtb3N0IG9uY2UtcGVyLXRpY2spXG4gICAgICB1cGRhdGU6IGRlYm91bmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgaW5zdGFuY2UuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgICByZXNvbHZlKHN0YXRlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgaXNEZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoSU5WQUxJRF9FTEVNRU5UX0VSUk9SKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH1cblxuICAgIGluc3RhbmNlLnNldE9wdGlvbnMob3B0aW9ucykudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIGlmICghaXNEZXN0cm95ZWQgJiYgb3B0aW9ucy5vbkZpcnN0VXBkYXRlKSB7XG4gICAgICAgIG9wdGlvbnMub25GaXJzdFVwZGF0ZShzdGF0ZSk7XG4gICAgICB9XG4gICAgfSk7IC8vIE1vZGlmaWVycyBoYXZlIHRoZSBhYmlsaXR5IHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgYmVmb3JlIHRoZSBmaXJzdFxuICAgIC8vIHVwZGF0ZSBjeWNsZSBydW5zLiBUaGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlIHVwZGF0ZVxuICAgIC8vIGN5Y2xlLiBUaGlzIGlzIHVzZWZ1bCB3aGVuIGEgbW9kaWZpZXIgYWRkcyBzb21lIHBlcnNpc3RlbnQgZGF0YSB0aGF0XG4gICAgLy8gb3RoZXIgbW9kaWZpZXJzIG5lZWQgdG8gdXNlLCBidXQgdGhlIG1vZGlmaWVyIGlzIHJ1biBhZnRlciB0aGUgZGVwZW5kZW50XG4gICAgLy8gb25lLlxuXG4gICAgZnVuY3Rpb24gcnVuTW9kaWZpZXJFZmZlY3RzKCkge1xuICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgICB2YXIgbmFtZSA9IF9yZWYzLm5hbWUsXG4gICAgICAgICAgICBfcmVmMyRvcHRpb25zID0gX3JlZjMub3B0aW9ucyxcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfcmVmMyRvcHRpb25zID09PSB2b2lkIDAgPyB7fSA6IF9yZWYzJG9wdGlvbnMsXG4gICAgICAgICAgICBlZmZlY3QgPSBfcmVmMy5lZmZlY3Q7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBlZmZlY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB2YXIgY2xlYW51cEZuID0gZWZmZWN0KHtcbiAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2UsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgbm9vcEZuID0gZnVuY3Rpb24gbm9vcEZuKCkge307XG5cbiAgICAgICAgICBlZmZlY3RDbGVhbnVwRm5zLnB1c2goY2xlYW51cEZuIHx8IG5vb3BGbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKSB7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHJldHVybiBmbigpO1xuICAgICAgfSk7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zID0gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9O1xufVxuZXhwb3J0IHZhciBjcmVhdGVQb3BwZXIgPSAvKiNfX1BVUkVfXyovcG9wcGVyR2VuZXJhdG9yKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgZGV0ZWN0T3ZlcmZsb3cgfTsiLCAiaW1wb3J0IHsgcG9wcGVyR2VuZXJhdG9yLCBkZXRlY3RPdmVyZmxvdyB9IGZyb20gXCIuL2NyZWF0ZVBvcHBlci5qc1wiO1xuaW1wb3J0IGV2ZW50TGlzdGVuZXJzIGZyb20gXCIuL21vZGlmaWVycy9ldmVudExpc3RlbmVycy5qc1wiO1xuaW1wb3J0IHBvcHBlck9mZnNldHMgZnJvbSBcIi4vbW9kaWZpZXJzL3BvcHBlck9mZnNldHMuanNcIjtcbmltcG9ydCBjb21wdXRlU3R5bGVzIGZyb20gXCIuL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzXCI7XG5pbXBvcnQgYXBwbHlTdHlsZXMgZnJvbSBcIi4vbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzXCI7XG5pbXBvcnQgb2Zmc2V0IGZyb20gXCIuL21vZGlmaWVycy9vZmZzZXQuanNcIjtcbmltcG9ydCBmbGlwIGZyb20gXCIuL21vZGlmaWVycy9mbGlwLmpzXCI7XG5pbXBvcnQgcHJldmVudE92ZXJmbG93IGZyb20gXCIuL21vZGlmaWVycy9wcmV2ZW50T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBhcnJvdyBmcm9tIFwiLi9tb2RpZmllcnMvYXJyb3cuanNcIjtcbmltcG9ydCBoaWRlIGZyb20gXCIuL21vZGlmaWVycy9oaWRlLmpzXCI7XG52YXIgZGVmYXVsdE1vZGlmaWVycyA9IFtldmVudExpc3RlbmVycywgcG9wcGVyT2Zmc2V0cywgY29tcHV0ZVN0eWxlcywgYXBwbHlTdHlsZXMsIG9mZnNldCwgZmxpcCwgcHJldmVudE92ZXJmbG93LCBhcnJvdywgaGlkZV07XG52YXIgY3JlYXRlUG9wcGVyID0gLyojX19QVVJFX18qL3BvcHBlckdlbmVyYXRvcih7XG4gIGRlZmF1bHRNb2RpZmllcnM6IGRlZmF1bHRNb2RpZmllcnNcbn0pOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciwgcG9wcGVyR2VuZXJhdG9yLCBkZWZhdWx0TW9kaWZpZXJzLCBkZXRlY3RPdmVyZmxvdyB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciBhcyBjcmVhdGVQb3BwZXJMaXRlIH0gZnJvbSBcIi4vcG9wcGVyLWxpdGUuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgKiBmcm9tIFwiLi9tb2RpZmllcnMvaW5kZXguanNcIjsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHtcbiAgICBub3JtYWxpemVQYXRoLFxuICAgIFRBYnN0cmFjdEZpbGUsXG4gICAgVEZpbGUsXG4gICAgVEZvbGRlcixcbiAgICBWYXVsdCxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVfdGZvbGRlcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZm9sZGVyX3N0cjogc3RyaW5nKTogVEZvbGRlciB7XG4gICAgZm9sZGVyX3N0ciA9IG5vcm1hbGl6ZVBhdGgoZm9sZGVyX3N0cik7XG5cbiAgICBjb25zdCBmb2xkZXIgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJfc3RyKTtcbiAgICBpZiAoIWZvbGRlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvbGRlciBcIiR7Zm9sZGVyX3N0cn1cIiBkb2Vzbid0IGV4aXN0YCk7XG4gICAgfVxuICAgIGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtmb2xkZXJfc3RyfSBpcyBhIGZpbGUsIG5vdCBhIGZvbGRlcmApO1xuICAgIH1cblxuICAgIHJldHVybiBmb2xkZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRfdGZpbGVzX2Zyb21fZm9sZGVyKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGZvbGRlcl9zdHI6IHN0cmluZ1xuKTogQXJyYXk8VEZpbGU+IHtcbiAgICBjb25zdCBmb2xkZXIgPSByZXNvbHZlX3Rmb2xkZXIocGx1Z2luLCBmb2xkZXJfc3RyKTtcblxuICAgIGNvbnN0IGZpbGVzOiBBcnJheTxURmlsZT4gPSBbXTtcbiAgICBWYXVsdC5yZWN1cnNlQ2hpbGRyZW4oZm9sZGVyLCAoZmlsZTogVEFic3RyYWN0RmlsZSkgPT4ge1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICBmaWxlcy5wdXNoKGZpbGUpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBmaWxlcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIHJldHVybiBhLmJhc2VuYW1lLmxvY2FsZUNvbXBhcmUoYi5iYXNlbmFtZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZmlsZXM7XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwiLi9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDeWNsZUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuQ3ljbGUpXG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcHVibGljIG5leHRPcHRpb24odmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBuZXh0T3B0aW9uOiBzdHJpbmc7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuZ2V0T3B0aW9uc0xpc3QoKTtcbiAgICAgICAgaWYgKHZhbHVlcy5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIG5leHRPcHRpb24gPSB2YWx1ZXNbMF0gfHwgXCJcIlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV4dE9wdGlvbiA9IHZhbHVlc1sodmFsdWVzLmluZGV4T2YodmFsdWUpICsgMSkgJSB2YWx1ZXMubGVuZ3RoXVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXh0T3B0aW9uXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRSYXdPcHRpb25Gcm9tRHVyYXRpb24oZHVyYXRpb246IGFueSk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGxldCBtYXRjaGVkVmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGR2QXBpICYmIGR2QXBpLnZhbHVlLmlzRHVyYXRpb24oZHVyYXRpb24pKSB7XG4gICAgICAgICAgICB0aGlzLmdldE9wdGlvbnNMaXN0KCkuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGR2T3B0aW9uID0gZHZBcGkuZHVyYXRpb24ob3B0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoZHVyYXRpb24udmFsdWVzKS5ldmVyeShqID0+XG4gICAgICAgICAgICAgICAgICAgICghZHVyYXRpb24udmFsdWVzW2pdICYmICFkdk9wdGlvbi52YWx1ZXNbal0pIHx8IChkdXJhdGlvbi52YWx1ZXNbal0gPT09IGR2T3B0aW9uLnZhbHVlc1tqXSlcbiAgICAgICAgICAgICAgICApKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWYWx1ZSA9IG9wdGlvblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hdGNoZWRWYWx1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQ/OiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGxldCB2YWx1ZVRleHQ6IHN0cmluZztcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6IHZhbHVlVGV4dCA9IFwiXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgbnVsbDogdmFsdWVUZXh0ID0gXCJcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBmYWxzZTogdmFsdWVUZXh0ID0gXCJmYWxzZVwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDA6IHZhbHVlVGV4dCA9IFwiMFwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiB2YWx1ZVRleHQgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbZmllbGROYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlVGV4dCA9IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHRoaXMuZ2V0UmF3T3B0aW9uRnJvbUR1cmF0aW9uKHZhbHVlVGV4dCkgfHwgdmFsdWVUZXh0IH0pXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIC8vIGRhdGF2aWV3IGlzIGNvbnZlcnRpbmcgc3RyaW5ncyB0byBkdXJhdGlvbiwgbGV0J3MgZmluZCBiYWNrIHRoZSByYXcgc3RyaW5nIG9wdGlvbiBmcm9tIGR1cmF0aW9uIGlmIG5lZWRlZFxuICAgICAgICBsZXQgbWF0Y2hlZFZhbHVlID0gdGhpcy5nZXRSYXdPcHRpb25Gcm9tRHVyYXRpb24odmFsdWUpIHx8IHZhbHVlO1xuICAgICAgICBjb25zdCBpY29uTmFtZSA9IEZpZWxkSWNvbltGaWVsZFR5cGUuQ3ljbGVdO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIG5hbWUsIHRoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpLnRvU3RyaW5nKCkpIH0pO1xuICAgICAgICBpZiAoQ3ljbGVGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgJHtuYW1lfSA6ICR7bWF0Y2hlZFZhbHVlfSBcdTI1QjcgJHt0aGlzLm5leHRPcHRpb24obWF0Y2hlZFZhbHVlKX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oaWNvbk5hbWUpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQ3ljbGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgJHtuYW1lfV8ke21hdGNoZWRWYWx1ZX1fJHt0aGlzLm5leHRPcHRpb24obWF0Y2hlZFZhbHVlKX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+PGI+JHtuYW1lfTwvYj4gOiAke21hdGNoZWRWYWx1ZX0gXHUyNUI3ICR7dGhpcy5uZXh0T3B0aW9uKG1hdGNoZWRWYWx1ZSl9PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogaWNvbk5hbWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoQ3ljbGVGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uTmFtZSwgYWN0aW9uLCBgJHttYXRjaGVkVmFsdWV9IFx1MjVCNyAke3RoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpfWApO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHZhbHVlIHx8IFwiXCIsIHRoaXMuZmllbGQsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3Qgb3B0aW9uIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgYW55PiB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG5leHRPcHRpb24gPSB0aGlzLm5leHRPcHRpb24ocFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKTtcbiAgICAgICAgLyogZW5kIHNwYWNlciAqL1xuICAgICAgICBjb25zdCBzcGFjZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIik7XG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oYnV0dG9uLCBGaWVsZEljb25bRmllbGRUeXBlLkN5Y2xlXSlcbiAgICAgICAgYnV0dG9uLnNldEF0dHIoJ2NsYXNzJywgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNob3coKTtcbiAgICAgICAgICAgICAgICBzcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBidXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qIGJ1dHRvbiBvbiBjbGljayA6IGdvIHRvIG5leHQgdmVyc2lvbiovXG4gICAgICAgIGJ1dHRvbi5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIEN5Y2xlRmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgbmV4dE9wdGlvbik7XG4gICAgICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFjZXIpO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgVGV4dENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IE11bHRpU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL011bHRpU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwiLi9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTXVsdGkpXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlc1wiKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChNdWx0aUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE11bHRpRmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChNdWx0aUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBNdWx0aVNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbnMgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgLyogXG4gICAgICAgIHRoaXMgY29udHJvbCBkaXNwbGF5cyBieSBkZWZhdWx0IHRoZSBsaXN0IG9mIHZhbHVlXG4gICAgICAgIHdoZW4gbW91c2VvdmVyOiB3ZSBkaXNwbGF5IGEgXCIrXCIgYnV0dG9uIGF0IHRoZSBiZWdnaW5pbmcgb2YgdGhlIGZpZWxkIHRvIGFkZCBhIG5ldyB2YWx1ZSBhbmQgYSBcInhcIiBidXR0b24gYWZ0ZXIgdGhlIHZhbHVlIGhvdmVyZWQgdG8gcmVtb3ZlIGl0IGZyb20gbGlzdFxuICAgICAgICB3aGVuIHRoZSBcInhcIiBidXR0b24gaXMgY2xpY2tlZCwgd2UgcmVtb3ZlIHRoZSBsaXN0IGZyb20gdmFsdWVcbiAgICAgICAgd2hlbiB0aGUgXCIrXCIgYnV0dG9uIGlzIGNsaWNrZWQsIHdlIGRpc3BsYXkgYSBzZWxlY3QgZHJvcGRvd24gZmlsdGVyZWQgd2l0aCByZW1haW5pbmcgb3B0aW9ucy4gd2hlbiBvbmUgb3B0aW9uIGlzIHNlbGVjdGVkIHdlIGFkZCBpdCB0byB0aGUgbGlzdCBhbmQgcmVtb3ZlIHRoZSBjb250cm9sXG4gICAgICAgICovXG4gICAgICAgIGxldCB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGN1cnJlbnRWYWx1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmIChwW3RoaXMuZmllbGQubmFtZV0pIHtcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhwW3RoaXMuZmllbGQubmFtZV0pLmluY2x1ZGVzKFwicGF0aFwiKSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZXMgPSBbYFtbJHtwW3RoaXMuZmllbGQubmFtZV0ucGF0aC5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpfV1dYF1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwW3RoaXMuZmllbGQubmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcy5wdXNoKC4uLnBbdGhpcy5maWVsZC5uYW1lXS5tYXAoKHY6IHN0cmluZykgPT4gdi50cmltKCkpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcyA9IHBbdGhpcy5maWVsZC5uYW1lXS5zcGxpdChcIixcIikubWFwKCh2OiBzdHJpbmcpID0+IHYudHJpbSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHNlbGVjdCBjb250YWluZXIgKi9cbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgICAgICAgc2VsZWN0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtc2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZWN0KVxuICAgICAgICBjb25zdCBudWxsT3B0aW9uID0gbmV3IE9wdGlvbihcIi0tc2VsZWN0LS1cIiwgdW5kZWZpbmVkKTtcbiAgICAgICAgc2VsZWN0LmFkZChudWxsT3B0aW9uKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5nZXRPcHRpb25zTGlzdCgpO1xuICAgICAgICB2YWx1ZXMuZmlsdGVyKHYgPT4gIWN1cnJlbnRWYWx1ZXMuY29udGFpbnModikpLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBPcHRpb24odiwgdik7XG4gICAgICAgICAgICBpZiAocFt0aGlzLmZpZWxkLm5hbWVdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhbHVlLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGVjdC5hZGQodmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICBzZWxlY3Qub25jaGFuZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZXMgPSBbLi4uY3VycmVudFZhbHVlcywgc2VsZWN0LnZhbHVlXS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICBNdWx0aUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlcyk7XG4gICAgICAgICAgICBzaW5nbGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgZG91YmxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZXNDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZWN0Lm9ua2V5ZG93biA9IChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVzQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzaW5nbGVTcGFjZXIpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjbG9zZVNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oY2xvc2VTZWxlY3QsIFwiY3Jvc3NcIik7XG4gICAgICAgIGNsb3NlU2VsZWN0LmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgIGNsb3NlU2VsZWN0LmFkZENsYXNzKFwibXVsdGlcIik7XG4gICAgICAgIGNsb3NlU2VsZWN0Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZXNDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9O1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoY2xvc2VTZWxlY3QpO1xuXG4gICAgICAgIC8qIGN1cnJlbnQgdmFsdWVzIGNvbnRhaW5lciAqL1xuICAgICAgICBjb25zdCB2YWx1ZXNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YWx1ZXNDb250YWluZXIuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LW11bHRpLXZhbHVlcy1jb250YWluZXJcIik7XG5cbiAgICAgICAgLyogY3VycmVudCB2YWx1ZXMgKi9cbiAgICAgICAgY3VycmVudFZhbHVlcy5mb3JFYWNoKHYgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdmFsdWVDb250YWluZXIuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LW11bHRpLXZhbHVlcy1jb250YWluZXJcIik7XG5cblxuICAgICAgICAgICAgY29uc3QgdmFsdWVSZW1vdmVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICAgICAgc2V0SWNvbih2YWx1ZVJlbW92ZUJ0biwgXCJjcm9zc1wiKVxuICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLmFkZENsYXNzKFwibXVsdGlcIik7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ1ZhbHVlcyA9IGN1cnJlbnRWYWx1ZXMuZmlsdGVyKGNWID0+IGNWICE9PSB2KS5qb2luKFwiLCBcIilcbiAgICAgICAgICAgICAgICBNdWx0aUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIHJlbWFpbmluZ1ZhbHVlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZVJlbW92ZUJ0bik7XG5cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdmFsdWVMYWJlbC5zZXRUZXh0KHYpO1xuICAgICAgICAgICAgdmFsdWVMYWJlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtbXVsdGktdmFsdWUtbGFiZWxcIik7XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUxhYmVsKTtcblxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFsdWVIb3ZlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwuYWRkQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwucmVtb3ZlQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YWx1ZXNDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGFkZEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oYWRkQnRuLCBcImJ1bGxldC1saXN0XCIpO1xuICAgICAgICBhZGRCdG4uc2V0QXR0cignY2xhc3MnLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuXG4gICAgICAgIHZhbHVlc0NvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRCdG4pO1xuICAgICAgICBhZGRCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHZhbHVlc0NvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzaW5nbGVTcGFjZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZG91YmxlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGVjdENvbnRhaW5lcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNpbmdsZVNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHNpbmdsZVNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLXNwYWNlclwiKVxuICAgICAgICBjb25zdCBkb3VibGVTcGFjZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBkb3VibGVTcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1kb3VibGUtc3BhY2VyXCIpXG5cbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIGRvdWJsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZUhvdmVyZWQpIHNpbmdsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgc2luZ2xlU3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgIGRvdWJsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIGRvdWJsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICBhZGRCdG4uc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlc0NvbnRhaW5lcik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNpbmdsZVNwYWNlcik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRGaWxlLCBCdXR0b25Db21wb25lbnQsIFN1Z2dlc3RNb2RhbCwgc2V0SWNvbiwgTm90aWNlLCBwYXJzZUxpbmt0ZXh0IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0ICogYXMgc2VsZWN0VmFsdWVzU291cmNlIGZyb20gXCJzcmMvdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXNcIlxuaW1wb3J0IHsgcmVsYXRpdmVUaW1lUm91bmRpbmcgfSBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgRmlsZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE11bHRpU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZE9wdGlvbnM6IEFycmF5PHN0cmluZz47XG4gICAgcHJpdmF0ZSBhZGRCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcbiAgICBwcml2YXRlIHJlbG9hZEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsT3B0aW9uczogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICBpZiAoaW5pdGlhbE9wdGlvbnMpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxPcHRpb25zKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgICAgICAgICAgaWYgKGR2QXBpICYmIGluaXRpYWxPcHRpb25zLnNvbWUobyA9PiBkdkFwaS52YWx1ZS5pc0xpbmsobykpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayhpdGVtKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgaXRlbS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMubWFwKGl0ZW0gPT4gaXRlbS50b1N0cmluZygpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5zdGFydHNXaXRoKFwiW1tcIikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IGluaXRpYWxPcHRpb25zLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbKC4qKVxcXSQvLCBcIiQxXCIpLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IFtdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5vbmtleWRvd24gPSBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09IFwiRW50ZXJcIiAmJiBlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICBjb25zdCB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1ub3RpY2UtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3Qgbm90aWNlID0gdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1ub3RpY2UtbGFiZWxcIiB9KTtcbiAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1ub3RpY2Utc3BhY2VyXCIgfSk7XG4gICAgICAgIHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZmluZChcIi5wcm9tcHRcIikucHJlcGVuZCh1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIpO1xuXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItaW5wdXQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dEVsKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmZpbmQoXCIucHJvbXB0XCIpLnByZXBlbmQoaW5wdXRDb250YWluZXIpXG5cblxuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1hY3Rpb25zXCIgfSlcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1hY3Rpb25zLXNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGluZm9Db250YWluZXIgPSBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWluZm9cIiB9KVxuICAgICAgICBpbmZvQ29udGFpbmVyLnNldFRleHQoXCJBbHQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvLyBhZGRCdXR0b25cbiAgICAgICAgdGhpcy5hZGRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRJY29uKFwicGx1c1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk7XG4gICAgICAgICAgICBub3RpY2Uuc2V0VGV4dChgJHt0aGlzLmlucHV0RWwudmFsdWV9IGFkZGVkIHRvIHRoZSBmaWVsZCBzZXR0aW5nc1xcbmNsaWNrIG9uIHJlbG9hZGApXG4gICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgICAgICB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIuc2hvdygpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0VG9vbHRpcChcIkFkZCB0aGlzIHZhbHVlIHRvIHRoaXMgZmllbGQgc2V0dGluZ3NcIilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpO1xuICAgICAgICAvL3JlbG9hZCBidXR0b25cbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lcilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uc2V0SWNvbihcInJlZnJlc2gtY3dcIilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uc2V0Q3RhKClcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSAnJztcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy51cGRhdGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy9jb25maXJtIGJ1dHRvblxuICAgICAgICBjb25zdCBjb25maXJtQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNvbmZpcm1CdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKVxuICAgICAgICBjb25maXJtQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXBsYWNlVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSlcbiAgICAgICAgY29uZmlybUJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICAvL2NhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4geyB0aGlzLmNsb3NlKCk7IH0pXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICAvL2NsZWFyIHZhbHVlIGJ1dHRvblxuICAgICAgICBjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjbGVhckJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgY2xlYXJCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsZWFyVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGNsZWFyQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYnV0dG9uXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwiZGFuZ2VyXCIpXG4gICAgICAgIHRoaXMubW9kYWxFbC5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXIpXG4gICAgfVxuXG4gICAgYXN5bmMgYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpPy5maWxlQ2xhc3NOYW1lXG4gICAgICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IGZpbGVDbGFzcz8uYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIGZpbGVDbGFzc0F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIGxldCBuZXdPcHRpb25zOiBzdHJpbmdbXSB8IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBbLi4uZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMsIG5ld1ZhbHVlXVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3QgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9uc1tgJHtPYmplY3Qua2V5cyhmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0KS5sZW5ndGh9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodmFsdWVzRmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkodmFsdWVzRmlsZSwgYCR7cmVzdWx0fVxcbiR7bmV3VmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnNbYCR7T2JqZWN0LmtleXMoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMpLmxlbmd0aH1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByZXNldEZpZWxkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKHByZXNldEZpZWxkPy5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHByZXNldEZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdmFsdWVzRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkodmFsdWVzRmlsZSwgYCR7cmVzdWx0fVxcbiR7bmV3VmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwcmVzZXRGaWVsZD8ub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmllbGQgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maW5kKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdCA9IGN1cnJlbnRFeGlzdGluZ0ZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXNMaXN0W2Ake09iamVjdC5rZXlzKHZhbHVlc0xpc3QpLmxlbmd0aCArIDF9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZ1bGxJbmRleChcInZhbHVlQWRkXCIpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5wdXNoKG5ld1ZhbHVlKVxuICAgIH1cblxuICAgIGFzeW5jIHJlcGxhY2VWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLnNlbGVjdGVkT3B0aW9ucztcbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIG9wdGlvbnMuam9pbihcIiwgXCIpKSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkVmFsdWVzID0gIXRoaXMuaW5Gcm9udG1hdHRlciA/IG9wdGlvbnMuam9pbihcIiwgXCIpIDogb3B0aW9ucy5sZW5ndGggPiAxID8gYFske29wdGlvbnMuam9pbihcIiwgXCIpfV1gIDogYCR7b3B0aW9uc1swXX1gXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCByZW5kZXJlZFZhbHVlcywgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhclZhbHVlcygpIHtcbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmVuZGVyU2VsZWN0ZWQoKSB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBjaG9vc2VyID0gdGhpcy5jaG9vc2VyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBIVE1MRGl2RWxlbWVudFtdID0gY2hvb3Nlci5zdWdnZXN0aW9uc1xuICAgICAgICBjb25zdCB2YWx1ZXM6IHN0cmluZ1tdID0gY2hvb3Nlci52YWx1ZXNcbiAgICAgICAgc3VnZ2VzdGlvbnMuZm9yRWFjaCgocywgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRPcHRpb25zLmluY2x1ZGVzKHZhbHVlc1tpXS50b1N0cmluZygpKSkge1xuICAgICAgICAgICAgICAgIHMuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdGVkXCIpXG4gICAgICAgICAgICAgICAgaWYgKHMucXVlcnlTZWxlY3RvckFsbChcIi5tZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIpLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBzLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCBcImNoZWNrLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcy5yZW1vdmVDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0ZWRcIilcbiAgICAgICAgICAgICAgICBzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiKS5mb3JFYWNoKGljb24gPT4gaWNvbi5yZW1vdmUoKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBsZXQgZHZGaWxlOiBhbnk7XG4gICAgICAgIGlmIChkdkFwaSkgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aClcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKSBhcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IGZpZWxkTWFuYWdlci5nZXRPcHRpb25zTGlzdChkdkZpbGUpLmZpbHRlcihvID0+IG8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSlcbiAgICAgICAgaWYgKHRoaXMuYWRkQnV0dG9uKSB7XG4gICAgICAgICAgICAodmFsdWVzLnNvbWUocCA9PiBwID09PSBxdWVyeSkgfHwgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgPT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzRnJvbURWUXVlcnkgfHwgIXF1ZXJ5KSA/XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpIDpcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5zaG93KCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB2YWx1ZXNcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5zZXRUZXh0KHZhbHVlKVxuICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLXZhbHVlLWNvbnRhaW5lclwiKVxuICAgICAgICBjb25zdCBzcGFjZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci12YWx1ZS1jb250YWluZXItc3BhY2VyXCIgfSlcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE9wdGlvbnMuaW5jbHVkZXModmFsdWUudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3RlZFwiKVxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIgfSlcbiAgICAgICAgICAgIHNldEljb24oaWNvbkNvbnRhaW5lciwgXCJjaGVjay1jaXJjbGVcIilcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlucHV0RWwuZm9jdXMoKVxuICAgIH1cblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24odmFsdWU6IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE9wdGlvbnMuaW5jbHVkZXModmFsdWUudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLnJlbW92ZSh2YWx1ZS50b1N0cmluZygpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMucHVzaCh2YWx1ZS50b1N0cmluZygpKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyU2VsZWN0ZWQoKVxuICAgIH1cblxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcblxuICAgIH1cblxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBOb3RpY2UsIHNldEljb24sIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgU2luZ2xlRmlsZU1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2ZpZWxkcy9TaW5nbGVGaWxlTW9kYWxcIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkT3B0aW9ucyB9IGZyb20gXCJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGZpbGVWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnRcbiAgICBwcml2YXRlIGR2UXVlcnlTdHJpbmc6IFRleHRBcmVhQ29tcG9uZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5GaWxlKVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGaWxlcyA9IChjdXJyZW50RmlsZT86IFRGaWxlKTogVEZpbGVbXSA9PiB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBnZXRSZXN1bHRzID0gKGFwaTogRGF0YXZpZXdQbHVnaW5bXCJhcGlcIl0pID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJkdlwiLCBcImN1cnJlbnRcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nfWApKShhcGksIGFwaS5wYWdlKGN1cnJlbnRGaWxlPy5wYXRoKSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgcXVlcnkgZm9yIGZpZWxkIDwke3RoaXMuZmllbGQubmFtZX0+XFxuY2hlY2sgeW91ciBzZXR0aW5nc2AsIDMwMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRhdGF2aWV3ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdXG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZURhdGF2aWV3SnMgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZUlubGluZURhdGF2aWV3SnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZXNQYXRoID0gZ2V0UmVzdWx0cyhkYXRhdmlldy5hcGkpLnZhbHVlcy5tYXAoKHY6IGFueSkgPT4gdi5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmlsdGVyKGYgPT4gZmlsZXNQYXRoLmluY2x1ZGVzKGYucGF0aCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgU2luZ2xlRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSlcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKClcbiAgICAgICAgaWYgKEZpbGVGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlICR7bmFtZX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChGaWxlRmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuRmlsZV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKEZpbGVGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IFNpbmdsZUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2tlZDogKCkgPT4ge30pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdXG4gICAgICAgICAgICBpZiAoZHZBcGkudmFsdWUuaXNMaW5rKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBjb250YWluZXIuY3JlYXRlRWwoJ2EnLCB7IHRleHQ6IHZhbHVlLnBhdGguc3BsaXQoXCIvXCIpLmxhc3QoKS5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSB9KTtcbiAgICAgICAgICAgICAgICBsaW5rLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHZhbHVlLnBhdGgsIGZpbGUucGF0aCwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgb25DbGlja2VkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycyk7XG4gICAgICAgIGNvbnN0IHNlYXJjaEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihzZWFyY2hCdG4sIEZpZWxkSWNvbltGaWVsZFR5cGUuRmlsZV0pXG4gICAgICAgIHNlYXJjaEJ0bi5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgICAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIilcblxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgIGxldCBmaWVsZE1vZGFsOiBTaW5nbGVGaWxlTW9kYWw7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IFNpbmdsZUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHNlYXJjaEJ0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKClcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uc2hvdygpXG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VhcmNoQnRuKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUZpbGVDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdlF1ZXJ5U3RyaW5nQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBkdlF1ZXJ5U3RyaW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGF0YXZpZXcgUXVlcnkgKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChkdlF1ZXJ5U3RyaW5nQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nIHx8IFwiXCIpO1xuXG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcih0aGlzLmR2UXVlcnlTdHJpbmcpO1xuICAgICAgICB9KVxuXG5cbiAgICAgICAgY29uc3QgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkFsaWFzXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBlcnNvbmFsaXNlIHRoZSByZW5kZXJpbmcgb2YgeW91ciBsaW5rcycgYWxpYXNlcyB3aXRoIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgc3RyaW5nICg8cGFnZT4gb2JqZWN0IGlzIGF2YWlsYWJsZSlcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21SZW5kZXJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lcik7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0UGxhY2Vob2xkZXIoXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIilcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tUmVuZGVyaW5nKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU29ydGluZyBvcmRlclwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIGN1c3RvbVNvcnRpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJQZXJzb25hbGlzZSB0aGUgc29ydGluZyBvcmRlciBvZiB5b3VyIGxpbmtzIHdpdGggYSBpbnN0cnVjdGlvbiB0YWtpbmcgMiBmaWxlcyAoYSwgYikgYW5kIHJldHVybmluZyAtMSwgMCBvciAxXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXN1YnRleHQnIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBgKGE6IFRGaWxlLCBiOiBURmlsZSk6IG51bWJlcmBcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgY3VzdG9tU29ydGluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjdXN0b21Tb3J0aW5nQ29udGFpbmVyKTtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFBsYWNlaG9sZGVyKFwiSmF2YXNjcmlwdCBpbnN0cnVjdGlvbiwgXCIgK1xuICAgICAgICAgICAgXCIoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyXFxuXCIgK1xuICAgICAgICAgICAgXCJleGFtcGxlIDEgKGFscGhhYmV0aWNhbCBvcmRlcik6IGEuYmFzZW5hbWUgPCBiLmJhc2VuYW1lID8gMSA6IC0xIFxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAyIChjcmVhdGlvbiB0aW1lIG5ld2VyIHRvIG9sZGVyKTogYi5zdGF0LmN0aW1lIC0gYi5zdGF0LmN0aW1lXCIpXG4gICAgICAgIGN1c3RvbVNvcnRpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tU29ydGluZyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW51bWJlci1vcHRpb25zXCIgfSlcbiAgICAgICAgdGhpcy5jcmVhdGVGaWxlQ29udGFpbmVyKHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkKVxuICAgICAgICB0aGlzLmZpbGVWYWxpZGF0b3JGaWVsZC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgfHwgXCJcIjtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG4gICAgICAgIC8vdG9kbyA6IG1hbmFnZSBib3RoIHJhdyBsaW5rcyBhbmQgZHYgTGluayBvYmplY3RzXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxufSIsICJpbXBvcnQgeyBURmlsZSwgRnV6enlTdWdnZXN0TW9kYWwsIEZ1enp5TWF0Y2gsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpbGVGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0ZpbGVGaWVsZFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlRnV6enlTdWdnZXN0ZXIgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZEZpbGU/OiBURmlsZVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsVmFsdWVPYmplY3Q6IGFueSxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsoaW5pdGlhbFZhbHVlT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGluaXRpYWxWYWx1ZU9iamVjdC5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHRoaXMuc2VsZWN0ZWRGaWxlID0gZmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZpbGVbXSB7XG4gICAgICAgIGNvbnN0IHNvcnRpbmdNZXRob2QgPSBuZXcgRnVuY3Rpb24oXCJhXCIsIFwiYlwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmd9YCkgfHwgZnVuY3Rpb24gKGE6IFRGaWxlLCBiOiBURmlsZSkgeyByZXR1cm4gYS5iYXNlbmFtZSA8IGIuYmFzZW5hbWUgPyAtMSA6IDEgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZmlsZU1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVNYW5hZ2VyLmdldEZpbGVzKHRoaXMuZmlsZSkuc29ydChzb3J0aW5nTWV0aG9kKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBpdGVtLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IEZ1enp5TWF0Y2g8VEZpbGU+LCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzXCIgfSk7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc3VnZ2VzdGVyLWl0ZW0td2l0aC1hbGlhcy1sYWJlbFwiIH0pXG4gICAgICAgICAgICBsYWJlbC5zZXRUZXh0KG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh2YWx1ZS5pdGVtLnBhdGgpKSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWZpbGVwYXRoXCIgfSlcbiAgICAgICAgICAgIGZpbGVQYXRoLnNldFRleHQodmFsdWUuaXRlbS5wYXRoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZS5pdGVtLmJhc2VuYW1lKVxuICAgICAgICB9XG4gICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItdmFsdWUtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLXZhbHVlLWNvbnRhaW5lci1zcGFjZXJcIiB9KVxuICAgICAgICBlbC5hcHBlbmRDaGlsZChzcGFjZXIpXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZT8ucGF0aCA9PT0gdmFsdWUuaXRlbS5wYXRoKSB7XG4gICAgICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0ZWRcIilcbiAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKClcbiAgICB9XG5cblxuICAgIGFzeW5jIG9uQ2hvb3NlSXRlbShpdGVtOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBsZXQgYWxpYXM6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKGl0ZW0ucGF0aCkpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGl0ZW0uYmFzZW5hbWUsIGFsaWFzKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRWYWx1ZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIEZpbGVGaWVsZC5idWlsZE1hcmtEb3duTGluayh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBpdGVtLmJhc2VuYW1lLCBhbGlhcyksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzQ29tbWVudFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIG1vbWVudCwgc2V0SWNvbiwgVGV4dENvbXBvbmVudCwgVEZpbGUsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRGF0ZU1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2ZpZWxkcy9EYXRlTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBDeWNsZUZpZWxkIGZyb20gXCIuL0N5Y2xlRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGTSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgY29tcGFyZUR1cmF0aW9uIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRlRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBkYXRlVmFsaWRhdG9yRmllbGQ6IEhUTUxEaXZFbGVtZW50XG4gICAgcHVibGljIGRlZmF1bHREYXRlRm9ybWF0OiBzdHJpbmcgPSBcIllZWVktTU0tRERcIlxuICAgIHByaXZhdGUgc2hpZnRCdG46IEhUTUxCdXR0b25FbGVtZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5EYXRlKTtcbiAgICAgICAgdGhpcy5zaG93TW9kYWxPcHRpb24gPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChgQ2hhbmdlIGRhdGUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaTtcbiAgICAgICAgY29uc3QgZGF0ZUljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5EYXRlXTtcbiAgICAgICAgY29uc3QgZGF0ZU1vZGFsQWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICBjb25zdCBwID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IHNoaWZ0RGF0ZUFjdGlvbiA9ICgpID0+IHRoaXMuc2hpZnREYXRlKGR2QXBpLCBwLCBmaWxlKTtcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyOiBEYXRlRmllbGQgPSBuZXcgRk1bdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgIGNvbnN0IFtjdXJyZW50U2hpZnRdOiBbc3RyaW5nIHwgdW5kZWZpbmVkLCBGaWVsZCB8IHVuZGVmaW5lZCwgc3RyaW5nIHwgdW5kZWZpbmVkXSA9IGZpZWxkTWFuYWdlci5zaGlmdER1cmF0aW9uKGZpbGUpO1xuICAgICAgICBpZiAoRGF0ZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKGRhdGVJY29uTmFtZSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGRhdGVNb2RhbEFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbCB8fCB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCAmJiBkdkFwaSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgU2hpZnQgPCR7bmFtZX0+ICR7Y3VycmVudFNoaWZ0fSBhaGVhZGApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJza2lwLWZvcndhcmRcIik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhzaGlmdERhdGVBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKERhdGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBkYXRlTW9kYWxBY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogZGF0ZUljb25OYW1lXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbCB8fCB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCAmJiBkdkFwaSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlNoaWZ0IDxiPiR7bmFtZX08L2I+ICR7Y3VycmVudFNoaWZ0fSBhaGVhZDwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IHNoaWZ0RGF0ZUFjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJza2lwLWZvcndhcmRcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoRGF0ZUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFwic2tpcC1mb3J3YXJkXCIsIHNoaWZ0RGF0ZUFjdGlvbiwgYFNoaWZ0ICR7bmFtZX0gYWhlYWQgYnkgJHtjdXJyZW50U2hpZnR9YCk7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oZGF0ZUljb25OYW1lLCBkYXRlTW9kYWxBY3Rpb24sIGBTZXQgJHtuYW1lfSdzIGRhdGVgKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgZGF0ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVEYXRlQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCkgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQgPSB0aGlzLmRlZmF1bHREYXRlRm9ybWF0XG4gICAgICAgIGlmICghdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmspIHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rID0gXCJmYWxzZVwiXG4gICAgICAgIGNvbnN0IGRhdGVGb3JtYXRDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGRhdGVGb3JtYXRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRlIGZvcm1hdFwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgY29uc3QgZGF0ZUZvcm1hdElucHV0ID0gbmV3IFRleHRDb21wb25lbnQoZGF0ZUZvcm1hdENvbnRhaW5lcilcbiAgICAgICAgZGF0ZUZvcm1hdElucHV0LnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0KVxuICAgICAgICBjb25zdCBkYXRlRXhhbXBsZSA9IGRhdGVGb3JtYXRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pXG4gICAgICAgIGRhdGVFeGFtcGxlLnNldFRleHQoYGV4YW1wbGU6ICR7bW9tZW50KCkuZm9ybWF0KGRhdGVGb3JtYXRJbnB1dC5nZXRWYWx1ZSgpKX1gKVxuICAgICAgICBkYXRlRm9ybWF0SW5wdXQub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0ID0gdmFsdWVcbiAgICAgICAgICAgIGRhdGVFeGFtcGxlLnNldFRleHQoYGV4YW1wbGU6ICR7bW9tZW50KCkuZm9ybWF0KHZhbHVlKX1gKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaW5zZXJ0IGFzIGxpbmsgdG9nZ2xlclxuICAgICAgICBjb25zdCBkZWZhdWx0SW5zZXJ0QXNMaW5rQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiSW5zZXJ0IGFzIGxpbmsgYnkgZGVmYXVsdFwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRJbnNlcnRBc0xpbmsgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGRlZmF1bHRJbnNlcnRBc0xpbmtDb250YWluZXIpO1xuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rLnNldFZhbHVlKERhdGVGaWVsZC5zdHJpbmdUb0Jvb2xlYW4odGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmspKVxuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rLm9uQ2hhbmdlKCh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmsgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2ZvbGRlciBwYXRoIGZvciBsaW5rXG4gICAgICAgIGNvbnN0IGRhdGVMaW5rUGF0aENvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZGF0ZUxpbmtQYXRoQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiTGluayBwYXRoIChvcHRpb25hbClcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pXG4gICAgICAgIGNvbnN0IGRhdGVMaW5rUGF0aElucHV0ID0gbmV3IFRleHRDb21wb25lbnQoZGF0ZUxpbmtQYXRoQ29udGFpbmVyKVxuICAgICAgICBkYXRlTGlua1BhdGhJbnB1dC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubGlua1BhdGgpXG4gICAgICAgIGRhdGVMaW5rUGF0aElucHV0Lm9uQ2hhbmdlKCh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMubGlua1BhdGggPSB2YWx1ZS5lbmRzV2l0aChcIi9cIikgPyB2YWx1ZSA6IHZhbHVlICsgXCIvXCI7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHNoaWZ0IGludGVydmFsIChzaG91bGQgYmUgYSBudW1iZXIgb3IgYSBsdXhvbiBodW1hbml6ZWQgZHVyYXRpb24gKHJlcXVpcmVzIGRhdGF2aWV3KSAtPiB0byBpbmNsdWRlIGluIHZhbGlkYXRpb24pXG4gICAgICAgIGNvbnN0IGRhdGVTaGlmdEludGVydmFsQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBkYXRlU2hpZnRJbnRlcnZhbENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRlZmluZSBhIHNoaWZ0IGludGVydmFsXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY29uc3QgZGF0ZVNoaWZ0SW50ZXJ2YWwgPSBuZXcgVGV4dENvbXBvbmVudChkYXRlU2hpZnRJbnRlcnZhbENvbnRhaW5lcik7XG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsLnNldFBsYWNlaG9sZGVyKFwiZXg6IDEgbW9udGggMiBkYXlzXCIpXG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbClcbiAgICAgICAgZGF0ZVNoaWZ0SW50ZXJ2YWwub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBpbnRlcnZhbHMgY3ljbGUgZmllbGQgbmFtZVxuICAgICAgICBjb25zdCBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBcIkZpZWxkIGNvbnRhaW5pbmcgc2hpZnQgaW50ZXJ2YWxzIChoYXMgdGhlIHByaW9yaXR5IG92ZXIgdGhlIFNoaWZ0IEludGVydmFsIGFib3ZlKVwiLFxuICAgICAgICAgICAgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkID0gbmV3IFRleHRDb21wb25lbnQobmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZENvbnRhaW5lcik7XG4gICAgICAgIG5leHRTaGlmdEludGVydmFsRmllbGQuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQpXG4gICAgICAgIG5leHRTaGlmdEludGVydmFsRmllbGQub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkID0gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5kYXRlVmFsaWRhdG9yRmllbGQgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbnVtYmVyLW9wdGlvbnNcIiB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVEYXRlQ29udGFpbmVyKHRoaXMuZGF0ZVZhbGlkYXRvckZpZWxkKTtcbiAgICAgICAgdGhpcy5kYXRlVmFsaWRhdG9yRmllbGQuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHNoaWZ0RGF0ZShkdjogYW55LCBwOiBhbnksIGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHsgZGF0ZUZvcm1hdCwgZGVmYXVsdEluc2VydEFzTGluaywgbGlua1BhdGggfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXI6IERhdGVGaWVsZCA9IG5ldyBGTVt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgY29uc3QgW2N1cnJlbnRTaGlmdCwgbmV4dEludGVydmFsRmllbGQsIG5leHRTaGlmdF06IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdID0gZmllbGRNYW5hZ2VyLnNoaWZ0RHVyYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnN0IGR2RGF0ZSA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICAvL2RhdGF2aWV3IGlzIGNvbnZlcnRpbmcgZGF0ZXMgdG8gbGlua3Mgb3IgZGF0ZXRpbWVzLCBsZXQncyBub3JtYWxpemVcbiAgICAgICAgY29uc3QgY3VycmVudERhdGVWYWx1ZSA9IGR2LnZhbHVlLmlzTGluayhkdkRhdGUpID9cbiAgICAgICAgICAgIGR2RGF0ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkgOlxuICAgICAgICAgICAgZHYudmFsdWUuaXNEYXRlKGR2RGF0ZSkgP1xuICAgICAgICAgICAgICAgIG1vbWVudChkdkRhdGUudG9KU0RhdGUoKSkuZm9ybWF0KGRhdGVGb3JtYXQpIDpcbiAgICAgICAgICAgICAgICBkdkRhdGVcbiAgICAgICAgY29uc3QgY3VycmVudER2RGF0ZSA9IGR2LmRhdGUobW9tZW50KGN1cnJlbnREYXRlVmFsdWUsIGRhdGVGb3JtYXQpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBuZXdEYXRlID0gY3VycmVudER2RGF0ZS5wbHVzKGR2LmR1cmF0aW9uKGN1cnJlbnRTaGlmdCB8fCBcIjEgZGF5XCIpKTtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBtb21lbnQobmV3RGF0ZS50b1N0cmluZygpKS5mb3JtYXQoZGF0ZUZvcm1hdClcbiAgICAgICAgaWYgKG5leHRJbnRlcnZhbEZpZWxkICYmIG5leHRTaGlmdCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZS5wYXRoLCBuZXh0SW50ZXJ2YWxGaWVsZC5uYW1lLCBuZXh0U2hpZnQpIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxpbmtGaWxlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGlua1BhdGggfHwgXCJcIiArIG5ld1ZhbHVlLmZvcm1hdChkYXRlRm9ybWF0KSwgZmlsZS5wYXRoKVxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IERhdGVGaWVsZC5zdHJpbmdUb0Jvb2xlYW4oZGVmYXVsdEluc2VydEFzTGluaykgP1xuICAgICAgICAgICAgYFtbJHtsaW5rUGF0aCB8fCBcIlwifSR7bmV3VmFsdWV9JHtsaW5rRmlsZSA/IFwifFwiICsgbGlua0ZpbGUuYmFzZW5hbWUgOiBcIlwifV1dYCA6XG4gICAgICAgICAgICBuZXdWYWx1ZVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBmb3JtYXR0ZWRWYWx1ZSkgfSk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcgfCB1bmRlZmluZWQ7IGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDsgfVxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKTtcbiAgICAgICAgY29uc3QgZGF0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihkYXRlQnRuLCBGaWVsZEljb25bRmllbGRUeXBlLkRhdGVdKVxuICAgICAgICBkYXRlQnRuLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgLyogZW5kIHNwYWNlciAqL1xuICAgICAgICBjb25zdCBzcGFjZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwgfHwgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMuc2hpZnRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpXG4gICAgICAgICAgICBzZXRJY29uKHRoaXMuc2hpZnRCdG4sIFwic2tpcC1mb3J3YXJkXCIpXG4gICAgICAgICAgICB0aGlzLnNoaWZ0QnRuLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgICAgIHNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWRvdWJsZS1zcGFjZXJcIilcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwLmZpbGUucGF0aClcbiAgICAgICAgbGV0IGZpZWxkTW9kYWw6IERhdGVNb2RhbDtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGlmIChwW3RoaXMuZmllbGQubmFtZV0gJiYgcFt0aGlzLmZpZWxkLm5hbWVdLmhhc093blByb3BlcnR5KFwicGF0aFwiKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW3RoaXMuZmllbGQubmFtZV0pXG4gICAgICAgICAgICAgICAgaWYgKGRhdGVGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZGF0ZUZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IERhdGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgZGF0ZUZpbGUubmFtZSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IERhdGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdLnBhdGguc3BsaXQoXCIvXCIpLmxhc3QoKS5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocFt0aGlzLmZpZWxkLm5hbWVdKSB7XG4gICAgICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIFwiXCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zaGlmdEJ0bikgdGhpcy5zaGlmdEJ0bi5vbmNsaWNrID0gKCkgPT4geyB0aGlzLnNoaWZ0RGF0ZShkdiwgcCwgZmlsZSkgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZpZWxkTW9kYWwub25DbG9zZSA9ICgpID0+IHsgZmllbGRNb2RhbC5jb250ZW50RWwuaW5uZXJIVE1MID0gXCJcIjsgfVxuICAgICAgICBkYXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB7IGZpZWxkTW9kYWwub3BlbigpIH1cblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgZGF0ZUJ0bi5oaWRlKClcbiAgICAgICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSB0aGlzLnNoaWZ0QnRuLmhpZGUoKVxuICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGF0ZUJ0bi5zaG93KClcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaGlmdEJ0bikgdGhpcy5zaGlmdEJ0bi5zaG93KClcbiAgICAgICAgICAgICAgICBzcGFjZXIuaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRhdGVCdG4uaGlkZSgpXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIHRoaXMuc2hpZnRCdG4uaGlkZSgpXG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZGF0ZUJ0bik7XG4gICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnNoaWZ0QnRuKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQ7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2tlZDogKCkgPT4ge30pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdXG4gICAgICAgICAgICBpZiAoZHZBcGkudmFsdWUuaXNEYXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB2YWx1ZS5kaXNwbGF5IH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYScsIHsgdGV4dDogdmFsdWUucGF0aC5zcGxpdChcIi9cIikubGFzdCgpLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpIH0pXG4gICAgICAgICAgICAgICAgbGluay5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh2YWx1ZS5wYXRoLCBmaWxlLnBhdGgsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrZWQoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoe30pO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKHZhbHVlKSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQoXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLnJlcGxhY2UoL15cXFtcXFsvZywgXCJcIikucmVwbGFjZSgvXFxdXFxdJC9nLCBcIlwiKS5zcGxpdChcInxcIikuZmlyc3QoKT8uc3BsaXQoXCIvXCIpLmxhc3QoKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXRcbiAgICAgICAgICAgICAgICApLmlzVmFsaWQoKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KFxuICAgICAgICAgICAgICAgICAgICAodmFsdWUgYXMgeyBwYXRoOiBzdHJpbmcgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wYXRoLnJlcGxhY2UoL15cXFtcXFsvZywgXCJcIikucmVwbGFjZSgvXFxdXFxdJC9nLCBcIlwiKS5zcGxpdChcInxcIikuZmlyc3QoKT8uc3BsaXQoXCIvXCIpLmxhc3QoKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXRcbiAgICAgICAgICAgICAgICApLmlzVmFsaWQoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHNoaWZ0RHVyYXRpb24oZmlsZTogVEZpbGUpOiBbc3RyaW5nIHwgdW5kZWZpbmVkLCBGaWVsZCB8IHVuZGVmaW5lZCwgc3RyaW5nIHwgdW5kZWZpbmVkXSB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWxcbiAgICAgICAgICAgIGNvbnN0IGN5Y2xlSW50ZXJ2YWxGaWVsZCA9IHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkXG4gICAgICAgICAgICBjb25zdCBjeWNsZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gY3ljbGVJbnRlcnZhbEZpZWxkKVxuICAgICAgICAgICAgaWYgKGN5Y2xlKSB7XG4gICAgICAgICAgICAgICAgLy9jeWNsZSBmaWVsZCBleGlzdHNcbiAgICAgICAgICAgICAgICBjb25zdCBjeWNsZU1hbmFnZXI6IEN5Y2xlRmllbGQgPSBuZXcgRk1bY3ljbGUudHlwZV0odGhpcy5wbHVnaW4sIGN5Y2xlKVxuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBjeWNsZU1hbmFnZXIuZ2V0T3B0aW9uc0xpc3QoZmlsZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpW2N5Y2xlLm5hbWVdXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAvL2N1cnJlbnQgdmFsdWUgaXMgbm90IG51bGxcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlU3RyaW5nID0gb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihvID0+IGR2QXBpLmR1cmF0aW9uKG8pICE9PSBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQobyA9PiBjb21wYXJlRHVyYXRpb24oZHZBcGkuZHVyYXRpb24obyksIGN1cnJlbnRWYWx1ZSkpXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWVTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY3VycmVudCB2YWx1ZSBoYXMgYSBtYXRjaCBpbiBjeWNsZSBvcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0VmFsdWUgPSBjeWNsZU1hbmFnZXIubmV4dE9wdGlvbihjdXJyZW50VmFsdWVTdHJpbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2N1cnJlbnRWYWx1ZVN0cmluZywgY3ljbGUsIG5leHRWYWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2N1cnJlbnQgdmFsdWUgaXMgbm90IGZvdW5kIG9yIDogZmFsbCBiYWNrIG9uIGZpcnN0IHZhbHVlXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtvcHRpb25zWzBdLCBjeWNsZSwgb3B0aW9uc1sxXSB8fCBvcHRpb25zWzBdXVxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnRlcnZhbCAmJiBkdkFwaS5kdXJhdGlvbihpbnRlcnZhbCkpIHtcbiAgICAgICAgICAgICAgICAvL25vIGN5Y2xlIGZpZWxkOiBmYWxsIGJhY2sgb24gaW50ZXJ2YWwgaWYgZXhpc3RzXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtpbnRlcnZhbCwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gZHYgbm90IGF2YWlsYWJsZSA9PiByZXR1cm4gdW5kZWZpbmVkIGN5Y2xlIHZhbHVlc1xuICAgICAgICByZXR1cm4gW3VuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG4gICAgfVxufSIsICJpbXBvcnQgeyBNb2RhbCwgVGV4dENvbXBvbmVudCwgVEZpbGUsIFRvZ2dsZUNvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0gfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IG1vbWVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IGZsYXRwaWNrciBmcm9tIFwiZmxhdHBpY2tyXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSwgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRGF0ZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRGF0ZUZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhdGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZztcbiAgICBwcml2YXRlIGluc2VydEFzTGluazogYm9vbGVhbjtcbiAgICBwcml2YXRlIGlucHV0RWw6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBlcnJvckZpZWxkOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGZvcm1hdDogc3RyaW5nO1xuICAgIHByaXZhdGUgbmV4dEludGVydmFsRmllbGQ/OiBGaWVsZDtcbiAgICBwcml2YXRlIHB1c2hOZXh0SW50ZXJ2YWw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGN1cnJlbnRTaGlmdD86IHN0cmluZ1xuICAgIHByaXZhdGUgbmV4dFNoaWZ0Pzogc3RyaW5nXG4gICAgcHJpdmF0ZSBkYXRlTWFuYWdlcj86IERhdGVGaWVsZFxuICAgIHByaXZhdGUgZHZBcGk/OiBhbnlcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSBpbml0aWFsVmFsdWU6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5pbml0aWFsVmFsdWUgPSBpbml0aWFsVmFsdWUgPyBpbml0aWFsVmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbXFxbL2csIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvZywgXCJcIikuc3BsaXQoXCJ8XCIpLmZpcnN0KCk/LnNwbGl0KFwiL1wiKS5sYXN0KCkgfHwgXCJcIiA6IFwiXCI7XG4gICAgICAgIHRoaXMuaW5zZXJ0QXNMaW5rID0gRk0uc3RyaW5nVG9Cb29sZWFuKHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rIHx8IFwiZmFsc2VcIikgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMuZm9ybWF0ID0gdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQgfHwgdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHREYXRlRm9ybWF0O1xuICAgICAgICB0aGlzLmR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcbiAgICAgICAgaWYgKHRoaXMuZHZBcGkpIHRoaXMuZGF0ZU1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5pbml0aWFsVmFsdWU7XG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZVwiIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkRmllbGRzKGZpZWxkQ29udGFpbmVyKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsZEZpZWxkcyhwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XG5cbiAgICAgICAgY29uc3QgZGF0ZUZpZWxkc0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLWZpZWxkcy1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5idWlsZElucHV0RWwoZGF0ZUZpZWxkc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZXJyb3JGaWVsZCA9IGRhdGVGaWVsZHNDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZS1lcnJvci1maWVsZFwiIH0pO1xuICAgICAgICB0aGlzLmVycm9yRmllbGQuaGlkZSgpO1xuICAgICAgICB0aGlzLmJ1aWxkSW5zZXJ0QXNMaW5rVG9nZ2xlcihkYXRlRmllbGRzQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ0bkNvbnRhaW5lciA9IGRhdGVGaWVsZHNDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICBjb25zdCBzYXZlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChzYXZlQnRuQ29udGFpbmVyKVxuICAgICAgICBzYXZlQnRuLnNldEljb24oXCJjaGVja21hcmtcIilcblxuICAgICAgICBzYXZlQnRuLm9uQ2xpY2soYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgbmV3VmFsdWU6IG1vbWVudC5Nb21lbnQ7XG4gICAgICAgICAgICAvL3RyeSBuYXR1cmFsIGxhbmd1YWdlIGRhdGVcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5lbmFibGVkUGx1Z2lucy5oYXMoJ25sZGF0ZXMtb2JzaWRpYW4nKSkge1xuICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5sZGF0ZXMgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zWydubGRhdGVzLW9ic2lkaWFuJ107XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbmxkYXRlcy5wYXJzZURhdGUodGhpcy52YWx1ZSkubW9tZW50O1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbW9tZW50KHRoaXMudmFsdWUsIHRoaXMuZm9ybWF0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbW9tZW50KHRoaXMudmFsdWUsIHRoaXMuZm9ybWF0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rUGF0aCA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHRoaXMuZmllbGQub3B0aW9ucy5saW5rUGF0aCB8fCBcIlwiICsgbmV3VmFsdWUuZm9ybWF0KHRoaXMuZm9ybWF0KSwgdGhpcy5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0aGlzLmluc2VydEFzTGluayA/IGBbWyR7dGhpcy5maWVsZC5vcHRpb25zLmxpbmtQYXRoIHx8IFwiXCJ9JHtuZXdWYWx1ZS5mb3JtYXQodGhpcy5mb3JtYXQpfSR7bGlua1BhdGggPyBcInxcIiArIGxpbmtQYXRoLmJhc2VuYW1lIDogXCJcIn1dXWAgOiBuZXdWYWx1ZS5mb3JtYXQodGhpcy5mb3JtYXQpXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBmb3JtYXR0ZWRWYWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBmb3JtYXR0ZWRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXh0SW50ZXJ2YWxGaWVsZCAmJiB0aGlzLnB1c2hOZXh0SW50ZXJ2YWwgJiYgdGhpcy5uZXh0U2hpZnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUucGF0aCwgdGhpcy5uZXh0SW50ZXJ2YWxGaWVsZCEubmFtZSwgdGhpcy5uZXh0U2hpZnQhKSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIikgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBcIlwiLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KSB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yRmllbGQuc2hvdygpO1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JGaWVsZC5zZXRUZXh0KGB2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgZGF0ZWApXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsLmlucHV0RWwuYWRkQ2xhc3MoXCJpcy1pbnZhbGlkXCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnNlcnRBc0xpbmtUb2dnbGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgdG9nZ2xlckNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVyLXdpdGgtbGFiZWxcIiB9KVxuICAgICAgICBjb25zdCB0b2dnbGVyQ29udGFpbmVyTGFiZWwgPSB0b2dnbGVyQ29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVyLWxhYmVsXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRvZ2dsZXJDb250YWluZXJMYWJlbC5zZXRUZXh0KFwiSW5zZXJ0IGFzIGxpbmtcIik7XG4gICAgICAgIGNvbnN0IHRvZ2dsZUVsID0gbmV3IFRvZ2dsZUNvbXBvbmVudCh0b2dnbGVyQ29udGFpbmVyKTtcbiAgICAgICAgdG9nZ2xlRWwuc2V0VmFsdWUoRk0uc3RyaW5nVG9Cb29sZWFuKHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rIHx8IFwiZmFsc2VcIikpXG4gICAgICAgIHRvZ2dsZUVsLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbnNlcnRBc0xpbmsgPSB2YWx1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZUJ1dHRvbihidXR0b246IEJ1dHRvbkNvbXBvbmVudCwgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQoISF2YWx1ZSlcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJkaXNhYmxlZFwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnJlbW92ZUNsYXNzKFwiZGlzYWJsZWRcIilcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy9sZXQgY3VycmVudER2RHVyYXRpb246IGFueTtcblxuICAgICAgICBpZiAodGhpcy5kYXRlTWFuYWdlcikgW3RoaXMuY3VycmVudFNoaWZ0LCB0aGlzLm5leHRJbnRlcnZhbEZpZWxkLCB0aGlzLm5leHRTaGlmdF0gPSB0aGlzLmRhdGVNYW5hZ2VyLnNoaWZ0RHVyYXRpb24odGhpcy5maWxlKTtcblxuICAgICAgICBjb25zdCBpbnB1dENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1kYXRlaW5wdXQtd2l0aC1waWNrZXJcIiB9KVxuICAgICAgICB0aGlzLmlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5pbnB1dEVsLmZvY3VzKCk7XG5cbiAgICAgICAgdGhpcy5pbnB1dEVsLnNldFBsYWNlaG9sZGVyKFxuICAgICAgICAgICAgdGhpcy5pbml0aWFsVmFsdWUgP1xuICAgICAgICAgICAgICAgIG1vbWVudCh0aGlzLmluaXRpYWxWYWx1ZSwgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQpLmZvcm1hdCh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdClcbiAgICAgICAgICAgICAgICA6IFwiXCIpO1xuICAgICAgICB0aGlzLmlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpO1xuICAgICAgICB0aGlzLmlucHV0RWwub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLmlucHV0RWwucmVtb3ZlQ2xhc3MoXCJpcy1pbnZhbGlkXCIpXG4gICAgICAgICAgICB0aGlzLmVycm9yRmllbGQuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWVcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKHNoaWZ0RnJvbVRvZGF5QnRuLCB2YWx1ZSlcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNhbGVuZGFyRGlzcGxheUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGNhbGVuZGFyRGlzcGxheUJ0bi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtbW9kYWwtaW5saW5lLWJ0blwiKVxuICAgICAgICBjYWxlbmRhckRpc3BsYXlCdG4uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLkRhdGVdKVxuICAgICAgICBjYWxlbmRhckRpc3BsYXlCdG4uc2V0VG9vbHRpcChcIm9wZW4gZGF0ZSBwaWNrZXJcIilcbiAgICAgICAgY29uc3Qgc2hpZnRGcm9tVG9kYXlCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtbW9kYWwtaW5saW5lLWJ0blwiKVxuICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5zZXRJY29uKFwic2tpcC1mb3J3YXJkXCIpXG4gICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLnNldFRvb2x0aXAoYFNoaWZ0ICR7dGhpcy5maWVsZC5uYW1lfSAke3RoaXMuY3VycmVudFNoaWZ0IHx8IFwiMSBkYXlcIn0gYWhlYWRgKVxuXG4gICAgICAgIGNvbnN0IGRhdGVQaWNrZXJDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtcGlja2VyLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBjb25zdCBkYXRlUGlja2VyID0gZmxhdHBpY2tyKGRhdGVQaWNrZXJDb250YWluZXIsIHtcbiAgICAgICAgICAgIGxvY2FsZToge1xuICAgICAgICAgICAgICAgIGZpcnN0RGF5T2ZXZWVrOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maXJzdERheU9mV2Vla1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlZmF1bHREYXRlOiBtb21lbnQoRGF0ZS5ub3coKSkuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKVxuICAgICAgICB9KTtcbiAgICAgICAgZGF0ZVBpY2tlci5jb25maWcub25DaGFuZ2UucHVzaCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0RhdGUgPSBtb21lbnQodmFsdWUudG9TdHJpbmcoKSkuZm9ybWF0KHRoaXMuZm9ybWF0KTtcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5zZXRWYWx1ZShuZXdEYXRlKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXdEYXRlO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b24oc2hpZnRGcm9tVG9kYXlCdG4sIHRoaXMudmFsdWUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgY2FsZW5kYXJEaXNwbGF5QnRuLm9uQ2xpY2soKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGRhdGVQaWNrZXIuc2V0RGF0ZShkYXRlUGlja2VyLnBhcnNlRGF0ZSh0aGlzLmlucHV0RWwuZ2V0VmFsdWUoKSkgfHwgbmV3IERhdGUoKSlcbiAgICAgICAgICAgIGRhdGVQaWNrZXIub3BlbigpO1xuICAgICAgICB9KVxuXG4gICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLm9uQ2xpY2soYXN5bmMgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnREdkRhdGUgPSB0aGlzLmR2QXBpLmRhdGUobW9tZW50KHRoaXMuaW5pdGlhbFZhbHVlLCB0aGlzLmZvcm1hdCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgICAgICBjb25zdCBuZXdEYXRlID0gY3VycmVudER2RGF0ZS5wbHVzKHRoaXMuZHZBcGkuZHVyYXRpb24odGhpcy5jdXJyZW50U2hpZnQgfHwgXCIxIGRheVwiKSk7XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IG1vbWVudChuZXdEYXRlLnRvU3RyaW5nKCkpLmZvcm1hdCh0aGlzLmZvcm1hdClcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5zZXRWYWx1ZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB0aGlzLnB1c2hOZXh0SW50ZXJ2YWwgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b24oc2hpZnRGcm9tVG9kYXlCdG4sIHRoaXMuaW5wdXRFbC5nZXRWYWx1ZSgpKVxuICAgICAgICB9KVxuXG4gICAgICAgIGlmICghdGhpcy5kdkFwaSkge1xuICAgICAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4uYnV0dG9uRWwuaGlkZSgpO1xuICAgICAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbiIsICJleHBvcnQgdmFyIEhPT0tTID0gW1xuICAgIFwib25DaGFuZ2VcIixcbiAgICBcIm9uQ2xvc2VcIixcbiAgICBcIm9uRGF5Q3JlYXRlXCIsXG4gICAgXCJvbkRlc3Ryb3lcIixcbiAgICBcIm9uS2V5RG93blwiLFxuICAgIFwib25Nb250aENoYW5nZVwiLFxuICAgIFwib25PcGVuXCIsXG4gICAgXCJvblBhcnNlQ29uZmlnXCIsXG4gICAgXCJvblJlYWR5XCIsXG4gICAgXCJvblZhbHVlVXBkYXRlXCIsXG4gICAgXCJvblllYXJDaGFuZ2VcIixcbiAgICBcIm9uUHJlQ2FsZW5kYXJQb3NpdGlvblwiLFxuXTtcbmV4cG9ydCB2YXIgZGVmYXVsdHMgPSB7XG4gICAgX2Rpc2FibGU6IFtdLFxuICAgIGFsbG93SW5wdXQ6IGZhbHNlLFxuICAgIGFsbG93SW52YWxpZFByZWxvYWQ6IGZhbHNlLFxuICAgIGFsdEZvcm1hdDogXCJGIGosIFlcIixcbiAgICBhbHRJbnB1dDogZmFsc2UsXG4gICAgYWx0SW5wdXRDbGFzczogXCJmb3JtLWNvbnRyb2wgaW5wdXRcIixcbiAgICBhbmltYXRlOiB0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFXCIpID09PSAtMSxcbiAgICBhcmlhRGF0ZUZvcm1hdDogXCJGIGosIFlcIixcbiAgICBhdXRvRmlsbERlZmF1bHRUaW1lOiB0cnVlLFxuICAgIGNsaWNrT3BlbnM6IHRydWUsXG4gICAgY2xvc2VPblNlbGVjdDogdHJ1ZSxcbiAgICBjb25qdW5jdGlvbjogXCIsIFwiLFxuICAgIGRhdGVGb3JtYXQ6IFwiWS1tLWRcIixcbiAgICBkZWZhdWx0SG91cjogMTIsXG4gICAgZGVmYXVsdE1pbnV0ZTogMCxcbiAgICBkZWZhdWx0U2Vjb25kczogMCxcbiAgICBkaXNhYmxlOiBbXSxcbiAgICBkaXNhYmxlTW9iaWxlOiBmYWxzZSxcbiAgICBlbmFibGVTZWNvbmRzOiBmYWxzZSxcbiAgICBlbmFibGVUaW1lOiBmYWxzZSxcbiAgICBlcnJvckhhbmRsZXI6IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBjb25zb2xlICE9PSBcInVuZGVmaW5lZFwiICYmIGNvbnNvbGUud2FybihlcnIpO1xuICAgIH0sXG4gICAgZ2V0V2VlazogZnVuY3Rpb24gKGdpdmVuRGF0ZSkge1xuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGdpdmVuRGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICBkYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyAzIC0gKChkYXRlLmdldERheSgpICsgNikgJSA3KSk7XG4gICAgICAgIHZhciB3ZWVrMSA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgMCwgNCk7XG4gICAgICAgIHJldHVybiAoMSArXG4gICAgICAgICAgICBNYXRoLnJvdW5kKCgoZGF0ZS5nZXRUaW1lKCkgLSB3ZWVrMS5nZXRUaW1lKCkpIC8gODY0MDAwMDAgLVxuICAgICAgICAgICAgICAgIDMgK1xuICAgICAgICAgICAgICAgICgod2VlazEuZ2V0RGF5KCkgKyA2KSAlIDcpKSAvXG4gICAgICAgICAgICAgICAgNykpO1xuICAgIH0sXG4gICAgaG91ckluY3JlbWVudDogMSxcbiAgICBpZ25vcmVkRm9jdXNFbGVtZW50czogW10sXG4gICAgaW5saW5lOiBmYWxzZSxcbiAgICBsb2NhbGU6IFwiZGVmYXVsdFwiLFxuICAgIG1pbnV0ZUluY3JlbWVudDogNSxcbiAgICBtb2RlOiBcInNpbmdsZVwiLFxuICAgIG1vbnRoU2VsZWN0b3JUeXBlOiBcImRyb3Bkb3duXCIsXG4gICAgbmV4dEFycm93OiBcIjxzdmcgdmVyc2lvbj0nMS4xJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB2aWV3Qm94PScwIDAgMTcgMTcnPjxnPjwvZz48cGF0aCBkPSdNMTMuMjA3IDguNDcybC03Ljg1NCA3Ljg1NC0wLjcwNy0wLjcwNyA3LjE0Ni03LjE0Ni03LjE0Ni03LjE0OCAwLjcwNy0wLjcwNyA3Ljg1NCA3Ljg1NHonIC8+PC9zdmc+XCIsXG4gICAgbm9DYWxlbmRhcjogZmFsc2UsXG4gICAgbm93OiBuZXcgRGF0ZSgpLFxuICAgIG9uQ2hhbmdlOiBbXSxcbiAgICBvbkNsb3NlOiBbXSxcbiAgICBvbkRheUNyZWF0ZTogW10sXG4gICAgb25EZXN0cm95OiBbXSxcbiAgICBvbktleURvd246IFtdLFxuICAgIG9uTW9udGhDaGFuZ2U6IFtdLFxuICAgIG9uT3BlbjogW10sXG4gICAgb25QYXJzZUNvbmZpZzogW10sXG4gICAgb25SZWFkeTogW10sXG4gICAgb25WYWx1ZVVwZGF0ZTogW10sXG4gICAgb25ZZWFyQ2hhbmdlOiBbXSxcbiAgICBvblByZUNhbGVuZGFyUG9zaXRpb246IFtdLFxuICAgIHBsdWdpbnM6IFtdLFxuICAgIHBvc2l0aW9uOiBcImF1dG9cIixcbiAgICBwb3NpdGlvbkVsZW1lbnQ6IHVuZGVmaW5lZCxcbiAgICBwcmV2QXJyb3c6IFwiPHN2ZyB2ZXJzaW9uPScxLjEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgeG1sbnM6eGxpbms9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnIHZpZXdCb3g9JzAgMCAxNyAxNyc+PGc+PC9nPjxwYXRoIGQ9J001LjIwNyA4LjQ3MWw3LjE0NiA3LjE0Ny0wLjcwNyAwLjcwNy03Ljg1My03Ljg1NCA3Ljg1NC03Ljg1MyAwLjcwNyAwLjcwNy03LjE0NyA3LjE0NnonIC8+PC9zdmc+XCIsXG4gICAgc2hvcnRoYW5kQ3VycmVudE1vbnRoOiBmYWxzZSxcbiAgICBzaG93TW9udGhzOiAxLFxuICAgIHN0YXRpYzogZmFsc2UsXG4gICAgdGltZV8yNGhyOiBmYWxzZSxcbiAgICB3ZWVrTnVtYmVyczogZmFsc2UsXG4gICAgd3JhcDogZmFsc2UsXG59O1xuIiwgImV4cG9ydCB2YXIgZW5nbGlzaCA9IHtcbiAgICB3ZWVrZGF5czoge1xuICAgICAgICBzaG9ydGhhbmQ6IFtcIlN1blwiLCBcIk1vblwiLCBcIlR1ZVwiLCBcIldlZFwiLCBcIlRodVwiLCBcIkZyaVwiLCBcIlNhdFwiXSxcbiAgICAgICAgbG9uZ2hhbmQ6IFtcbiAgICAgICAgICAgIFwiU3VuZGF5XCIsXG4gICAgICAgICAgICBcIk1vbmRheVwiLFxuICAgICAgICAgICAgXCJUdWVzZGF5XCIsXG4gICAgICAgICAgICBcIldlZG5lc2RheVwiLFxuICAgICAgICAgICAgXCJUaHVyc2RheVwiLFxuICAgICAgICAgICAgXCJGcmlkYXlcIixcbiAgICAgICAgICAgIFwiU2F0dXJkYXlcIixcbiAgICAgICAgXSxcbiAgICB9LFxuICAgIG1vbnRoczoge1xuICAgICAgICBzaG9ydGhhbmQ6IFtcbiAgICAgICAgICAgIFwiSmFuXCIsXG4gICAgICAgICAgICBcIkZlYlwiLFxuICAgICAgICAgICAgXCJNYXJcIixcbiAgICAgICAgICAgIFwiQXByXCIsXG4gICAgICAgICAgICBcIk1heVwiLFxuICAgICAgICAgICAgXCJKdW5cIixcbiAgICAgICAgICAgIFwiSnVsXCIsXG4gICAgICAgICAgICBcIkF1Z1wiLFxuICAgICAgICAgICAgXCJTZXBcIixcbiAgICAgICAgICAgIFwiT2N0XCIsXG4gICAgICAgICAgICBcIk5vdlwiLFxuICAgICAgICAgICAgXCJEZWNcIixcbiAgICAgICAgXSxcbiAgICAgICAgbG9uZ2hhbmQ6IFtcbiAgICAgICAgICAgIFwiSmFudWFyeVwiLFxuICAgICAgICAgICAgXCJGZWJydWFyeVwiLFxuICAgICAgICAgICAgXCJNYXJjaFwiLFxuICAgICAgICAgICAgXCJBcHJpbFwiLFxuICAgICAgICAgICAgXCJNYXlcIixcbiAgICAgICAgICAgIFwiSnVuZVwiLFxuICAgICAgICAgICAgXCJKdWx5XCIsXG4gICAgICAgICAgICBcIkF1Z3VzdFwiLFxuICAgICAgICAgICAgXCJTZXB0ZW1iZXJcIixcbiAgICAgICAgICAgIFwiT2N0b2JlclwiLFxuICAgICAgICAgICAgXCJOb3ZlbWJlclwiLFxuICAgICAgICAgICAgXCJEZWNlbWJlclwiLFxuICAgICAgICBdLFxuICAgIH0sXG4gICAgZGF5c0luTW9udGg6IFszMSwgMjgsIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXSxcbiAgICBmaXJzdERheU9mV2VlazogMCxcbiAgICBvcmRpbmFsOiBmdW5jdGlvbiAobnRoKSB7XG4gICAgICAgIHZhciBzID0gbnRoICUgMTAwO1xuICAgICAgICBpZiAocyA+IDMgJiYgcyA8IDIxKVxuICAgICAgICAgICAgcmV0dXJuIFwidGhcIjtcbiAgICAgICAgc3dpdGNoIChzICUgMTApIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzdFwiO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIm5kXCI7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwicmRcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidGhcIjtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmFuZ2VTZXBhcmF0b3I6IFwiIHRvIFwiLFxuICAgIHdlZWtBYmJyZXZpYXRpb246IFwiV2tcIixcbiAgICBzY3JvbGxUaXRsZTogXCJTY3JvbGwgdG8gaW5jcmVtZW50XCIsXG4gICAgdG9nZ2xlVGl0bGU6IFwiQ2xpY2sgdG8gdG9nZ2xlXCIsXG4gICAgYW1QTTogW1wiQU1cIiwgXCJQTVwiXSxcbiAgICB5ZWFyQXJpYUxhYmVsOiBcIlllYXJcIixcbiAgICBtb250aEFyaWFMYWJlbDogXCJNb250aFwiLFxuICAgIGhvdXJBcmlhTGFiZWw6IFwiSG91clwiLFxuICAgIG1pbnV0ZUFyaWFMYWJlbDogXCJNaW51dGVcIixcbiAgICB0aW1lXzI0aHI6IGZhbHNlLFxufTtcbmV4cG9ydCBkZWZhdWx0IGVuZ2xpc2g7XG4iLCAiZXhwb3J0IHZhciBwYWQgPSBmdW5jdGlvbiAobnVtYmVyLCBsZW5ndGgpIHtcbiAgICBpZiAobGVuZ3RoID09PSB2b2lkIDApIHsgbGVuZ3RoID0gMjsgfVxuICAgIHJldHVybiAoXCIwMDBcIiArIG51bWJlcikuc2xpY2UobGVuZ3RoICogLTEpO1xufTtcbmV4cG9ydCB2YXIgaW50ID0gZnVuY3Rpb24gKGJvb2wpIHsgcmV0dXJuIChib29sID09PSB0cnVlID8gMSA6IDApOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlKGZuLCB3YWl0KSB7XG4gICAgdmFyIHQ7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIGNsZWFyVGltZW91dCh0KTtcbiAgICAgICAgdCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZm4uYXBwbHkoX3RoaXMsIGFyZ3MpOyB9LCB3YWl0KTtcbiAgICB9O1xufVxuZXhwb3J0IHZhciBhcnJheWlmeSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICByZXR1cm4gb2JqIGluc3RhbmNlb2YgQXJyYXkgPyBvYmogOiBbb2JqXTtcbn07XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsZW0sIGNsYXNzTmFtZSwgYm9vbCkge1xuICAgIGlmIChib29sID09PSB0cnVlKVxuICAgICAgICByZXR1cm4gZWxlbS5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgZWxlbS5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG59XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRWxlbWVudCh0YWcsIGNsYXNzTmFtZSwgY29udGVudCkge1xuICAgIHZhciBlID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcbiAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUgfHwgXCJcIjtcbiAgICBjb250ZW50ID0gY29udGVudCB8fCBcIlwiO1xuICAgIGUuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xuICAgIGlmIChjb250ZW50ICE9PSB1bmRlZmluZWQpXG4gICAgICAgIGUudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIHJldHVybiBlO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyTm9kZShub2RlKSB7XG4gICAgd2hpbGUgKG5vZGUuZmlyc3RDaGlsZClcbiAgICAgICAgbm9kZS5yZW1vdmVDaGlsZChub2RlLmZpcnN0Q2hpbGQpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRQYXJlbnQobm9kZSwgY29uZGl0aW9uKSB7XG4gICAgaWYgKGNvbmRpdGlvbihub2RlKSlcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlKVxuICAgICAgICByZXR1cm4gZmluZFBhcmVudChub2RlLnBhcmVudE5vZGUsIGNvbmRpdGlvbik7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOdW1iZXJJbnB1dChpbnB1dENsYXNzTmFtZSwgb3B0cykge1xuICAgIHZhciB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcIm51bUlucHV0V3JhcHBlclwiKSwgbnVtSW5wdXQgPSBjcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgXCJudW1JbnB1dCBcIiArIGlucHV0Q2xhc3NOYW1lKSwgYXJyb3dVcCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiYXJyb3dVcFwiKSwgYXJyb3dEb3duID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJhcnJvd0Rvd25cIik7XG4gICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUUgOS4wXCIpID09PSAtMSkge1xuICAgICAgICBudW1JbnB1dC50eXBlID0gXCJudW1iZXJcIjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG51bUlucHV0LnR5cGUgPSBcInRleHRcIjtcbiAgICAgICAgbnVtSW5wdXQucGF0dGVybiA9IFwiXFxcXGQqXCI7XG4gICAgfVxuICAgIGlmIChvcHRzICE9PSB1bmRlZmluZWQpXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvcHRzKVxuICAgICAgICAgICAgbnVtSW5wdXQuc2V0QXR0cmlidXRlKGtleSwgb3B0c1trZXldKTtcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKG51bUlucHV0KTtcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGFycm93VXApO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoYXJyb3dEb3duKTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRFdmVudFRhcmdldChldmVudCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnQuY29tcG9zZWRQYXRoID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHZhciBwYXRoID0gZXZlbnQuY29tcG9zZWRQYXRoKCk7XG4gICAgICAgICAgICByZXR1cm4gcGF0aFswXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnQudGFyZ2V0O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGV2ZW50LnRhcmdldDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgaW50LCBwYWQgfSBmcm9tIFwiLi4vdXRpbHNcIjtcbnZhciBkb05vdGhpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB1bmRlZmluZWQ7IH07XG5leHBvcnQgdmFyIG1vbnRoVG9TdHIgPSBmdW5jdGlvbiAobW9udGhOdW1iZXIsIHNob3J0aGFuZCwgbG9jYWxlKSB7IHJldHVybiBsb2NhbGUubW9udGhzW3Nob3J0aGFuZCA/IFwic2hvcnRoYW5kXCIgOiBcImxvbmdoYW5kXCJdW21vbnRoTnVtYmVyXTsgfTtcbmV4cG9ydCB2YXIgcmV2Rm9ybWF0ID0ge1xuICAgIEQ6IGRvTm90aGluZyxcbiAgICBGOiBmdW5jdGlvbiAoZGF0ZU9iaiwgbW9udGhOYW1lLCBsb2NhbGUpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNb250aChsb2NhbGUubW9udGhzLmxvbmdoYW5kLmluZGV4T2YobW9udGhOYW1lKSk7XG4gICAgfSxcbiAgICBHOiBmdW5jdGlvbiAoZGF0ZU9iaiwgaG91cikge1xuICAgICAgICBkYXRlT2JqLnNldEhvdXJzKChkYXRlT2JqLmdldEhvdXJzKCkgPj0gMTIgPyAxMiA6IDApICsgcGFyc2VGbG9hdChob3VyKSk7XG4gICAgfSxcbiAgICBIOiBmdW5jdGlvbiAoZGF0ZU9iaiwgaG91cikge1xuICAgICAgICBkYXRlT2JqLnNldEhvdXJzKHBhcnNlRmxvYXQoaG91cikpO1xuICAgIH0sXG4gICAgSjogZnVuY3Rpb24gKGRhdGVPYmosIGRheSkge1xuICAgICAgICBkYXRlT2JqLnNldERhdGUocGFyc2VGbG9hdChkYXkpKTtcbiAgICB9LFxuICAgIEs6IGZ1bmN0aW9uIChkYXRlT2JqLCBhbVBNLCBsb2NhbGUpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRIb3VycygoZGF0ZU9iai5nZXRIb3VycygpICUgMTIpICtcbiAgICAgICAgICAgIDEyICogaW50KG5ldyBSZWdFeHAobG9jYWxlLmFtUE1bMV0sIFwiaVwiKS50ZXN0KGFtUE0pKSk7XG4gICAgfSxcbiAgICBNOiBmdW5jdGlvbiAoZGF0ZU9iaiwgc2hvcnRNb250aCwgbG9jYWxlKSB7XG4gICAgICAgIGRhdGVPYmouc2V0TW9udGgobG9jYWxlLm1vbnRocy5zaG9ydGhhbmQuaW5kZXhPZihzaG9ydE1vbnRoKSk7XG4gICAgfSxcbiAgICBTOiBmdW5jdGlvbiAoZGF0ZU9iaiwgc2Vjb25kcykge1xuICAgICAgICBkYXRlT2JqLnNldFNlY29uZHMocGFyc2VGbG9hdChzZWNvbmRzKSk7XG4gICAgfSxcbiAgICBVOiBmdW5jdGlvbiAoXywgdW5peFNlY29uZHMpIHsgcmV0dXJuIG5ldyBEYXRlKHBhcnNlRmxvYXQodW5peFNlY29uZHMpICogMTAwMCk7IH0sXG4gICAgVzogZnVuY3Rpb24gKGRhdGVPYmosIHdlZWtOdW0sIGxvY2FsZSkge1xuICAgICAgICB2YXIgd2Vla051bWJlciA9IHBhcnNlSW50KHdlZWtOdW0pO1xuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGRhdGVPYmouZ2V0RnVsbFllYXIoKSwgMCwgMiArICh3ZWVrTnVtYmVyIC0gMSkgKiA3LCAwLCAwLCAwLCAwKTtcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpIC0gZGF0ZS5nZXREYXkoKSArIGxvY2FsZS5maXJzdERheU9mV2Vlayk7XG4gICAgICAgIHJldHVybiBkYXRlO1xuICAgIH0sXG4gICAgWTogZnVuY3Rpb24gKGRhdGVPYmosIHllYXIpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRGdWxsWWVhcihwYXJzZUZsb2F0KHllYXIpKTtcbiAgICB9LFxuICAgIFo6IGZ1bmN0aW9uIChfLCBJU09EYXRlKSB7IHJldHVybiBuZXcgRGF0ZShJU09EYXRlKTsgfSxcbiAgICBkOiBmdW5jdGlvbiAoZGF0ZU9iaiwgZGF5KSB7XG4gICAgICAgIGRhdGVPYmouc2V0RGF0ZShwYXJzZUZsb2F0KGRheSkpO1xuICAgIH0sXG4gICAgaDogZnVuY3Rpb24gKGRhdGVPYmosIGhvdXIpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRIb3VycygoZGF0ZU9iai5nZXRIb3VycygpID49IDEyID8gMTIgOiAwKSArIHBhcnNlRmxvYXQoaG91cikpO1xuICAgIH0sXG4gICAgaTogZnVuY3Rpb24gKGRhdGVPYmosIG1pbnV0ZXMpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNaW51dGVzKHBhcnNlRmxvYXQobWludXRlcykpO1xuICAgIH0sXG4gICAgajogZnVuY3Rpb24gKGRhdGVPYmosIGRheSkge1xuICAgICAgICBkYXRlT2JqLnNldERhdGUocGFyc2VGbG9hdChkYXkpKTtcbiAgICB9LFxuICAgIGw6IGRvTm90aGluZyxcbiAgICBtOiBmdW5jdGlvbiAoZGF0ZU9iaiwgbW9udGgpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNb250aChwYXJzZUZsb2F0KG1vbnRoKSAtIDEpO1xuICAgIH0sXG4gICAgbjogZnVuY3Rpb24gKGRhdGVPYmosIG1vbnRoKSB7XG4gICAgICAgIGRhdGVPYmouc2V0TW9udGgocGFyc2VGbG9hdChtb250aCkgLSAxKTtcbiAgICB9LFxuICAgIHM6IGZ1bmN0aW9uIChkYXRlT2JqLCBzZWNvbmRzKSB7XG4gICAgICAgIGRhdGVPYmouc2V0U2Vjb25kcyhwYXJzZUZsb2F0KHNlY29uZHMpKTtcbiAgICB9LFxuICAgIHU6IGZ1bmN0aW9uIChfLCB1bml4TWlsbFNlY29uZHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHBhcnNlRmxvYXQodW5peE1pbGxTZWNvbmRzKSk7XG4gICAgfSxcbiAgICB3OiBkb05vdGhpbmcsXG4gICAgeTogZnVuY3Rpb24gKGRhdGVPYmosIHllYXIpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRGdWxsWWVhcigyMDAwICsgcGFyc2VGbG9hdCh5ZWFyKSk7XG4gICAgfSxcbn07XG5leHBvcnQgdmFyIHRva2VuUmVnZXggPSB7XG4gICAgRDogXCJcIixcbiAgICBGOiBcIlwiLFxuICAgIEc6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgSDogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBKOiBcIihcXFxcZFxcXFxkfFxcXFxkKVxcXFx3K1wiLFxuICAgIEs6IFwiXCIsXG4gICAgTTogXCJcIixcbiAgICBTOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIFU6IFwiKC4rKVwiLFxuICAgIFc6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgWTogXCIoXFxcXGR7NH0pXCIsXG4gICAgWjogXCIoLispXCIsXG4gICAgZDogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBoOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIGk6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgajogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBsOiBcIlwiLFxuICAgIG06IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgbjogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBzOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIHU6IFwiKC4rKVwiLFxuICAgIHc6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgeTogXCIoXFxcXGR7Mn0pXCIsXG59O1xuZXhwb3J0IHZhciBmb3JtYXRzID0ge1xuICAgIFo6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCk7IH0sXG4gICAgRDogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gbG9jYWxlLndlZWtkYXlzLnNob3J0aGFuZFtmb3JtYXRzLncoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKV07XG4gICAgfSxcbiAgICBGOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBtb250aFRvU3RyKGZvcm1hdHMubihkYXRlLCBsb2NhbGUsIG9wdGlvbnMpIC0gMSwgZmFsc2UsIGxvY2FsZSk7XG4gICAgfSxcbiAgICBHOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBwYWQoZm9ybWF0cy5oKGRhdGUsIGxvY2FsZSwgb3B0aW9ucykpO1xuICAgIH0sXG4gICAgSDogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldEhvdXJzKCkpOyB9LFxuICAgIEo6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZS5vcmRpbmFsICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgID8gZGF0ZS5nZXREYXRlKCkgKyBsb2NhbGUub3JkaW5hbChkYXRlLmdldERhdGUoKSlcbiAgICAgICAgICAgIDogZGF0ZS5nZXREYXRlKCk7XG4gICAgfSxcbiAgICBLOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlKSB7IHJldHVybiBsb2NhbGUuYW1QTVtpbnQoZGF0ZS5nZXRIb3VycygpID4gMTEpXTsgfSxcbiAgICBNOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBtb250aFRvU3RyKGRhdGUuZ2V0TW9udGgoKSwgdHJ1ZSwgbG9jYWxlKTtcbiAgICB9LFxuICAgIFM6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXRTZWNvbmRzKCkpOyB9LFxuICAgIFU6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldFRpbWUoKSAvIDEwMDA7IH0sXG4gICAgVzogZnVuY3Rpb24gKGRhdGUsIF8sIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0V2VlayhkYXRlKTtcbiAgICB9LFxuICAgIFk6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXRGdWxsWWVhcigpLCA0KTsgfSxcbiAgICBkOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0RGF0ZSgpKTsgfSxcbiAgICBoOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gKGRhdGUuZ2V0SG91cnMoKSAlIDEyID8gZGF0ZS5nZXRIb3VycygpICUgMTIgOiAxMik7IH0sXG4gICAgaTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldE1pbnV0ZXMoKSk7IH0sXG4gICAgajogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0RGF0ZSgpOyB9LFxuICAgIGw6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5cy5sb25naGFuZFtkYXRlLmdldERheSgpXTtcbiAgICB9LFxuICAgIG06IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXRNb250aCgpICsgMSk7IH0sXG4gICAgbjogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0TW9udGgoKSArIDE7IH0sXG4gICAgczogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0U2Vjb25kcygpOyB9LFxuICAgIHU6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldFRpbWUoKTsgfSxcbiAgICB3OiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXREYXkoKTsgfSxcbiAgICB5OiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gU3RyaW5nKGRhdGUuZ2V0RnVsbFllYXIoKSkuc3Vic3RyaW5nKDIpOyB9LFxufTtcbiIsICJpbXBvcnQgeyB0b2tlblJlZ2V4LCByZXZGb3JtYXQsIGZvcm1hdHMsIH0gZnJvbSBcIi4vZm9ybWF0dGluZ1wiO1xuaW1wb3J0IHsgZGVmYXVsdHMgfSBmcm9tIFwiLi4vdHlwZXMvb3B0aW9uc1wiO1xuaW1wb3J0IHsgZW5nbGlzaCB9IGZyb20gXCIuLi9sMTBuL2RlZmF1bHRcIjtcbmV4cG9ydCB2YXIgY3JlYXRlRGF0ZUZvcm1hdHRlciA9IGZ1bmN0aW9uIChfYSkge1xuICAgIHZhciBfYiA9IF9hLmNvbmZpZywgY29uZmlnID0gX2IgPT09IHZvaWQgMCA/IGRlZmF1bHRzIDogX2IsIF9jID0gX2EubDEwbiwgbDEwbiA9IF9jID09PSB2b2lkIDAgPyBlbmdsaXNoIDogX2MsIF9kID0gX2EuaXNNb2JpbGUsIGlzTW9iaWxlID0gX2QgPT09IHZvaWQgMCA/IGZhbHNlIDogX2Q7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRlT2JqLCBmcm10LCBvdmVycmlkZUxvY2FsZSkge1xuICAgICAgICB2YXIgbG9jYWxlID0gb3ZlcnJpZGVMb2NhbGUgfHwgbDEwbjtcbiAgICAgICAgaWYgKGNvbmZpZy5mb3JtYXREYXRlICE9PSB1bmRlZmluZWQgJiYgIWlzTW9iaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnLmZvcm1hdERhdGUoZGF0ZU9iaiwgZnJtdCwgbG9jYWxlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJtdFxuICAgICAgICAgICAgLnNwbGl0KFwiXCIpXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChjLCBpLCBhcnIpIHtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXRzW2NdICYmIGFycltpIC0gMV0gIT09IFwiXFxcXFwiXG4gICAgICAgICAgICAgICAgPyBmb3JtYXRzW2NdKGRhdGVPYmosIGxvY2FsZSwgY29uZmlnKVxuICAgICAgICAgICAgICAgIDogYyAhPT0gXCJcXFxcXCJcbiAgICAgICAgICAgICAgICAgICAgPyBjXG4gICAgICAgICAgICAgICAgICAgIDogXCJcIjtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKFwiXCIpO1xuICAgIH07XG59O1xuZXhwb3J0IHZhciBjcmVhdGVEYXRlUGFyc2VyID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgdmFyIF9iID0gX2EuY29uZmlnLCBjb25maWcgPSBfYiA9PT0gdm9pZCAwID8gZGVmYXVsdHMgOiBfYiwgX2MgPSBfYS5sMTBuLCBsMTBuID0gX2MgPT09IHZvaWQgMCA/IGVuZ2xpc2ggOiBfYztcbiAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGUsIGdpdmVuRm9ybWF0LCB0aW1lbGVzcywgY3VzdG9tTG9jYWxlKSB7XG4gICAgICAgIGlmIChkYXRlICE9PSAwICYmICFkYXRlKVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGxvY2FsZSA9IGN1c3RvbUxvY2FsZSB8fCBsMTBuO1xuICAgICAgICB2YXIgcGFyc2VkRGF0ZTtcbiAgICAgICAgdmFyIGRhdGVPcmlnID0gZGF0ZTtcbiAgICAgICAgaWYgKGRhdGUgaW5zdGFuY2VvZiBEYXRlKVxuICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpKTtcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGRhdGUgIT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgIGRhdGUudG9GaXhlZCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgICAgICBlbHNlIGlmICh0eXBlb2YgZGF0ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGZvcm1hdCA9IGdpdmVuRm9ybWF0IHx8IChjb25maWcgfHwgZGVmYXVsdHMpLmRhdGVGb3JtYXQ7XG4gICAgICAgICAgICB2YXIgZGF0ZXN0ciA9IFN0cmluZyhkYXRlKS50cmltKCk7XG4gICAgICAgICAgICBpZiAoZGF0ZXN0ciA9PT0gXCJ0b2RheVwiKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdGltZWxlc3MgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29uZmlnICYmIGNvbmZpZy5wYXJzZURhdGUpIHtcbiAgICAgICAgICAgICAgICBwYXJzZWREYXRlID0gY29uZmlnLnBhcnNlRGF0ZShkYXRlLCBmb3JtYXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoL1okLy50ZXN0KGRhdGVzdHIpIHx8XG4gICAgICAgICAgICAgICAgL0dNVCQvLnRlc3QoZGF0ZXN0cikpIHtcbiAgICAgICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlZCA9IHZvaWQgMCwgb3BzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1hdGNoSW5kZXggPSAwLCByZWdleFN0ciA9IFwiXCI7IGkgPCBmb3JtYXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuID0gZm9ybWF0W2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNCYWNrU2xhc2ggPSB0b2tlbiA9PT0gXCJcXFxcXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlc2NhcGVkID0gZm9ybWF0W2kgLSAxXSA9PT0gXCJcXFxcXCIgfHwgaXNCYWNrU2xhc2g7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b2tlblJlZ2V4W3Rva2VuXSAmJiAhZXNjYXBlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXhTdHIgKz0gdG9rZW5SZWdleFt0b2tlbl07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBuZXcgUmVnRXhwKHJlZ2V4U3RyKS5leGVjKGRhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoICYmIChtYXRjaGVkID0gdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHNbdG9rZW4gIT09IFwiWVwiID8gXCJwdXNoXCIgOiBcInVuc2hpZnRcIl0oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbjogcmV2Rm9ybWF0W3Rva2VuXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsOiBtYXRjaFsrK21hdGNoSW5kZXhdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFpc0JhY2tTbGFzaClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4U3RyICs9IFwiLlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXJzZWREYXRlID1cbiAgICAgICAgICAgICAgICAgICAgIWNvbmZpZyB8fCAhY29uZmlnLm5vQ2FsZW5kYXJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gbmV3IERhdGUobmV3IERhdGUoKS5nZXRGdWxsWWVhcigpLCAwLCAxLCAwLCAwLCAwLCAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldEhvdXJzKDAsIDAsIDAsIDApKTtcbiAgICAgICAgICAgICAgICBvcHMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZuID0gX2EuZm4sIHZhbCA9IF9hLnZhbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChwYXJzZWREYXRlID0gZm4ocGFyc2VkRGF0ZSwgdmFsLCBsb2NhbGUpIHx8IHBhcnNlZERhdGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPSBtYXRjaGVkID8gcGFyc2VkRGF0ZSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIShwYXJzZWREYXRlIGluc3RhbmNlb2YgRGF0ZSAmJiAhaXNOYU4ocGFyc2VkRGF0ZS5nZXRUaW1lKCkpKSkge1xuICAgICAgICAgICAgY29uZmlnLmVycm9ySGFuZGxlcihuZXcgRXJyb3IoXCJJbnZhbGlkIGRhdGUgcHJvdmlkZWQ6IFwiICsgZGF0ZU9yaWcpKTtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRpbWVsZXNzID09PSB0cnVlKVxuICAgICAgICAgICAgcGFyc2VkRGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICAgICAgcmV0dXJuIHBhcnNlZERhdGU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZURhdGVzKGRhdGUxLCBkYXRlMiwgdGltZWxlc3MpIHtcbiAgICBpZiAodGltZWxlc3MgPT09IHZvaWQgMCkgeyB0aW1lbGVzcyA9IHRydWU7IH1cbiAgICBpZiAodGltZWxlc3MgIT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiAobmV3IERhdGUoZGF0ZTEuZ2V0VGltZSgpKS5zZXRIb3VycygwLCAwLCAwLCAwKSAtXG4gICAgICAgICAgICBuZXcgRGF0ZShkYXRlMi5nZXRUaW1lKCkpLnNldEhvdXJzKDAsIDAsIDAsIDApKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGUxLmdldFRpbWUoKSAtIGRhdGUyLmdldFRpbWUoKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlVGltZXMoZGF0ZTEsIGRhdGUyKSB7XG4gICAgcmV0dXJuICgzNjAwICogKGRhdGUxLmdldEhvdXJzKCkgLSBkYXRlMi5nZXRIb3VycygpKSArXG4gICAgICAgIDYwICogKGRhdGUxLmdldE1pbnV0ZXMoKSAtIGRhdGUyLmdldE1pbnV0ZXMoKSkgK1xuICAgICAgICBkYXRlMS5nZXRTZWNvbmRzKCkgLVxuICAgICAgICBkYXRlMi5nZXRTZWNvbmRzKCkpO1xufVxuZXhwb3J0IHZhciBpc0JldHdlZW4gPSBmdW5jdGlvbiAodHMsIHRzMSwgdHMyKSB7XG4gICAgcmV0dXJuIHRzID4gTWF0aC5taW4odHMxLCB0czIpICYmIHRzIDwgTWF0aC5tYXgodHMxLCB0czIpO1xufTtcbmV4cG9ydCB2YXIgY2FsY3VsYXRlU2Vjb25kc1NpbmNlTWlkbmlnaHQgPSBmdW5jdGlvbiAoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpIHtcbiAgICByZXR1cm4gaG91cnMgKiAzNjAwICsgbWludXRlcyAqIDYwICsgc2Vjb25kcztcbn07XG5leHBvcnQgdmFyIHBhcnNlU2Vjb25kcyA9IGZ1bmN0aW9uIChzZWNvbmRzU2luY2VNaWRuaWdodCkge1xuICAgIHZhciBob3VycyA9IE1hdGguZmxvb3Ioc2Vjb25kc1NpbmNlTWlkbmlnaHQgLyAzNjAwKSwgbWludXRlcyA9IChzZWNvbmRzU2luY2VNaWRuaWdodCAtIGhvdXJzICogMzYwMCkgLyA2MDtcbiAgICByZXR1cm4gW2hvdXJzLCBtaW51dGVzLCBzZWNvbmRzU2luY2VNaWRuaWdodCAtIGhvdXJzICogMzYwMCAtIG1pbnV0ZXMgKiA2MF07XG59O1xuZXhwb3J0IHZhciBkdXJhdGlvbiA9IHtcbiAgICBEQVk6IDg2NDAwMDAwLFxufTtcbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0SG91cnMoY29uZmlnKSB7XG4gICAgdmFyIGhvdXJzID0gY29uZmlnLmRlZmF1bHRIb3VyO1xuICAgIHZhciBtaW51dGVzID0gY29uZmlnLmRlZmF1bHRNaW51dGU7XG4gICAgdmFyIHNlY29uZHMgPSBjb25maWcuZGVmYXVsdFNlY29uZHM7XG4gICAgaWYgKGNvbmZpZy5taW5EYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIG1pbkhvdXIgPSBjb25maWcubWluRGF0ZS5nZXRIb3VycygpO1xuICAgICAgICB2YXIgbWluTWludXRlcyA9IGNvbmZpZy5taW5EYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgdmFyIG1pblNlY29uZHMgPSBjb25maWcubWluRGF0ZS5nZXRTZWNvbmRzKCk7XG4gICAgICAgIGlmIChob3VycyA8IG1pbkhvdXIpIHtcbiAgICAgICAgICAgIGhvdXJzID0gbWluSG91cjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaG91cnMgPT09IG1pbkhvdXIgJiYgbWludXRlcyA8IG1pbk1pbnV0ZXMpIHtcbiAgICAgICAgICAgIG1pbnV0ZXMgPSBtaW5NaW51dGVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChob3VycyA9PT0gbWluSG91ciAmJiBtaW51dGVzID09PSBtaW5NaW51dGVzICYmIHNlY29uZHMgPCBtaW5TZWNvbmRzKVxuICAgICAgICAgICAgc2Vjb25kcyA9IGNvbmZpZy5taW5EYXRlLmdldFNlY29uZHMoKTtcbiAgICB9XG4gICAgaWYgKGNvbmZpZy5tYXhEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIG1heEhyID0gY29uZmlnLm1heERhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgdmFyIG1heE1pbnV0ZXMgPSBjb25maWcubWF4RGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgIGhvdXJzID0gTWF0aC5taW4oaG91cnMsIG1heEhyKTtcbiAgICAgICAgaWYgKGhvdXJzID09PSBtYXhIcilcbiAgICAgICAgICAgIG1pbnV0ZXMgPSBNYXRoLm1pbihtYXhNaW51dGVzLCBtaW51dGVzKTtcbiAgICAgICAgaWYgKGhvdXJzID09PSBtYXhIciAmJiBtaW51dGVzID09PSBtYXhNaW51dGVzKVxuICAgICAgICAgICAgc2Vjb25kcyA9IGNvbmZpZy5tYXhEYXRlLmdldFNlY29uZHMoKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgaG91cnM6IGhvdXJzLCBtaW51dGVzOiBtaW51dGVzLCBzZWNvbmRzOiBzZWNvbmRzIH07XG59XG4iLCAiXCJ1c2Ugc3RyaWN0XCI7XG5pZiAodHlwZW9mIE9iamVjdC5hc3NpZ24gIT09IFwiZnVuY3Rpb25cIikge1xuICAgIE9iamVjdC5hc3NpZ24gPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoXCJDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuICh0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldKTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAodmFyIF9hID0gMCwgYXJnc18xID0gYXJnczsgX2EgPCBhcmdzXzEubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJnc18xW19hXTtcbiAgICAgICAgICAgIF9sb29wXzEoc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG59XG4iLCAidmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciBfX3NwcmVhZEFycmF5cyA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheXMpIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxuICAgICAgICAgICAgcltrXSA9IGFbal07XG4gICAgcmV0dXJuIHI7XG59O1xuaW1wb3J0IHsgZGVmYXVsdHMgYXMgZGVmYXVsdE9wdGlvbnMsIEhPT0tTLCB9IGZyb20gXCIuL3R5cGVzL29wdGlvbnNcIjtcbmltcG9ydCBFbmdsaXNoIGZyb20gXCIuL2wxMG4vZGVmYXVsdFwiO1xuaW1wb3J0IHsgYXJyYXlpZnksIGRlYm91bmNlLCBpbnQsIHBhZCB9IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQgeyBjbGVhck5vZGUsIGNyZWF0ZUVsZW1lbnQsIGNyZWF0ZU51bWJlcklucHV0LCBmaW5kUGFyZW50LCB0b2dnbGVDbGFzcywgZ2V0RXZlbnRUYXJnZXQsIH0gZnJvbSBcIi4vdXRpbHMvZG9tXCI7XG5pbXBvcnQgeyBjb21wYXJlRGF0ZXMsIGNyZWF0ZURhdGVQYXJzZXIsIGNyZWF0ZURhdGVGb3JtYXR0ZXIsIGR1cmF0aW9uLCBpc0JldHdlZW4sIGdldERlZmF1bHRIb3VycywgY2FsY3VsYXRlU2Vjb25kc1NpbmNlTWlkbmlnaHQsIHBhcnNlU2Vjb25kcywgfSBmcm9tIFwiLi91dGlscy9kYXRlc1wiO1xuaW1wb3J0IHsgdG9rZW5SZWdleCwgbW9udGhUb1N0ciB9IGZyb20gXCIuL3V0aWxzL2Zvcm1hdHRpbmdcIjtcbmltcG9ydCBcIi4vdXRpbHMvcG9seWZpbGxzXCI7XG52YXIgREVCT1VOQ0VEX0NIQU5HRV9NUyA9IDMwMDtcbmZ1bmN0aW9uIEZsYXRwaWNrckluc3RhbmNlKGVsZW1lbnQsIGluc3RhbmNlQ29uZmlnKSB7XG4gICAgdmFyIHNlbGYgPSB7XG4gICAgICAgIGNvbmZpZzogX19hc3NpZ24oX19hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zKSwgZmxhdHBpY2tyLmRlZmF1bHRDb25maWcpLFxuICAgICAgICBsMTBuOiBFbmdsaXNoLFxuICAgIH07XG4gICAgc2VsZi5wYXJzZURhdGUgPSBjcmVhdGVEYXRlUGFyc2VyKHsgY29uZmlnOiBzZWxmLmNvbmZpZywgbDEwbjogc2VsZi5sMTBuIH0pO1xuICAgIHNlbGYuX2hhbmRsZXJzID0gW107XG4gICAgc2VsZi5wbHVnaW5FbGVtZW50cyA9IFtdO1xuICAgIHNlbGYubG9hZGVkUGx1Z2lucyA9IFtdO1xuICAgIHNlbGYuX2JpbmQgPSBiaW5kO1xuICAgIHNlbGYuX3NldEhvdXJzRnJvbURhdGUgPSBzZXRIb3Vyc0Zyb21EYXRlO1xuICAgIHNlbGYuX3Bvc2l0aW9uQ2FsZW5kYXIgPSBwb3NpdGlvbkNhbGVuZGFyO1xuICAgIHNlbGYuY2hhbmdlTW9udGggPSBjaGFuZ2VNb250aDtcbiAgICBzZWxmLmNoYW5nZVllYXIgPSBjaGFuZ2VZZWFyO1xuICAgIHNlbGYuY2xlYXIgPSBjbGVhcjtcbiAgICBzZWxmLmNsb3NlID0gY2xvc2U7XG4gICAgc2VsZi5vbk1vdXNlT3ZlciA9IG9uTW91c2VPdmVyO1xuICAgIHNlbGYuX2NyZWF0ZUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50O1xuICAgIHNlbGYuY3JlYXRlRGF5ID0gY3JlYXRlRGF5O1xuICAgIHNlbGYuZGVzdHJveSA9IGRlc3Ryb3k7XG4gICAgc2VsZi5pc0VuYWJsZWQgPSBpc0VuYWJsZWQ7XG4gICAgc2VsZi5qdW1wVG9EYXRlID0ganVtcFRvRGF0ZTtcbiAgICBzZWxmLnVwZGF0ZVZhbHVlID0gdXBkYXRlVmFsdWU7XG4gICAgc2VsZi5vcGVuID0gb3BlbjtcbiAgICBzZWxmLnJlZHJhdyA9IHJlZHJhdztcbiAgICBzZWxmLnNldCA9IHNldDtcbiAgICBzZWxmLnNldERhdGUgPSBzZXREYXRlO1xuICAgIHNlbGYudG9nZ2xlID0gdG9nZ2xlO1xuICAgIGZ1bmN0aW9uIHNldHVwSGVscGVyRnVuY3Rpb25zKCkge1xuICAgICAgICBzZWxmLnV0aWxzID0ge1xuICAgICAgICAgICAgZ2V0RGF5c0luTW9udGg6IGZ1bmN0aW9uIChtb250aCwgeXIpIHtcbiAgICAgICAgICAgICAgICBpZiAobW9udGggPT09IHZvaWQgMCkgeyBtb250aCA9IHNlbGYuY3VycmVudE1vbnRoOyB9XG4gICAgICAgICAgICAgICAgaWYgKHlyID09PSB2b2lkIDApIHsgeXIgPSBzZWxmLmN1cnJlbnRZZWFyOyB9XG4gICAgICAgICAgICAgICAgaWYgKG1vbnRoID09PSAxICYmICgoeXIgJSA0ID09PSAwICYmIHlyICUgMTAwICE9PSAwKSB8fCB5ciAlIDQwMCA9PT0gMCkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAyOTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5sMTBuLmRheXNJbk1vbnRoW21vbnRoXTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIHNlbGYuZWxlbWVudCA9IHNlbGYuaW5wdXQgPSBlbGVtZW50O1xuICAgICAgICBzZWxmLmlzT3BlbiA9IGZhbHNlO1xuICAgICAgICBwYXJzZUNvbmZpZygpO1xuICAgICAgICBzZXR1cExvY2FsZSgpO1xuICAgICAgICBzZXR1cElucHV0cygpO1xuICAgICAgICBzZXR1cERhdGVzKCk7XG4gICAgICAgIHNldHVwSGVscGVyRnVuY3Rpb25zKCk7XG4gICAgICAgIGlmICghc2VsZi5pc01vYmlsZSlcbiAgICAgICAgICAgIGJ1aWxkKCk7XG4gICAgICAgIGJpbmRFdmVudHMoKTtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggfHwgc2VsZi5jb25maWcubm9DYWxlbmRhcikge1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLmVuYWJsZVRpbWUpIHtcbiAgICAgICAgICAgICAgICBzZXRIb3Vyc0Zyb21EYXRlKHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgPyBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA6IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1cGRhdGVWYWx1ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0Q2FsZW5kYXJXaWR0aCgpO1xuICAgICAgICB2YXIgaXNTYWZhcmkgPSAvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgICAgICBpZiAoIXNlbGYuaXNNb2JpbGUgJiYgaXNTYWZhcmkpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uQ2FsZW5kYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblJlYWR5XCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRDbG9zZXN0QWN0aXZlRWxlbWVudCgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gKCgoX2EgPSBzZWxmLmNhbGVuZGFyQ29udGFpbmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0Um9vdE5vZGUoKSlcbiAgICAgICAgICAgIC5hY3RpdmVFbGVtZW50IHx8IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBiaW5kVG9JbnN0YW5jZShmbikge1xuICAgICAgICByZXR1cm4gZm4uYmluZChzZWxmKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0Q2FsZW5kYXJXaWR0aCgpIHtcbiAgICAgICAgdmFyIGNvbmZpZyA9IHNlbGYuY29uZmlnO1xuICAgICAgICBpZiAoY29uZmlnLndlZWtOdW1iZXJzID09PSBmYWxzZSAmJiBjb25maWcuc2hvd01vbnRocyA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbmZpZy5ub0NhbGVuZGFyICE9PSB0cnVlKSB7XG4gICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jYWxlbmRhckNvbnRhaW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXlzV2lkdGggPSAoc2VsZi5kYXlzLm9mZnNldFdpZHRoICsgMSkgKiBjb25maWcuc2hvd01vbnRocztcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyLnN0eWxlLndpZHRoID0gZGF5c1dpZHRoICsgXCJweFwiO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLndpZHRoID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRheXNXaWR0aCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHNlbGYud2Vla1dyYXBwZXIgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNlbGYud2Vla1dyYXBwZXIub2Zmc2V0V2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJweFwiO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnJlbW92ZVByb3BlcnR5KFwidmlzaWJpbGl0eVwiKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5yZW1vdmVQcm9wZXJ0eShcImRpc3BsYXlcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlVGltZShlKSB7XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdERhdGUgPSBzZWxmLmNvbmZpZy5taW5EYXRlID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMobmV3IERhdGUoKSwgc2VsZi5jb25maWcubWluRGF0ZSkgPj0gMFxuICAgICAgICAgICAgICAgID8gbmV3IERhdGUoKVxuICAgICAgICAgICAgICAgIDogbmV3IERhdGUoc2VsZi5jb25maWcubWluRGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRzID0gZ2V0RGVmYXVsdEhvdXJzKHNlbGYuY29uZmlnKTtcbiAgICAgICAgICAgIGRlZmF1bHREYXRlLnNldEhvdXJzKGRlZmF1bHRzLmhvdXJzLCBkZWZhdWx0cy5taW51dGVzLCBkZWZhdWx0cy5zZWNvbmRzLCBkZWZhdWx0RGF0ZS5nZXRNaWxsaXNlY29uZHMoKSk7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSBbZGVmYXVsdERhdGVdO1xuICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBkZWZhdWx0RGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSAhPT0gdW5kZWZpbmVkICYmIGUudHlwZSAhPT0gXCJibHVyXCIpIHtcbiAgICAgICAgICAgIHRpbWVXcmFwcGVyKGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmV2VmFsdWUgPSBzZWxmLl9pbnB1dC52YWx1ZTtcbiAgICAgICAgc2V0SG91cnNGcm9tSW5wdXRzKCk7XG4gICAgICAgIHVwZGF0ZVZhbHVlKCk7XG4gICAgICAgIGlmIChzZWxmLl9pbnB1dC52YWx1ZSAhPT0gcHJldlZhbHVlKSB7XG4gICAgICAgICAgICBzZWxmLl9kZWJvdW5jZWRDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBhbXBtMm1pbGl0YXJ5KGhvdXIsIGFtUE0pIHtcbiAgICAgICAgcmV0dXJuIChob3VyICUgMTIpICsgMTIgKiBpbnQoYW1QTSA9PT0gc2VsZi5sMTBuLmFtUE1bMV0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBtaWxpdGFyeTJhbXBtKGhvdXIpIHtcbiAgICAgICAgc3dpdGNoIChob3VyICUgMjQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDEyO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91ciAlIDEyO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldEhvdXJzRnJvbUlucHV0cygpIHtcbiAgICAgICAgaWYgKHNlbGYuaG91ckVsZW1lbnQgPT09IHVuZGVmaW5lZCB8fCBzZWxmLm1pbnV0ZUVsZW1lbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGhvdXJzID0gKHBhcnNlSW50KHNlbGYuaG91ckVsZW1lbnQudmFsdWUuc2xpY2UoLTIpLCAxMCkgfHwgMCkgJSAyNCwgbWludXRlcyA9IChwYXJzZUludChzZWxmLm1pbnV0ZUVsZW1lbnQudmFsdWUsIDEwKSB8fCAwKSAlIDYwLCBzZWNvbmRzID0gc2VsZi5zZWNvbmRFbGVtZW50ICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgID8gKHBhcnNlSW50KHNlbGYuc2Vjb25kRWxlbWVudC52YWx1ZSwgMTApIHx8IDApICUgNjBcbiAgICAgICAgICAgIDogMDtcbiAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBob3VycyA9IGFtcG0ybWlsaXRhcnkoaG91cnMsIHNlbGYuYW1QTS50ZXh0Q29udGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpbWl0TWluSG91cnMgPSBzZWxmLmNvbmZpZy5taW5UaW1lICE9PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICAgICAgc2VsZi5taW5EYXRlSGFzVGltZSAmJlxuICAgICAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqICYmXG4gICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLCBzZWxmLmNvbmZpZy5taW5EYXRlLCB0cnVlKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgMCk7XG4gICAgICAgIHZhciBsaW1pdE1heEhvdXJzID0gc2VsZi5jb25maWcubWF4VGltZSAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcubWF4RGF0ZSAmJlxuICAgICAgICAgICAgICAgIHNlbGYubWF4RGF0ZUhhc1RpbWUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiwgc2VsZi5jb25maWcubWF4RGF0ZSwgdHJ1ZSkgPT09XG4gICAgICAgICAgICAgICAgICAgIDApO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubWF4VGltZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5UaW1lICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pblRpbWUgPiBzZWxmLmNvbmZpZy5tYXhUaW1lKSB7XG4gICAgICAgICAgICB2YXIgbWluQm91bmQgPSBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodChzZWxmLmNvbmZpZy5taW5UaW1lLmdldEhvdXJzKCksIHNlbGYuY29uZmlnLm1pblRpbWUuZ2V0TWludXRlcygpLCBzZWxmLmNvbmZpZy5taW5UaW1lLmdldFNlY29uZHMoKSk7XG4gICAgICAgICAgICB2YXIgbWF4Qm91bmQgPSBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodChzZWxmLmNvbmZpZy5tYXhUaW1lLmdldEhvdXJzKCksIHNlbGYuY29uZmlnLm1heFRpbWUuZ2V0TWludXRlcygpLCBzZWxmLmNvbmZpZy5tYXhUaW1lLmdldFNlY29uZHMoKSk7XG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodChob3VycywgbWludXRlcywgc2Vjb25kcyk7XG4gICAgICAgICAgICBpZiAoY3VycmVudFRpbWUgPiBtYXhCb3VuZCAmJiBjdXJyZW50VGltZSA8IG1pbkJvdW5kKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHBhcnNlU2Vjb25kcyhtaW5Cb3VuZCk7XG4gICAgICAgICAgICAgICAgaG91cnMgPSByZXN1bHRbMF07XG4gICAgICAgICAgICAgICAgbWludXRlcyA9IHJlc3VsdFsxXTtcbiAgICAgICAgICAgICAgICBzZWNvbmRzID0gcmVzdWx0WzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGxpbWl0TWF4SG91cnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4VGltZSA9IHNlbGYuY29uZmlnLm1heFRpbWUgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLm1heFRpbWVcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5tYXhEYXRlO1xuICAgICAgICAgICAgICAgIGhvdXJzID0gTWF0aC5taW4oaG91cnMsIG1heFRpbWUuZ2V0SG91cnMoKSk7XG4gICAgICAgICAgICAgICAgaWYgKGhvdXJzID09PSBtYXhUaW1lLmdldEhvdXJzKCkpXG4gICAgICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBNYXRoLm1pbihtaW51dGVzLCBtYXhUaW1lLmdldE1pbnV0ZXMoKSk7XG4gICAgICAgICAgICAgICAgaWYgKG1pbnV0ZXMgPT09IG1heFRpbWUuZ2V0TWludXRlcygpKVxuICAgICAgICAgICAgICAgICAgICBzZWNvbmRzID0gTWF0aC5taW4oc2Vjb25kcywgbWF4VGltZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxpbWl0TWluSG91cnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWluVGltZSA9IHNlbGYuY29uZmlnLm1pblRpbWUgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLm1pblRpbWVcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5taW5EYXRlO1xuICAgICAgICAgICAgICAgIGhvdXJzID0gTWF0aC5tYXgoaG91cnMsIG1pblRpbWUuZ2V0SG91cnMoKSk7XG4gICAgICAgICAgICAgICAgaWYgKGhvdXJzID09PSBtaW5UaW1lLmdldEhvdXJzKCkgJiYgbWludXRlcyA8IG1pblRpbWUuZ2V0TWludXRlcygpKVxuICAgICAgICAgICAgICAgICAgICBtaW51dGVzID0gbWluVGltZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICAgICAgaWYgKG1pbnV0ZXMgPT09IG1pblRpbWUuZ2V0TWludXRlcygpKVxuICAgICAgICAgICAgICAgICAgICBzZWNvbmRzID0gTWF0aC5tYXgoc2Vjb25kcywgbWluVGltZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldEhvdXJzKGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0SG91cnNGcm9tRGF0ZShkYXRlT2JqKSB7XG4gICAgICAgIHZhciBkYXRlID0gZGF0ZU9iaiB8fCBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iajtcbiAgICAgICAgaWYgKGRhdGUgJiYgZGF0ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIHNldEhvdXJzKGRhdGUuZ2V0SG91cnMoKSwgZGF0ZS5nZXRNaW51dGVzKCksIGRhdGUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRIb3Vycyhob3VycywgbWludXRlcywgc2Vjb25kcykge1xuICAgICAgICBpZiAoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmouc2V0SG91cnMoaG91cnMgJSAyNCwgbWludXRlcywgc2Vjb25kcyB8fCAwLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuaG91ckVsZW1lbnQgfHwgIXNlbGYubWludXRlRWxlbWVudCB8fCBzZWxmLmlzTW9iaWxlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnZhbHVlID0gcGFkKCFzZWxmLmNvbmZpZy50aW1lXzI0aHJcbiAgICAgICAgICAgID8gKCgxMiArIGhvdXJzKSAlIDEyKSArIDEyICogaW50KGhvdXJzICUgMTIgPT09IDApXG4gICAgICAgICAgICA6IGhvdXJzKTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LnZhbHVlID0gcGFkKG1pbnV0ZXMpO1xuICAgICAgICBpZiAoc2VsZi5hbVBNICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmFtUE0udGV4dENvbnRlbnQgPSBzZWxmLmwxMG4uYW1QTVtpbnQoaG91cnMgPj0gMTIpXTtcbiAgICAgICAgaWYgKHNlbGYuc2Vjb25kRWxlbWVudCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnZhbHVlID0gcGFkKHNlY29uZHMpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvblllYXJJbnB1dChldmVudCkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChldmVudCk7XG4gICAgICAgIHZhciB5ZWFyID0gcGFyc2VJbnQoZXZlbnRUYXJnZXQudmFsdWUpICsgKGV2ZW50LmRlbHRhIHx8IDApO1xuICAgICAgICBpZiAoeWVhciAvIDEwMDAgPiAxIHx8XG4gICAgICAgICAgICAoZXZlbnQua2V5ID09PSBcIkVudGVyXCIgJiYgIS9bXlxcZF0vLnRlc3QoeWVhci50b1N0cmluZygpKSkpIHtcbiAgICAgICAgICAgIGNoYW5nZVllYXIoeWVhcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYmluZChlbGVtZW50LCBldmVudCwgaGFuZGxlciwgb3B0aW9ucykge1xuICAgICAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAgICAgIHJldHVybiBldmVudC5mb3JFYWNoKGZ1bmN0aW9uIChldikgeyByZXR1cm4gYmluZChlbGVtZW50LCBldiwgaGFuZGxlciwgb3B0aW9ucyk7IH0pO1xuICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEFycmF5KVxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsgcmV0dXJuIGJpbmQoZWwsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTsgfSk7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgICAgIHNlbGYuX2hhbmRsZXJzLnB1c2goe1xuICAgICAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7IHJldHVybiBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpOyB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdHJpZ2dlckNoYW5nZSgpIHtcbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DaGFuZ2VcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJpbmRFdmVudHMoKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy53cmFwKSB7XG4gICAgICAgICAgICBbXCJvcGVuXCIsIFwiY2xvc2VcIiwgXCJ0b2dnbGVcIiwgXCJjbGVhclwiXS5mb3JFYWNoKGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGYuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtXCIgKyBldnQgKyBcIl1cIiksIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmluZChlbCwgXCJjbGlja1wiLCBzZWxmW2V2dF0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHNldHVwTW9iaWxlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlYm91bmNlZFJlc2l6ZSA9IGRlYm91bmNlKG9uUmVzaXplLCA1MCk7XG4gICAgICAgIHNlbGYuX2RlYm91bmNlZENoYW5nZSA9IGRlYm91bmNlKHRyaWdnZXJDaGFuZ2UsIERFQk9VTkNFRF9DSEFOR0VfTVMpO1xuICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICYmICEvaVBob25lfGlQYWR8aVBvZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpXG4gICAgICAgICAgICBiaW5kKHNlbGYuZGF5c0NvbnRhaW5lciwgXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKVxuICAgICAgICAgICAgICAgICAgICBvbk1vdXNlT3ZlcihnZXRFdmVudFRhcmdldChlKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJrZXlkb3duXCIsIG9uS2V5RG93bik7XG4gICAgICAgIGlmIChzZWxmLmNhbGVuZGFyQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJrZXlkb3duXCIsIG9uS2V5RG93bik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5pbmxpbmUgJiYgIXNlbGYuY29uZmlnLnN0YXRpYylcbiAgICAgICAgICAgIGJpbmQod2luZG93LCBcInJlc2l6ZVwiLCBkZWJvdW5jZWRSZXNpemUpO1xuICAgICAgICBpZiAod2luZG93Lm9udG91Y2hzdGFydCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgYmluZCh3aW5kb3cuZG9jdW1lbnQsIFwidG91Y2hzdGFydFwiLCBkb2N1bWVudENsaWNrKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgYmluZCh3aW5kb3cuZG9jdW1lbnQsIFwibW91c2Vkb3duXCIsIGRvY3VtZW50Q2xpY2spO1xuICAgICAgICBiaW5kKHdpbmRvdy5kb2N1bWVudCwgXCJmb2N1c1wiLCBkb2N1bWVudENsaWNrLCB7IGNhcHR1cmU6IHRydWUgfSk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5jbGlja09wZW5zID09PSB0cnVlKSB7XG4gICAgICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImZvY3VzXCIsIHNlbGYub3Blbik7XG4gICAgICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImNsaWNrXCIsIHNlbGYub3Blbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBiaW5kKHNlbGYubW9udGhOYXYsIFwiY2xpY2tcIiwgb25Nb250aE5hdkNsaWNrKTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5tb250aE5hdiwgW1wia2V5dXBcIiwgXCJpbmNyZW1lbnRcIl0sIG9uWWVhcklucHV0KTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5kYXlzQ29udGFpbmVyLCBcImNsaWNrXCIsIHNlbGVjdERhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLnRpbWVDb250YWluZXIgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5taW51dGVFbGVtZW50ICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHNlbFRleHQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRFdmVudFRhcmdldChlKS5zZWxlY3QoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBiaW5kKHNlbGYudGltZUNvbnRhaW5lciwgW1wiaW5jcmVtZW50XCJdLCB1cGRhdGVUaW1lKTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi50aW1lQ29udGFpbmVyLCBcImJsdXJcIiwgdXBkYXRlVGltZSwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgICAgICAgICAgYmluZChzZWxmLnRpbWVDb250YWluZXIsIFwiY2xpY2tcIiwgdGltZUluY3JlbWVudCk7XG4gICAgICAgICAgICBiaW5kKFtzZWxmLmhvdXJFbGVtZW50LCBzZWxmLm1pbnV0ZUVsZW1lbnRdLCBbXCJmb2N1c1wiLCBcImNsaWNrXCJdLCBzZWxUZXh0KTtcbiAgICAgICAgICAgIGlmIChzZWxmLnNlY29uZEVsZW1lbnQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBiaW5kKHNlbGYuc2Vjb25kRWxlbWVudCwgXCJmb2N1c1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLnNlY29uZEVsZW1lbnQgJiYgc2VsZi5zZWNvbmRFbGVtZW50LnNlbGVjdCgpOyB9KTtcbiAgICAgICAgICAgIGlmIChzZWxmLmFtUE0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGJpbmQoc2VsZi5hbVBNLCBcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWUoZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmFsbG93SW5wdXQpIHtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiYmx1clwiLCBvbkJsdXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGp1bXBUb0RhdGUoanVtcERhdGUsIHRyaWdnZXJDaGFuZ2UpIHtcbiAgICAgICAgdmFyIGp1bXBUbyA9IGp1bXBEYXRlICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgID8gc2VsZi5wYXJzZURhdGUoanVtcERhdGUpXG4gICAgICAgICAgICA6IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqIHx8XG4gICAgICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1pbkRhdGUgJiYgc2VsZi5jb25maWcubWluRGF0ZSA+IHNlbGYubm93XG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWluRGF0ZVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1heERhdGUgJiYgc2VsZi5jb25maWcubWF4RGF0ZSA8IHNlbGYubm93XG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLm1heERhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIDogc2VsZi5ub3cpO1xuICAgICAgICB2YXIgb2xkWWVhciA9IHNlbGYuY3VycmVudFllYXI7XG4gICAgICAgIHZhciBvbGRNb250aCA9IHNlbGYuY3VycmVudE1vbnRoO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGp1bXBUbyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IGp1bXBUby5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0ganVtcFRvLmdldE1vbnRoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGUubWVzc2FnZSA9IFwiSW52YWxpZCBkYXRlIHN1cHBsaWVkOiBcIiArIGp1bXBUbztcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVycm9ySGFuZGxlcihlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSAmJiBzZWxmLmN1cnJlbnRZZWFyICE9PSBvbGRZZWFyKSB7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblllYXJDaGFuZ2VcIik7XG4gICAgICAgICAgICBidWlsZE1vbnRoU3dpdGNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UgJiZcbiAgICAgICAgICAgIChzZWxmLmN1cnJlbnRZZWFyICE9PSBvbGRZZWFyIHx8IHNlbGYuY3VycmVudE1vbnRoICE9PSBvbGRNb250aCkpIHtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uTW9udGhDaGFuZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdGltZUluY3JlbWVudChlKSB7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICBpZiAofmV2ZW50VGFyZ2V0LmNsYXNzTmFtZS5pbmRleE9mKFwiYXJyb3dcIikpXG4gICAgICAgICAgICBpbmNyZW1lbnROdW1JbnB1dChlLCBldmVudFRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJhcnJvd1VwXCIpID8gMSA6IC0xKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5jcmVtZW50TnVtSW5wdXQoZSwgZGVsdGEsIGlucHV0RWxlbSkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZSAmJiBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgdmFyIGlucHV0ID0gaW5wdXRFbGVtIHx8XG4gICAgICAgICAgICAodGFyZ2V0ICYmIHRhcmdldC5wYXJlbnROb2RlICYmIHRhcmdldC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQpO1xuICAgICAgICB2YXIgZXZlbnQgPSBjcmVhdGVFdmVudChcImluY3JlbWVudFwiKTtcbiAgICAgICAgZXZlbnQuZGVsdGEgPSBkZWx0YTtcbiAgICAgICAgaW5wdXQgJiYgaW5wdXQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkKCkge1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1jYWxlbmRhclwiKTtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci50YWJJbmRleCA9IC0xO1xuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLm5vQ2FsZW5kYXIpIHtcbiAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGJ1aWxkTW9udGhOYXYoKSk7XG4gICAgICAgICAgICBzZWxmLmlubmVyQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1pbm5lckNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy53ZWVrTnVtYmVycykge1xuICAgICAgICAgICAgICAgIHZhciBfYSA9IGJ1aWxkV2Vla3MoKSwgd2Vla1dyYXBwZXIgPSBfYS53ZWVrV3JhcHBlciwgd2Vla051bWJlcnMgPSBfYS53ZWVrTnVtYmVycztcbiAgICAgICAgICAgICAgICBzZWxmLmlubmVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHdlZWtXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICBzZWxmLndlZWtOdW1iZXJzID0gd2Vla051bWJlcnM7XG4gICAgICAgICAgICAgICAgc2VsZi53ZWVrV3JhcHBlciA9IHdlZWtXcmFwcGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5yQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1yQ29udGFpbmVyXCIpO1xuICAgICAgICAgICAgc2VsZi5yQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1aWxkV2Vla2RheXMoKSk7XG4gICAgICAgICAgICBpZiAoIXNlbGYuZGF5c0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItZGF5c1wiKTtcbiAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJ1aWxkRGF5cygpO1xuICAgICAgICAgICAgc2VsZi5yQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGYuZGF5c0NvbnRhaW5lcik7XG4gICAgICAgICAgICBzZWxmLmlubmVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGYuckNvbnRhaW5lcik7XG4gICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChzZWxmLmlubmVyQ29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSkge1xuICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoYnVpbGRUaW1lKCkpO1xuICAgICAgICB9XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwicmFuZ2VNb2RlXCIsIHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIik7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYW5pbWF0ZVwiLCBzZWxmLmNvbmZpZy5hbmltYXRlID09PSB0cnVlKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJtdWx0aU1vbnRoXCIsIHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxKTtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICAgIHZhciBjdXN0b21BcHBlbmQgPSBzZWxmLmNvbmZpZy5hcHBlbmRUbyAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5hcHBlbmRUby5ub2RlVHlwZSAhPT0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuaW5saW5lIHx8IHNlbGYuY29uZmlnLnN0YXRpYykge1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKHNlbGYuY29uZmlnLmlubGluZSA/IFwiaW5saW5lXCIgOiBcInN0YXRpY1wiKTtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5pbmxpbmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWN1c3RvbUFwcGVuZCAmJiBzZWxmLmVsZW1lbnQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5lbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIHNlbGYuX2lucHV0Lm5leHRTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5hcHBlbmRUbyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5hcHBlbmRUby5hcHBlbmRDaGlsZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5zdGF0aWMpIHtcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd3JhcHBlclwiKTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5lbGVtZW50LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLCBzZWxmLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoc2VsZi5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dClcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChzZWxmLmFsdElucHV0KTtcbiAgICAgICAgICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHNlbGYuY2FsZW5kYXJDb250YWluZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZi5jb25maWcuc3RhdGljICYmICFzZWxmLmNvbmZpZy5pbmxpbmUpXG4gICAgICAgICAgICAoc2VsZi5jb25maWcuYXBwZW5kVG8gIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcuYXBwZW5kVG9cbiAgICAgICAgICAgICAgICA6IHdpbmRvdy5kb2N1bWVudC5ib2R5KS5hcHBlbmRDaGlsZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY3JlYXRlRGF5KGNsYXNzTmFtZSwgZGF0ZSwgX2RheU51bWJlciwgaSkge1xuICAgICAgICB2YXIgZGF0ZUlzRW5hYmxlZCA9IGlzRW5hYmxlZChkYXRlLCB0cnVlKSwgZGF5RWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIGNsYXNzTmFtZSwgZGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKSk7XG4gICAgICAgIGRheUVsZW1lbnQuZGF0ZU9iaiA9IGRhdGU7XG4gICAgICAgIGRheUVsZW1lbnQuJGkgPSBpO1xuICAgICAgICBkYXlFbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgc2VsZi5mb3JtYXREYXRlKGRhdGUsIHNlbGYuY29uZmlnLmFyaWFEYXRlRm9ybWF0KSk7XG4gICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZihcImhpZGRlblwiKSA9PT0gLTEgJiZcbiAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlLCBzZWxmLm5vdykgPT09IDApIHtcbiAgICAgICAgICAgIHNlbGYudG9kYXlEYXRlRWxlbSA9IGRheUVsZW1lbnQ7XG4gICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0b2RheVwiKTtcbiAgICAgICAgICAgIGRheUVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1jdXJyZW50XCIsIFwiZGF0ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0ZUlzRW5hYmxlZCkge1xuICAgICAgICAgICAgZGF5RWxlbWVudC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgaWYgKGlzRGF0ZVNlbGVjdGVkKGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgZGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVFbGVtID0gZGF5RWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZUNsYXNzKGRheUVsZW1lbnQsIFwic3RhcnRSYW5nZVwiLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0sIHRydWUpID09PSAwKTtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoZGF5RWxlbWVudCwgXCJlbmRSYW5nZVwiLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMV0gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMV0sIHRydWUpID09PSAwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSA9PT0gXCJuZXh0TW9udGhEYXlcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImluUmFuZ2VcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZmxhdHBpY2tyLWRpc2FibGVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpIHtcbiAgICAgICAgICAgIGlmIChpc0RhdGVJblJhbmdlKGRhdGUpICYmICFpc0RhdGVTZWxlY3RlZChkYXRlKSlcbiAgICAgICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJpblJhbmdlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLndlZWtOdW1iZXJzICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5zaG93TW9udGhzID09PSAxICYmXG4gICAgICAgICAgICBjbGFzc05hbWUgIT09IFwicHJldk1vbnRoRGF5XCIgJiZcbiAgICAgICAgICAgIGkgJSA3ID09PSA2KSB7XG4gICAgICAgICAgICBzZWxmLndlZWtOdW1iZXJzLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBcIjxzcGFuIGNsYXNzPSdmbGF0cGlja3ItZGF5Jz5cIiArIHNlbGYuY29uZmlnLmdldFdlZWsoZGF0ZSkgKyBcIjwvc3Bhbj5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25EYXlDcmVhdGVcIiwgZGF5RWxlbWVudCk7XG4gICAgICAgIHJldHVybiBkYXlFbGVtZW50O1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb2N1c09uRGF5RWxlbSh0YXJnZXROb2RlKSB7XG4gICAgICAgIHRhcmdldE5vZGUuZm9jdXMoKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIilcbiAgICAgICAgICAgIG9uTW91c2VPdmVyKHRhcmdldE5vZGUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRGaXJzdEF2YWlsYWJsZURheShkZWx0YSkge1xuICAgICAgICB2YXIgc3RhcnRNb250aCA9IGRlbHRhID4gMCA/IDAgOiBzZWxmLmNvbmZpZy5zaG93TW9udGhzIC0gMTtcbiAgICAgICAgdmFyIGVuZE1vbnRoID0gZGVsdGEgPiAwID8gc2VsZi5jb25maWcuc2hvd01vbnRocyA6IC0xO1xuICAgICAgICBmb3IgKHZhciBtID0gc3RhcnRNb250aDsgbSAhPSBlbmRNb250aDsgbSArPSBkZWx0YSkge1xuICAgICAgICAgICAgdmFyIG1vbnRoID0gc2VsZi5kYXlzQ29udGFpbmVyLmNoaWxkcmVuW21dO1xuICAgICAgICAgICAgdmFyIHN0YXJ0SW5kZXggPSBkZWx0YSA+IDAgPyAwIDogbW9udGguY2hpbGRyZW4ubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBlbmRJbmRleCA9IGRlbHRhID4gMCA/IG1vbnRoLmNoaWxkcmVuLmxlbmd0aCA6IC0xO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0SW5kZXg7IGkgIT0gZW5kSW5kZXg7IGkgKz0gZGVsdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IG1vbnRoLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjLmNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJiBpc0VuYWJsZWQoYy5kYXRlT2JqKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0TmV4dEF2YWlsYWJsZURheShjdXJyZW50LCBkZWx0YSkge1xuICAgICAgICB2YXIgZ2l2ZW5Nb250aCA9IGN1cnJlbnQuY2xhc3NOYW1lLmluZGV4T2YoXCJNb250aFwiKSA9PT0gLTFcbiAgICAgICAgICAgID8gY3VycmVudC5kYXRlT2JqLmdldE1vbnRoKClcbiAgICAgICAgICAgIDogc2VsZi5jdXJyZW50TW9udGg7XG4gICAgICAgIHZhciBlbmRNb250aCA9IGRlbHRhID4gMCA/IHNlbGYuY29uZmlnLnNob3dNb250aHMgOiAtMTtcbiAgICAgICAgdmFyIGxvb3BEZWx0YSA9IGRlbHRhID4gMCA/IDEgOiAtMTtcbiAgICAgICAgZm9yICh2YXIgbSA9IGdpdmVuTW9udGggLSBzZWxmLmN1cnJlbnRNb250aDsgbSAhPSBlbmRNb250aDsgbSArPSBsb29wRGVsdGEpIHtcbiAgICAgICAgICAgIHZhciBtb250aCA9IHNlbGYuZGF5c0NvbnRhaW5lci5jaGlsZHJlblttXTtcbiAgICAgICAgICAgIHZhciBzdGFydEluZGV4ID0gZ2l2ZW5Nb250aCAtIHNlbGYuY3VycmVudE1vbnRoID09PSBtXG4gICAgICAgICAgICAgICAgPyBjdXJyZW50LiRpICsgZGVsdGFcbiAgICAgICAgICAgICAgICA6IGRlbHRhIDwgMFxuICAgICAgICAgICAgICAgICAgICA/IG1vbnRoLmNoaWxkcmVuLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgOiAwO1xuICAgICAgICAgICAgdmFyIG51bU1vbnRoRGF5cyA9IG1vbnRoLmNoaWxkcmVuLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydEluZGV4OyBpID49IDAgJiYgaSA8IG51bU1vbnRoRGF5cyAmJiBpICE9IChkZWx0YSA+IDAgPyBudW1Nb250aERheXMgOiAtMSk7IGkgKz0gbG9vcERlbHRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSBtb250aC5jaGlsZHJlbltpXTtcbiAgICAgICAgICAgICAgICBpZiAoYy5jbGFzc05hbWUuaW5kZXhPZihcImhpZGRlblwiKSA9PT0gLTEgJiZcbiAgICAgICAgICAgICAgICAgICAgaXNFbmFibGVkKGMuZGF0ZU9iaikgJiZcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoY3VycmVudC4kaSAtIGkpID49IE1hdGguYWJzKGRlbHRhKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvY3VzT25EYXlFbGVtKGMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuY2hhbmdlTW9udGgobG9vcERlbHRhKTtcbiAgICAgICAgZm9jdXNPbkRheShnZXRGaXJzdEF2YWlsYWJsZURheShsb29wRGVsdGEpLCAwKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgZnVuY3Rpb24gZm9jdXNPbkRheShjdXJyZW50LCBvZmZzZXQpIHtcbiAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBnZXRDbG9zZXN0QWN0aXZlRWxlbWVudCgpO1xuICAgICAgICB2YXIgZGF5Rm9jdXNlZCA9IGlzSW5WaWV3KGFjdGl2ZUVsZW1lbnQgfHwgZG9jdW1lbnQuYm9keSk7XG4gICAgICAgIHZhciBzdGFydEVsZW0gPSBjdXJyZW50ICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgID8gY3VycmVudFxuICAgICAgICAgICAgOiBkYXlGb2N1c2VkXG4gICAgICAgICAgICAgICAgPyBhY3RpdmVFbGVtZW50XG4gICAgICAgICAgICAgICAgOiBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gIT09IHVuZGVmaW5lZCAmJiBpc0luVmlldyhzZWxmLnNlbGVjdGVkRGF0ZUVsZW0pXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5zZWxlY3RlZERhdGVFbGVtXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi50b2RheURhdGVFbGVtICE9PSB1bmRlZmluZWQgJiYgaXNJblZpZXcoc2VsZi50b2RheURhdGVFbGVtKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxmLnRvZGF5RGF0ZUVsZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIDogZ2V0Rmlyc3RBdmFpbGFibGVEYXkob2Zmc2V0ID4gMCA/IDEgOiAtMSk7XG4gICAgICAgIGlmIChzdGFydEVsZW0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5faW5wdXQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghZGF5Rm9jdXNlZCkge1xuICAgICAgICAgICAgZm9jdXNPbkRheUVsZW0oc3RhcnRFbGVtKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGdldE5leHRBdmFpbGFibGVEYXkoc3RhcnRFbGVtLCBvZmZzZXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkTW9udGhEYXlzKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHZhciBmaXJzdE9mTW9udGggPSAobmV3IERhdGUoeWVhciwgbW9udGgsIDEpLmdldERheSgpIC0gc2VsZi5sMTBuLmZpcnN0RGF5T2ZXZWVrICsgNykgJSA3O1xuICAgICAgICB2YXIgcHJldk1vbnRoRGF5cyA9IHNlbGYudXRpbHMuZ2V0RGF5c0luTW9udGgoKG1vbnRoIC0gMSArIDEyKSAlIDEyLCB5ZWFyKTtcbiAgICAgICAgdmFyIGRheXNJbk1vbnRoID0gc2VsZi51dGlscy5nZXREYXlzSW5Nb250aChtb250aCwgeWVhciksIGRheXMgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLCBpc011bHRpTW9udGggPSBzZWxmLmNvbmZpZy5zaG93TW9udGhzID4gMSwgcHJldk1vbnRoRGF5Q2xhc3MgPSBpc011bHRpTW9udGggPyBcInByZXZNb250aERheSBoaWRkZW5cIiA6IFwicHJldk1vbnRoRGF5XCIsIG5leHRNb250aERheUNsYXNzID0gaXNNdWx0aU1vbnRoID8gXCJuZXh0TW9udGhEYXkgaGlkZGVuXCIgOiBcIm5leHRNb250aERheVwiO1xuICAgICAgICB2YXIgZGF5TnVtYmVyID0gcHJldk1vbnRoRGF5cyArIDEgLSBmaXJzdE9mTW9udGgsIGRheUluZGV4ID0gMDtcbiAgICAgICAgZm9yICg7IGRheU51bWJlciA8PSBwcmV2TW9udGhEYXlzOyBkYXlOdW1iZXIrKywgZGF5SW5kZXgrKykge1xuICAgICAgICAgICAgZGF5cy5hcHBlbmRDaGlsZChjcmVhdGVEYXkoXCJmbGF0cGlja3ItZGF5IFwiICsgcHJldk1vbnRoRGF5Q2xhc3MsIG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgZGF5TnVtYmVyKSwgZGF5TnVtYmVyLCBkYXlJbmRleCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoZGF5TnVtYmVyID0gMTsgZGF5TnVtYmVyIDw9IGRheXNJbk1vbnRoOyBkYXlOdW1iZXIrKywgZGF5SW5kZXgrKykge1xuICAgICAgICAgICAgZGF5cy5hcHBlbmRDaGlsZChjcmVhdGVEYXkoXCJmbGF0cGlja3ItZGF5XCIsIG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXlOdW1iZXIpLCBkYXlOdW1iZXIsIGRheUluZGV4KSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgZGF5TnVtID0gZGF5c0luTW9udGggKyAxOyBkYXlOdW0gPD0gNDIgLSBmaXJzdE9mTW9udGggJiZcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5zaG93TW9udGhzID09PSAxIHx8IGRheUluZGV4ICUgNyAhPT0gMCk7IGRheU51bSsrLCBkYXlJbmRleCsrKSB7XG4gICAgICAgICAgICBkYXlzLmFwcGVuZENoaWxkKGNyZWF0ZURheShcImZsYXRwaWNrci1kYXkgXCIgKyBuZXh0TW9udGhEYXlDbGFzcywgbmV3IERhdGUoeWVhciwgbW9udGggKyAxLCBkYXlOdW0gJSBkYXlzSW5Nb250aCksIGRheU51bSwgZGF5SW5kZXgpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF5Q29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImRheUNvbnRhaW5lclwiKTtcbiAgICAgICAgZGF5Q29udGFpbmVyLmFwcGVuZENoaWxkKGRheXMpO1xuICAgICAgICByZXR1cm4gZGF5Q29udGFpbmVyO1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZERheXMoKSB7XG4gICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNsZWFyTm9kZShzZWxmLmRheXNDb250YWluZXIpO1xuICAgICAgICBpZiAoc2VsZi53ZWVrTnVtYmVycylcbiAgICAgICAgICAgIGNsZWFyTm9kZShzZWxmLndlZWtOdW1iZXJzKTtcbiAgICAgICAgdmFyIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5jb25maWcuc2hvd01vbnRoczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKHNlbGYuY3VycmVudFllYXIsIHNlbGYuY3VycmVudE1vbnRoLCAxKTtcbiAgICAgICAgICAgIGQuc2V0TW9udGgoc2VsZi5jdXJyZW50TW9udGggKyBpKTtcbiAgICAgICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQoYnVpbGRNb250aERheXMoZC5nZXRGdWxsWWVhcigpLCBkLmdldE1vbnRoKCkpKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmRheXNDb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZyk7XG4gICAgICAgIHNlbGYuZGF5cyA9IHNlbGYuZGF5c0NvbnRhaW5lci5maXJzdENoaWxkO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiICYmIHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIG9uTW91c2VPdmVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aFN3aXRjaCgpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxIHx8XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tb250aFNlbGVjdG9yVHlwZSAhPT0gXCJkcm9wZG93blwiKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgc2hvdWxkQnVpbGRNb250aCA9IGZ1bmN0aW9uIChtb250aCkge1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1pbkRhdGUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKSAmJlxuICAgICAgICAgICAgICAgIG1vbnRoIDwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRNb250aCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICEoc2VsZi5jb25maWcubWF4RGF0ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpICYmXG4gICAgICAgICAgICAgICAgbW9udGggPiBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldE1vbnRoKCkpO1xuICAgICAgICB9O1xuICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLnRhYkluZGV4ID0gLTE7XG4gICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIXNob3VsZEJ1aWxkTW9udGgoaSkpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB2YXIgbW9udGggPSBjcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIFwiZmxhdHBpY2tyLW1vbnRoRHJvcGRvd24tbW9udGhcIik7XG4gICAgICAgICAgICBtb250aC52YWx1ZSA9IG5ldyBEYXRlKHNlbGYuY3VycmVudFllYXIsIGkpLmdldE1vbnRoKCkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIG1vbnRoLnRleHRDb250ZW50ID0gbW9udGhUb1N0cihpLCBzZWxmLmNvbmZpZy5zaG9ydGhhbmRDdXJyZW50TW9udGgsIHNlbGYubDEwbik7XG4gICAgICAgICAgICBtb250aC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgaWYgKHNlbGYuY3VycmVudE1vbnRoID09PSBpKSB7XG4gICAgICAgICAgICAgICAgbW9udGguc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci5hcHBlbmRDaGlsZChtb250aCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aCgpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItbW9udGhcIik7XG4gICAgICAgIHZhciBtb250aE5hdkZyYWdtZW50ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgdmFyIG1vbnRoRWxlbWVudDtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxIHx8XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tb250aFNlbGVjdG9yVHlwZSA9PT0gXCJzdGF0aWNcIikge1xuICAgICAgICAgICAgbW9udGhFbGVtZW50ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJjdXItbW9udGhcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcInNlbGVjdFwiLCBcImZsYXRwaWNrci1tb250aERyb3Bkb3duLW1vbnRoc1wiKTtcbiAgICAgICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBzZWxmLmwxMG4ubW9udGhBcmlhTGFiZWwpO1xuICAgICAgICAgICAgYmluZChzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLCBcImNoYW5nZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRNb250aCA9IHBhcnNlSW50KHRhcmdldC52YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgIHNlbGYuY2hhbmdlTW9udGgoc2VsZWN0ZWRNb250aCAtIHNlbGYuY3VycmVudE1vbnRoKTtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk1vbnRoQ2hhbmdlXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBidWlsZE1vbnRoU3dpdGNoKCk7XG4gICAgICAgICAgICBtb250aEVsZW1lbnQgPSBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyO1xuICAgICAgICB9XG4gICAgICAgIHZhciB5ZWFySW5wdXQgPSBjcmVhdGVOdW1iZXJJbnB1dChcImN1ci15ZWFyXCIsIHsgdGFiaW5kZXg6IFwiLTFcIiB9KTtcbiAgICAgICAgdmFyIHllYXJFbGVtZW50ID0geWVhcklucHV0LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF07XG4gICAgICAgIHllYXJFbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgc2VsZi5sMTBuLnllYXJBcmlhTGFiZWwpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubWluRGF0ZSkge1xuICAgICAgICAgICAgeWVhckVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWluXCIsIHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcubWF4RGF0ZSkge1xuICAgICAgICAgICAgeWVhckVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4XCIsIHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHllYXJFbGVtZW50LmRpc2FibGVkID1cbiAgICAgICAgICAgICAgICAhIXNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpID09PSBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnRNb250aCA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItY3VycmVudC1tb250aFwiKTtcbiAgICAgICAgY3VycmVudE1vbnRoLmFwcGVuZENoaWxkKG1vbnRoRWxlbWVudCk7XG4gICAgICAgIGN1cnJlbnRNb250aC5hcHBlbmRDaGlsZCh5ZWFySW5wdXQpO1xuICAgICAgICBtb250aE5hdkZyYWdtZW50LmFwcGVuZENoaWxkKGN1cnJlbnRNb250aCk7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChtb250aE5hdkZyYWdtZW50KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRhaW5lcjogY29udGFpbmVyLFxuICAgICAgICAgICAgeWVhckVsZW1lbnQ6IHllYXJFbGVtZW50LFxuICAgICAgICAgICAgbW9udGhFbGVtZW50OiBtb250aEVsZW1lbnQsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkTW9udGhzKCkge1xuICAgICAgICBjbGVhck5vZGUoc2VsZi5tb250aE5hdik7XG4gICAgICAgIHNlbGYubW9udGhOYXYuYXBwZW5kQ2hpbGQoc2VsZi5wcmV2TW9udGhOYXYpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuc2hvd01vbnRocykge1xuICAgICAgICAgICAgc2VsZi55ZWFyRWxlbWVudHMgPSBbXTtcbiAgICAgICAgICAgIHNlbGYubW9udGhFbGVtZW50cyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIG0gPSBzZWxmLmNvbmZpZy5zaG93TW9udGhzOyBtLS07KSB7XG4gICAgICAgICAgICB2YXIgbW9udGggPSBidWlsZE1vbnRoKCk7XG4gICAgICAgICAgICBzZWxmLnllYXJFbGVtZW50cy5wdXNoKG1vbnRoLnllYXJFbGVtZW50KTtcbiAgICAgICAgICAgIHNlbGYubW9udGhFbGVtZW50cy5wdXNoKG1vbnRoLm1vbnRoRWxlbWVudCk7XG4gICAgICAgICAgICBzZWxmLm1vbnRoTmF2LmFwcGVuZENoaWxkKG1vbnRoLmNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5tb250aE5hdi5hcHBlbmRDaGlsZChzZWxmLm5leHRNb250aE5hdik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkTW9udGhOYXYoKSB7XG4gICAgICAgIHNlbGYubW9udGhOYXYgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLW1vbnRoc1wiKTtcbiAgICAgICAgc2VsZi55ZWFyRWxlbWVudHMgPSBbXTtcbiAgICAgICAgc2VsZi5tb250aEVsZW1lbnRzID0gW107XG4gICAgICAgIHNlbGYucHJldk1vbnRoTmF2ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItcHJldi1tb250aFwiKTtcbiAgICAgICAgc2VsZi5wcmV2TW9udGhOYXYuaW5uZXJIVE1MID0gc2VsZi5jb25maWcucHJldkFycm93O1xuICAgICAgICBzZWxmLm5leHRNb250aE5hdiA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLW5leHQtbW9udGhcIik7XG4gICAgICAgIHNlbGYubmV4dE1vbnRoTmF2LmlubmVySFRNTCA9IHNlbGYuY29uZmlnLm5leHRBcnJvdztcbiAgICAgICAgYnVpbGRNb250aHMoKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYsIFwiX2hpZGVQcmV2TW9udGhBcnJvd1wiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuX19oaWRlUHJldk1vbnRoQXJyb3c7IH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChib29sKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX19oaWRlUHJldk1vbnRoQXJyb3cgIT09IGJvb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5wcmV2TW9udGhOYXYsIFwiZmxhdHBpY2tyLWRpc2FibGVkXCIsIGJvb2wpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9faGlkZVByZXZNb250aEFycm93ID0gYm9vbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYsIFwiX2hpZGVOZXh0TW9udGhBcnJvd1wiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuX19oaWRlTmV4dE1vbnRoQXJyb3c7IH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChib29sKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX19oaWRlTmV4dE1vbnRoQXJyb3cgIT09IGJvb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5uZXh0TW9udGhOYXYsIFwiZmxhdHBpY2tyLWRpc2FibGVkXCIsIGJvb2wpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9faGlkZU5leHRNb250aEFycm93ID0gYm9vbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5jdXJyZW50WWVhckVsZW1lbnQgPSBzZWxmLnllYXJFbGVtZW50c1swXTtcbiAgICAgICAgdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpO1xuICAgICAgICByZXR1cm4gc2VsZi5tb250aE5hdjtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRUaW1lKCkge1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoYXNUaW1lXCIpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubm9DYWxlbmRhcilcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5vQ2FsZW5kYXJcIik7XG4gICAgICAgIHZhciBkZWZhdWx0cyA9IGdldERlZmF1bHRIb3VycyhzZWxmLmNvbmZpZyk7XG4gICAgICAgIHNlbGYudGltZUNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItdGltZVwiKTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLnRhYkluZGV4ID0gLTE7XG4gICAgICAgIHZhciBzZXBhcmF0b3IgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci10aW1lLXNlcGFyYXRvclwiLCBcIjpcIik7XG4gICAgICAgIHZhciBob3VySW5wdXQgPSBjcmVhdGVOdW1iZXJJbnB1dChcImZsYXRwaWNrci1ob3VyXCIsIHtcbiAgICAgICAgICAgIFwiYXJpYS1sYWJlbFwiOiBzZWxmLmwxMG4uaG91ckFyaWFMYWJlbCxcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQgPSBob3VySW5wdXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXTtcbiAgICAgICAgdmFyIG1pbnV0ZUlucHV0ID0gY3JlYXRlTnVtYmVySW5wdXQoXCJmbGF0cGlja3ItbWludXRlXCIsIHtcbiAgICAgICAgICAgIFwiYXJpYS1sYWJlbFwiOiBzZWxmLmwxMG4ubWludXRlQXJpYUxhYmVsLFxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50ID0gbWludXRlSW5wdXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC50YWJJbmRleCA9IHNlbGYubWludXRlRWxlbWVudC50YWJJbmRleCA9IC0xO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnZhbHVlID0gcGFkKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqXG4gICAgICAgICAgICA/IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLmdldEhvdXJzKClcbiAgICAgICAgICAgIDogc2VsZi5jb25maWcudGltZV8yNGhyXG4gICAgICAgICAgICAgICAgPyBkZWZhdWx0cy5ob3Vyc1xuICAgICAgICAgICAgICAgIDogbWlsaXRhcnkyYW1wbShkZWZhdWx0cy5ob3VycykpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQudmFsdWUgPSBwYWQoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmpcbiAgICAgICAgICAgID8gc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmouZ2V0TWludXRlcygpXG4gICAgICAgICAgICA6IGRlZmF1bHRzLm1pbnV0ZXMpO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnNldEF0dHJpYnV0ZShcInN0ZXBcIiwgc2VsZi5jb25maWcuaG91ckluY3JlbWVudC50b1N0cmluZygpKTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LnNldEF0dHJpYnV0ZShcInN0ZXBcIiwgc2VsZi5jb25maWcubWludXRlSW5jcmVtZW50LnRvU3RyaW5nKCkpO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1pblwiLCBzZWxmLmNvbmZpZy50aW1lXzI0aHIgPyBcIjBcIiA6IFwiMVwiKTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgc2VsZi5jb25maWcudGltZV8yNGhyID8gXCIyM1wiIDogXCIxMlwiKTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIyXCIpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWluXCIsIFwiMFwiKTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heFwiLCBcIjU5XCIpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4bGVuZ3RoXCIsIFwiMlwiKTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKGhvdXJJbnB1dCk7XG4gICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZXBhcmF0b3IpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQobWludXRlSW5wdXQpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcudGltZV8yNGhyKVxuICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJ0aW1lMjRoclwiKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmVuYWJsZVNlY29uZHMpIHtcbiAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGFzU2Vjb25kc1wiKTtcbiAgICAgICAgICAgIHZhciBzZWNvbmRJbnB1dCA9IGNyZWF0ZU51bWJlcklucHV0KFwiZmxhdHBpY2tyLXNlY29uZFwiKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudCA9IHNlY29uZElucHV0LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF07XG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQudmFsdWUgPSBwYWQoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmpcbiAgICAgICAgICAgICAgICA/IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLmdldFNlY29uZHMoKVxuICAgICAgICAgICAgICAgIDogZGVmYXVsdHMuc2Vjb25kcyk7XG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBzZWxmLm1pbnV0ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic3RlcFwiKSk7XG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWluXCIsIFwiMFwiKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgXCI1OVwiKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIyXCIpO1xuICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLXRpbWUtc2VwYXJhdG9yXCIsIFwiOlwiKSk7XG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoc2Vjb25kSW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZi5jb25maWcudGltZV8yNGhyKSB7XG4gICAgICAgICAgICBzZWxmLmFtUE0gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci1hbS1wbVwiLCBzZWxmLmwxMG4uYW1QTVtpbnQoKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqXG4gICAgICAgICAgICAgICAgPyBzZWxmLmhvdXJFbGVtZW50LnZhbHVlXG4gICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5kZWZhdWx0SG91cikgPiAxMSldKTtcbiAgICAgICAgICAgIHNlbGYuYW1QTS50aXRsZSA9IHNlbGYubDEwbi50b2dnbGVUaXRsZTtcbiAgICAgICAgICAgIHNlbGYuYW1QTS50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGYuYW1QTSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGYudGltZUNvbnRhaW5lcjtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRXZWVrZGF5cygpIHtcbiAgICAgICAgaWYgKCFzZWxmLndlZWtkYXlDb250YWluZXIpXG4gICAgICAgICAgICBzZWxmLndlZWtkYXlDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXdlZWtkYXlzXCIpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBjbGVhck5vZGUoc2VsZi53ZWVrZGF5Q29udGFpbmVyKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHNlbGYuY29uZmlnLnNob3dNb250aHM7IGktLTspIHtcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXdlZWtkYXljb250YWluZXJcIik7XG4gICAgICAgICAgICBzZWxmLndlZWtkYXlDb250YWluZXIuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVXZWVrZGF5cygpO1xuICAgICAgICByZXR1cm4gc2VsZi53ZWVrZGF5Q29udGFpbmVyO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVXZWVrZGF5cygpIHtcbiAgICAgICAgaWYgKCFzZWxmLndlZWtkYXlDb250YWluZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlyc3REYXlPZldlZWsgPSBzZWxmLmwxMG4uZmlyc3REYXlPZldlZWs7XG4gICAgICAgIHZhciB3ZWVrZGF5cyA9IF9fc3ByZWFkQXJyYXlzKHNlbGYubDEwbi53ZWVrZGF5cy5zaG9ydGhhbmQpO1xuICAgICAgICBpZiAoZmlyc3REYXlPZldlZWsgPiAwICYmIGZpcnN0RGF5T2ZXZWVrIDwgd2Vla2RheXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB3ZWVrZGF5cyA9IF9fc3ByZWFkQXJyYXlzKHdlZWtkYXlzLnNwbGljZShmaXJzdERheU9mV2Vlaywgd2Vla2RheXMubGVuZ3RoKSwgd2Vla2RheXMuc3BsaWNlKDAsIGZpcnN0RGF5T2ZXZWVrKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IHNlbGYuY29uZmlnLnNob3dNb250aHM7IGktLTspIHtcbiAgICAgICAgICAgIHNlbGYud2Vla2RheUNvbnRhaW5lci5jaGlsZHJlbltpXS5pbm5lckhUTUwgPSBcIlxcbiAgICAgIDxzcGFuIGNsYXNzPSdmbGF0cGlja3Itd2Vla2RheSc+XFxuICAgICAgICBcIiArIHdlZWtkYXlzLmpvaW4oXCI8L3NwYW4+PHNwYW4gY2xhc3M9J2ZsYXRwaWNrci13ZWVrZGF5Jz5cIikgKyBcIlxcbiAgICAgIDwvc3Bhbj5cXG4gICAgICBcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZFdlZWtzKCkge1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoYXNXZWVrc1wiKTtcbiAgICAgICAgdmFyIHdlZWtXcmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci13ZWVrd3JhcHBlclwiKTtcbiAgICAgICAgd2Vla1dyYXBwZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3Itd2Vla2RheVwiLCBzZWxmLmwxMG4ud2Vla0FiYnJldmlhdGlvbikpO1xuICAgICAgICB2YXIgd2Vla051bWJlcnMgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXdlZWtzXCIpO1xuICAgICAgICB3ZWVrV3JhcHBlci5hcHBlbmRDaGlsZCh3ZWVrTnVtYmVycyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3ZWVrV3JhcHBlcjogd2Vla1dyYXBwZXIsXG4gICAgICAgICAgICB3ZWVrTnVtYmVyczogd2Vla051bWJlcnMsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNoYW5nZU1vbnRoKHZhbHVlLCBpc09mZnNldCkge1xuICAgICAgICBpZiAoaXNPZmZzZXQgPT09IHZvaWQgMCkgeyBpc09mZnNldCA9IHRydWU7IH1cbiAgICAgICAgdmFyIGRlbHRhID0gaXNPZmZzZXQgPyB2YWx1ZSA6IHZhbHVlIC0gc2VsZi5jdXJyZW50TW9udGg7XG4gICAgICAgIGlmICgoZGVsdGEgPCAwICYmIHNlbGYuX2hpZGVQcmV2TW9udGhBcnJvdyA9PT0gdHJ1ZSkgfHxcbiAgICAgICAgICAgIChkZWx0YSA+IDAgJiYgc2VsZi5faGlkZU5leHRNb250aEFycm93ID09PSB0cnVlKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2VsZi5jdXJyZW50TW9udGggKz0gZGVsdGE7XG4gICAgICAgIGlmIChzZWxmLmN1cnJlbnRNb250aCA8IDAgfHwgc2VsZi5jdXJyZW50TW9udGggPiAxMSkge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciArPSBzZWxmLmN1cnJlbnRNb250aCA+IDExID8gMSA6IC0xO1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSAoc2VsZi5jdXJyZW50TW9udGggKyAxMikgJSAxMjtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uWWVhckNoYW5nZVwiKTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICBidWlsZERheXMoKTtcbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25Nb250aENoYW5nZVwiKTtcbiAgICAgICAgdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjbGVhcih0cmlnZ2VyQ2hhbmdlRXZlbnQsIHRvSW5pdGlhbCkge1xuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZUV2ZW50ID09PSB2b2lkIDApIHsgdHJpZ2dlckNoYW5nZUV2ZW50ID0gdHJ1ZTsgfVxuICAgICAgICBpZiAodG9Jbml0aWFsID09PSB2b2lkIDApIHsgdG9Jbml0aWFsID0gdHJ1ZTsgfVxuICAgICAgICBzZWxmLmlucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgICBpZiAoc2VsZi5tb2JpbGVJbnB1dCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IFtdO1xuICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKHRvSW5pdGlhbCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IHNlbGYuX2luaXRpYWxEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IHNlbGYuX2luaXRpYWxEYXRlLmdldE1vbnRoKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmVuYWJsZVRpbWUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IGdldERlZmF1bHRIb3VycyhzZWxmLmNvbmZpZyksIGhvdXJzID0gX2EuaG91cnMsIG1pbnV0ZXMgPSBfYS5taW51dGVzLCBzZWNvbmRzID0gX2Euc2Vjb25kcztcbiAgICAgICAgICAgIHNldEhvdXJzKGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnJlZHJhdygpO1xuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZUV2ZW50KVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DaGFuZ2VcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgICBzZWxmLmlzT3BlbiA9IGZhbHNlO1xuICAgICAgICBpZiAoIXNlbGYuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNhbGVuZGFyQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuX2lucHV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9pbnB1dC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2xvc2VcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25EZXN0cm95XCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gc2VsZi5faGFuZGxlcnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICBzZWxmLl9oYW5kbGVyc1tpXS5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLl9oYW5kbGVycyA9IFtdO1xuICAgICAgICBpZiAoc2VsZi5tb2JpbGVJbnB1dCkge1xuICAgICAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2VsZi5tb2JpbGVJbnB1dCk7XG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgJiYgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuc3RhdGljICYmIHNlbGYuY2FsZW5kYXJDb250YWluZXIucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIHZhciB3cmFwcGVyID0gc2VsZi5jYWxlbmRhckNvbnRhaW5lci5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIubGFzdENoaWxkICYmIHdyYXBwZXIucmVtb3ZlQ2hpbGQod3JhcHBlci5sYXN0Q2hpbGQpO1xuICAgICAgICAgICAgICAgIGlmICh3cmFwcGVyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHdyYXBwZXIuZmlyc3RDaGlsZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBwZXIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUod3JhcHBlci5maXJzdENoaWxkLCB3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2VsZi5jYWxlbmRhckNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQpIHtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICBzZWxmLmFsdElucHV0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2VsZi5hbHRJbnB1dCk7XG4gICAgICAgICAgICBkZWxldGUgc2VsZi5hbHRJbnB1dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5pbnB1dCkge1xuICAgICAgICAgICAgc2VsZi5pbnB1dC50eXBlID0gc2VsZi5pbnB1dC5fdHlwZTtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImZsYXRwaWNrci1pbnB1dFwiKTtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQucmVtb3ZlQXR0cmlidXRlKFwicmVhZG9ubHlcIik7XG4gICAgICAgIH1cbiAgICAgICAgW1xuICAgICAgICAgICAgXCJfc2hvd1RpbWVJbnB1dFwiLFxuICAgICAgICAgICAgXCJsYXRlc3RTZWxlY3RlZERhdGVPYmpcIixcbiAgICAgICAgICAgIFwiX2hpZGVOZXh0TW9udGhBcnJvd1wiLFxuICAgICAgICAgICAgXCJfaGlkZVByZXZNb250aEFycm93XCIsXG4gICAgICAgICAgICBcIl9faGlkZU5leHRNb250aEFycm93XCIsXG4gICAgICAgICAgICBcIl9faGlkZVByZXZNb250aEFycm93XCIsXG4gICAgICAgICAgICBcImlzTW9iaWxlXCIsXG4gICAgICAgICAgICBcImlzT3BlblwiLFxuICAgICAgICAgICAgXCJzZWxlY3RlZERhdGVFbGVtXCIsXG4gICAgICAgICAgICBcIm1pbkRhdGVIYXNUaW1lXCIsXG4gICAgICAgICAgICBcIm1heERhdGVIYXNUaW1lXCIsXG4gICAgICAgICAgICBcImRheXNcIixcbiAgICAgICAgICAgIFwiZGF5c0NvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJfaW5wdXRcIixcbiAgICAgICAgICAgIFwiX3Bvc2l0aW9uRWxlbWVudFwiLFxuICAgICAgICAgICAgXCJpbm5lckNvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJyQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcIm1vbnRoTmF2XCIsXG4gICAgICAgICAgICBcInRvZGF5RGF0ZUVsZW1cIixcbiAgICAgICAgICAgIFwiY2FsZW5kYXJDb250YWluZXJcIixcbiAgICAgICAgICAgIFwid2Vla2RheUNvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJwcmV2TW9udGhOYXZcIixcbiAgICAgICAgICAgIFwibmV4dE1vbnRoTmF2XCIsXG4gICAgICAgICAgICBcIm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcImN1cnJlbnRNb250aEVsZW1lbnRcIixcbiAgICAgICAgICAgIFwiY3VycmVudFllYXJFbGVtZW50XCIsXG4gICAgICAgICAgICBcIm5hdmlnYXRpb25DdXJyZW50TW9udGhcIixcbiAgICAgICAgICAgIFwic2VsZWN0ZWREYXRlRWxlbVwiLFxuICAgICAgICAgICAgXCJjb25maWdcIixcbiAgICAgICAgXS5mb3JFYWNoKGZ1bmN0aW9uIChrKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzZWxmW2tdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNDYWxlbmRhckVsZW0oZWxlbSkge1xuICAgICAgICByZXR1cm4gc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jb250YWlucyhlbGVtKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZG9jdW1lbnRDbGljayhlKSB7XG4gICAgICAgIGlmIChzZWxmLmlzT3BlbiAmJiAhc2VsZi5jb25maWcuaW5saW5lKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRUYXJnZXRfMSA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICAgICAgdmFyIGlzQ2FsZW5kYXJFbGVtZW50ID0gaXNDYWxlbmRhckVsZW0oZXZlbnRUYXJnZXRfMSk7XG4gICAgICAgICAgICB2YXIgaXNJbnB1dCA9IGV2ZW50VGFyZ2V0XzEgPT09IHNlbGYuaW5wdXQgfHxcbiAgICAgICAgICAgICAgICBldmVudFRhcmdldF8xID09PSBzZWxmLmFsdElucHV0IHx8XG4gICAgICAgICAgICAgICAgc2VsZi5lbGVtZW50LmNvbnRhaW5zKGV2ZW50VGFyZ2V0XzEpIHx8XG4gICAgICAgICAgICAgICAgKGUucGF0aCAmJlxuICAgICAgICAgICAgICAgICAgICBlLnBhdGguaW5kZXhPZiAmJlxuICAgICAgICAgICAgICAgICAgICAofmUucGF0aC5pbmRleE9mKHNlbGYuaW5wdXQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICB+ZS5wYXRoLmluZGV4T2Yoc2VsZi5hbHRJbnB1dCkpKTtcbiAgICAgICAgICAgIHZhciBsb3N0Rm9jdXMgPSAhaXNJbnB1dCAmJlxuICAgICAgICAgICAgICAgICFpc0NhbGVuZGFyRWxlbWVudCAmJlxuICAgICAgICAgICAgICAgICFpc0NhbGVuZGFyRWxlbShlLnJlbGF0ZWRUYXJnZXQpO1xuICAgICAgICAgICAgdmFyIGlzSWdub3JlZCA9ICFzZWxmLmNvbmZpZy5pZ25vcmVkRm9jdXNFbGVtZW50cy5zb21lKGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW0uY29udGFpbnMoZXZlbnRUYXJnZXRfMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChsb3N0Rm9jdXMgJiYgaXNJZ25vcmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLmFsbG93SW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXREYXRlKHNlbGYuX2lucHV0LnZhbHVlLCBmYWxzZSwgc2VsZi5jb25maWcuYWx0SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcuYWx0Rm9ybWF0XG4gICAgICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi50aW1lQ29udGFpbmVyICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5taW51dGVFbGVtZW50ICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQudmFsdWUgIT09IFwiXCIgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZyAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMSlcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jbGVhcihmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gY2hhbmdlWWVhcihuZXdZZWFyKSB7XG4gICAgICAgIGlmICghbmV3WWVhciB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1pbkRhdGUgJiYgbmV3WWVhciA8IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKSkgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5tYXhEYXRlICYmIG5ld1llYXIgPiBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCkpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgbmV3WWVhck51bSA9IG5ld1llYXIsIGlzTmV3WWVhciA9IHNlbGYuY3VycmVudFllYXIgIT09IG5ld1llYXJOdW07XG4gICAgICAgIHNlbGYuY3VycmVudFllYXIgPSBuZXdZZWFyTnVtIHx8IHNlbGYuY3VycmVudFllYXI7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gTWF0aC5taW4oc2VsZi5jb25maWcubWF4RGF0ZS5nZXRNb250aCgpLCBzZWxmLmN1cnJlbnRNb250aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IE1hdGgubWF4KHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0TW9udGgoKSwgc2VsZi5jdXJyZW50TW9udGgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc05ld1llYXIpIHtcbiAgICAgICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblllYXJDaGFuZ2VcIik7XG4gICAgICAgICAgICBidWlsZE1vbnRoU3dpdGNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gaXNFbmFibGVkKGRhdGUsIHRpbWVsZXNzKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHRpbWVsZXNzID09PSB2b2lkIDApIHsgdGltZWxlc3MgPSB0cnVlOyB9XG4gICAgICAgIHZhciBkYXRlVG9DaGVjayA9IHNlbGYucGFyc2VEYXRlKGRhdGUsIHVuZGVmaW5lZCwgdGltZWxlc3MpO1xuICAgICAgICBpZiAoKHNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgIGRhdGVUb0NoZWNrICYmXG4gICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZVRvQ2hlY2ssIHNlbGYuY29uZmlnLm1pbkRhdGUsIHRpbWVsZXNzICE9PSB1bmRlZmluZWQgPyB0aW1lbGVzcyA6ICFzZWxmLm1pbkRhdGVIYXNUaW1lKSA8IDApIHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcubWF4RGF0ZSAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrICYmXG4gICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGVUb0NoZWNrLCBzZWxmLmNvbmZpZy5tYXhEYXRlLCB0aW1lbGVzcyAhPT0gdW5kZWZpbmVkID8gdGltZWxlc3MgOiAhc2VsZi5tYXhEYXRlSGFzVGltZSkgPiAwKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5lbmFibGUgJiYgc2VsZi5jb25maWcuZGlzYWJsZS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKGRhdGVUb0NoZWNrID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIHZhciBib29sID0gISFzZWxmLmNvbmZpZy5lbmFibGUsIGFycmF5ID0gKF9hID0gc2VsZi5jb25maWcuZW5hYmxlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBzZWxmLmNvbmZpZy5kaXNhYmxlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgZCA9IHZvaWQgMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkID0gYXJyYXlbaV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIGQgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgICAgICAgICAgIGQoZGF0ZVRvQ2hlY2spKVxuICAgICAgICAgICAgICAgIHJldHVybiBib29sO1xuICAgICAgICAgICAgZWxzZSBpZiAoZCBpbnN0YW5jZW9mIERhdGUgJiZcbiAgICAgICAgICAgICAgICBkYXRlVG9DaGVjayAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgZC5nZXRUaW1lKCkgPT09IGRhdGVUb0NoZWNrLmdldFRpbWUoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9vbDtcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcnNlZCA9IHNlbGYucGFyc2VEYXRlKGQsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlZCAmJiBwYXJzZWQuZ2V0VGltZSgpID09PSBkYXRlVG9DaGVjay5nZXRUaW1lKClcbiAgICAgICAgICAgICAgICAgICAgPyBib29sXG4gICAgICAgICAgICAgICAgICAgIDogIWJvb2w7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZCA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBkLmZyb20gJiZcbiAgICAgICAgICAgICAgICBkLnRvICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2suZ2V0VGltZSgpID49IGQuZnJvbS5nZXRUaW1lKCkgJiZcbiAgICAgICAgICAgICAgICBkYXRlVG9DaGVjay5nZXRUaW1lKCkgPD0gZC50by5nZXRUaW1lKCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFib29sO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0luVmlldyhlbGVtKSB7XG4gICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiAoZWxlbS5jbGFzc05hbWUuaW5kZXhPZihcImhpZGRlblwiKSA9PT0gLTEgJiZcbiAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTmFtZS5pbmRleE9mKFwiZmxhdHBpY2tyLWRpc2FibGVkXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci5jb250YWlucyhlbGVtKSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25CbHVyKGUpIHtcbiAgICAgICAgdmFyIGlzSW5wdXQgPSBlLnRhcmdldCA9PT0gc2VsZi5faW5wdXQ7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBzZWxmLl9pbnB1dC52YWx1ZS50cmltRW5kKCkgIT09IGdldERhdGVTdHIoKTtcbiAgICAgICAgaWYgKGlzSW5wdXQgJiZcbiAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCAmJlxuICAgICAgICAgICAgIShlLnJlbGF0ZWRUYXJnZXQgJiYgaXNDYWxlbmRhckVsZW0oZS5yZWxhdGVkVGFyZ2V0KSkpIHtcbiAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShzZWxmLl9pbnB1dC52YWx1ZSwgdHJ1ZSwgZS50YXJnZXQgPT09IHNlbGYuYWx0SW5wdXRcbiAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLmFsdEZvcm1hdFxuICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25LZXlEb3duKGUpIHtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgIHZhciBpc0lucHV0ID0gc2VsZi5jb25maWcud3JhcFxuICAgICAgICAgICAgPyBlbGVtZW50LmNvbnRhaW5zKGV2ZW50VGFyZ2V0KVxuICAgICAgICAgICAgOiBldmVudFRhcmdldCA9PT0gc2VsZi5faW5wdXQ7XG4gICAgICAgIHZhciBhbGxvd0lucHV0ID0gc2VsZi5jb25maWcuYWxsb3dJbnB1dDtcbiAgICAgICAgdmFyIGFsbG93S2V5ZG93biA9IHNlbGYuaXNPcGVuICYmICghYWxsb3dJbnB1dCB8fCAhaXNJbnB1dCk7XG4gICAgICAgIHZhciBhbGxvd0lubGluZUtleWRvd24gPSBzZWxmLmNvbmZpZy5pbmxpbmUgJiYgaXNJbnB1dCAmJiAhYWxsb3dJbnB1dDtcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMgJiYgaXNJbnB1dCkge1xuICAgICAgICAgICAgaWYgKGFsbG93SW5wdXQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNldERhdGUoc2VsZi5faW5wdXQudmFsdWUsIHRydWUsIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmFsdElucHV0XG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcuYWx0Rm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgICAgICAgICAgc2VsZi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBldmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0NhbGVuZGFyRWxlbShldmVudFRhcmdldCkgfHxcbiAgICAgICAgICAgIGFsbG93S2V5ZG93biB8fFxuICAgICAgICAgICAgYWxsb3dJbmxpbmVLZXlkb3duKSB7XG4gICAgICAgICAgICB2YXIgaXNUaW1lT2JqID0gISFzZWxmLnRpbWVDb250YWluZXIgJiZcbiAgICAgICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuY29udGFpbnMoZXZlbnRUYXJnZXQpO1xuICAgICAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNUaW1lT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2N1c0FuZENsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RGF0ZShlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBmb2N1c0FuZENsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBjYXNlIDQ2OlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJbnB1dCAmJiAhc2VsZi5jb25maWcuYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbGVhcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1RpbWVPYmogJiYgIWlzSW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3RpdmVFbGVtZW50ID0gZ2V0Q2xvc2VzdEFjdGl2ZUVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhbGxvd0lucHV0ID09PSBmYWxzZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYWN0aXZlRWxlbWVudCAmJiBpc0luVmlldyhhY3RpdmVFbGVtZW50KSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhXzEgPSBlLmtleUNvZGUgPT09IDM5ID8gMSA6IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZS5jdHJsS2V5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uRGF5KHVuZGVmaW5lZCwgZGVsdGFfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1vbnRoKGRlbHRhXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uRGF5KGdldEZpcnN0QXZhaWxhYmxlRGF5KDEpLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VsZi5ob3VyRWxlbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YSA9IGUua2V5Q29kZSA9PT0gNDAgPyAxIDogLTE7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2VsZi5kYXlzQ29udGFpbmVyICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldC4kaSAhPT0gdW5kZWZpbmVkKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRUYXJnZXQgPT09IHNlbGYuaW5wdXQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmFsdElucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5jdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VZZWFyKHNlbGYuY3VycmVudFllYXIgLSBkZWx0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPbkRheShnZXRGaXJzdEF2YWlsYWJsZURheSgxKSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghaXNUaW1lT2JqKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25EYXkodW5kZWZpbmVkLCBkZWx0YSAqIDcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50VGFyZ2V0ID09PSBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlWWVhcihzZWxmLmN1cnJlbnRZZWFyIC0gZGVsdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLmVuYWJsZVRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNUaW1lT2JqICYmIHNlbGYuaG91ckVsZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZShlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RlYm91bmNlZENoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVGltZU9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1zID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFtUE0sXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChzZWxmLnBsdWdpbkVsZW1lbnRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBlbGVtcy5pbmRleE9mKGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlbGVtc1tpICsgKGUuc2hpZnRLZXkgPyAtMSA6IDEpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRhcmdldCB8fCBzZWxmLl9pbnB1dCkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghc2VsZi5jb25maWcubm9DYWxlbmRhciAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIuY29udGFpbnMoZXZlbnRUYXJnZXQpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmFtUE0gIT09IHVuZGVmaW5lZCAmJiBldmVudFRhcmdldCA9PT0gc2VsZi5hbVBNKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxmLmwxMG4uYW1QTVswXS5jaGFyQXQoMCk6XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxmLmwxMG4uYW1QTVswXS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKTpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hbVBNLnRleHRDb250ZW50ID0gc2VsZi5sMTBuLmFtUE1bMF07XG4gICAgICAgICAgICAgICAgICAgIHNldEhvdXJzRnJvbUlucHV0cygpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGYubDEwbi5hbVBNWzFdLmNoYXJBdCgwKTpcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGYubDEwbi5hbVBNWzFdLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFtUE0udGV4dENvbnRlbnQgPSBzZWxmLmwxMG4uYW1QTVsxXTtcbiAgICAgICAgICAgICAgICAgICAgc2V0SG91cnNGcm9tSW5wdXRzKCk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc0lucHV0IHx8IGlzQ2FsZW5kYXJFbGVtKGV2ZW50VGFyZ2V0KSkge1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25LZXlEb3duXCIsIGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uTW91c2VPdmVyKGVsZW0sIGNlbGxDbGFzcykge1xuICAgICAgICBpZiAoY2VsbENsYXNzID09PSB2b2lkIDApIHsgY2VsbENsYXNzID0gXCJmbGF0cGlja3ItZGF5XCI7IH1cbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggIT09IDEgfHxcbiAgICAgICAgICAgIChlbGVtICYmXG4gICAgICAgICAgICAgICAgKCFlbGVtLmNsYXNzTGlzdC5jb250YWlucyhjZWxsQ2xhc3MpIHx8XG4gICAgICAgICAgICAgICAgICAgIGVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiZmxhdHBpY2tyLWRpc2FibGVkXCIpKSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBob3ZlckRhdGUgPSBlbGVtXG4gICAgICAgICAgICA/IGVsZW0uZGF0ZU9iai5nZXRUaW1lKClcbiAgICAgICAgICAgIDogc2VsZi5kYXlzLmZpcnN0RWxlbWVudENoaWxkLmRhdGVPYmouZ2V0VGltZSgpLCBpbml0aWFsRGF0ZSA9IHNlbGYucGFyc2VEYXRlKHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgdW5kZWZpbmVkLCB0cnVlKS5nZXRUaW1lKCksIHJhbmdlU3RhcnREYXRlID0gTWF0aC5taW4oaG92ZXJEYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0uZ2V0VGltZSgpKSwgcmFuZ2VFbmREYXRlID0gTWF0aC5tYXgoaG92ZXJEYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0uZ2V0VGltZSgpKTtcbiAgICAgICAgdmFyIGNvbnRhaW5zRGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIG1pblJhbmdlID0gMCwgbWF4UmFuZ2UgPSAwO1xuICAgICAgICBmb3IgKHZhciB0ID0gcmFuZ2VTdGFydERhdGU7IHQgPCByYW5nZUVuZERhdGU7IHQgKz0gZHVyYXRpb24uREFZKSB7XG4gICAgICAgICAgICBpZiAoIWlzRW5hYmxlZChuZXcgRGF0ZSh0KSwgdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb250YWluc0Rpc2FibGVkID1cbiAgICAgICAgICAgICAgICAgICAgY29udGFpbnNEaXNhYmxlZCB8fCAodCA+IHJhbmdlU3RhcnREYXRlICYmIHQgPCByYW5nZUVuZERhdGUpO1xuICAgICAgICAgICAgICAgIGlmICh0IDwgaW5pdGlhbERhdGUgJiYgKCFtaW5SYW5nZSB8fCB0ID4gbWluUmFuZ2UpKVxuICAgICAgICAgICAgICAgICAgICBtaW5SYW5nZSA9IHQ7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodCA+IGluaXRpYWxEYXRlICYmICghbWF4UmFuZ2UgfHwgdCA8IG1heFJhbmdlKSlcbiAgICAgICAgICAgICAgICAgICAgbWF4UmFuZ2UgPSB0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBob3ZlcmFibGVDZWxscyA9IEFycmF5LmZyb20oc2VsZi5yQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIqOm50aC1jaGlsZCgtbitcIiArIHNlbGYuY29uZmlnLnNob3dNb250aHMgKyBcIikgPiAuXCIgKyBjZWxsQ2xhc3MpKTtcbiAgICAgICAgaG92ZXJhYmxlQ2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoZGF5RWxlbSkge1xuICAgICAgICAgICAgdmFyIGRhdGUgPSBkYXlFbGVtLmRhdGVPYmo7XG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gZGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICB2YXIgb3V0T2ZSYW5nZSA9IChtaW5SYW5nZSA+IDAgJiYgdGltZXN0YW1wIDwgbWluUmFuZ2UpIHx8XG4gICAgICAgICAgICAgICAgKG1heFJhbmdlID4gMCAmJiB0aW1lc3RhbXAgPiBtYXhSYW5nZSk7XG4gICAgICAgICAgICBpZiAob3V0T2ZSYW5nZSkge1xuICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LmFkZChcIm5vdEFsbG93ZWRcIik7XG4gICAgICAgICAgICAgICAgW1wiaW5SYW5nZVwiLCBcInN0YXJ0UmFuZ2VcIiwgXCJlbmRSYW5nZVwiXS5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LnJlbW92ZShjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb250YWluc0Rpc2FibGVkICYmICFvdXRPZlJhbmdlKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIFtcInN0YXJ0UmFuZ2VcIiwgXCJpblJhbmdlXCIsIFwiZW5kUmFuZ2VcIiwgXCJub3RBbGxvd2VkXCJdLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5yZW1vdmUoYyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChlbGVtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoaG92ZXJEYXRlIDw9IHNlbGYuc2VsZWN0ZWREYXRlc1swXS5nZXRUaW1lKClcbiAgICAgICAgICAgICAgICAgICAgPyBcInN0YXJ0UmFuZ2VcIlxuICAgICAgICAgICAgICAgICAgICA6IFwiZW5kUmFuZ2VcIik7XG4gICAgICAgICAgICAgICAgaWYgKGluaXRpYWxEYXRlIDwgaG92ZXJEYXRlICYmIHRpbWVzdGFtcCA9PT0gaW5pdGlhbERhdGUpXG4gICAgICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LmFkZChcInN0YXJ0UmFuZ2VcIik7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaW5pdGlhbERhdGUgPiBob3ZlckRhdGUgJiYgdGltZXN0YW1wID09PSBpbml0aWFsRGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QuYWRkKFwiZW5kUmFuZ2VcIik7XG4gICAgICAgICAgICAgICAgaWYgKHRpbWVzdGFtcCA+PSBtaW5SYW5nZSAmJlxuICAgICAgICAgICAgICAgICAgICAobWF4UmFuZ2UgPT09IDAgfHwgdGltZXN0YW1wIDw9IG1heFJhbmdlKSAmJlxuICAgICAgICAgICAgICAgICAgICBpc0JldHdlZW4odGltZXN0YW1wLCBpbml0aWFsRGF0ZSwgaG92ZXJEYXRlKSlcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QuYWRkKFwiaW5SYW5nZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uUmVzaXplKCkge1xuICAgICAgICBpZiAoc2VsZi5pc09wZW4gJiYgIXNlbGYuY29uZmlnLnN0YXRpYyAmJiAhc2VsZi5jb25maWcuaW5saW5lKVxuICAgICAgICAgICAgcG9zaXRpb25DYWxlbmRhcigpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvcGVuKGUsIHBvc2l0aW9uRWxlbWVudCkge1xuICAgICAgICBpZiAocG9zaXRpb25FbGVtZW50ID09PSB2b2lkIDApIHsgcG9zaXRpb25FbGVtZW50ID0gc2VsZi5fcG9zaXRpb25FbGVtZW50OyB9XG4gICAgICAgIGlmIChzZWxmLmlzTW9iaWxlID09PSB0cnVlKSB7XG4gICAgICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5jbGljaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25PcGVuXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuX2lucHV0LmRpc2FibGVkIHx8IHNlbGYuY29uZmlnLmlubGluZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB3YXNPcGVuID0gc2VsZi5pc09wZW47XG4gICAgICAgIHNlbGYuaXNPcGVuID0gdHJ1ZTtcbiAgICAgICAgaWYgKCF3YXNPcGVuKSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgc2VsZi5faW5wdXQuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uT3BlblwiKTtcbiAgICAgICAgICAgIHBvc2l0aW9uQ2FsZW5kYXIocG9zaXRpb25FbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSA9PT0gdHJ1ZSAmJiBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyID09PSB0cnVlKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuYWxsb3dJbnB1dCA9PT0gZmFsc2UgJiZcbiAgICAgICAgICAgICAgICAoZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgICAgICFzZWxmLnRpbWVDb250YWluZXIuY29udGFpbnMoZS5yZWxhdGVkVGFyZ2V0KSkpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuaG91ckVsZW1lbnQuc2VsZWN0KCk7IH0sIDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBtaW5NYXhEYXRlU2V0dGVyKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICAgICAgICB2YXIgZGF0ZU9iaiA9IChzZWxmLmNvbmZpZ1tcIl9cIiArIHR5cGUgKyBcIkRhdGVcIl0gPSBzZWxmLnBhcnNlRGF0ZShkYXRlLCBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KSk7XG4gICAgICAgICAgICB2YXIgaW52ZXJzZURhdGVPYmogPSBzZWxmLmNvbmZpZ1tcIl9cIiArICh0eXBlID09PSBcIm1pblwiID8gXCJtYXhcIiA6IFwibWluXCIpICsgXCJEYXRlXCJdO1xuICAgICAgICAgICAgaWYgKGRhdGVPYmogIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGZbdHlwZSA9PT0gXCJtaW5cIiA/IFwibWluRGF0ZUhhc1RpbWVcIiA6IFwibWF4RGF0ZUhhc1RpbWVcIl0gPVxuICAgICAgICAgICAgICAgICAgICBkYXRlT2JqLmdldEhvdXJzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlT2JqLmdldE1pbnV0ZXMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmouZ2V0U2Vjb25kcygpID4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSBzZWxmLnNlbGVjdGVkRGF0ZXMuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBpc0VuYWJsZWQoZCk7IH0pO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCAmJiB0eXBlID09PSBcIm1pblwiKVxuICAgICAgICAgICAgICAgICAgICBzZXRIb3Vyc0Zyb21EYXRlKGRhdGVPYmopO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVZhbHVlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgcmVkcmF3KCk7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGVPYmogIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhckVsZW1lbnRbdHlwZV0gPSBkYXRlT2JqLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXJFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSh0eXBlKTtcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudC5kaXNhYmxlZCA9XG4gICAgICAgICAgICAgICAgICAgICEhaW52ZXJzZURhdGVPYmogJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmogIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJzZURhdGVPYmouZ2V0RnVsbFllYXIoKSA9PT0gZGF0ZU9iai5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBwYXJzZUNvbmZpZygpIHtcbiAgICAgICAgdmFyIGJvb2xPcHRzID0gW1xuICAgICAgICAgICAgXCJ3cmFwXCIsXG4gICAgICAgICAgICBcIndlZWtOdW1iZXJzXCIsXG4gICAgICAgICAgICBcImFsbG93SW5wdXRcIixcbiAgICAgICAgICAgIFwiYWxsb3dJbnZhbGlkUHJlbG9hZFwiLFxuICAgICAgICAgICAgXCJjbGlja09wZW5zXCIsXG4gICAgICAgICAgICBcInRpbWVfMjRoclwiLFxuICAgICAgICAgICAgXCJlbmFibGVUaW1lXCIsXG4gICAgICAgICAgICBcIm5vQ2FsZW5kYXJcIixcbiAgICAgICAgICAgIFwiYWx0SW5wdXRcIixcbiAgICAgICAgICAgIFwic2hvcnRoYW5kQ3VycmVudE1vbnRoXCIsXG4gICAgICAgICAgICBcImlubGluZVwiLFxuICAgICAgICAgICAgXCJzdGF0aWNcIixcbiAgICAgICAgICAgIFwiZW5hYmxlU2Vjb25kc1wiLFxuICAgICAgICAgICAgXCJkaXNhYmxlTW9iaWxlXCIsXG4gICAgICAgIF07XG4gICAgICAgIHZhciB1c2VyQ29uZmlnID0gX19hc3NpZ24oX19hc3NpZ24oe30sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZWxlbWVudC5kYXRhc2V0IHx8IHt9KSkpLCBpbnN0YW5jZUNvbmZpZyk7XG4gICAgICAgIHZhciBmb3JtYXRzID0ge307XG4gICAgICAgIHNlbGYuY29uZmlnLnBhcnNlRGF0ZSA9IHVzZXJDb25maWcucGFyc2VEYXRlO1xuICAgICAgICBzZWxmLmNvbmZpZy5mb3JtYXREYXRlID0gdXNlckNvbmZpZy5mb3JtYXREYXRlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwiZW5hYmxlXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX2VuYWJsZTsgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWcuX2VuYWJsZSA9IHBhcnNlRGF0ZVJ1bGVzKGRhdGVzKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwiZGlzYWJsZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9kaXNhYmxlOyB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5fZGlzYWJsZSA9IHBhcnNlRGF0ZVJ1bGVzKGRhdGVzKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgdGltZU1vZGUgPSB1c2VyQ29uZmlnLm1vZGUgPT09IFwidGltZVwiO1xuICAgICAgICBpZiAoIXVzZXJDb25maWcuZGF0ZUZvcm1hdCAmJiAodXNlckNvbmZpZy5lbmFibGVUaW1lIHx8IHRpbWVNb2RlKSkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHREYXRlRm9ybWF0ID0gZmxhdHBpY2tyLmRlZmF1bHRDb25maWcuZGF0ZUZvcm1hdCB8fCBkZWZhdWx0T3B0aW9ucy5kYXRlRm9ybWF0O1xuICAgICAgICAgICAgZm9ybWF0cy5kYXRlRm9ybWF0ID1cbiAgICAgICAgICAgICAgICB1c2VyQ29uZmlnLm5vQ2FsZW5kYXIgfHwgdGltZU1vZGVcbiAgICAgICAgICAgICAgICAgICAgPyBcIkg6aVwiICsgKHVzZXJDb25maWcuZW5hYmxlU2Vjb25kcyA/IFwiOlNcIiA6IFwiXCIpXG4gICAgICAgICAgICAgICAgICAgIDogZGVmYXVsdERhdGVGb3JtYXQgKyBcIiBIOmlcIiArICh1c2VyQ29uZmlnLmVuYWJsZVNlY29uZHMgPyBcIjpTXCIgOiBcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXNlckNvbmZpZy5hbHRJbnB1dCAmJlxuICAgICAgICAgICAgKHVzZXJDb25maWcuZW5hYmxlVGltZSB8fCB0aW1lTW9kZSkgJiZcbiAgICAgICAgICAgICF1c2VyQ29uZmlnLmFsdEZvcm1hdCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRBbHRGb3JtYXQgPSBmbGF0cGlja3IuZGVmYXVsdENvbmZpZy5hbHRGb3JtYXQgfHwgZGVmYXVsdE9wdGlvbnMuYWx0Rm9ybWF0O1xuICAgICAgICAgICAgZm9ybWF0cy5hbHRGb3JtYXQgPVxuICAgICAgICAgICAgICAgIHVzZXJDb25maWcubm9DYWxlbmRhciB8fCB0aW1lTW9kZVxuICAgICAgICAgICAgICAgICAgICA/IFwiaDppXCIgKyAodXNlckNvbmZpZy5lbmFibGVTZWNvbmRzID8gXCI6UyBLXCIgOiBcIiBLXCIpXG4gICAgICAgICAgICAgICAgICAgIDogZGVmYXVsdEFsdEZvcm1hdCArIChcIiBoOmlcIiArICh1c2VyQ29uZmlnLmVuYWJsZVNlY29uZHMgPyBcIjpTXCIgOiBcIlwiKSArIFwiIEtcIik7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcIm1pbkRhdGVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fbWluRGF0ZTsgfSxcbiAgICAgICAgICAgIHNldDogbWluTWF4RGF0ZVNldHRlcihcIm1pblwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJtYXhEYXRlXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX21heERhdGU7IH0sXG4gICAgICAgICAgICBzZXQ6IG1pbk1heERhdGVTZXR0ZXIoXCJtYXhcIiksXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgbWluTWF4VGltZVNldHRlciA9IGZ1bmN0aW9uICh0eXBlKSB7IHJldHVybiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZ1t0eXBlID09PSBcIm1pblwiID8gXCJfbWluVGltZVwiIDogXCJfbWF4VGltZVwiXSA9IHNlbGYucGFyc2VEYXRlKHZhbCwgXCJIOmk6U1wiKTtcbiAgICAgICAgfTsgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcIm1pblRpbWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fbWluVGltZTsgfSxcbiAgICAgICAgICAgIHNldDogbWluTWF4VGltZVNldHRlcihcIm1pblwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJtYXhUaW1lXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX21heFRpbWU7IH0sXG4gICAgICAgICAgICBzZXQ6IG1pbk1heFRpbWVTZXR0ZXIoXCJtYXhcIiksXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlckNvbmZpZy5tb2RlID09PSBcInRpbWVcIikge1xuICAgICAgICAgICAgc2VsZi5jb25maWcubm9DYWxlbmRhciA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5lbmFibGVUaW1lID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuYXNzaWduKHNlbGYuY29uZmlnLCBmb3JtYXRzLCB1c2VyQ29uZmlnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib29sT3B0cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHNlbGYuY29uZmlnW2Jvb2xPcHRzW2ldXSA9XG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWdbYm9vbE9wdHNbaV1dID09PSB0cnVlIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW2Jvb2xPcHRzW2ldXSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIEhPT0tTLmZpbHRlcihmdW5jdGlvbiAoaG9vaykgeyByZXR1cm4gc2VsZi5jb25maWdbaG9va10gIT09IHVuZGVmaW5lZDsgfSkuZm9yRWFjaChmdW5jdGlvbiAoaG9vaykge1xuICAgICAgICAgICAgc2VsZi5jb25maWdbaG9va10gPSBhcnJheWlmeShzZWxmLmNvbmZpZ1tob29rXSB8fCBbXSkubWFwKGJpbmRUb0luc3RhbmNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYuaXNNb2JpbGUgPVxuICAgICAgICAgICAgIXNlbGYuY29uZmlnLmRpc2FibGVNb2JpbGUgJiZcbiAgICAgICAgICAgICAgICAhc2VsZi5jb25maWcuaW5saW5lICYmXG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWcubW9kZSA9PT0gXCJzaW5nbGVcIiAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy5kaXNhYmxlLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy5lbmFibGUgJiZcbiAgICAgICAgICAgICAgICAhc2VsZi5jb25maWcud2Vla051bWJlcnMgJiZcbiAgICAgICAgICAgICAgICAvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5jb25maWcucGx1Z2lucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHBsdWdpbkNvbmYgPSBzZWxmLmNvbmZpZy5wbHVnaW5zW2ldKHNlbGYpIHx8IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHBsdWdpbkNvbmYpIHtcbiAgICAgICAgICAgICAgICBpZiAoSE9PS1MuaW5kZXhPZihrZXkpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWdba2V5XSA9IGFycmF5aWZ5KHBsdWdpbkNvbmZba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoYmluZFRvSW5zdGFuY2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHNlbGYuY29uZmlnW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdXNlckNvbmZpZ1trZXldID09PSBcInVuZGVmaW5lZFwiKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1trZXldID0gcGx1Z2luQ29uZltrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdXNlckNvbmZpZy5hbHRJbnB1dENsYXNzKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5hbHRJbnB1dENsYXNzID1cbiAgICAgICAgICAgICAgICBnZXRJbnB1dEVsZW0oKS5jbGFzc05hbWUgKyBcIiBcIiArIHNlbGYuY29uZmlnLmFsdElucHV0Q2xhc3M7XG4gICAgICAgIH1cbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25QYXJzZUNvbmZpZ1wiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0SW5wdXRFbGVtKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5jb25maWcud3JhcFxuICAgICAgICAgICAgPyBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1pbnB1dF1cIilcbiAgICAgICAgICAgIDogZWxlbWVudDtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0dXBMb2NhbGUoKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZi5jb25maWcubG9jYWxlICE9PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICB0eXBlb2YgZmxhdHBpY2tyLmwxMG5zW3NlbGYuY29uZmlnLmxvY2FsZV0gPT09IFwidW5kZWZpbmVkXCIpXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5lcnJvckhhbmRsZXIobmV3IEVycm9yKFwiZmxhdHBpY2tyOiBpbnZhbGlkIGxvY2FsZSBcIiArIHNlbGYuY29uZmlnLmxvY2FsZSkpO1xuICAgICAgICBzZWxmLmwxMG4gPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmxhdHBpY2tyLmwxMG5zLmRlZmF1bHQpLCAodHlwZW9mIHNlbGYuY29uZmlnLmxvY2FsZSA9PT0gXCJvYmplY3RcIlxuICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5sb2NhbGVcbiAgICAgICAgICAgIDogc2VsZi5jb25maWcubG9jYWxlICE9PSBcImRlZmF1bHRcIlxuICAgICAgICAgICAgICAgID8gZmxhdHBpY2tyLmwxMG5zW3NlbGYuY29uZmlnLmxvY2FsZV1cbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCkpO1xuICAgICAgICB0b2tlblJlZ2V4LkQgPSBcIihcIiArIHNlbGYubDEwbi53ZWVrZGF5cy5zaG9ydGhhbmQuam9pbihcInxcIikgKyBcIilcIjtcbiAgICAgICAgdG9rZW5SZWdleC5sID0gXCIoXCIgKyBzZWxmLmwxMG4ud2Vla2RheXMubG9uZ2hhbmQuam9pbihcInxcIikgKyBcIilcIjtcbiAgICAgICAgdG9rZW5SZWdleC5NID0gXCIoXCIgKyBzZWxmLmwxMG4ubW9udGhzLnNob3J0aGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4LkYgPSBcIihcIiArIHNlbGYubDEwbi5tb250aHMubG9uZ2hhbmQuam9pbihcInxcIikgKyBcIilcIjtcbiAgICAgICAgdG9rZW5SZWdleC5LID0gXCIoXCIgKyBzZWxmLmwxMG4uYW1QTVswXSArIFwifFwiICsgc2VsZi5sMTBuLmFtUE1bMV0gKyBcInxcIiArIHNlbGYubDEwbi5hbVBNWzBdLnRvTG93ZXJDYXNlKCkgKyBcInxcIiArIHNlbGYubDEwbi5hbVBNWzFdLnRvTG93ZXJDYXNlKCkgKyBcIilcIjtcbiAgICAgICAgdmFyIHVzZXJDb25maWcgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgaW5zdGFuY2VDb25maWcpLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVsZW1lbnQuZGF0YXNldCB8fCB7fSkpKTtcbiAgICAgICAgaWYgKHVzZXJDb25maWcudGltZV8yNGhyID09PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnLnRpbWVfMjRociA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy50aW1lXzI0aHIgPSBzZWxmLmwxMG4udGltZV8yNGhyO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuZm9ybWF0RGF0ZSA9IGNyZWF0ZURhdGVGb3JtYXR0ZXIoc2VsZik7XG4gICAgICAgIHNlbGYucGFyc2VEYXRlID0gY3JlYXRlRGF0ZVBhcnNlcih7IGNvbmZpZzogc2VsZi5jb25maWcsIGwxMG46IHNlbGYubDEwbiB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcG9zaXRpb25DYWxlbmRhcihjdXN0b21Qb3NpdGlvbkVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLmNvbmZpZy5wb3NpdGlvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdm9pZCBzZWxmLmNvbmZpZy5wb3NpdGlvbihzZWxmLCBjdXN0b21Qb3NpdGlvbkVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNhbGVuZGFyQ29udGFpbmVyID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uUHJlQ2FsZW5kYXJQb3NpdGlvblwiKTtcbiAgICAgICAgdmFyIHBvc2l0aW9uRWxlbWVudCA9IGN1c3RvbVBvc2l0aW9uRWxlbWVudCB8fCBzZWxmLl9wb3NpdGlvbkVsZW1lbnQ7XG4gICAgICAgIHZhciBjYWxlbmRhckhlaWdodCA9IEFycmF5LnByb3RvdHlwZS5yZWR1Y2UuY2FsbChzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNoaWxkcmVuLCAoZnVuY3Rpb24gKGFjYywgY2hpbGQpIHsgcmV0dXJuIGFjYyArIGNoaWxkLm9mZnNldEhlaWdodDsgfSksIDApLCBjYWxlbmRhcldpZHRoID0gc2VsZi5jYWxlbmRhckNvbnRhaW5lci5vZmZzZXRXaWR0aCwgY29uZmlnUG9zID0gc2VsZi5jb25maWcucG9zaXRpb24uc3BsaXQoXCIgXCIpLCBjb25maWdQb3NWZXJ0aWNhbCA9IGNvbmZpZ1Bvc1swXSwgY29uZmlnUG9zSG9yaXpvbnRhbCA9IGNvbmZpZ1Bvcy5sZW5ndGggPiAxID8gY29uZmlnUG9zWzFdIDogbnVsbCwgaW5wdXRCb3VuZHMgPSBwb3NpdGlvbkVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIGRpc3RhbmNlRnJvbUJvdHRvbSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGlucHV0Qm91bmRzLmJvdHRvbSwgc2hvd09uVG9wID0gY29uZmlnUG9zVmVydGljYWwgPT09IFwiYWJvdmVcIiB8fFxuICAgICAgICAgICAgKGNvbmZpZ1Bvc1ZlcnRpY2FsICE9PSBcImJlbG93XCIgJiZcbiAgICAgICAgICAgICAgICBkaXN0YW5jZUZyb21Cb3R0b20gPCBjYWxlbmRhckhlaWdodCAmJlxuICAgICAgICAgICAgICAgIGlucHV0Qm91bmRzLnRvcCA+IGNhbGVuZGFySGVpZ2h0KTtcbiAgICAgICAgdmFyIHRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCArXG4gICAgICAgICAgICBpbnB1dEJvdW5kcy50b3AgK1xuICAgICAgICAgICAgKCFzaG93T25Ub3AgPyBwb3NpdGlvbkVsZW1lbnQub2Zmc2V0SGVpZ2h0ICsgMiA6IC1jYWxlbmRhckhlaWdodCAtIDIpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93VG9wXCIsICFzaG93T25Ub3ApO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93Qm90dG9tXCIsIHNob3dPblRvcCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5pbmxpbmUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBsZWZ0ID0gd2luZG93LnBhZ2VYT2Zmc2V0ICsgaW5wdXRCb3VuZHMubGVmdDtcbiAgICAgICAgdmFyIGlzQ2VudGVyID0gZmFsc2U7XG4gICAgICAgIHZhciBpc1JpZ2h0ID0gZmFsc2U7XG4gICAgICAgIGlmIChjb25maWdQb3NIb3Jpem9udGFsID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICBsZWZ0IC09IChjYWxlbmRhcldpZHRoIC0gaW5wdXRCb3VuZHMud2lkdGgpIC8gMjtcbiAgICAgICAgICAgIGlzQ2VudGVyID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb25maWdQb3NIb3Jpem9udGFsID09PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgIGxlZnQgLT0gY2FsZW5kYXJXaWR0aCAtIGlucHV0Qm91bmRzLndpZHRoO1xuICAgICAgICAgICAgaXNSaWdodCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhcnJvd0xlZnRcIiwgIWlzQ2VudGVyICYmICFpc1JpZ2h0KTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhcnJvd0NlbnRlclwiLCBpc0NlbnRlcik7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dSaWdodFwiLCBpc1JpZ2h0KTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gd2luZG93LmRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGggLVxuICAgICAgICAgICAgKHdpbmRvdy5wYWdlWE9mZnNldCArIGlucHV0Qm91bmRzLnJpZ2h0KTtcbiAgICAgICAgdmFyIHJpZ2h0TW9zdCA9IGxlZnQgKyBjYWxlbmRhcldpZHRoID4gd2luZG93LmRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGg7XG4gICAgICAgIHZhciBjZW50ZXJNb3N0ID0gcmlnaHQgKyBjYWxlbmRhcldpZHRoID4gd2luZG93LmRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGg7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwicmlnaHRNb3N0XCIsIHJpZ2h0TW9zdCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5zdGF0aWMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUudG9wID0gdG9wICsgXCJweFwiO1xuICAgICAgICBpZiAoIXJpZ2h0TW9zdCkge1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gbGVmdCArIFwicHhcIjtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmlnaHQgPSBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghY2VudGVyTW9zdCkge1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCJhdXRvXCI7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnJpZ2h0ID0gcmlnaHQgKyBcInB4XCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZG9jID0gZ2V0RG9jdW1lbnRTdHlsZVNoZWV0KCk7XG4gICAgICAgICAgICBpZiAoZG9jID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIGJvZHlXaWR0aCA9IHdpbmRvdy5kb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgdmFyIGNlbnRlckxlZnQgPSBNYXRoLm1heCgwLCBib2R5V2lkdGggLyAyIC0gY2FsZW5kYXJXaWR0aCAvIDIpO1xuICAgICAgICAgICAgdmFyIGNlbnRlckJlZm9yZSA9IFwiLmZsYXRwaWNrci1jYWxlbmRhci5jZW50ZXJNb3N0OmJlZm9yZVwiO1xuICAgICAgICAgICAgdmFyIGNlbnRlckFmdGVyID0gXCIuZmxhdHBpY2tyLWNhbGVuZGFyLmNlbnRlck1vc3Q6YWZ0ZXJcIjtcbiAgICAgICAgICAgIHZhciBjZW50ZXJJbmRleCA9IGRvYy5jc3NSdWxlcy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgY2VudGVyU3R5bGUgPSBcIntsZWZ0OlwiICsgaW5wdXRCb3VuZHMubGVmdCArIFwicHg7cmlnaHQ6YXV0bzt9XCI7XG4gICAgICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcInJpZ2h0TW9zdFwiLCBmYWxzZSk7XG4gICAgICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImNlbnRlck1vc3RcIiwgdHJ1ZSk7XG4gICAgICAgICAgICBkb2MuaW5zZXJ0UnVsZShjZW50ZXJCZWZvcmUgKyBcIixcIiArIGNlbnRlckFmdGVyICsgY2VudGVyU3R5bGUsIGNlbnRlckluZGV4KTtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUubGVmdCA9IGNlbnRlckxlZnQgKyBcInB4XCI7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnJpZ2h0ID0gXCJhdXRvXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0RG9jdW1lbnRTdHlsZVNoZWV0KCkge1xuICAgICAgICB2YXIgZWRpdGFibGVTaGVldCA9IG51bGw7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jdW1lbnQuc3R5bGVTaGVldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzaGVldCA9IGRvY3VtZW50LnN0eWxlU2hlZXRzW2ldO1xuICAgICAgICAgICAgaWYgKCFzaGVldC5jc3NSdWxlcylcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc2hlZXQuY3NzUnVsZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlZGl0YWJsZVNoZWV0ID0gc2hlZXQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWRpdGFibGVTaGVldCAhPSBudWxsID8gZWRpdGFibGVTaGVldCA6IGNyZWF0ZVN0eWxlU2hlZXQoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY3JlYXRlU3R5bGVTaGVldCgpIHtcbiAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgICAgcmV0dXJuIHN0eWxlLnNoZWV0O1xuICAgIH1cbiAgICBmdW5jdGlvbiByZWRyYXcoKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5ub0NhbGVuZGFyIHx8IHNlbGYuaXNNb2JpbGUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpO1xuICAgICAgICBidWlsZERheXMoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZm9jdXNBbmRDbG9zZSgpIHtcbiAgICAgICAgc2VsZi5faW5wdXQuZm9jdXMoKTtcbiAgICAgICAgaWYgKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFXCIpICE9PSAtMSB8fFxuICAgICAgICAgICAgbmF2aWdhdG9yLm1zTWF4VG91Y2hQb2ludHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2V0VGltZW91dChzZWxmLmNsb3NlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzZWxlY3REYXRlKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB2YXIgaXNTZWxlY3RhYmxlID0gZnVuY3Rpb24gKGRheSkge1xuICAgICAgICAgICAgcmV0dXJuIGRheS5jbGFzc0xpc3QgJiZcbiAgICAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZmxhdHBpY2tyLWRheVwiKSAmJlxuICAgICAgICAgICAgICAgICFkYXkuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZmxhdHBpY2tyLWRpc2FibGVkXCIpICYmXG4gICAgICAgICAgICAgICAgIWRheS5jbGFzc0xpc3QuY29udGFpbnMoXCJub3RBbGxvd2VkXCIpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgdCA9IGZpbmRQYXJlbnQoZ2V0RXZlbnRUYXJnZXQoZSksIGlzU2VsZWN0YWJsZSk7XG4gICAgICAgIGlmICh0ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciB0YXJnZXQgPSB0O1xuICAgICAgICB2YXIgc2VsZWN0ZWREYXRlID0gKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID0gbmV3IERhdGUodGFyZ2V0LmRhdGVPYmouZ2V0VGltZSgpKSk7XG4gICAgICAgIHZhciBzaG91bGRDaGFuZ2VNb250aCA9IChzZWxlY3RlZERhdGUuZ2V0TW9udGgoKSA8IHNlbGYuY3VycmVudE1vbnRoIHx8XG4gICAgICAgICAgICBzZWxlY3RlZERhdGUuZ2V0TW9udGgoKSA+XG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggKyBzZWxmLmNvbmZpZy5zaG93TW9udGhzIC0gMSkgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIjtcbiAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVFbGVtID0gdGFyZ2V0O1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJzaW5nbGVcIilcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IFtzZWxlY3RlZERhdGVdO1xuICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcIm11bHRpcGxlXCIpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gaXNEYXRlU2VsZWN0ZWQoc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEluZGV4KVxuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5zcGxpY2UocGFyc2VJbnQoc2VsZWN0ZWRJbmRleCksIDEpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5wdXNoKHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIHNlbGYuY2xlYXIoZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID0gc2VsZWN0ZWREYXRlO1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnB1c2goc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgICAgIGlmIChjb21wYXJlRGF0ZXMoc2VsZWN0ZWREYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0sIHRydWUpICE9PSAwKVxuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLmdldFRpbWUoKSAtIGIuZ2V0VGltZSgpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBzZXRIb3Vyc0Zyb21JbnB1dHMoKTtcbiAgICAgICAgaWYgKHNob3VsZENoYW5nZU1vbnRoKSB7XG4gICAgICAgICAgICB2YXIgaXNOZXdZZWFyID0gc2VsZi5jdXJyZW50WWVhciAhPT0gc2VsZWN0ZWREYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0gc2VsZWN0ZWREYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IHNlbGVjdGVkRGF0ZS5nZXRNb250aCgpO1xuICAgICAgICAgICAgaWYgKGlzTmV3WWVhcikge1xuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uWWVhckNoYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBidWlsZE1vbnRoU3dpdGNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk1vbnRoQ2hhbmdlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHVwZGF0ZU5hdmlnYXRpb25DdXJyZW50TW9udGgoKTtcbiAgICAgICAgYnVpbGREYXlzKCk7XG4gICAgICAgIHVwZGF0ZVZhbHVlKCk7XG4gICAgICAgIGlmICghc2hvdWxkQ2hhbmdlTW9udGggJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIiAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcuc2hvd01vbnRocyA9PT0gMSlcbiAgICAgICAgICAgIGZvY3VzT25EYXlFbGVtKHRhcmdldCk7XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuc2VsZWN0ZWREYXRlRWxlbSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlRWxlbSAmJiBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5ob3VyRWxlbWVudCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCAhPT0gdW5kZWZpbmVkICYmIHNlbGYuaG91ckVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmNsb3NlT25TZWxlY3QpIHtcbiAgICAgICAgICAgIHZhciBzaW5nbGUgPSBzZWxmLmNvbmZpZy5tb2RlID09PSBcInNpbmdsZVwiICYmICFzZWxmLmNvbmZpZy5lbmFibGVUaW1lO1xuICAgICAgICAgICAgdmFyIHJhbmdlID0gc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiICYmXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMiAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy5lbmFibGVUaW1lO1xuICAgICAgICAgICAgaWYgKHNpbmdsZSB8fCByYW5nZSkge1xuICAgICAgICAgICAgICAgIGZvY3VzQW5kQ2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyQ2hhbmdlKCk7XG4gICAgfVxuICAgIHZhciBDQUxMQkFDS1MgPSB7XG4gICAgICAgIGxvY2FsZTogW3NldHVwTG9jYWxlLCB1cGRhdGVXZWVrZGF5c10sXG4gICAgICAgIHNob3dNb250aHM6IFtidWlsZE1vbnRocywgc2V0Q2FsZW5kYXJXaWR0aCwgYnVpbGRXZWVrZGF5c10sXG4gICAgICAgIG1pbkRhdGU6IFtqdW1wVG9EYXRlXSxcbiAgICAgICAgbWF4RGF0ZTogW2p1bXBUb0RhdGVdLFxuICAgICAgICBwb3NpdGlvbkVsZW1lbnQ6IFt1cGRhdGVQb3NpdGlvbkVsZW1lbnRdLFxuICAgICAgICBjbGlja09wZW5zOiBbXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLmNsaWNrT3BlbnMgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJmb2N1c1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICAgICAgICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImNsaWNrXCIsIHNlbGYub3Blbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5faW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNlbGYub3Blbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9O1xuICAgIGZ1bmN0aW9uIHNldChvcHRpb24sIHZhbHVlKSB7XG4gICAgICAgIGlmIChvcHRpb24gIT09IG51bGwgJiYgdHlwZW9mIG9wdGlvbiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihzZWxmLmNvbmZpZywgb3B0aW9uKTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvcHRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoQ0FMTEJBQ0tTW2tleV0gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgQ0FMTEJBQ0tTW2tleV0uZm9yRWFjaChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCgpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnW29wdGlvbl0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChDQUxMQkFDS1Nbb3B0aW9uXSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIENBTExCQUNLU1tvcHRpb25dLmZvckVhY2goZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgoKTsgfSk7XG4gICAgICAgICAgICBlbHNlIGlmIChIT09LUy5pbmRleE9mKG9wdGlvbikgPiAtMSlcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1tvcHRpb25dID0gYXJyYXlpZnkodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgICAgIHVwZGF0ZVZhbHVlKHRydWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRTZWxlY3RlZERhdGUoaW5wdXREYXRlLCBmb3JtYXQpIHtcbiAgICAgICAgdmFyIGRhdGVzID0gW107XG4gICAgICAgIGlmIChpbnB1dERhdGUgaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAgICAgIGRhdGVzID0gaW5wdXREYXRlLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gc2VsZi5wYXJzZURhdGUoZCwgZm9ybWF0KTsgfSk7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0RGF0ZSBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGlucHV0RGF0ZSA9PT0gXCJudW1iZXJcIilcbiAgICAgICAgICAgIGRhdGVzID0gW3NlbGYucGFyc2VEYXRlKGlucHV0RGF0ZSwgZm9ybWF0KV07XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dERhdGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoc2VsZi5jb25maWcubW9kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzaW5nbGVcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwidGltZVwiOlxuICAgICAgICAgICAgICAgICAgICBkYXRlcyA9IFtzZWxmLnBhcnNlRGF0ZShpbnB1dERhdGUsIGZvcm1hdCldO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibXVsdGlwbGVcIjpcbiAgICAgICAgICAgICAgICAgICAgZGF0ZXMgPSBpbnB1dERhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdChzZWxmLmNvbmZpZy5jb25qdW5jdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHNlbGYucGFyc2VEYXRlKGRhdGUsIGZvcm1hdCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicmFuZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgZGF0ZXMgPSBpbnB1dERhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdChzZWxmLmwxMG4ucmFuZ2VTZXBhcmF0b3IpXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBzZWxmLnBhcnNlRGF0ZShkYXRlLCBmb3JtYXQpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgc2VsZi5jb25maWcuZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihcIkludmFsaWQgZGF0ZSBzdXBwbGllZDogXCIgKyBKU09OLnN0cmluZ2lmeShpbnB1dERhdGUpKSk7XG4gICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IChzZWxmLmNvbmZpZy5hbGxvd0ludmFsaWRQcmVsb2FkXG4gICAgICAgICAgICA/IGRhdGVzXG4gICAgICAgICAgICA6IGRhdGVzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZCBpbnN0YW5jZW9mIERhdGUgJiYgaXNFbmFibGVkKGQsIGZhbHNlKTsgfSkpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKVxuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEuZ2V0VGltZSgpIC0gYi5nZXRUaW1lKCk7IH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXREYXRlKGRhdGUsIHRyaWdnZXJDaGFuZ2UsIGZvcm1hdCkge1xuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSA9PT0gdm9pZCAwKSB7IHRyaWdnZXJDaGFuZ2UgPSBmYWxzZTsgfVxuICAgICAgICBpZiAoZm9ybWF0ID09PSB2b2lkIDApIHsgZm9ybWF0ID0gc2VsZi5jb25maWcuZGF0ZUZvcm1hdDsgfVxuICAgICAgICBpZiAoKGRhdGUgIT09IDAgJiYgIWRhdGUpIHx8IChkYXRlIGluc3RhbmNlb2YgQXJyYXkgJiYgZGF0ZS5sZW5ndGggPT09IDApKVxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuY2xlYXIodHJpZ2dlckNoYW5nZSk7XG4gICAgICAgIHNldFNlbGVjdGVkRGF0ZShkYXRlLCBmb3JtYXQpO1xuICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXNbc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICBzZWxmLnJlZHJhdygpO1xuICAgICAgICBqdW1wVG9EYXRlKHVuZGVmaW5lZCwgdHJpZ2dlckNoYW5nZSk7XG4gICAgICAgIHNldEhvdXJzRnJvbURhdGUoKTtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHNlbGYuY2xlYXIoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHVwZGF0ZVZhbHVlKHRyaWdnZXJDaGFuZ2UpO1xuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSlcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2hhbmdlXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwYXJzZURhdGVSdWxlcyhhcnIpIHtcbiAgICAgICAgcmV0dXJuIGFyclxuICAgICAgICAgICAgLnNsaWNlKClcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcnVsZSA9PT0gXCJzdHJpbmdcIiB8fFxuICAgICAgICAgICAgICAgIHR5cGVvZiBydWxlID09PSBcIm51bWJlclwiIHx8XG4gICAgICAgICAgICAgICAgcnVsZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5wYXJzZURhdGUocnVsZSwgdW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJ1bGUgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgcnVsZSA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgICAgIHJ1bGUuZnJvbSAmJlxuICAgICAgICAgICAgICAgIHJ1bGUudG8pXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogc2VsZi5wYXJzZURhdGUocnVsZS5mcm9tLCB1bmRlZmluZWQpLFxuICAgICAgICAgICAgICAgICAgICB0bzogc2VsZi5wYXJzZURhdGUocnVsZS50bywgdW5kZWZpbmVkKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJ1bGU7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0dXBEYXRlcygpIHtcbiAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gW107XG4gICAgICAgIHNlbGYubm93ID0gc2VsZi5wYXJzZURhdGUoc2VsZi5jb25maWcubm93KSB8fCBuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgcHJlbG9hZGVkRGF0ZSA9IHNlbGYuY29uZmlnLmRlZmF1bHREYXRlIHx8XG4gICAgICAgICAgICAoKHNlbGYuaW5wdXQubm9kZU5hbWUgPT09IFwiSU5QVVRcIiB8fFxuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQubm9kZU5hbWUgPT09IFwiVEVYVEFSRUFcIikgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnBsYWNlaG9sZGVyICYmXG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSA9PT0gc2VsZi5pbnB1dC5wbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgID8gbnVsbFxuICAgICAgICAgICAgICAgIDogc2VsZi5pbnB1dC52YWx1ZSk7XG4gICAgICAgIGlmIChwcmVsb2FkZWREYXRlKVxuICAgICAgICAgICAgc2V0U2VsZWN0ZWREYXRlKHByZWxvYWRlZERhdGUsIHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICBzZWxmLl9pbml0aWFsRGF0ZSA9XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID4gMFxuICAgICAgICAgICAgICAgID8gc2VsZi5zZWxlY3RlZERhdGVzWzBdXG4gICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0VGltZSgpID4gc2VsZi5ub3cuZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWluRGF0ZVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1heERhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heERhdGUuZ2V0VGltZSgpIDwgc2VsZi5ub3cuZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLm1heERhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIDogc2VsZi5ub3c7XG4gICAgICAgIHNlbGYuY3VycmVudFllYXIgPSBzZWxmLl9pbml0aWFsRGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IHNlbGYuX2luaXRpYWxEYXRlLmdldE1vbnRoKCk7XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID4gMClcbiAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID0gc2VsZi5zZWxlY3RlZERhdGVzWzBdO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubWluVGltZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5jb25maWcubWluVGltZSA9IHNlbGYucGFyc2VEYXRlKHNlbGYuY29uZmlnLm1pblRpbWUsIFwiSDppXCIpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubWF4VGltZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5jb25maWcubWF4VGltZSA9IHNlbGYucGFyc2VEYXRlKHNlbGYuY29uZmlnLm1heFRpbWUsIFwiSDppXCIpO1xuICAgICAgICBzZWxmLm1pbkRhdGVIYXNUaW1lID1cbiAgICAgICAgICAgICEhc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgICAgIChzZWxmLmNvbmZpZy5taW5EYXRlLmdldEhvdXJzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0TWludXRlcygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5EYXRlLmdldFNlY29uZHMoKSA+IDApO1xuICAgICAgICBzZWxmLm1heERhdGVIYXNUaW1lID1cbiAgICAgICAgICAgICEhc2VsZi5jb25maWcubWF4RGF0ZSAmJlxuICAgICAgICAgICAgICAgIChzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEhvdXJzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heERhdGUuZ2V0TWludXRlcygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldFNlY29uZHMoKSA+IDApO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cElucHV0cygpIHtcbiAgICAgICAgc2VsZi5pbnB1dCA9IGdldElucHV0RWxlbSgpO1xuICAgICAgICBpZiAoIXNlbGYuaW5wdXQpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVycm9ySGFuZGxlcihuZXcgRXJyb3IoXCJJbnZhbGlkIGlucHV0IGVsZW1lbnQgc3BlY2lmaWVkXCIpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmlucHV0Ll90eXBlID0gc2VsZi5pbnB1dC50eXBlO1xuICAgICAgICBzZWxmLmlucHV0LnR5cGUgPSBcInRleHRcIjtcbiAgICAgICAgc2VsZi5pbnB1dC5jbGFzc0xpc3QuYWRkKFwiZmxhdHBpY2tyLWlucHV0XCIpO1xuICAgICAgICBzZWxmLl9pbnB1dCA9IHNlbGYuaW5wdXQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5hbHRJbnB1dCkge1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoc2VsZi5pbnB1dC5ub2RlTmFtZSwgc2VsZi5jb25maWcuYWx0SW5wdXRDbGFzcyk7XG4gICAgICAgICAgICBzZWxmLl9pbnB1dCA9IHNlbGYuYWx0SW5wdXQ7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnBsYWNlaG9sZGVyID0gc2VsZi5pbnB1dC5wbGFjZWhvbGRlcjtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQuZGlzYWJsZWQgPSBzZWxmLmlucHV0LmRpc2FibGVkO1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC5yZXF1aXJlZCA9IHNlbGYuaW5wdXQucmVxdWlyZWQ7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnRhYkluZGV4ID0gc2VsZi5pbnB1dC50YWJJbmRleDtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiaGlkZGVuXCIpO1xuICAgICAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5zdGF0aWMgJiYgc2VsZi5pbnB1dC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5hbHRJbnB1dCwgc2VsZi5pbnB1dC5uZXh0U2libGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5hbGxvd0lucHV0KVxuICAgICAgICAgICAgc2VsZi5faW5wdXQuc2V0QXR0cmlidXRlKFwicmVhZG9ubHlcIiwgXCJyZWFkb25seVwiKTtcbiAgICAgICAgdXBkYXRlUG9zaXRpb25FbGVtZW50KCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uRWxlbWVudCgpIHtcbiAgICAgICAgc2VsZi5fcG9zaXRpb25FbGVtZW50ID0gc2VsZi5jb25maWcucG9zaXRpb25FbGVtZW50IHx8IHNlbGYuX2lucHV0O1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cE1vYmlsZSgpIHtcbiAgICAgICAgdmFyIGlucHV0VHlwZSA9IHNlbGYuY29uZmlnLmVuYWJsZVRpbWVcbiAgICAgICAgICAgID8gc2VsZi5jb25maWcubm9DYWxlbmRhclxuICAgICAgICAgICAgICAgID8gXCJ0aW1lXCJcbiAgICAgICAgICAgICAgICA6IFwiZGF0ZXRpbWUtbG9jYWxcIlxuICAgICAgICAgICAgOiBcImRhdGVcIjtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCBzZWxmLmlucHV0LmNsYXNzTmFtZSArIFwiIGZsYXRwaWNrci1tb2JpbGVcIik7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQudGFiSW5kZXggPSAxO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnR5cGUgPSBpbnB1dFR5cGU7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQuZGlzYWJsZWQgPSBzZWxmLmlucHV0LmRpc2FibGVkO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnJlcXVpcmVkID0gc2VsZi5pbnB1dC5yZXF1aXJlZDtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5wbGFjZWhvbGRlciA9IHNlbGYuaW5wdXQucGxhY2Vob2xkZXI7XG4gICAgICAgIHNlbGYubW9iaWxlRm9ybWF0U3RyID1cbiAgICAgICAgICAgIGlucHV0VHlwZSA9PT0gXCJkYXRldGltZS1sb2NhbFwiXG4gICAgICAgICAgICAgICAgPyBcIlktbS1kXFxcXFRIOmk6U1wiXG4gICAgICAgICAgICAgICAgOiBpbnB1dFR5cGUgPT09IFwiZGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgID8gXCJZLW0tZFwiXG4gICAgICAgICAgICAgICAgICAgIDogXCJIOmk6U1wiO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQuZGVmYXVsdFZhbHVlID0gc2VsZi5tb2JpbGVJbnB1dC52YWx1ZSA9IHNlbGYuZm9ybWF0RGF0ZShzZWxmLnNlbGVjdGVkRGF0ZXNbMF0sIHNlbGYubW9iaWxlRm9ybWF0U3RyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcubWluRGF0ZSlcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQubWluID0gc2VsZi5mb3JtYXREYXRlKHNlbGYuY29uZmlnLm1pbkRhdGUsIFwiWS1tLWRcIik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhEYXRlKVxuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5tYXggPSBzZWxmLmZvcm1hdERhdGUoc2VsZi5jb25maWcubWF4RGF0ZSwgXCJZLW0tZFwiKTtcbiAgICAgICAgaWYgKHNlbGYuaW5wdXQuZ2V0QXR0cmlidXRlKFwic3RlcFwiKSlcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQuc3RlcCA9IFN0cmluZyhzZWxmLmlucHV0LmdldEF0dHJpYnV0ZShcInN0ZXBcIikpO1xuICAgICAgICBzZWxmLmlucHV0LnR5cGUgPSBcImhpZGRlblwiO1xuICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC50eXBlID0gXCJoaWRkZW5cIjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChzZWxmLmlucHV0LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLm1vYmlsZUlucHV0LCBzZWxmLmlucHV0Lm5leHRTaWJsaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoX2EpIHsgfVxuICAgICAgICBiaW5kKHNlbGYubW9iaWxlSW5wdXQsIFwiY2hhbmdlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBzZWxmLnNldERhdGUoZ2V0RXZlbnRUYXJnZXQoZSkudmFsdWUsIGZhbHNlLCBzZWxmLm1vYmlsZUZvcm1hdFN0cik7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNoYW5nZVwiKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2xvc2VcIik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0b2dnbGUoZSkge1xuICAgICAgICBpZiAoc2VsZi5pc09wZW4gPT09IHRydWUpXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5jbG9zZSgpO1xuICAgICAgICBzZWxmLm9wZW4oZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRyaWdnZXJFdmVudChldmVudCwgZGF0YSkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGhvb2tzID0gc2VsZi5jb25maWdbZXZlbnRdO1xuICAgICAgICBpZiAoaG9va3MgIT09IHVuZGVmaW5lZCAmJiBob29rcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaG9va3NbaV0gJiYgaSA8IGhvb2tzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIGhvb2tzW2ldKHNlbGYuc2VsZWN0ZWREYXRlcywgc2VsZi5pbnB1dC52YWx1ZSwgc2VsZiwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50ID09PSBcIm9uQ2hhbmdlXCIpIHtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQuZGlzcGF0Y2hFdmVudChjcmVhdGVFdmVudChcImNoYW5nZVwiKSk7XG4gICAgICAgICAgICBzZWxmLmlucHV0LmRpc3BhdGNoRXZlbnQoY3JlYXRlRXZlbnQoXCJpbnB1dFwiKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gY3JlYXRlRXZlbnQobmFtZSkge1xuICAgICAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiRXZlbnRcIik7XG4gICAgICAgIGUuaW5pdEV2ZW50KG5hbWUsIHRydWUsIHRydWUpO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNEYXRlU2VsZWN0ZWQoZGF0ZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkRGF0ZSA9IHNlbGYuc2VsZWN0ZWREYXRlc1tpXTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZERhdGUgaW5zdGFuY2VvZiBEYXRlICYmXG4gICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKHNlbGVjdGVkRGF0ZSwgZGF0ZSkgPT09IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCIgKyBpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNEYXRlSW5SYW5nZShkYXRlKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlICE9PSBcInJhbmdlXCIgfHwgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA8IDIpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiAoY29tcGFyZURhdGVzKGRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSkgPj0gMCAmJlxuICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1sxXSkgPD0gMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZU5hdmlnYXRpb25DdXJyZW50TW9udGgoKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5ub0NhbGVuZGFyIHx8IHNlbGYuaXNNb2JpbGUgfHwgIXNlbGYubW9udGhOYXYpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNlbGYueWVhckVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKHllYXJFbGVtZW50LCBpKSB7XG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKHNlbGYuY3VycmVudFllYXIsIHNlbGYuY3VycmVudE1vbnRoLCAxKTtcbiAgICAgICAgICAgIGQuc2V0TW9udGgoc2VsZi5jdXJyZW50TW9udGggKyBpKTtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5zaG93TW9udGhzID4gMSB8fFxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vbnRoU2VsZWN0b3JUeXBlID09PSBcInN0YXRpY1wiKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5tb250aEVsZW1lbnRzW2ldLnRleHRDb250ZW50ID1cbiAgICAgICAgICAgICAgICAgICAgbW9udGhUb1N0cihkLmdldE1vbnRoKCksIHNlbGYuY29uZmlnLnNob3J0aGFuZEN1cnJlbnRNb250aCwgc2VsZi5sMTBuKSArIFwiIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci52YWx1ZSA9IGQuZ2V0TW9udGgoKS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWVhckVsZW1lbnQudmFsdWUgPSBkLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYuX2hpZGVQcmV2TW9udGhBcnJvdyA9XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5EYXRlICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAoc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jdXJyZW50TW9udGggPD0gc2VsZi5jb25maWcubWluRGF0ZS5nZXRNb250aCgpXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jdXJyZW50WWVhciA8IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKSk7XG4gICAgICAgIHNlbGYuX2hpZGVOZXh0TW9udGhBcnJvdyA9XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tYXhEYXRlICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAoc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jdXJyZW50TW9udGggKyAxID4gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRNb250aCgpXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jdXJyZW50WWVhciA+IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldERhdGVTdHIoc3BlY2lmaWNGb3JtYXQpIHtcbiAgICAgICAgdmFyIGZvcm1hdCA9IHNwZWNpZmljRm9ybWF0IHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcuYWx0SW5wdXQgPyBzZWxmLmNvbmZpZy5hbHRGb3JtYXQgOiBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgcmV0dXJuIHNlbGYuc2VsZWN0ZWREYXRlc1xuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZE9iaikgeyByZXR1cm4gc2VsZi5mb3JtYXREYXRlKGRPYmosIGZvcm1hdCk7IH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChkLCBpLCBhcnIpIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmNvbmZpZy5tb2RlICE9PSBcInJhbmdlXCIgfHxcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5lbmFibGVUaW1lIHx8XG4gICAgICAgICAgICAgICAgYXJyLmluZGV4T2YoZCkgPT09IGk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuam9pbihzZWxmLmNvbmZpZy5tb2RlICE9PSBcInJhbmdlXCJcbiAgICAgICAgICAgID8gc2VsZi5jb25maWcuY29uanVuY3Rpb25cbiAgICAgICAgICAgIDogc2VsZi5sMTBuLnJhbmdlU2VwYXJhdG9yKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlVmFsdWUodHJpZ2dlckNoYW5nZSkge1xuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSA9PT0gdm9pZCAwKSB7IHRyaWdnZXJDaGFuZ2UgPSB0cnVlOyB9XG4gICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0ICE9PSB1bmRlZmluZWQgJiYgc2VsZi5tb2JpbGVGb3JtYXRTdHIpIHtcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQudmFsdWUgPVxuICAgICAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmZvcm1hdERhdGUoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmosIHNlbGYubW9iaWxlRm9ybWF0U3RyKVxuICAgICAgICAgICAgICAgICAgICA6IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSA9IGdldERhdGVTdHIoc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgIGlmIChzZWxmLmFsdElucHV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQudmFsdWUgPSBnZXREYXRlU3RyKHNlbGYuY29uZmlnLmFsdEZvcm1hdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UgIT09IGZhbHNlKVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25WYWx1ZVVwZGF0ZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb250aE5hdkNsaWNrKGUpIHtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgIHZhciBpc1ByZXZNb250aCA9IHNlbGYucHJldk1vbnRoTmF2LmNvbnRhaW5zKGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgdmFyIGlzTmV4dE1vbnRoID0gc2VsZi5uZXh0TW9udGhOYXYuY29udGFpbnMoZXZlbnRUYXJnZXQpO1xuICAgICAgICBpZiAoaXNQcmV2TW9udGggfHwgaXNOZXh0TW9udGgpIHtcbiAgICAgICAgICAgIGNoYW5nZU1vbnRoKGlzUHJldk1vbnRoID8gLTEgOiAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLnllYXJFbGVtZW50cy5pbmRleE9mKGV2ZW50VGFyZ2V0KSA+PSAwKSB7XG4gICAgICAgICAgICBldmVudFRhcmdldC5zZWxlY3QoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChldmVudFRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJhcnJvd1VwXCIpKSB7XG4gICAgICAgICAgICBzZWxmLmNoYW5nZVllYXIoc2VsZi5jdXJyZW50WWVhciArIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImFycm93RG93blwiKSkge1xuICAgICAgICAgICAgc2VsZi5jaGFuZ2VZZWFyKHNlbGYuY3VycmVudFllYXIgLSAxKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB0aW1lV3JhcHBlcihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGlzS2V5RG93biA9IGUudHlwZSA9PT0gXCJrZXlkb3duXCIsIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSksIGlucHV0ID0gZXZlbnRUYXJnZXQ7XG4gICAgICAgIGlmIChzZWxmLmFtUE0gIT09IHVuZGVmaW5lZCAmJiBldmVudFRhcmdldCA9PT0gc2VsZi5hbVBNKSB7XG4gICAgICAgICAgICBzZWxmLmFtUE0udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgIHNlbGYubDEwbi5hbVBNW2ludChzZWxmLmFtUE0udGV4dENvbnRlbnQgPT09IHNlbGYubDEwbi5hbVBNWzBdKV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1pbiA9IHBhcnNlRmxvYXQoaW5wdXQuZ2V0QXR0cmlidXRlKFwibWluXCIpKSwgbWF4ID0gcGFyc2VGbG9hdChpbnB1dC5nZXRBdHRyaWJ1dGUoXCJtYXhcIikpLCBzdGVwID0gcGFyc2VGbG9hdChpbnB1dC5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKSwgY3VyVmFsdWUgPSBwYXJzZUludChpbnB1dC52YWx1ZSwgMTApLCBkZWx0YSA9IGUuZGVsdGEgfHxcbiAgICAgICAgICAgIChpc0tleURvd24gPyAoZS53aGljaCA9PT0gMzggPyAxIDogLTEpIDogMCk7XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IGN1clZhbHVlICsgc3RlcCAqIGRlbHRhO1xuICAgICAgICBpZiAodHlwZW9mIGlucHV0LnZhbHVlICE9PSBcInVuZGVmaW5lZFwiICYmIGlucHV0LnZhbHVlLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgdmFyIGlzSG91ckVsZW0gPSBpbnB1dCA9PT0gc2VsZi5ob3VyRWxlbWVudCwgaXNNaW51dGVFbGVtID0gaW5wdXQgPT09IHNlbGYubWludXRlRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSA8IG1pbikge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID1cbiAgICAgICAgICAgICAgICAgICAgbWF4ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGludCghaXNIb3VyRWxlbSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgKGludChpc0hvdXJFbGVtKSAmJiBpbnQoIXNlbGYuYW1QTSkpO1xuICAgICAgICAgICAgICAgIGlmIChpc01pbnV0ZUVsZW0pXG4gICAgICAgICAgICAgICAgICAgIGluY3JlbWVudE51bUlucHV0KHVuZGVmaW5lZCwgLTEsIHNlbGYuaG91ckVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmV3VmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9XG4gICAgICAgICAgICAgICAgICAgIGlucHV0ID09PSBzZWxmLmhvdXJFbGVtZW50ID8gbmV3VmFsdWUgLSBtYXggLSBpbnQoIXNlbGYuYW1QTSkgOiBtaW47XG4gICAgICAgICAgICAgICAgaWYgKGlzTWludXRlRWxlbSlcbiAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtSW5wdXQodW5kZWZpbmVkLCAxLCBzZWxmLmhvdXJFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLmFtUE0gJiZcbiAgICAgICAgICAgICAgICBpc0hvdXJFbGVtICYmXG4gICAgICAgICAgICAgICAgKHN0ZXAgPT09IDFcbiAgICAgICAgICAgICAgICAgICAgPyBuZXdWYWx1ZSArIGN1clZhbHVlID09PSAyM1xuICAgICAgICAgICAgICAgICAgICA6IE1hdGguYWJzKG5ld1ZhbHVlIC0gY3VyVmFsdWUpID4gc3RlcCkpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmFtUE0udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmwxMG4uYW1QTVtpbnQoc2VsZi5hbVBNLnRleHRDb250ZW50ID09PSBzZWxmLmwxMG4uYW1QTVswXSldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBwYWQobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGluaXQoKTtcbiAgICByZXR1cm4gc2VsZjtcbn1cbmZ1bmN0aW9uIF9mbGF0cGlja3Iobm9kZUxpc3QsIGNvbmZpZykge1xuICAgIHZhciBub2RlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZVxuICAgICAgICAuY2FsbChub2RlTGlzdClcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4geCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50OyB9KTtcbiAgICB2YXIgaW5zdGFuY2VzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKFwiZGF0YS1mcC1vbWl0XCIpICE9PSBudWxsKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKG5vZGUuX2ZsYXRwaWNrciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5fZmxhdHBpY2tyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBub2RlLl9mbGF0cGlja3IgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLl9mbGF0cGlja3IgPSBGbGF0cGlja3JJbnN0YW5jZShub2RlLCBjb25maWcgfHwge30pO1xuICAgICAgICAgICAgaW5zdGFuY2VzLnB1c2gobm9kZS5fZmxhdHBpY2tyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaW5zdGFuY2VzLmxlbmd0aCA9PT0gMSA/IGluc3RhbmNlc1swXSA6IGluc3RhbmNlcztcbn1cbmlmICh0eXBlb2YgSFRNTEVsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICB0eXBlb2YgSFRNTENvbGxlY3Rpb24gIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICB0eXBlb2YgTm9kZUxpc3QgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBIVE1MQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdHBpY2tyID0gTm9kZUxpc3QucHJvdG90eXBlLmZsYXRwaWNrciA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3IodGhpcywgY29uZmlnKTtcbiAgICB9O1xuICAgIEhUTUxFbGVtZW50LnByb3RvdHlwZS5mbGF0cGlja3IgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKFt0aGlzXSwgY29uZmlnKTtcbiAgICB9O1xufVxudmFyIGZsYXRwaWNrciA9IGZ1bmN0aW9uIChzZWxlY3RvciwgY29uZmlnKSB7XG4gICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcih3aW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvciksIGNvbmZpZyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHNlbGVjdG9yIGluc3RhbmNlb2YgTm9kZSkge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcihbc2VsZWN0b3JdLCBjb25maWcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3Ioc2VsZWN0b3IsIGNvbmZpZyk7XG4gICAgfVxufTtcbmZsYXRwaWNrci5kZWZhdWx0Q29uZmlnID0ge307XG5mbGF0cGlja3IubDEwbnMgPSB7XG4gICAgZW46IF9fYXNzaWduKHt9LCBFbmdsaXNoKSxcbiAgICBkZWZhdWx0OiBfX2Fzc2lnbih7fSwgRW5nbGlzaCksXG59O1xuZmxhdHBpY2tyLmxvY2FsaXplID0gZnVuY3Rpb24gKGwxMG4pIHtcbiAgICBmbGF0cGlja3IubDEwbnMuZGVmYXVsdCA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBmbGF0cGlja3IubDEwbnMuZGVmYXVsdCksIGwxMG4pO1xufTtcbmZsYXRwaWNrci5zZXREZWZhdWx0cyA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICBmbGF0cGlja3IuZGVmYXVsdENvbmZpZyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBmbGF0cGlja3IuZGVmYXVsdENvbmZpZyksIGNvbmZpZyk7XG59O1xuZmxhdHBpY2tyLnBhcnNlRGF0ZSA9IGNyZWF0ZURhdGVQYXJzZXIoe30pO1xuZmxhdHBpY2tyLmZvcm1hdERhdGUgPSBjcmVhdGVEYXRlRm9ybWF0dGVyKHt9KTtcbmZsYXRwaWNrci5jb21wYXJlRGF0ZXMgPSBjb21wYXJlRGF0ZXM7XG5pZiAodHlwZW9mIGpRdWVyeSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgalF1ZXJ5LmZuICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgalF1ZXJ5LmZuLmZsYXRwaWNrciA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3IodGhpcywgY29uZmlnKTtcbiAgICB9O1xufVxuRGF0ZS5wcm90b3R5cGUuZnBfaW5jciA9IGZ1bmN0aW9uIChkYXlzKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMuZ2V0RnVsbFllYXIoKSwgdGhpcy5nZXRNb250aCgpLCB0aGlzLmdldERhdGUoKSArICh0eXBlb2YgZGF5cyA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlSW50KGRheXMsIDEwKSA6IGRheXMpKTtcbn07XG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbmRvdy5mbGF0cGlja3IgPSBmbGF0cGlja3I7XG59XG5leHBvcnQgZGVmYXVsdCBmbGF0cGlja3I7XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGdlbnVpbmVLZXlzKGR2RmlsZTogYW55KTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGdlbnVpbmVLZXlzOiBzdHJpbmdbXSA9IFtdXG4gICAgT2JqZWN0LmtleXMoZHZGaWxlKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmICghZ2VudWluZUtleXMubWFwKGsgPT4gay50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpLmluY2x1ZGVzKGtleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpKSB7XG4gICAgICAgICAgICBnZW51aW5lS2V5cy5wdXNoKGtleSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT09IGtleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpIHtcbiAgICAgICAgICAgICAgICBnZW51aW5lS2V5c1tnZW51aW5lS2V5cy5pbmRleE9mKGtleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpXSA9IGtleVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gZ2VudWluZUtleXNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVEdXJhdGlvbihkdkR1ckE6IGFueSwgZHZEdXJCOiBhbnkpOiBib29sZWFuIHtcbiAgICBjb25zdCBub3JtYWxpemVkQSA9IGR2RHVyQS5zaGlmdFRvKFwieWVhcnNcIiwgXCJtb250aHNcIiwgXCJ3ZWVrc1wiLCBcImRheXNcIiwgXCJob3Vyc1wiLCBcIm1pbnV0ZXNcIiwgXCJzZWNvbmRzXCIsIFwibWlsbGlzZWNvbmRzXCIpLm5vcm1hbGl6ZSgpXG4gICAgY29uc3Qgbm9ybWFsaXplZEIgPSBkdkR1ckIuc2hpZnRUbyhcInllYXJzXCIsIFwibW9udGhzXCIsIFwid2Vla3NcIiwgXCJkYXlzXCIsIFwiaG91cnNcIiwgXCJtaW51dGVzXCIsIFwic2Vjb25kc1wiLCBcIm1pbGxpc2Vjb25kc1wiKS5ub3JtYWxpemUoKVxuICAgIHJldHVybiBub3JtYWxpemVkQS5lcXVhbHMobm9ybWFsaXplZEIpXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIE5vdGljZSwgc2V0SWNvbiwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBNdWx0aUZpbGVNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvTXVsdGlGaWxlTW9kYWxcIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkT3B0aW9ucyB9IGZyb20gXCJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE11bHRpRmlsZUZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIHByaXZhdGUgZmlsZVZhbGlkYXRvckZpZWxkOiBIVE1MRGl2RWxlbWVudFxuICAgIHByaXZhdGUgZHZRdWVyeVN0cmluZzogVGV4dEFyZWFDb21wb25lbnRcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLk11bHRpRmlsZSlcbiAgICB9XG5cbiAgICBzdGF0aWMgYnVpbGRNYXJrRG93bkxpbmsocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBkZXN0RmlsZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChwYXRoLCBmaWxlLnBhdGgpXG4gICAgICAgIGlmIChkZXN0RmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHBsdWdpbi5hcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoXG4gICAgICAgICAgICAgICAgZGVzdEZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBkZXN0RmlsZS5iYXNlbmFtZVxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRGaWxlcyA9IChjdXJyZW50RmlsZT86IFRGaWxlKTogVEZpbGVbXSA9PiB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBnZXRSZXN1bHRzID0gKGFwaTogRGF0YXZpZXdQbHVnaW5bXCJhcGlcIl0pID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJkdlwiLCBcImN1cnJlbnRcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nfWApKShhcGksIGFwaS5wYWdlKGN1cnJlbnRGaWxlPy5wYXRoKSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgcXVlcnkgZm9yIGZpZWxkIDwke3RoaXMuZmllbGQubmFtZX0+XFxuY2hlY2sgeW91ciBzZXR0aW5nc2AsIDMwMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRhdGF2aWV3ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdXG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZURhdGF2aWV3SnMgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZUlubGluZURhdGF2aWV3SnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZXNQYXRoID0gZ2V0UmVzdWx0cyhkYXRhdmlldy5hcGkpLnZhbHVlcy5tYXAoKHY6IGFueSkgPT4gdi5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmlsdGVyKGYgPT4gZmlsZXNQYXRoLmluY2x1ZGVzKGYucGF0aCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogYW55LCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgTXVsdGlGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKVxuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKClcbiAgICAgICAgaWYgKE11bHRpRmlsZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtuYW1lfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE11bHRpRmlsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChNdWx0aUZpbGVGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IE11bHRpRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpO1xuICAgICAgICBjb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24oc2VhcmNoQnRuLCBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdKVxuICAgICAgICBzZWFyY2hCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpXG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICAvL2xldCBmaWVsZE1vZGFsOiBTaW5nbGVGaWxlTW9kYWw7XG4gICAgICAgIGxldCBmaWVsZE1vZGFsOiBNdWx0aUZpbGVNb2RhbDtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgc2VhcmNoQnRuLmhpZGUoKVxuICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoQnRuLnNob3coKVxuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoQnRuLmhpZGUoKVxuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlYXJjaEJ0bik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IFF1ZXJ5IChvcHRpb25hbClcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcblxuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5kdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiQWxpYXNcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pO1xuICAgICAgICBjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiUGVyc29uYWxpc2UgdGhlIHJlbmRlcmluZyBvZiB5b3VyIGxpbmtzJyBhbGlhc2VzIHdpdGggYSBmdW5jdGlvbiByZXR1cm5pbmcgYSBzdHJpbmcgKDxwYWdlPiBvYmplY3QgaXMgYXZhaWxhYmxlKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0JyB9KTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lci5jcmVhdGVFbChcImNvZGVcIiwge1xuICAgICAgICAgICAgdGV4dDogYGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIDxmdW5jdGlvbiB1c2luZyBcInBhZ2VcIj47IH1gXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGN1c3RvbVJlbmRlcmluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyKTtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcgfHwgXCJcIik7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5zZXRQbGFjZWhvbGRlcihcIkphdmFzY3JpcHQgc3RyaW5nLCBcIiArXG4gICAgICAgICAgICBcInRoZSBcXFwicGFnZVxcXCIgKGRhdGF2aWV3IHBhZ2UgdHlwZSkgdmFyaWFibGUgaXMgYXZhaWxhYmxlXFxuXCIgK1xuICAgICAgICAgICAgXCJleGFtcGxlIDE6IHBhZ2UuZmlsZS5uYW1lXFxuZXhhbXBsZSAyOiBgJHtwYWdlLmZpbGUubmFtZX0gb2YgZ2VuZGVyICR7cGFnZS5nZW5kZXJ9YFwiKVxuICAgICAgICBjdXN0b21SZW5kZXJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZyA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcihjdXN0b21SZW5kZXJpbmcpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IGN1c3RvbVNvcnRpbmdDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGN1c3RvbVNvcnRpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJTb3J0aW5nIG9yZGVyXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY3VzdG9tU29ydGluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBlcnNvbmFsaXNlIHRoZSBzb3J0aW5nIG9yZGVyIG9mIHlvdXIgbGlua3Mgd2l0aCBhIGluc3RydWN0aW9uIHRha2luZyAyIGZpbGVzIChhLCBiKSBhbmQgcmV0dXJuaW5nIC0xLCAwIG9yIDFcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbVNvcnRpbmdDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGAoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyYFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGN1c3RvbVNvcnRpbmdDb250YWluZXIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIGN1c3RvbVNvcnRpbmcuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmcgfHwgXCJcIik7XG4gICAgICAgIGN1c3RvbVNvcnRpbmcuc2V0UGxhY2Vob2xkZXIoXCJKYXZhc2NyaXB0IGluc3RydWN0aW9uLCBcIiArXG4gICAgICAgICAgICBcIihhOiBURmlsZSwgYjogVEZpbGUpOiBudW1iZXJcXG5cIiArXG4gICAgICAgICAgICBcImV4YW1wbGUgMSAoYWxwaGFiZXRpY2FsIG9yZGVyKTogYS5iYXNlbmFtZSA8IGIuYmFzZW5hbWUgPyAxIDogLTEgXFxuXCIgK1xuICAgICAgICAgICAgXCJleGFtcGxlIDIgKGNyZWF0aW9uIHRpbWUgbmV3ZXIgdG8gb2xkZXIpOiBiLnN0YXQuY3RpbWUgLSBiLnN0YXQuY3RpbWVcIilcbiAgICAgICAgY3VzdG9tU29ydGluZy5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU29ydGluZyA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcihjdXN0b21Tb3J0aW5nKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlVmFsaWRhdG9yRmllbGQgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbnVtYmVyLW9wdGlvbnNcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZUZpbGVDb250YWluZXIodGhpcy5maWxlVmFsaWRhdG9yRmllbGQpXG4gICAgICAgIHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcgfCB7IHBhdGg6IHN0cmluZyB9IHwgeyBwYXRoOiBzdHJpbmcgfVtdKTogYm9vbGVhbiB7XG4gICAgICAgIC8vdG9kbyA6IG1hbmFnZSBib3RoIHJhdyBsaW5rcyBhbmQgZHYgTGluayBvYmplY3RzXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2s6ICgpID0+IHt9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgZHZWYWx1ZSA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBBcnJheS5pc0FycmF5KGR2VmFsdWUpID8gZHZWYWx1ZSA6IFtkdlZhbHVlXVxuICAgICAgICAgICAgdmFsdWVzLmZvckVhY2goKHZhbHVlLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYScsIHsgdGV4dDogdmFsdWUucGF0aC5zcGxpdChcIi9cIikubGFzdCgpLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpIH0pO1xuICAgICAgICAgICAgICAgICAgICBsaW5rLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh2YWx1ZS5wYXRoLCBmaWxlLnBhdGgsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB2YWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGkgPCB2YWx1ZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IFwiIHwgXCIgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoKVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoLCBCdXR0b25Db21wb25lbnQsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE11bHRpRmlsZUZ1enp5U3VnZ2VzdGVyIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VEZpbGU+IHtcblxuICAgIHByaXZhdGUgc2VsZWN0ZWRGaWxlczogVEZpbGVbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsVmFsdWVPYmplY3Q6IGFueSxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVmFsdWVzOiBBcnJheTxhbnk+ID0gQXJyYXkuaXNBcnJheShpbml0aWFsVmFsdWVPYmplY3QpID8gaW5pdGlhbFZhbHVlT2JqZWN0IDogW2luaXRpYWxWYWx1ZU9iamVjdF1cbiAgICAgICAgICAgIHNlbGVjdGVkVmFsdWVzLmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHZhbHVlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHRoaXMuc2VsZWN0ZWRGaWxlcy5wdXNoKGZpbGUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5vbmtleWRvd24gPSBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09IFwiRW50ZXJcIiAmJiBlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWFjdGlvbnMtc3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgaW5mb0NvbnRhaW5lciA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItaW5mb1wiIH0pXG4gICAgICAgIGluZm9Db250YWluZXIuc2V0VGV4dChcIkFsdCtFbnRlciB0byBzYXZlXCIpXG4gICAgICAgIC8vY29uZmlybSBidXR0b25cbiAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIilcbiAgICAgICAgY29uZmlybUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH0pXG4gICAgICAgIGNvbmZpcm1CdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgLy9jYW5jZWwgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHsgdGhpcy5jbG9zZSgpOyB9KVxuICAgICAgICBjYW5jZWxCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgLy9jbGVhciB2YWx1ZSBidXR0b25cbiAgICAgICAgY29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jbGVhclZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcImRhbmdlclwiKVxuXG4gICAgICAgIHRoaXMubW9kYWxFbC5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXIpXG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZpbGVbXSB7XG4gICAgICAgIGNvbnN0IHNvcnRpbmdNZXRob2QgPSBuZXcgRnVuY3Rpb24oXCJhXCIsIFwiYlwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmd9YCkgfHwgZnVuY3Rpb24gKGE6IFRGaWxlLCBiOiBURmlsZSkgeyByZXR1cm4gYS5iYXNlbmFtZSA8IGIuYmFzZW5hbWUgPyAtMSA6IDEgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZmlsZU1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVNYW5hZ2VyLmdldEZpbGVzKHRoaXMuZmlsZSkuc29ydChzb3J0aW5nTWV0aG9kKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBpdGVtLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIGFzeW5jIHJlcGxhY2VWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuc2VsZWN0ZWRGaWxlcy5tYXAoZmlsZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICAgICAgbGV0IGFsaWFzOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKGZpbGUucGF0aCkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRk0uYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmlsZS5iYXNlbmFtZSwgYWxpYXMpXG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5qb2luKFwiLCBcIilcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0VmFsdWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuam9pbihcIiwgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc0NvbW1lbnRcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGFzeW5jIGNsZWFyVmFsdWVzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBcIlwiXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogRnV6enlNYXRjaDxURmlsZT4sIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXN1Z2dlc3Rlci1pdGVtLXdpdGgtYWxpYXNcIiB9KTtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWxhYmVsXCIgfSlcbiAgICAgICAgICAgIGxhYmVsLnNldFRleHQobmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKHZhbHVlLml0ZW0ucGF0aCkpKVxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBzdWdnZXN0aW9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXN1Z2dlc3Rlci1pdGVtLXdpdGgtYWxpYXMtZmlsZXBhdGhcIiB9KVxuICAgICAgICAgICAgZmlsZVBhdGguc2V0VGV4dCh2YWx1ZS5pdGVtLnBhdGgpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbC5zZXRUZXh0KHZhbHVlLml0ZW0uYmFzZW5hbWUpXG4gICAgICAgIH1cbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci12YWx1ZS1jb250YWluZXJcIilcbiAgICAgICAgY29uc3Qgc3BhY2VyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItdmFsdWUtY29udGFpbmVyLXNwYWNlclwiIH0pXG4gICAgICAgIGVsLmFwcGVuZENoaWxkKHNwYWNlcilcblxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzLnNvbWUoZmlsZSA9PiBmaWxlLnBhdGggPT09IHZhbHVlLml0ZW0ucGF0aCkpIHtcbiAgICAgICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3RlZFwiKVxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIgfSlcbiAgICAgICAgICAgIHNldEljb24oaWNvbkNvbnRhaW5lciwgXCJjaGVjay1jaXJjbGVcIilcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlclNlbGVjdGVkKCkge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlclxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogSFRNTERpdkVsZW1lbnRbXSA9IGNob29zZXIuc3VnZ2VzdGlvbnNcbiAgICAgICAgY29uc3QgdmFsdWVzOiBGdXp6eU1hdGNoPFRGaWxlPltdID0gY2hvb3Nlci52YWx1ZXNcblxuICAgICAgICBzdWdnZXN0aW9ucy5mb3JFYWNoKChzLCBpKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzLnNvbWUoZmlsZSA9PiBmaWxlLnBhdGggPT09IHZhbHVlc1tpXS5pdGVtLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgcy5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0ZWRcIilcbiAgICAgICAgICAgICAgICBpZiAocy5xdWVyeVNlbGVjdG9yQWxsKFwiLm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWljb25cIikubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHMuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWljb25cIiB9KVxuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzLnJlbW92ZUNsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3RlZFwiKVxuICAgICAgICAgICAgICAgIHMucXVlcnlTZWxlY3RvckFsbChcIi5tZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIpLmZvckVhY2goaWNvbiA9PiBpY29uLnJlbW92ZSgpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbih2YWx1ZTogRnV6enlNYXRjaDxURmlsZT4sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaWxlcy5pbmNsdWRlcyh2YWx1ZS5pdGVtKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZpbGVzLnJlbW92ZSh2YWx1ZS5pdGVtKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZpbGVzLnB1c2godmFsdWUuaXRlbSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlclNlbGVjdGVkKClcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZUl0ZW0oaXRlbTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHsgfVxuXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0QXJlYUNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgU3RhdHVzIH0gZnJvbSBcInNyYy90eXBlcy9sb29rdXBUeXBlc1wiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcbmltcG9ydCB7IHVwZGF0ZUxvb2t1cHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3VwZGF0ZUxvb2t1cHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTG9va3VwRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBsb29rdXBWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5Mb29rdXApXG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2VcbiAgICB9XG5cbiAgICBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlICYmIHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGYgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4O1xuICAgICAgICAgICAgY29uc3QgaWQgPSBgJHtmaWxlLnBhdGh9X18ke3RoaXMuZmllbGQubmFtZX1gO1xuICAgICAgICAgICAgbGV0IHN0YXR1czogU3RhdHVzO1xuICAgICAgICAgICAgc3RhdHVzID0gZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLmdldChpZCkgfHwgU3RhdHVzLmNoYW5nZWRcbiAgICAgICAgICAgIC8vZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUgaXMgdXBkYXRlZCBhZnRlciBmaWxlQ2xhc3MgY2hhbmdlIGNhY2hlIHJlc29sdXRpb24gc28gd29uJ3QgYmUgdHJpZ2dlcmVkIHByb3Blcmx5LiBcbiAgICAgICAgICAgIC8vd2UgYW50aWNpcGF0ZSB0aGlzIGNoYW5nZSBzbyB0aGF0IHRoZSB1cGRhdGUgYnV0dG9uIGFwcGVhcnNcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmdldChgJHtmaWxlLnBhdGh9X19yZWxhdGVkX18ke3RoaXMuZmllbGQuZmlsZUNsYXNzTmFtZX1fX18ke3RoaXMuZmllbGQubmFtZX1gKSAhPT1cbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZVxuICAgICAgICAgICAgKSBzdGF0dXMgPSBTdGF0dXMuY2hhbmdlZFxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQgPyBcInJlZnJlc2gtY2N3XCIgOiBcImZpbGUtY2hlY2tcIlxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4geyB1cGRhdGVMb29rdXBzKHRoaXMucGx1Z2luLCBcInNpbmdsZV9jb21tYW5kXCIsIHsgZmlsZTogZmlsZSwgZmllbGROYW1lOiB0aGlzLmZpZWxkLm5hbWUgfSkgfVxuICAgICAgICAgICAgaWYgKExvb2t1cEZpZWxkLmlzTWVudShsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oaWNvbik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pICYmIHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKExvb2t1cEZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSAmJiBzdGF0dXMgPT09IFN0YXR1cy51cFRvRGF0ZSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uLCAoKSA9PiB7IH0sIGAke25hbWV9IGlzIHVwIHRvIGRhdGVgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihcInNlcnZlci1jb2dcIiwgKCkgPT4geyB9LCBgJHtuYW1lfSBpcyBhdXRvLXVwZGF0ZWRgLCBcImRpc2FibGVkXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vbm8gZmllbGQgbW9kYWwsIHdlIGluY2x1ZGUgdGhlIGZpZWxkIGRpcmVjdGx5XG4gICAgICAgIGlmIChsaW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY3JlYXRlRHZGaWVsZChkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyB9KTogdm9pZCB7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGRpc3BsYXlTZWxlY3RlZE91dHB1dE9wdGlvbkNvbnRhaW5lcihvcHRpb25Db250YWluZXJzOiBbQXJyYXk8a2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlPiwgSFRNTEVsZW1lbnQgfCB1bmRlZmluZWRdW10sIHZhbHVlOiBrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGUpIHtcbiAgICAgICAgb3B0aW9uQ29udGFpbmVycy5mb3JFYWNoKG9wdGlvbnNfc2V0ID0+IHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zX3NldFswXS5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zX3NldFsxXT8uc2hvdygpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNfc2V0WzFdPy5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgZGlzcGxheVZhbHVlKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZywgb25DbGlja2VkID0gKCkgPT4geyB9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpPy5maWxlQ2xhc3NOYW1lIHx8IFwicHJlc2V0RmllbGRcIlxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuZ2V0KGAke2ZpbGUucGF0aH1fX3JlbGF0ZWRfXyR7ZmlsZUNsYXNzTmFtZX1fX18ke2ZpZWxkTmFtZX1gKSB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgZGlzcGxheVNlbGVjdGVkT3V0cHV0V2FybmluZ0NvbnRhaW5lcihvcHRpb25XYXJuaW5nQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgdmFsdWU6IGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSkge1xuICAgICAgICBbTG9va3VwLlR5cGUuTGlua3NCdWxsZXRMaXN0LnRvU3RyaW5nKCksIExvb2t1cC5UeXBlLkN1c3RvbUJ1bGxldExpc3QudG9TdHJpbmcoKV0uaW5jbHVkZXModmFsdWUpID9cbiAgICAgICAgICAgIG9wdGlvbldhcm5pbmdDb250YWluZXIuc2hvdygpIDogb3B0aW9uV2FybmluZ0NvbnRhaW5lci5oaWRlKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVMb29rdXBDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuXG4gICAgICAgIGNvbnN0IGF1dG9VcGRhdGVDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGF1dG9VcGRhdGVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJBdXRvIHVwZGF0ZSB0aGlzIGZpZWxkIFwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIGF1dG9VcGRhdGVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJUaGlzIGNvdWxkIGxlYWQgdG8gbGF0ZW5jaWVzIGRlcGVuZGluZyBvbiB0aGUgcXVlcmllc1wiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0IHdhcm5pbmcnIH0pO1xuICAgICAgICBjb25zdCBhdXRvVXBkYXRlID0gbmV3IFRvZ2dsZUNvbXBvbmVudChhdXRvVXBkYXRlQ29udGFpbmVyKTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlID09PSB1bmRlZmluZWQpIHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlID0gdHJ1ZVxuICAgICAgICBhdXRvVXBkYXRlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlKTtcbiAgICAgICAgYXV0b1VwZGF0ZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuYXV0b1VwZGF0ZSA9IHZhbHVlXG4gICAgICAgIH0pXG5cblxuXG4gICAgICAgIGNvbnN0IGR2UXVlcnlTdHJpbmdDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGR2UXVlcnlTdHJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJQYWdlcyB0byBsb29rIGZvciBpbiB5b3VyIHZhdWx0IChEYXRhdmlld0pTIFF1ZXJ5KVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIGR2UXVlcnlTdHJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRhdmlld0pTIHF1ZXJ5IG9mIHRoZSBmb3JtIGBkdi5wYWdlcyguLi4pYFwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0JyB9KTtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChkdlF1ZXJ5U3RyaW5nQ29udGFpbmVyKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgZHZRdWVyeVN0cmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBkdlF1ZXJ5U3RyaW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nIHx8IFwiXCIpO1xuICAgICAgICBkdlF1ZXJ5U3RyaW5nLnNldFBsYWNlaG9sZGVyKFwiZXhhbXBlOiBkdi5wYWdlcygnI3N0dWRlbnQnKVwiKVxuXG4gICAgICAgIGR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoZHZRdWVyeVN0cmluZyk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgdGFyZ2V0RmllbGRDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRhcmdldEZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiTmFtZSBvZiB0aGUgcmVsYXRlZCBmaWVsZFwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIHRhcmdldEZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiZmllbGQgaW4gdGhlIHRhcmdldCBwYWdlcyB0aGF0IGNvbnRhaW5zIGEgbGluayB0byB0aGUgcGFnZSB3aGVyZSB0aGlzIGxvb2t1cCBmaWVsZCBpc1wiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0JyB9KTtcbiAgICAgICAgY29uc3QgdGFyZ2V0RmllbGROYW1lID0gbmV3IFRleHRDb21wb25lbnQodGFyZ2V0RmllbGRDb250YWluZXIpO1xuICAgICAgICB0YXJnZXRGaWVsZE5hbWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnRhcmdldEZpZWxkTmFtZSB8fCBcIlwiKTtcbiAgICAgICAgdGFyZ2V0RmllbGROYW1lLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy50YXJnZXRGaWVsZE5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGFyZ2V0RmllbGROYW1lKVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vbG9va3VwIHR5cGUgc2VsZWN0b3JcbiAgICAgICAgY29uc3Qgb3V0cHV0VHlwZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLm91dHB1dFR5cGUgPSB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSB8fCBMb29rdXAuVHlwZS5MaW5rc0xpc3RcbiAgICAgICAgb3V0cHV0VHlwZUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlR5cGUgb2Ygb3V0cHV0XCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY29uc3Qgb3V0cHV0VHlwZUxpc3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQob3V0cHV0VHlwZUNvbnRhaW5lcik7XG4gICAgICAgIE9iamVjdC5rZXlzKExvb2t1cC5UeXBlKS5mb3JFYWNoKChvdXRwdXRUeXBlOiBrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGUpID0+IHtcbiAgICAgICAgICAgIG91dHB1dFR5cGVMaXN0LmFkZE9wdGlvbihvdXRwdXRUeXBlLCBMb29rdXAuRGVzY3JpcHRpb25bb3V0cHV0VHlwZV0pXG4gICAgICAgIH0pXG4gICAgICAgIG91dHB1dFR5cGVMaXN0LnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlKVxuXG4gICAgICAgIGNvbnN0IG91dHB1dFdhcm5pbmdDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG91dHB1dFdhcm5pbmdDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgICAgIHRleHQ6XG4gICAgICAgICAgICAgICAgXCJXYXJuaW5nOiB0aGlzIG1heSBvdmVycmlkZSBzb21lIGxpbmVzIHVuZGVyIHlvdXIgbGlzdC4gXCIgK1xuICAgICAgICAgICAgICAgIFwiVGhlcmUgc2hvdWxkbid0IGJlIGFuIGV4dHJhIG1hbnVhbCBpdGVtIGluIHRoZSBsaXN0IHRoYXQgaXMgYXV0b21hdGljYWxseSBcIiArXG4gICAgICAgICAgICAgICAgXCJyZW5kZXJlZCBieSB0aGlzIGZpZWxkOiBpdCB3b3VsZCBiZSBvdmVycmlkZW4gYWZ0ZXIgZWFjaCBmaWVsZCBpbmRleGluZ1wiLFxuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXdhcm5pbmdcIlxuICAgICAgICB9KTtcblxuICAgICAgICAvL0J1aWx0IGluIHN1bW1hcml6bmcgZnVuY3Rpb24gb3B0aW9uc1xuICAgICAgICBjb25zdCBidWlsdGluT3B0aW9uc0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uQ29udGFpbmVyID0gYnVpbHRpbk9wdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiA9IHRoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiB8fCBMb29rdXAuRGVmYXVsdC5CdWlsdGluU3VtbWFyaXppbmdcbiAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25MYWJlbC5CdWlsdGluU3VtbWFyaXppbmcsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvblwiIH0pO1xuICAgICAgICBjb25zdCBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25MaXN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIE9iamVjdC5rZXlzKExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmcpLmZvckVhY2goKGJ1aWx0aW5GdW5jdGlvbjoga2V5b2YgdHlwZW9mIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmcpID0+IHtcbiAgICAgICAgICAgIGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkxpc3QuYWRkT3B0aW9uKGJ1aWx0aW5GdW5jdGlvbiwgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ1tidWlsdGluRnVuY3Rpb25dKVxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IGJ1aWx0aW5PcHRpb25zRGVzY3JpcHRpb25Db250YWluZXIgPSBidWlsdGluT3B0aW9uc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dFwiIH0pO1xuICAgICAgICBjb25zdCBidWlsdGluRnVuY3Rpb24gPSB0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gYXMga2V5b2YgdHlwZW9mIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdcbiAgICAgICAgYnVpbHRpbk9wdGlvbnNEZXNjcmlwdGlvbkNvbnRhaW5lci5zZXRUZXh0KExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbkRlc2NyaXB0aW9uW2J1aWx0aW5GdW5jdGlvbl0ucmVwbGFjZShcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XCIsIHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lKSlcblxuICAgICAgICBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25MaXN0LnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbilcbiAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uTGlzdC5vbkNoYW5nZSgodmFsdWU6IGtleW9mIHR5cGVvZiBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gPSB2YWx1ZVxuICAgICAgICAgICAgYnVpbHRpbk9wdGlvbnNEZXNjcmlwdGlvbkNvbnRhaW5lci5zZXRUZXh0KExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbkRlc2NyaXB0aW9uW3ZhbHVlXS5yZXBsYWNlKFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cIiwgdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUpKVxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IHN1bW1hcml6ZWRGaWVsZE5hbWVDb250YWluZXIgPSBidWlsdGluT3B0aW9uc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUgPSB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZVxuICAgICAgICBzdW1tYXJpemVkRmllbGROYW1lQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU3VtbWFyaXplZCBmaWVsZCBuYW1lXCIsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvblwiIH0pO1xuICAgICAgICBzdW1tYXJpemVkRmllbGROYW1lQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiTmFtZSBvZiB0aGUgZmllbGQgY29udGFpbmluZyBzdW1tYXJpemVkIHZhbHVlIHVzZWQgZm9yIHRoZSBzdW1tYXJpemluZyBmdW5jdGlvblwiLCBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dFwiIH0pO1xuICAgICAgICBjb25zdCBzdW1tYXJpemVkRmllbGROYW1lID0gbmV3IFRleHRDb21wb25lbnQoc3VtbWFyaXplZEZpZWxkTmFtZUNvbnRhaW5lcik7XG4gICAgICAgIHN1bW1hcml6ZWRGaWVsZE5hbWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUpXG4gICAgICAgIHN1bW1hcml6ZWRGaWVsZE5hbWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUgPSB2YWx1ZVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIEN1c3RvbSBsaXN0IGZ1bmN0aW9uIG9wdGlvbnNcbiAgICAgICAgY29uc3Qgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb25Db250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24gPSB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9uIHx8IExvb2t1cC5EZWZhdWx0LkN1c3RvbUxpc3RcbiAgICAgICAgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb25Db250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogTG9va3VwLk9wdGlvbkxhYmVsLkN1c3RvbUxpc3QsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvblwiIH0pO1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lci5jcmVhdGVFbChcImNvZGVcIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uU3ViTGFiZWwuQ3VzdG9tTGlzdCwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXN1YnRleHRcIiB9KVxuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbiA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLnNldFBsYWNlaG9sZGVyKExvb2t1cC5IZWxwZXIuQ3VzdG9tTGlzdClcbiAgICAgICAgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb24uc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbUxpc3RGdW5jdGlvbilcbiAgICAgICAgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb24uaW5wdXRFbC5jb2xzID0gNjU7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24gPSB2YWx1ZVxuICAgICAgICB9KVxuXG5cbiAgICAgICAgY29uc3Qgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb24gPSB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU3VtbWFyaXppbmdGdW5jdGlvbiB8fCBMb29rdXAuRGVmYXVsdC5DdXN0b21TdW1tYXJpemluZ1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25MYWJlbC5DdXN0b21TdW1tYXJpemluZywgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSk7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Db250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHsgdGV4dDogTG9va3VwLk9wdGlvblN1YkxhYmVsLkN1c3RvbVN1bW1hcml6aW5nLCBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dFwiIH0pXG4gICAgICAgIGNvbnN0IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24gPSBuZXcgVGV4dEFyZWFDb21wb25lbnQob3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24uc2V0UGxhY2Vob2xkZXIoTG9va3VwLkhlbHBlci5DdXN0b21TdW1tYXJpemluZylcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU3VtbWFyaXppbmdGdW5jdGlvbilcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5pbnB1dEVsLnJvd3MgPSA4O1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBvcHRpb25Db250YWluZXJzOiBbQXJyYXk8a2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlPiwgSFRNTEVsZW1lbnQgfCB1bmRlZmluZWRdW10gPSBbXG4gICAgICAgICAgICBbW1wiTGlua3NMaXN0XCIsIFwiTGlua3NCdWxsZXRMaXN0XCJdLCB1bmRlZmluZWRdLFxuICAgICAgICAgICAgW1tcIkJ1aWx0aW5TdW1tYXJpemluZ1wiXSwgYnVpbHRpbk9wdGlvbnNDb250YWluZXJdLFxuICAgICAgICAgICAgW1tcIkN1c3RvbUxpc3RcIiwgXCJDdXN0b21CdWxsZXRMaXN0XCJdLCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lcl0sXG4gICAgICAgICAgICBbW1wiQ3VzdG9tU3VtbWFyaXppbmdcIl0sIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Db250YWluZXJdXG4gICAgICAgIF1cblxuICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dE9wdGlvbkNvbnRhaW5lcihvcHRpb25Db250YWluZXJzLCBvdXRwdXRUeXBlTGlzdC5nZXRWYWx1ZSgpIGFzIGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSlcbiAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRPdXRwdXRXYXJuaW5nQ29udGFpbmVyKG91dHB1dFdhcm5pbmdDb250YWluZXIsIG91dHB1dFR5cGVMaXN0LmdldFZhbHVlKCkgYXMga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKVxuXG4gICAgICAgIG91dHB1dFR5cGVMaXN0Lm9uQ2hhbmdlKCh2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRPdXRwdXRPcHRpb25Db250YWluZXIob3B0aW9uQ29udGFpbmVycywgdmFsdWUpXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dFdhcm5pbmdDb250YWluZXIob3V0cHV0V2FybmluZ0NvbnRhaW5lciwgdmFsdWUpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMubG9va3VwVmFsaWRhdG9yRmllbGQgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbnVtYmVyLW9wdGlvbnNcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZUxvb2t1cENvbnRhaW5lcih0aGlzLmxvb2t1cFZhbGlkYXRvckZpZWxkKVxuICAgICAgICB0aGlzLmxvb2t1cFZhbGlkYXRvckZpZWxkLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgc2hvcnREZXNjcmlwdGlvbiA9IExvb2t1cC5TaG9ydERlc2NyaXB0aW9uW3RoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlIGFzIExvb2t1cC5UeXBlXVxuICAgICAgICBsZXQgY29tcGxlbWVudDogc3RyaW5nID0gXCJcIlxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLm91dHB1dFR5cGUgPT09IExvb2t1cC5UeXBlLkJ1aWx0aW5TdW1tYXJpemluZykge1xuICAgICAgICAgICAgY29tcGxlbWVudCA9IGAgJHt0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb259YCArXG4gICAgICAgICAgICAgICAgYCR7dGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uICE9PSBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nLkNvdW50QWxsID8gXCIgXCIgKyB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSA6IFwiXCJ9YFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaG9ydERlc2NyaXB0aW9uICsgY29tcGxlbWVudFxuICAgIH1cblxuICAgIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0ICogYXMgTG9va3VwIGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcbmltcG9ydCB7IGdldFZhbHVlcyB9IGZyb20gXCIuL2dldFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCIuL3JlcGxhY2VWYWx1ZXNcIjtcblxuZnVuY3Rpb24gYXJyYXlzQXNTdHJpbmdBcmVFcXVhbChhOiBzdHJpbmcsIGI6IHN0cmluZykge1xuICAgIGNvbnN0IGFBc0FycmF5ID0gYS5zcGxpdChcIixcIikubWFwKHYgPT4gdi50cmltKCkpXG4gICAgY29uc3QgYkFzQXJyYXkgPSBiLnNwbGl0KFwiLFwiKS5tYXAodiA9PiB2LnRyaW0oKSlcbiAgICByZXR1cm4gYUFzQXJyYXkuZXZlcnkoaXRlbSA9PiBiQXNBcnJheS5pbmNsdWRlcyhpdGVtKSkgJiYgYkFzQXJyYXkuZXZlcnkoaXRlbSA9PiBhQXNBcnJheS5pbmNsdWRlcyhpdGVtKSlcbn1cblxuYXN5bmMgZnVuY3Rpb24gcGFyc2VGaWVsZFZhbHVlcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3QgcmF3VmFsdWUgPSAoYXdhaXQgZ2V0VmFsdWVzKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lKSk/LlswXVxuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgPGRpdiBoaWRkZW4gaWQ9XFxcIiR7ZmllbGROYW1lfV92YWx1ZXNcXFwiPig/PHZhbHVlcz4uKik8L2Rpdj5gKVxuICAgIGNvbnN0IGZSID0gcmF3VmFsdWUubWF0Y2gocmVnZXgpXG4gICAgcmV0dXJuIGZSPy5ncm91cHM/LnZhbHVlcyB8fCByYXdWYWx1ZVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlTG9va3VwcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBzb3VyY2U6IHN0cmluZyA9IFwiXCIsXG4gICAgZm9yY2VVcGRhdGVPbmU/OiB7IGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZyB9XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KClcbiAgICAvL2NvbnNvbGUubG9nKFwic3RhcnQgdXBkYXRlIGxvb2t1cHMgW1wiLCBzb3VyY2UsIFwiXVwiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgbGV0IHJlbmRlcmluZ0Vycm9yczogc3RyaW5nW10gPSBbXVxuICAgIGZvciAobGV0IGlkIG9mIGYuZmlsZUxvb2t1cEZpbGVzLmtleXMoKSkge1xuICAgICAgICBjb25zdCBtYXRjaFJlZ2V4ID0gLyg/PGZpbGVQYXRoPi4qKV9fcmVsYXRlZF9fKD88ZmlsZUNsYXNzTmFtZT4uKilfX18oPzxmaWVsZE5hbWU+LiopL1xuICAgICAgICBjb25zdCB7IGZpbGVQYXRoLCBmaWxlQ2xhc3NOYW1lLCBmaWVsZE5hbWUgfSA9IGlkLm1hdGNoKG1hdGNoUmVnZXgpPy5ncm91cHMgfHwge31cbiAgICAgICAgY29uc3QgdEZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCkgYXMgVEZpbGVcbiAgICAgICAgY29uc3QgZHZBcGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGNvbnN0IGR2RmlsZSA9IGR2QXBpICYmIGR2QXBpLnBhZ2UodEZpbGUucGF0aClcbiAgICAgICAgaWYgKHRGaWxlICYmIGR2RmlsZSkge1xuICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VzID0gZi5maWxlTG9va3VwRmlsZXMuZ2V0KGlkKVxuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBmLmZpbGVzRmllbGRzLmdldChmaWxlUGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PSBmaWVsZE5hbWUpXG4gICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRUeXBlID0gZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlXG4gICAgICAgICAgICAgICAgaWYgKCFmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmdldChpZCkpIGYuZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUuc2V0KGlkLCBvdXRwdXRUeXBlKVxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3V0cHV0VHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkxpbmtzTGlzdDpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb29rdXAuVHlwZS5MaW5rc0J1bGxldExpc3Q6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWVzQXJyYXkgPSBwYWdlcz8ubWFwKChkdkZpbGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmllbGRNYW5hZ2VyLmJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbiwgdEZpbGUsIGR2RmlsZS5maWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gKG5ld1ZhbHVlc0FycmF5IHx8IFtdKS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbUxpc3Q6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9va3VwLlR5cGUuQ3VzdG9tQnVsbGV0TGlzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZW5kZXJpbmdGdW5jdGlvbiA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke2ZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9ufWApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWVzQXJyYXkgPSBwYWdlcz8ubWFwKChkdkZpbGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlcmluZ0Z1bmN0aW9uKGR2RmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbmRlcmluZ0Vycm9ycy5pbmNsdWRlcyhmaWVsZC5uYW1lKSkgcmVuZGVyaW5nRXJyb3JzLnB1c2goZmllbGQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gKG5ld1ZhbHVlc0FycmF5IHx8IFtdKS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbVN1bW1hcml6aW5nOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb24gPSBmaWVsZC5vcHRpb25zLmN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb25cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcml6aW5nRnVuY3Rpb24gPSBuZXcgRnVuY3Rpb24oXCJwYWdlc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx7XFx7c3VtbWFyaXplZEZpZWxkTmFtZVxcfVxcfS9nLCBmaWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gc3VtbWFyaXppbmdGdW5jdGlvbihwYWdlcykudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9va3VwLlR5cGUuQnVpbHRpblN1bW1hcml6aW5nOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1aWx0aW5GdW5jdGlvbiA9IGZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gYXMga2V5b2YgdHlwZW9mIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJpemluZ0Z1bmN0aW9uID0gbmV3IEZ1bmN0aW9uKFwicGFnZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uW2J1aWx0aW5GdW5jdGlvbl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHtcXHtzdW1tYXJpemVkRmllbGROYW1lXFx9XFx9L2csIGZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBzdW1tYXJpemluZ0Z1bmN0aW9uKHBhZ2VzKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbmRlcmluZ0Vycm9ycy5pbmNsdWRlcyhmaWVsZC5uYW1lKSkgcmVuZGVyaW5nRXJyb3JzLnB1c2goZmllbGQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdmFsdWUgaGFzIGNoYW5nZWQgaW4gb3JkZXIgbm90IHRvIGNyZWF0ZSBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gZi5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuZ2V0KGlkKSB8fCBhd2FpdCBwYXJzZUZpZWxkVmFsdWVzKHBsdWdpbiwgdEZpbGUsIGZpZWxkLm5hbWUpIHx8IFwiXCJcbiAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRDaGVja0ZvclVwZGF0ZSA9XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLm9wdGlvbnMuYXV0b1VwZGF0ZSB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPT09IHVuZGVmaW5lZCB8fCAvL2ZpZWxkIGlzIGF1dG9VcGRhdGVkIE9SXG4gICAgICAgICAgICAgICAgICAgICggLy9maWVsZCBpcyBub3QgYXV0b3VwZGF0ZWQgYW5kIHdlIGhhdmUgdG8gY2hlY2sgZm9yIHJlcXVlc3QgdG8gdXBkYXRlIHRoaXMgb25lXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JjZVVwZGF0ZU9uZT8uZmlsZS5wYXRoID09PSB0RmlsZS5wYXRoICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JjZVVwZGF0ZU9uZT8uZmllbGROYW1lID09PSBmaWVsZC5uYW1lXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZUhhc0NoYW5nZWQgPSAoIWN1cnJlbnRWYWx1ZSAmJiBuZXdWYWx1ZSAhPT0gXCJcIikgfHwgIWFycmF5c0FzU3RyaW5nQXJlRXF1YWwoY3VycmVudFZhbHVlLCBuZXdWYWx1ZSlcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXRIYXNDaGFuZ2VkID0gb3V0cHV0VHlwZSAhPT0gZi5maWxlTG9va3VwRmllbGRMYXN0T3V0cHV0VHlwZS5nZXQoaWQpXG5cbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkQ2hlY2tGb3JVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuc2V0KGlkLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUuc2V0KGlkLCBvdXRwdXRUeXBlKTtcbiAgICAgICAgICAgICAgICB9Ly8gbWFrZSBzdXJlIHRoYXQgdGhpcyBpcyBzZXQgYXQgZmlyc3QgaW5kZXhpbmd9XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZENoZWNrRm9yVXBkYXRlICYmICh2YWx1ZUhhc0NoYW5nZWQgfHwgZm9ybWF0SGFzQ2hhbmdlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNWYWx1ZXNDb3VudCA9IHBsdWdpbi5maWVsZEluZGV4LnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLmdldChpZCkgfHwgMFxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHJlcGxhY2VWYWx1ZXMocGx1Z2luLCB0RmlsZSwgZmllbGROYW1lLCBuZXdWYWx1ZSwgcHJldmlvdXNWYWx1ZXNDb3VudCkpO1xuICAgICAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtmaWVsZE5hbWV9YCwgTG9va3VwLlN0YXR1cy51cFRvRGF0ZSlcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZSAhPT0gXCJmdWxsIEluZGV4XCIpIHsgLy8gdGhpcyBjYXNlIGlzIGZvciBmaWxlQ2xhc3MgY2hhbmdlcywgbm8gbmVlZCBmb3IgcmV3cml0ZSBvdGhlciBsb29rdXBzIGFmdGVyIGNhY2hlIHVwZGF0ZVxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2hhbmdlZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdmFsdWVIYXNDaGFuZ2VkICYmICFmb3JtYXRIYXNDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkc1N0YXR1cy5zZXQoYCR7ZmlsZVBhdGh9X18ke2ZpZWxkTmFtZX1gLCBMb29rdXAuU3RhdHVzLnVwVG9EYXRlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocmVuZGVyaW5nRXJyb3JzLmxlbmd0aCkgbmV3IE5vdGljZShgVGhvc2UgZmllbGRzIGhhdmUgaW5jb3JyZWN0IG91dHB1dCByZW5kZXJpbmcgZnVuY3Rpb25zOlxcbiR7cmVuZGVyaW5nRXJyb3JzLmpvaW4oXCIsXFxuXCIpfWApXG4gICAgLy9jb25zb2xlLmxvZyhcImZpbmlzaGVkIHVwZGF0ZSBsb29rdXBzIFtcIiwgc291cmNlLCBcIl1cIiwgcGx1Z2luLmZpZWxkSW5kZXgubGFzdFJldmlzaW9uLCBcIi0+XCIsIHBsdWdpbi5maWVsZEluZGV4LmR2Py5hcGkuaW5kZXgucmV2aXNpb24sIGAkeyhEYXRlLm5vdygpIC0gc3RhcnQpfW1zYClcbn1cbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyBpbmxpbmVGaWVsZFJlZ2V4LCBlbmNvZGVMaW5rLCBkZWNvZGVMaW5rIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFZhbHVlcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZU9yZmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPcmZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPcmZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yZmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gKGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI7XG4gICAgY29uc3QgeyBwb3NpdGlvbjogeyBzdGFydCwgZW5kIH0gfSA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIgOiB7IHBvc2l0aW9uOiB7IHN0YXJ0OiB1bmRlZmluZWQsIGVuZDogdW5kZWZpbmVkIH0gfTtcbiAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG4gICAgY29udGVudC5tYXAoKGxpbmUsIGkpID0+IHtcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAke2F0dHJpYnV0ZX06KC4qKWAsICd1Jyk7XG4gICAgICAgICAgICBjb25zdCByID0gbGluZS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHJlc3VsdC5wdXNoKHJbMV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZnVsbExpbmVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcXV0qKWAsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGZSID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaChmdWxsTGluZVJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChmUj8uZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsoZlIuZ3JvdXBzLnZhbHVlcykpIH07XG4gICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgY29uc3Qgc1JCID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhCcmFja2V0cyk7XG4gICAgICAgICAgICBsZXQgbmV4dCA9IHNSQi5uZXh0KCk7XG4gICAgICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3VwcykgeyByZXN1bHQucHVzaChkZWNvZGVMaW5rKG5leHQudmFsdWUuZ3JvdXBzLnZhbHVlcykpIH1cbiAgICAgICAgICAgICAgICBuZXh0ID0gc1JCLm5leHQoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW5TZW50ZW5jZVJlZ2V4UGFyID0gbmV3IFJlZ0V4cChgXFxcXCgke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcKV0rKT9cXFxcKWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCBzUlAgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleFBhcik7XG4gICAgICAgICAgICBuZXh0ID0gc1JQLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsobmV4dC52YWx1ZS5ncm91cHMudmFsdWVzKSkgfVxuICAgICAgICAgICAgICAgIG5leHQgPSBzUlAubmV4dCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiByZXN1bHQ7XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlLCBNZW51LCBUZXh0QXJlYUNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkSWNvbiB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IFN0YXR1cyB9IGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcbmltcG9ydCB7IEZpZWxkT3B0aW9ucyB9IGZyb20gXCJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzXCI7XG5pbXBvcnQgeyB1cGRhdGVGb3JtdWxhcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvdXBkYXRlRm9ybXVsYXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybXVsYUZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIHByaXZhdGUgZm9ybXVsYVZhbGlkYXRvckZpZWxkOiBIVE1MRGl2RWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLkZvcm11bGEpXG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2VcbiAgICB9XG5cbiAgICBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiB7IH07XG4gICAgICAgIGlmIChGb3JtdWxhRmllbGQuaXNNZW51KGxvY2F0aW9uKSAmJiBzdGF0dXMgPT09IFN0YXR1cy5jaGFuZ2VkKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb24uRm9ybXVsYSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKEZvcm11bGFGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pICYmIHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb24uRm9ybXVsYVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChGb3JtdWxhRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uLkZvcm11bGEsICgpID0+IHsgfSwgYCR7bmFtZX0gaXMgYXV0b21hdGljYWxseSBjYWxjdWxhdGVkYCwgXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvL25vIGZpZWxkIG1vZGFsLCB3ZSBpbmNsdWRlIHRoZSBmaWVsZCBkaXJlY3RseVxuICAgICAgICBpZiAobGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBcIlwiKSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpIH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNyZWF0ZUR2RmllbGQoZHY6IGFueSwgcDogYW55LCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcgfCB1bmRlZmluZWQ7IGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDsgfSk6IHZvaWQge1xuXG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2tlZCA9ICgpID0+IHsgfSk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmID0+IGYubmFtZSA9PT0gZmllbGROYW1lKT8uZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUZvcm11bGFGaWVsZExhc3RWYWx1ZS5nZXQoYCR7ZmlsZS5wYXRofV9fY2FsY3VsYXRlZF9fJHtmaWxlQ2xhc3NOYW1lfV9fXyR7ZmllbGROYW1lfWApIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGb3JtdWxhQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcblxuICAgICAgICBjb25zdCBmb3JtdWxhQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBmb3JtdWxhQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiamF2YXNjcmlwdCBmb3JtdWxhXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgZm9ybXVsYUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcImN1cnJlbnQgYW5kIHBhZ2VzIHZhcmlhYmxlcyBhcmUgYXZhaWxhYmxlYFwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0JyB9KTtcbiAgICAgICAgY29uc3QgZm9ybXVsYSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChmb3JtdWxhQ29udGFpbmVyKTtcbiAgICAgICAgZm9ybXVsYS5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgZm9ybXVsYS5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBmb3JtdWxhLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5mb3JtdWxhIHx8IFwiXCIpO1xuICAgICAgICBmb3JtdWxhLnNldFBsYWNlaG9sZGVyKFwiZXhhbXBlOiBjdXJyZW50LmFwcGxlICsgY3VycmVudC5iYW5hbmFzIC0gM1wiKVxuXG4gICAgICAgIGZvcm11bGEub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmZvcm11bGEgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoZm9ybXVsYSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZm9ybXVsYVZhbGlkYXRvckZpZWxkID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW51bWJlci1vcHRpb25zXCIgfSlcbiAgICAgICAgdGhpcy5jcmVhdGVGb3JtdWxhQ29udGFpbmVyKHRoaXMuZm9ybXVsYVZhbGlkYXRvckZpZWxkKVxuICAgICAgICB0aGlzLmZvcm11bGFWYWxpZGF0b3JGaWVsZC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZm9ybXVsYVxuICAgIH1cblxuICAgIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG59IiwgImltcG9ydCBJbnB1dCBmcm9tICcuL0lucHV0RmllbGQnXG5pbXBvcnQgQm9vbGVhbiBmcm9tICcuL0Jvb2xlYW5GaWVsZCdcbmltcG9ydCBOdW1iZXIgZnJvbSAnLi9OdW1iZXJGaWVsZCdcbmltcG9ydCBTZWxlY3QgZnJvbSAnLi9TZWxlY3RGaWVsZCdcbmltcG9ydCBDeWNsZSBmcm9tICcuL0N5Y2xlRmllbGQnXG5pbXBvcnQgTXVsdGkgZnJvbSAnLi9NdWx0aUZpZWxkJ1xuaW1wb3J0IEZpbGUgZnJvbSAnLi9GaWxlRmllbGQnXG5pbXBvcnQgRGF0ZSBmcm9tICcuL0RhdGVGaWVsZCdcbmltcG9ydCBNdWx0aUZpbGUgZnJvbSAnLi9NdWx0aUZpbGVGaWVsZCdcbmltcG9ydCBMb29rdXAgZnJvbSAnLi9Mb29rdXBGaWVsZCdcbmltcG9ydCBGb3JtdWxhIGZyb20gJy4vRm9ybXVsYUZpZWxkJ1xuXG5jb25zdCBNYW5hZ2VycyA9IHtcbiAgICBJbnB1dCxcbiAgICBCb29sZWFuLFxuICAgIE51bWJlcixcbiAgICBTZWxlY3QsXG4gICAgQ3ljbGUsXG4gICAgTXVsdGksXG4gICAgRmlsZSxcbiAgICBEYXRlLFxuICAgIE11bHRpRmlsZSxcbiAgICBMb29rdXAsXG4gICAgRm9ybXVsYVxufVxuXG5leHBvcnQgZGVmYXVsdCBNYW5hZ2VycyIsICJpbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuXG5leHBvcnQgY29uc3QgZW51bSBGaWVsZFR5cGUge1xuICAgICdJbnB1dCcgPSBcIklucHV0XCIsXG4gICAgJ1NlbGVjdCcgPSBcIlNlbGVjdFwiLFxuICAgICdNdWx0aScgPSBcIk11bHRpXCIsXG4gICAgJ0N5Y2xlJyA9IFwiQ3ljbGVcIixcbiAgICAnQm9vbGVhbicgPSBcIkJvb2xlYW5cIixcbiAgICBcIk51bWJlclwiID0gXCJOdW1iZXJcIixcbiAgICBcIkZpbGVcIiA9IFwiRmlsZVwiLFxuICAgIFwiTXVsdGlGaWxlXCIgPSBcIk11bHRpRmlsZVwiLFxuICAgIFwiRGF0ZVwiID0gXCJEYXRlXCIsXG4gICAgXCJMb29rdXBcIiA9IFwiTG9va3VwXCIsXG4gICAgXCJGb3JtdWxhXCIgPSBcIkZvcm11bGFcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRUeXBlTGFiZWxNYXBwaW5nOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgRmllbGRUeXBlPiA9IHtcbiAgICBcIklucHV0XCI6IEZpZWxkVHlwZS5JbnB1dCxcbiAgICBcIlNlbGVjdFwiOiBGaWVsZFR5cGUuU2VsZWN0LFxuICAgIFwiTXVsdGlcIjogRmllbGRUeXBlLk11bHRpLFxuICAgIFwiQ3ljbGVcIjogRmllbGRUeXBlLkN5Y2xlLFxuICAgIFwiQm9vbGVhblwiOiBGaWVsZFR5cGUuQm9vbGVhbixcbiAgICBcIk51bWJlclwiOiBGaWVsZFR5cGUuTnVtYmVyLFxuICAgIFwiRmlsZVwiOiBGaWVsZFR5cGUuRmlsZSxcbiAgICBcIk11bHRpRmlsZVwiOiBGaWVsZFR5cGUuTXVsdGlGaWxlLFxuICAgIFwiRGF0ZVwiOiBGaWVsZFR5cGUuRGF0ZSxcbiAgICBcIkxvb2t1cFwiOiBGaWVsZFR5cGUuTG9va3VwLFxuICAgIFwiRm9ybXVsYVwiOiBGaWVsZFR5cGUuRm9ybXVsYVxufTtcblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZVRhZ0NsYXNzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwic2luZ2xlXCIsXG4gICAgXCJTZWxlY3RcIjogXCJzZWxlY3RcIixcbiAgICBcIk11bHRpXCI6IFwibXVsdGlcIixcbiAgICBcIkN5Y2xlXCI6IFwiY3ljbGVcIixcbiAgICBcIkJvb2xlYW5cIjogXCJib29sZWFuXCIsXG4gICAgXCJOdW1iZXJcIjogXCJudW1iZXJcIixcbiAgICBcIkZpbGVcIjogXCJmaWxlXCIsXG4gICAgXCJNdWx0aUZpbGVcIjogXCJmaWxlXCIsXG4gICAgXCJEYXRlXCI6IFwiZGF0ZVwiLFxuICAgIFwiTG9va3VwXCI6IFwibG9va3VwXCIsXG4gICAgXCJGb3JtdWxhXCI6IFwiZm9ybXVsYVwiXG59XG5cbmV4cG9ydCBjb25zdCBGaWVsZFR5cGVUb29sdGlwOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwiQWNjZXB0IGFueSB2YWx1ZVwiLFxuICAgIFwiU2VsZWN0XCI6IFwiQWNjZXB0IGEgc2luZ2xlIHZhbHVlIGZyb20gYSBsaXN0XCIsXG4gICAgXCJNdWx0aVwiOiBcIkFjY2VwdCBtdWx0aXBsZSB2YWx1ZXMgZnJvbSBhIGxpc3RcIixcbiAgICBcIkN5Y2xlXCI6IFwiQ3ljbGUgdGhyb3VnaCB2YWx1ZXMgZnJvbSBhIGxpc3RcIixcbiAgICBcIkJvb2xlYW5cIjogXCJBY2NlcHQgdHJ1ZSBvZiBmYWxzZVwiLFxuICAgIFwiTnVtYmVyXCI6IFwiQWNjZXB0IGEgbnVtYmVyXCIsXG4gICAgXCJGaWxlXCI6IFwiQWNjZXB0IGEgbGlua1wiLFxuICAgIFwiTXVsdGlGaWxlXCI6IFwiQWNjZXB0IG11bHRpcGxlIGxpbmtzXCIsXG4gICAgXCJEYXRlXCI6IFwiQWNjZXB0IGEgZGF0ZVwiLFxuICAgIFwiTG9va3VwXCI6IFwiQWNjZXB0IGEgbG9va3VwIHF1ZXJ5XCIsXG4gICAgXCJGb3JtdWxhXCI6IFwiQWNjZXB0IGEgZm9ybXVsYVwiXG59XG5cbmV4cG9ydCBjb25zdCBGaWVsZE1hbmFnZXI6IFJlY29yZDxrZXlvZiB0eXBlb2YgRmllbGRUeXBlLCBhbnk+ID0ge1xuICAgIFwiSW5wdXRcIjogTWFuYWdlcnMuSW5wdXQsXG4gICAgXCJTZWxlY3RcIjogTWFuYWdlcnMuU2VsZWN0LFxuICAgIFwiTXVsdGlcIjogTWFuYWdlcnMuTXVsdGksXG4gICAgXCJDeWNsZVwiOiBNYW5hZ2Vycy5DeWNsZSxcbiAgICBcIkJvb2xlYW5cIjogTWFuYWdlcnMuQm9vbGVhbixcbiAgICBcIk51bWJlclwiOiBNYW5hZ2Vycy5OdW1iZXIsXG4gICAgXCJGaWxlXCI6IE1hbmFnZXJzLkZpbGUsXG4gICAgXCJNdWx0aUZpbGVcIjogTWFuYWdlcnMuTXVsdGlGaWxlLFxuICAgIFwiRGF0ZVwiOiBNYW5hZ2Vycy5EYXRlLFxuICAgIFwiTG9va3VwXCI6IE1hbmFnZXJzLkxvb2t1cCxcbiAgICBcIkZvcm11bGFcIjogTWFuYWdlcnMuRm9ybXVsYVxufVxuXG5leHBvcnQgY29uc3QgRmllbGRJY29uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwicGVuY2lsXCIsXG4gICAgXCJTZWxlY3RcIjogXCJyaWdodC10cmlhbmdsZVwiLFxuICAgIFwiTXVsdGlcIjogXCJidWxsZXQtbGlzdFwiLFxuICAgIFwiQ3ljbGVcIjogXCJzd2l0Y2hcIixcbiAgICBcIkJvb2xlYW5cIjogXCJjaGVja21hcmtcIixcbiAgICBcIk51bWJlclwiOiBcInBsdXMtbWludXMtZ2x5cGhcIixcbiAgICBcIkZpbGVcIjogXCJsaW5rXCIsXG4gICAgXCJNdWx0aUZpbGVcIjogXCJsaW5rXCIsXG4gICAgXCJEYXRlXCI6IFwiY2FsZW5kYXItd2l0aC1jaGVja21hcmtcIixcbiAgICBcIkxvb2t1cFwiOiBcImZpbGUtc2VhcmNoXCIsXG4gICAgXCJGb3JtdWxhXCI6IFwiZnVuY3Rpb24tc3F1YXJlXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkQmFja2dyb3VuZENvbG9yQ2xhc3M6IFJlY29yZDxrZXlvZiB0eXBlb2YgRmllbGRUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiSW5wdXRcIjogXCJzaW5nbGVcIixcbiAgICBcIlNlbGVjdFwiOiBcInNlbGVjdFwiLFxuICAgIFwiTXVsdGlcIjogXCJtdWx0aVwiLFxuICAgIFwiQ3ljbGVcIjogXCJjeWNsZVwiLFxuICAgIFwiQm9vbGVhblwiOiBcImJvb2xlYW5cIixcbiAgICBcIk51bWJlclwiOiBcIm51bWJlclwiLFxuICAgIFwiRmlsZVwiOiBcImZpbGVcIixcbiAgICBcIk11bHRpRmlsZVwiOiBcImZpbGVcIixcbiAgICBcIkRhdGVcIjogXCJkYXRlXCIsXG4gICAgXCJMb29rdXBcIjogXCJsb29rdXBcIixcbiAgICBcIkZvcm11bGFcIjogXCJsb29rdXBcIlxufSIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwiLi4vdHlwZXMvZmllbGRUeXBlc1wiXG5cbmNsYXNzIEZpZWxkIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgbmFtZTogc3RyaW5nID0gXCJcIixcbiAgICAgICAgcHVibGljIG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fSxcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgdHlwZTogRmllbGRUeXBlID0gRmllbGRUeXBlLklucHV0LFxuICAgICAgICBwdWJsaWMgZmlsZUNsYXNzTmFtZT86IHN0cmluZ1xuICAgICkgeyB9O1xuXG4gICAgc3RhdGljIGNvcHlQcm9wZXJ0eSh0YXJnZXQ6IEZpZWxkLCBzb3VyY2U6IEZpZWxkKSB7XG4gICAgICAgIHRhcmdldC5pZCA9IHNvdXJjZS5pZDtcbiAgICAgICAgdGFyZ2V0Lm5hbWUgPSBzb3VyY2UubmFtZTtcbiAgICAgICAgdGFyZ2V0LnR5cGUgPSBzb3VyY2UudHlwZVxuICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2Uub3B0aW9ucykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIHRhcmdldC5vcHRpb25zW2tdID0gc291cmNlLm9wdGlvbnNba107XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQub3B0aW9ucykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXMoc291cmNlLm9wdGlvbnMpLmluY2x1ZGVzKGspKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldC5vcHRpb25zW2tdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlRGVmYXVsdChuYW1lOiBzdHJpbmcpOiBGaWVsZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIGZpZWxkLnR5cGUgPSBGaWVsZFR5cGUuSW5wdXQ7XG4gICAgICAgIGZpZWxkLm5hbWUgPSBuYW1lO1xuICAgICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgRmllbGQ7IiwgImltcG9ydCB7IENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnkgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnlcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IHJlc29sdmVMb29rdXBzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXNvbHZlTG9va3Vwc1wiO1xuaW1wb3J0IHsgdXBkYXRlTG9va3VwcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvdXBkYXRlTG9va3Vwc1wiO1xuaW1wb3J0IHsgdXBkYXRlRm9ybXVsYXMsIGNsZWFuUmVtb3ZlZEZvcm11bGFzRnJvbUluZGV4IH0gZnJvbSBcInNyYy9jb21tYW5kcy91cGRhdGVGb3JtdWxhc1wiO1xuXG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IFN0YXR1cyBhcyBMb29rdXBTdGF0dXMsIFR5cGUgYXMgTG9va3VwVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRJbmRleCBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBwdWJsaWMgZmlsZUNsYXNzZXNGaWVsZHM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzOiBGaWVsZFtdO1xuICAgIHB1YmxpYyBmaWxlc0ZpZWxkc0Zyb21UYWdzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzUXVlcmllczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpbGVzRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpZWxkczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpbGVzRmllbGRzRXhpc3RzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWxlQ2xhc3NlczogTWFwPHN0cmluZywgRmlsZUNsYXNzW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpbGVDbGFzc2VzTmFtZXM6IE1hcDxzdHJpbmcsIHN0cmluZ1tdIHwgdW5kZWZpbmVkPjtcbiAgICBwdWJsaWMgZmlsZUNsYXNzZXNBbmNlc3RvcnM6IE1hcDxzdHJpbmcsIHN0cmluZ1tdPlxuICAgIHB1YmxpYyBmaWxlQ2xhc3Nlc1BhdGg6IE1hcDxzdHJpbmcsIEZpbGVDbGFzcz47XG4gICAgcHVibGljIGZpbGVDbGFzc2VzTmFtZTogTWFwPHN0cmluZywgRmlsZUNsYXNzPjtcbiAgICBwdWJsaWMgdmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzOiBNYXA8c3RyaW5nLCBzdHJpbmdbXT47XG4gICAgcHVibGljIHRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzOiBNYXA8c3RyaW5nLCBGaWxlQ2xhc3M+O1xuICAgIHB1YmxpYyBmaWxlTG9va3VwRmlsZXM6IE1hcDxzdHJpbmcsIGFueVtdPjtcbiAgICBwdWJsaWMgZmlsZUxvb2t1cEZpZWxkc1N0YXR1czogTWFwPHN0cmluZywgTG9va3VwU3RhdHVzPjtcbiAgICBwdWJsaWMgcHJldmlvdXNGaWxlTG9va3VwRmlsZXNWYWx1ZXM6IE1hcDxzdHJpbmcsIG51bWJlcj47XG4gICAgcHVibGljIGZpbGVMb29rdXBGaWVsZExhc3RWYWx1ZTogTWFwPHN0cmluZywgc3RyaW5nPjtcbiAgICBwdWJsaWMgZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGU6IE1hcDxzdHJpbmcsIGtleW9mIHR5cGVvZiBMb29rdXBUeXBlPjtcbiAgICBwdWJsaWMgZmlsZUZvcm11bGFGaWVsZExhc3RWYWx1ZTogTWFwPHN0cmluZywgc3RyaW5nPjtcbiAgICBwdWJsaWMgbG9va3VwUXVlcmllczogTWFwPHN0cmluZywgRmllbGQ+O1xuICAgIHB1YmxpYyBkdjogYW55O1xuICAgIHB1YmxpYyBsYXN0UmV2aXNpb246IDA7XG4gICAgcHVibGljIGZpbGVDaGFuZ2VkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHVibGljIGR2UmVhZHk6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwdWJsaWMgbG9hZFRpbWU6IG51bWJlcjtcbiAgICBwdWJsaWMgZmlyc3RJbmRleGluZ0RvbmU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGNsYXNzRmlsZXNQYXRoOiBzdHJpbmcgfCBudWxsO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHVibGljIGNhY2hlVmVyc2lvbjogc3RyaW5nLCBwdWJsaWMgb25DaGFuZ2U6ICgpID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIoKVxuICAgICAgICB0aGlzLmZsdXNoQ2FjaGUoKTtcbiAgICAgICAgdGhpcy5maWxlTG9va3VwRmlsZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMucHJldmlvdXNGaWxlTG9va3VwRmlsZXNWYWx1ZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUZvcm11bGFGaWVsZExhc3RWYWx1ZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5kdiA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc7XG4gICAgICAgIHRoaXMuY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGg7XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIHRoaXMubG9hZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBhd2FpdCAoYXN5bmMgKCkgPT4geyB9KSgpOyAvL29ubHkgd2F5IHRvIGhhdmUgbWV0YWRhdGEgYnV0dG9uIHRvIHNob3cgdXAgYXQgcmVsb2FkICE/IVxuXG4gICAgICAgIGlmICh0aGlzLmR2Py5hcGkuaW5kZXguaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZHYgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3O1xuICAgICAgICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLmR2LmFwaS5pbmRleC5yZXZpc2lvbjtcbiAgICAgICAgICAgIHRoaXMuZHZSZWFkeSA9IHRydWU7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmZ1bGxJbmRleChcImR2IGlzIHJ1bm5pbmdcIiwgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oXCJkYXRhdmlldzppbmRleC1yZWFkeVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5kdiA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc7XG4gICAgICAgICAgICAgICAgdGhpcy5kdlJlYWR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmZ1bGxJbmRleChcImR2IGluZGV4XCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHYuYXBpLmluZGV4LnJldmlzaW9uO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwib2JzaWRpYW4gcmVzb2x2ZWRcIilcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuaW5Qcm9ncmVzc1Rhc2tDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5mdWxsSW5kZXgoXCJjYWNoZSByZXNvbHZlZFwiLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFJldmlzaW9uID0gdGhpcy5kdj8uYXBpLmluZGV4LnJldmlzaW9uIHx8IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdkYXRhdmlldzptZXRhZGF0YS1jaGFuZ2UnLCBhc3luYyAob3A6IGFueSwgZmlsZTogVEZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwic29tZSBmaWxlIGNoYW5nZWRcIiwgdGhpcy5maWxlQ2hhbmdlZCk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5ldyByZXZpc2lvblwiLCB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgICAgICAgICAgICAgaWYgKG9wID09PSBcInVwZGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgIC8vZGF0YXZpZXcgaXMgdHJpZ2dlcmluZyBcInVwZGF0ZVwiIG9uIG1ldGFkYXRhY2FjaGUub24oXCJyZXNvbHZlXCIpIGV2ZW4gaWYgbm8gY2hhbmdlIGluIHRoZSBmaWxlLiBJdCBvY2N1cnMgYXQgYXBwIGxhdW5jaFxuICAgICAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIHRoZSBmaWxlIG10aW1lIGlzIG9sZGVyIHRoYXQgcGx1Z2luIGxvYWQgLT4gaW4gdGhpcyBjYXNlIG5vIGZpbGUgaGFzIGNoYW5nZSwgbm8gbmVlZCB0byB1cGxkYXRlIGxvb2t1cHNcbiAgICAgICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmZpbGVDYWNoZVtmaWxlLnBhdGhdLm10aW1lID49IHRoaXMubG9hZFRpbWVcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5kdj8uYXBpLmluZGV4LnJldmlzaW9uICE9PSB0aGlzLmxhc3RSZXZpc2lvblxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmZpbGVDaGFuZ2VkXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMuZHZSZWFkeVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAvL21heWJlIGZ1bGxJbmRleCBkaWRuJ3QgY2F0Y2ggbmV3IGZpbGVzIHRoYXQgaGF2ZSB0byBiZSB1cGRhdGVkOiBsZXQncyByZWJ1aWxkIGdldEZpbGVGaWVsZHNFeGlzdCBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICAgICAgICAgIGNsZWFuUmVtb3ZlZEZvcm11bGFzRnJvbUluZGV4KHRoaXMucGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRGaWxlc0ZpZWxkc0V4aXN0cyhmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xhc3NGaWxlc1BhdGggJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgodGhpcy5jbGFzc0ZpbGVzUGF0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVsbEluZGV4KFwiZmlsZUNsYXNzIGNoYW5nZWRcIilcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlRm9ybXVsYXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZUxvb2t1cHMoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IEZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NOYW1lRnJvbVBhdGgodGhpcy5wbHVnaW4sIGZpbGUucGF0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlTG9va3VwcyhmaWxlQ2xhc3NOYW1lLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLmR2LmFwaS5pbmRleC5yZXZpc2lvblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS50cmlnZ2VyKFwibWV0YWRhdGEtbWVudTppbmRleGVkXCIpXG4gICAgfVxuXG5cbiAgICBwcml2YXRlIGZsdXNoQ2FjaGUoKSB7XG4gICAgICAgIHRoaXMuZmlsZXNGaWVsZHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWVsZHNFeGlzdHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmllbGRzRnJvbUdsb2JhbEZpbGVDbGFzcyA9IFtdO1xuICAgICAgICB0aGlzLmZpbGVzRmllbGRzRnJvbVRhZ3MgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzUXVlcmllcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVDbGFzc2VzUGF0aCA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc05hbWUgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmxvb2t1cFF1ZXJpZXMgPSBuZXcgTWFwKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZnVsbEluZGV4KGV2ZW50OiBzdHJpbmcsIGZvcmNlX3VwZGF0ZV9hbGwgPSBmYWxzZSwgd2l0aG91dF9sb29rdXBzID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IGluZGV4IFtcIiwgZXZlbnQsIFwiXVwiLCB0aGlzLmxhc3RSZXZpc2lvbiwgXCItPlwiLCB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgICAgIGxldCBzdGFydCA9IERhdGUubm93KCksIHRpbWUgPSBEYXRlLm5vdygpXG4gICAgICAgIHRoaXMuZmx1c2hDYWNoZSgpO1xuICAgICAgICB0aGlzLmdldEZpbGVDbGFzc2VzQW5jZXN0b3JzKCk7XG4gICAgICAgIHRoaXMuZ2V0R2xvYmFsRmlsZUNsYXNzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZUNsYXNzZXMoKTtcbiAgICAgICAgdGhpcy5nZXRMb29rdXBRdWVyaWVzKCk7XG4gICAgICAgIHRoaXMucmVzb2x2ZUZpbGVDbGFzc01hdGNoaW5nVGFncygpO1xuICAgICAgICB0aGlzLnJlc29sdmVGaWxlQ2xhc3NRdWVyaWVzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZXNGaWVsZHMoKTtcbiAgICAgICAgdGhpcy5nZXRGaWxlc0ZpZWxkc0V4aXN0cygpO1xuICAgICAgICBhd2FpdCB0aGlzLmdldFZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcygpO1xuICAgICAgICB0aGlzLnJlc29sdmVMb29rdXBzKHdpdGhvdXRfbG9va3Vwcyk7XG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlTG9va3VwcyhcImZ1bGwgSW5kZXhcIiwgd2l0aG91dF9sb29rdXBzKTtcbiAgICAgICAgaWYgKGZvcmNlX3VwZGF0ZV9hbGwgfHwgIXRoaXMuZmlyc3RJbmRleGluZ0RvbmUpIGF3YWl0IHRoaXMudXBkYXRlRm9ybXVsYXMoKTsgLy9jYWxjdWxhdGUgZm9ybXVsYXMgYXQgc3RhcnQgb2Ygd2l0aCBmb3JjZSB1cGRhdGVcbiAgICAgICAgdGhpcy5maXJzdEluZGV4aW5nRG9uZSA9IHRydWU7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJlbmQgaW5kZXggW1wiLCBldmVudCwgXCJdXCIsIHRoaXMubGFzdFJldmlzaW9uLCBcIi0+XCIsIHRoaXMuZHY/LmFwaS5pbmRleC5yZXZpc2lvbiwgYCR7KERhdGUubm93KCkgLSBzdGFydCl9bXNgKVxuICAgIH1cblxuICAgIHJlc29sdmVMb29rdXBzKHdpdGhvdXRfbG9va3VwczogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBpZiAoIXdpdGhvdXRfbG9va3VwcykgcmVzb2x2ZUxvb2t1cHModGhpcy5wbHVnaW4pO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUxvb2t1cHMoc291cmNlOiBzdHJpbmcgPSBcIlwiLCB3aXRob3V0X2xvb2t1cHM6IGJvb2xlYW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF3aXRob3V0X2xvb2t1cHMpIGF3YWl0IHVwZGF0ZUxvb2t1cHModGhpcy5wbHVnaW4sIHNvdXJjZSk7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlRm9ybXVsYXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHVwZGF0ZUZvcm11bGFzKHRoaXMucGx1Z2luKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRWYWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNOYW1lLmZvckVhY2goKGZpbGVDbGFzcykgPT4ge1xuICAgICAgICAgICAgZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZm9yRWFjaChhc3luYyBhdHRyID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGF0dHIub3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiAhIShhdHRyLm9wdGlvbnMgYXMgUmVjb3JkPHN0cmluZywgYW55PilbXCJ2YWx1ZXNMaXN0Tm90ZVBhdGhcIl0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXMuc2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgKGF0dHIub3B0aW9ucyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KS52YWx1ZXNMaXN0Tm90ZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBGaWVsZFNldHRpbmcuZ2V0VmFsdWVzTGlzdEZyb21Ob3RlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhdHRyLm9wdGlvbnMgYXMgUmVjb3JkPHN0cmluZywgYW55PikudmFsdWVzTGlzdE5vdGVQYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaChhc3luYyBzZXR0aW5nID0+IHtcbiAgICAgICAgICAgIGlmIChzZXR0aW5nLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXMuc2V0KFxuICAgICAgICAgICAgICAgICAgICBzZXR0aW5nLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoLFxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBGaWVsZFNldHRpbmcuZ2V0VmFsdWVzTGlzdEZyb21Ob3RlKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0RmlsZUNsYXNzZXNBbmNlc3RvcnMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICAgICAgLy8xLiBpdGVyYXRlIG92ZXIgZmlsZUNsYXNzZXMgdG8gaW5pdCBmaWxlQ2xhc3Nlc0FuY2VzdG9yc1xuICAgICAgICBpZiAoY2xhc3NGaWxlc1BhdGgpIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGYgPT4gZi5wYXRoLmluY2x1ZGVzKGNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChmID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IEZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NOYW1lRnJvbVBhdGgodGhpcy5wbHVnaW4sIGYucGF0aClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmKT8uZnJvbnRtYXR0ZXI/LmV4dGVuZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChgJHtjbGFzc0ZpbGVzUGF0aH0ke3BhcmVudH0ubWRgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMuc2V0KGZpbGVDbGFzc05hbWUsIFtwYXJlbnRdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMuc2V0KGZpbGVDbGFzc05hbWUsIFtdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5zZXQoZmlsZUNsYXNzTmFtZSwgW10pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIC8vMi4gZm9yIGVhY2ggZmlsZUNsYXNzIGdldCBhbmNlc3RvcnMgcmVjdXJzaXZlbHkgLSBzdG9wIHdoZW4gYW4gYW5jZXN0b3IgaXMgdGhlIGZpbGVDbGFzc1xuICAgICAgICBbLi4udGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9yc10uZm9yRWFjaCgoW2ZpbGVDbGFzc05hbWUsIGFuY2VzdG9yc10pID0+IHtcbiAgICAgICAgICAgIGlmIChhbmNlc3RvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QW5jZXN0b3JzUmVjdXJzaXZlbHkoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cblxuICAgIGdldEFuY2VzdG9yc1JlY3Vyc2l2ZWx5KGZpbGVDbGFzc05hbWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBhbmNlc3RvcnMgPSB0aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICBpZiAoYW5jZXN0b3JzICYmIGFuY2VzdG9ycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RBbmNlc3RvciA9IGFuY2VzdG9ycy5sYXN0KCk7XG4gICAgICAgICAgICBjb25zdCBsYXN0QW5jZXN0b3JQYXJlbnQgPSB0aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldChsYXN0QW5jZXN0b3IhKT8uWzBdO1xuICAgICAgICAgICAgaWYgKGxhc3RBbmNlc3RvclBhcmVudCAmJiBsYXN0QW5jZXN0b3JQYXJlbnQgIT09IGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzLnNldChmaWxlQ2xhc3NOYW1lLCBbLi4uYW5jZXN0b3JzLCBsYXN0QW5jZXN0b3JQYXJlbnRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEdsb2JhbEZpbGVDbGFzcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZ2xvYmFsRmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzXG4gICAgICAgIGlmICghZ2xvYmFsRmlsZUNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MgPSBbXVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MgPSBGaWxlQ2xhc3NcbiAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZUZpbGVDbGFzcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cmlidXRlcy5tYXAoYXR0ciA9PiBhdHRyLmdldEZpZWxkKCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgeyB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRGaWxlQ2xhc3NlcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLmNsYXNzRmlsZXNQYXRoXG4gICAgICAgIGlmIChjbGFzc0ZpbGVzUGF0aCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLnBhdGguaW5jbHVkZXMoY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZi5wYXRoKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuc2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3MuYXR0cmlidXRlcy5tYXAoYXR0ciA9PiBhdHRyLmdldEZpZWxkKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNQYXRoLnNldChmLnBhdGgsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzTmFtZS5zZXQoZmlsZUNsYXNzLm5hbWUsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyPy5tYXBXaXRoVGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMuc2V0KGZpbGVDbGFzc05hbWUsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZXJyb3IpIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldExvb2t1cFF1ZXJpZXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkxvb2t1cCkuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvb2t1cFF1ZXJpZXMuc2V0KGBwcmVzZXRGaWVsZF9fXyR7ZmllbGQubmFtZX1gLCBmaWVsZClcbiAgICAgICAgfSk7XG4gICAgICAgIFsuLi50aGlzLmZpbGVDbGFzc2VzRmllbGRzXS5mb3JFYWNoKChbZmlsZUNsYXNzTmFtZSwgZmllbGRzXSkgPT4ge1xuICAgICAgICAgICAgZmllbGRzLmZpbHRlcihmaWVsZCA9PiBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKS5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvb2t1cFF1ZXJpZXMuc2V0KGAke2ZpbGVDbGFzc05hbWV9X19fJHtmaWVsZC5uYW1lfWAsIGZpZWxkKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICByZXNvbHZlRmlsZUNsYXNzTWF0Y2hpbmdUYWdzKCk6IHZvaWQge1xuICAgICAgICBpZiAoIVsuLi50aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzXS5sZW5ndGgpIHJldHVyblxuICAgICAgICAvL0FsdGVybmF0aXZlIHdheVxuICAgICAgICBjb25zdCBtYXBwZWRUYWdzID0gWy4uLnRoaXMudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMua2V5cygpXVxuICAgICAgICBjb25zdCBmaWxlc1dpdGhNYXBwZWRUYWdRdWVyeSA9IG1hcHBlZFRhZ3MubWFwKHQgPT4gYCMke3R9YCkuam9pbihcIiBvciBcIilcbiAgICAgICAgdGhpcy5kdi5hcGkucGFnZXMoZmlsZXNXaXRoTWFwcGVkVGFnUXVlcnkpLmZvckVhY2goKGR2RmlsZTogYW55KSA9PiB7XG4gICAgICAgICAgICBkdkZpbGUuZmlsZS50YWdzLmZvckVhY2goKF90YWc6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IF90YWcucmVwbGFjZSgvXlxcIy8sIFwiXCIpXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlcy5nZXQodGFnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGR2RmlsZS5maWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMuc2V0KGZpbGVQYXRoLCBbLi4ubmV3IFNldChbLi4uKHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5nZXQoZmlsZVBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzXSldKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5zZXQoZHZGaWxlLmZpbGUucGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZmlsZVBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzLm5hbWVdKV0pXG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVRhZyA9IHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVDbGFzcy5uYW1lKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmllbGRzID0gdGhpcy5maWxlc0ZpZWxkc0Zyb21UYWdzLmdldChmaWxlUGF0aClcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3RmllbGRzID0gWy4uLmZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21UYWddXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZEN1cnJlbnRGaWVsZHMgPSBjdXJyZW50RmllbGRzPy5maWx0ZXIoZmllbGQgPT4gIW5ld0ZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpKSB8fCBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGRzLnB1c2goLi4uZmlsdGVyZWRDdXJyZW50RmllbGRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21UYWdzLnNldChmaWxlUGF0aCwgbmV3RmllbGRzKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICByZXNvbHZlRmlsZUNsYXNzUXVlcmllcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzUXVlcmllcy5mb3JFYWNoKHNmY3EgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmNxID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KHNmY3EubmFtZSwgc2ZjcS5pZCwgc2ZjcS5xdWVyeSwgc2ZjcS5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgZmNxLmdldFJlc3VsdHMoZHZBcGkpLmZvckVhY2goKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZjcS5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZiA9IHJlc3VsdC5maWxlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbLi4ubmV3IFNldChbLi4uKHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5nZXQoZi5wYXRoKSB8fCBbXSksIGZpbGVDbGFzc10pXSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuc2V0KGYucGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZi5wYXRoKSB8fCBbXSksIGZpbGVDbGFzcy5uYW1lXSldKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRmlsZUNsYXNzZXNGaWVsZHNGcm9tUXVlcnkgPSB0aGlzLmZpbGVDbGFzc2VzRmllbGRzLmdldChmY3EuZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVF1ZXJ5KSB0aGlzLmZpbGVzRmllbGRzRnJvbUZpbGVDbGFzc1F1ZXJpZXMuc2V0KHJlc3VsdC5maWxlLnBhdGgsIGZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21RdWVyeSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0RmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpXG4gICAgICAgICAgICAuZmlsdGVyKGYgPT4gIXRoaXMuY2xhc3NGaWxlc1BhdGhcbiAgICAgICAgICAgICAgICB8fCAhZi5wYXRoLmluY2x1ZGVzKHRoaXMuY2xhc3NGaWxlc1BhdGgpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuZm9yRWFjaChmID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRmlsZUNsYXNzZXNOYW1lcyA9IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc2VzQ2FjaGU6IHN0cmluZ1tdIHwgc3RyaW5nID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGYpPy5mcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzXVxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3Nlc0NhY2hlKSB7XG4gICAgICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoZmlsZUNsYXNzZXNDYWNoZSkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUZpbGVDbGFzc2VzTmFtZXMucHVzaCguLi5maWxlQ2xhc3Nlc0NhY2hlKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlRmlsZUNsYXNzZXNOYW1lcy5wdXNoKC4uLmZpbGVDbGFzc2VzQ2FjaGUuc3BsaXQoJywnKS5tYXAoZmNuID0+IGZjbi50cmltKCkpKVxuICAgICAgICAgICAgICAgICAgICBmaWxlRmlsZUNsYXNzZXNOYW1lcy5mb3JFYWNoKGZpbGVGaWxlQ2xhc3NOYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMuZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlRmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMuc2V0KGYucGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXMuZ2V0KGYucGF0aCkgfHwgW10pLCBmaWxlQ2xhc3NdKV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuc2V0KGYucGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZi5wYXRoKSB8fCBbXSksIGZpbGVDbGFzcy5uYW1lXSldKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc2VzRmllbGRzRnJvbUZpbGUgPSB0aGlzLmZpbGVDbGFzc2VzRmllbGRzLmdldChmaWxlRmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmllbGRzID0gdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLmdldChmLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc2VzRmllbGRzRnJvbUZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3RmllbGRzID0gWy4uLmZpbGVDbGFzc2VzRmllbGRzRnJvbUZpbGVdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkQ3VycmVudEZpZWxkcyA9IGN1cnJlbnRGaWVsZHM/LmZpbHRlcihmaWVsZCA9PiAhbmV3RmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSkpIHx8IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKC4uLmZpbHRlcmVkQ3VycmVudEZpZWxkcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIG5ld0ZpZWxkcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyB0aGlzLmZpbGVzRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXMuc2V0KGYucGF0aCwgW10pOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyB0aGlzLmZpbGVzRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXMuc2V0KGYucGF0aCwgW10pOyB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFtdKTsgfVxuICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICBnZXRGaWxlc0ZpZWxkcygpOiB2b2lkIHtcbiAgICAgICAgLypcbiAgICAgICAgUHJpb3JpdHkgb3JkZXI6XG4gICAgICAgIDEuIElubmVyIGZpbGVDbGFzc1xuICAgICAgICAyLiBUYWcgbWF0Y2hcbiAgICAgICAgMy4gZmlsZUNsYXNzUXVlcnkgbWF0Y2hcbiAgICAgICAgNC4gR2xvYmFsIGZpbGVDbGFzc1xuICAgICAgICA1LiBzZXR0aW5ncyBwcmVzZXQgZmllbGRzXG4gICAgICAgICovXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcbiAgICAgICAgICAgIC5maWx0ZXIoZiA9PiAhdGhpcy5jbGFzc0ZpbGVzUGF0aCB8fCAhZi5wYXRoLmluY2x1ZGVzKHRoaXMuY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzID0gdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLmdldChmLnBhdGgpXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpZWxkc0Zyb21RdWVyeSA9IHRoaXMuZmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzUXVlcmllcy5nZXQoZi5wYXRoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRmllbGRzRnJvbVRhZyA9IHRoaXMuZmlsZXNGaWVsZHNGcm9tVGFncy5nZXQoZi5wYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzPy5sZW5ndGggfHxcbiAgICAgICAgICAgICAgICAgICAgZmlsZUZpZWxkc0Zyb21RdWVyeT8ubGVuZ3RoIHx8XG4gICAgICAgICAgICAgICAgICAgIGZpbGVGaWVsZHNGcm9tVGFnPy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZXNGaWVsZHM6IEZpZWxkW10gPSBmaWxlRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXMgfHwgW107XG4gICAgICAgICAgICAgICAgICAgIGZpbGVzRmllbGRzLnB1c2goLi4uKGZpbGVGaWVsZHNGcm9tVGFnIHx8IFtdKS5maWx0ZXIoZmllbGQgPT4gIWZpbGVzRmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSkpKVxuICAgICAgICAgICAgICAgICAgICBmaWxlc0ZpZWxkcy5wdXNoKC4uLihmaWxlRmllbGRzRnJvbVF1ZXJ5IHx8IFtdKS5maWx0ZXIoZmllbGQgPT4gIWZpbGVzRmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGQubmFtZSkpKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmllbGRzLnNldChmLnBhdGgsIGZpbGVzRmllbGRzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZmllbGRzRnJvbUdsb2JhbEZpbGVDbGFzcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkcy5zZXQoZi5wYXRoLCB0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbdGhpcy5maWxlQ2xhc3Nlc05hbWUuZ2V0KHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyEpIV0pXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLnNldChmLnBhdGgsIFt0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MhXSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMubWFwKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgZmllbGRzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0RmlsZXNGaWVsZHNFeGlzdHMoZmlsZT86IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIGxldCBmaWxlRmllbGRzOiBBcnJheTxbc3RyaW5nLCBGaWVsZFtdXT5cbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVGaWVsZHMgPSBbW2ZpbGUucGF0aCwgdGhpcy5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKSB8fCBbXV1dXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaWxlRmllbGRzID0gWy4uLnRoaXMuZmlsZXNGaWVsZHNdXG4gICAgICAgIH1cbiAgICAgICAgZmlsZUZpZWxkcy5mb3JFYWNoKChbZmlsZVBhdGgsIGZpZWxkc10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IHRoaXMuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0ZpZWxkczogRmllbGRbXSA9IFtdXG4gICAgICAgICAgICBmaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGR2RmlsZSAmJiBkdkZpbGVbZmllbGQubmFtZV0gIT09IHVuZGVmaW5lZCkgeyBleGlzdGluZ0ZpZWxkcy5wdXNoKGZpZWxkKSB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKGV4aXN0aW5nRmllbGRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHNFeGlzdHMuc2V0KGZpbGVQYXRoLCBleGlzdGluZ0ZpZWxkcylcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0V4aXN0cy5kZWxldGUoZmlsZVBhdGgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuIiwgImltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwiLi9maWxlQ2xhc3NcIjtcblxuY2xhc3MgRmlsZUNsYXNzQXR0cmlidXRlIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgb3JpZ2luOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyB0eXBlOiBGaWVsZFR5cGUgPSBGaWVsZFR5cGUuSW5wdXQsXG4gICAgICAgIHB1YmxpYyBvcHRpb25zOiBzdHJpbmdbXSB8IFJlY29yZDxzdHJpbmcsIGFueT4gPSBbXSxcbiAgICAgICAgcHVibGljIGZpbGVDbGFzc05hbWU6IHN0cmluZ1xuICAgICkgeyB9XG5cbiAgICBwdWJsaWMgZ2V0RmllbGQoKSB7XG4gICAgICAgIGxldCBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMub3B0aW9ucykpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucz8uZm9yRWFjaCgob3B0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNbaW5kZXhdID0gb3B0aW9uO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEZpZWxkKHRoaXMubmFtZSwgb3B0aW9ucywgdGhpcy5uYW1lLCB0aGlzLnR5cGUsIHRoaXMuZmlsZUNsYXNzTmFtZSk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfTsiLCAiaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH0gZnJvbSBcIi4vZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkVHlwZUxhYmVsTWFwcGluZyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgY2FwaXRhbGl6ZSB9IGZyb20gXCJzcmMvdXRpbHMvdGV4dFV0aWxzXCI7XG5pbXBvcnQgeyBnZW51aW5lS2V5cyB9IGZyb20gXCJzcmMvdXRpbHMvZGF0YXZpZXdVdGlsc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0RnJvbnRtYXR0ZXJXaXRoRmllbGRzXCI7XG5cbmludGVyZmFjZSBGaWxlQ2xhc3Mge1xuICAgIGF0dHJpYnV0ZXM6IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT47XG4gICAgb2JqZWN0czogRmlsZUNsYXNzTWFuYWdlcjtcbiAgICBlcnJvcnM6IHN0cmluZ1tdO1xuICAgIHBhcmVudD86IEZpbGVDbGFzcztcbiAgICBleGNsdWRlcz86IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT47XG59XG5cbmV4cG9ydCBjbGFzcyBBZGRGaWxlQ2xhc3NUb0ZpbGVNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxzdHJpbmc+IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHwgUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICByZXR1cm4gWy4uLnRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmtleXMoKV1cbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZUNsYXNzTmFtZSA9PiAhdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzXG4gICAgICAgICAgICAgICAgLmdldCh0aGlzLmZpbGUucGF0aCk/Lm1hcChmaWxlQ2xhc3MgPT4gZmlsZUNsYXNzLm5hbWUpXG4gICAgICAgICAgICAgICAgLmluY2x1ZGVzKGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuZmlsdGVyKGZpbGVDbGFzc05hbWUgPT4gZmlsZUNsYXNzTmFtZS50b0xvY2FsZUxvd2VyQ2FzZSgpLmNvbnRhaW5zKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5zZXRUZXh0KHZhbHVlKTtcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIHRoaXMuaW5zZXJ0RmlsZUNsYXNzVG9GaWxlKGl0ZW0pXG4gICAgfVxuXG4gICAgYXN5bmMgaW5zZXJ0RmlsZUNsYXNzVG9GaWxlKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc1xuICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXMuZ2V0KHRoaXMuZmlsZS5wYXRoKVxuICAgICAgICBjb25zdCBmcm9udG1hdHRlckZpbGVDbGFzc2VzID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRoaXMuZmlsZSk/LmZyb250bWF0dGVyPy5bZmlsZUNsYXNzQWxpYXNdO1xuICAgICAgICBpZiAoY3VycmVudEZpbGVDbGFzc2VzICYmIGZyb250bWF0dGVyRmlsZUNsYXNzZXMpIHtcbiAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmlsZUNsYXNzQWxpYXMsIFsuLi5jdXJyZW50RmlsZUNsYXNzZXMubWFwKGZjID0+IGZjLm5hbWUpLCB2YWx1ZV0uam9pbihcIiwgXCIpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5maWxlKT8uZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGlmIChmcm9udG1hdHRlcikge1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhmcm9udG1hdHRlcikuaW5jbHVkZXMoZmlsZUNsYXNzQWxpYXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZmlsZUNsYXNzIGZpZWxkIGlzIGVtcHR5LCBoYXMgYW4gZW1wdHkgYXJyYXkgb2YgaXMgYmFkbHkgZm9ybWF0dGVkOiBvdmVycmlkZSBpdFxuICAgICAgICAgICAgICAgICAgICBhd2FpdCByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpbGVDbGFzc0FsaWFzLCB2YWx1ZSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2Zyb250bWF0dGVyIGV4aXN0cyBidXQgZG9lc24ndCBjb250YWluIGZpbGVDbGFzczogYWRkIGl0XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZSAtIDFcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpbGVDbGFzc0FsaWFzLCB2YWx1ZSwgbGluZU51bWJlciwgdHJ1ZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgICAgICAgICAgICAgZmllbGRzW2ZpbGVDbGFzc0FsaWFzXSA9IHZhbHVlXG4gICAgICAgICAgICAgICAgYXdhaXQgaW5zZXJ0RnJvbnRtYXR0ZXJXaXRoRmllbGRzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpZWxkcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgaW5zdGFuY2U6IEZpbGVDbGFzcykgeyB9XG5cbiAgICBwdWJsaWMgYWxsKCkge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maWx0ZXIoZmlsZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGU/LmZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgJiYgT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpLmluY2x1ZGVzKGZpbGVDbGFzc0FsaWFzKVxuICAgICAgICAgICAgICAgICYmIGNhY2hlLmZyb250bWF0dGVyW2ZpbGVDbGFzc0FsaWFzXSA9PSB0aGlzLmluc3RhbmNlLm5hbWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aE5hbWUgPSB0aGlzLmFsbCgpLmZpbHRlcihmaWxlID0+IGZpbGUucGF0aC5yZXBsYWNlKC9tZCQvLCBcIlwiKS5lbmRzV2l0aChuYW1lKSk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQYXRoKHBhdGg6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhOYW1lID0gdGhpcy5hbGwoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGggPT0gcGF0aCk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vYmplY3RzID0gbmV3IEZpbGVDbGFzc01hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgIH1cblxuICAgIHB1YmxpYyBpc01hcHBlZFdpdGhUYWcoKTogYm9vbGVhbiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NGaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgICAgIGNvbnN0IG1hcFdpdGhUYWcgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZUNsYXNzRmlsZSk/LmZyb250bWF0dGVyPy5tYXBXaXRoVGFnO1xuICAgICAgICAgICAgcmV0dXJuICEhbWFwV2l0aFRhZztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldENsYXNzRmlsZSgpOiBURmlsZSB7XG4gICAgICAgIGNvbnN0IGZpbGVzQ2xhc3NQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGg7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke2ZpbGVzQ2xhc3NQYXRofSR7dGhpcy5uYW1lfS5tZGApO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICBgbm8gZmlsZSBuYW1lZCA8JHt0aGlzLm5hbWV9Lm1kPiBpbiA8JHtmaWxlc0NsYXNzUGF0aH0+IGZvbGRlciB0byBtYXRjaCA8JHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc306ICR7dGhpcy5uYW1lfT4gaW4gb25lIG9mIHRoZXNlIG5vdGVzYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldEluaGVyaXRhbmNlTGlzdCgpOiBGaWxlQ2xhc3NbXSB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyPy5leHRlbmRzXG4gICAgICAgIGlmIChmYWxzZSAmJiBwYXJlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudEZpbGVDbGFzcyA9IEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIHBhcmVudCk7XG4gICAgICAgICAgICByZXR1cm4gWy4uLnBhcmVudEZpbGVDbGFzcy5nZXRJbmhlcml0YW5jZUxpc3QoKSwgdGhpc11cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3RoaXNdXG4gICAgfVxuXG4gICAgZ2V0SWNvbigpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICBjb25zdCBwYXJlbnRzID0gdGhpcy5nZXRJbmhlcml0YW5jZUxpc3QoKTtcbiAgICAgICAgcGFyZW50cy5yZXZlcnNlKClcbiAgICAgICAgbGV0IGljb246IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgcGFyZW50cy5zb21lKChmaWxlQ2xhc3MsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgICAgICBjb25zdCBfaWNvbiA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI/Lmljb25cbiAgICAgICAgICAgIGlmIChfaWNvbikge1xuICAgICAgICAgICAgICAgIGljb24gPSBfaWNvblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGljb25cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0RmlsZUNsYXNzQXR0cmlidXRlcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZUNsYXNzOiBGaWxlQ2xhc3MsIGV4Y2x1ZGVzPzogc3RyaW5nW10pOiBGaWxlQ2xhc3NBdHRyaWJ1dGVbXSB7XG5cbiAgICAgICAgY29uc3QgZmlsZSA9IGZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgbGV0IGF0dHJpYnV0ZXM6IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT4gPSBbXTtcbiAgICAgICAgY29uc3QgZHZBcGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGdlbnVpbmVLZXlzKGR2RmlsZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSBcImZpbGVcIiAmJiAhT2JqZWN0LmtleXMoZHZGaWxlLmZpbGUuZnJvbnRtYXR0ZXIgfHwge30pLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0eXBlb2YgZHZGaWxlW2tleV0gIT09IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KGR2RmlsZVtrZXldKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogZHZGaWxlW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgb3B0aW9ucyB9ID0gSlNPTi5wYXJzZShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFR5cGUgPSBGaWVsZFR5cGVMYWJlbE1hcHBpbmdbY2FwaXRhbGl6ZSh0eXBlKSBhcyBrZXlvZiB0eXBlb2YgRmllbGRUeXBlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZSh0aGlzLm5hbWUsIGtleSwgZmllbGRUeXBlLCBvcHRpb25zLCBmaWxlQ2xhc3MubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnB1c2goYXR0cilcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4Y2x1ZGVzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXR0cmlidXRlcy5maWx0ZXIoYXR0ciA9PiAhZXhjbHVkZXMuaW5jbHVkZXMoYXR0ci5uYW1lKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0RXhjbHVkZWRGaWVsZHNGcm9tRnJvbnRtYXR0ZXIoZXhjbHVkZWRGaWVsZHM6IHN0cmluZ1tdIHwgc3RyaW5nIHwgdW5kZWZpbmVkKTogc3RyaW5nW10ge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShleGNsdWRlZEZpZWxkcykpIHtcbiAgICAgICAgICAgIHJldHVybiBleGNsdWRlZEZpZWxkcztcbiAgICAgICAgfSBlbHNlIGlmIChleGNsdWRlZEZpZWxkcykge1xuICAgICAgICAgICAgcmV0dXJuIGV4Y2x1ZGVkRmllbGRzLnNwbGl0KFwiLFwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtdXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0QXR0cmlidXRlcyhleGNsdWRlUGFyZW50czogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9ycyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNBbmNlc3RvcnMuZ2V0KHRoaXMubmFtZSk7XG4gICAgICAgICAgICBjb25zdCBfZXhjbHVkZWRGaWVsZHMgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyPy5leGNsdWRlc1xuICAgICAgICAgICAgbGV0IGV4Y2x1ZGVkRmllbGRzID0gRmlsZUNsYXNzLmdldEV4Y2x1ZGVkRmllbGRzRnJvbUZyb250bWF0dGVyKF9leGNsdWRlZEZpZWxkcyk7XG5cbiAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yc0F0dHJpYnV0ZXM6IE1hcDxzdHJpbmcsIEZpbGVDbGFzc0F0dHJpYnV0ZVtdPiA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIGFuY2VzdG9yc0F0dHJpYnV0ZXMuc2V0KHRoaXMubmFtZSwgRmlsZUNsYXNzLmdldEZpbGVDbGFzc0F0dHJpYnV0ZXModGhpcy5wbHVnaW4sIHRoaXMsIGV4Y2x1ZGVkRmllbGRzKSlcbiAgICAgICAgICAgIGlmICghZXhjbHVkZVBhcmVudHMpIHtcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnM/LmZvckVhY2goYW5jZXN0b3JOYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5jZXN0b3JGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aH0ke2FuY2VzdG9yTmFtZX0ubWRgKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhbmNlc3RvciA9IG5ldyBGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIGFuY2VzdG9yTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yc0F0dHJpYnV0ZXMuc2V0KGFuY2VzdG9yTmFtZSwgRmlsZUNsYXNzLmdldEZpbGVDbGFzc0F0dHJpYnV0ZXModGhpcy5wbHVnaW4sIGFuY2VzdG9yLCBleGNsdWRlZEZpZWxkcykpXG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmNlc3RvckZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBhbmNlc3RvckZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IF9leGNsdWRlZEZpZWxkcyA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhbmNlc3RvckZpbGUpPy5mcm9udG1hdHRlcj8uZXhjbHVkZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkRmllbGRzID0gRmlsZUNsYXNzLmdldEV4Y2x1ZGVkRmllbGRzRnJvbUZyb250bWF0dGVyKF9leGNsdWRlZEZpZWxkcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBbZmlsZUNsYXNzTmFtZSwgZmlsZUNsYXNzQXR0cmlidXRlc10gb2YgYW5jZXN0b3JzQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5wdXNoKC4uLmZpbGVDbGFzc0F0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gIXRoaXMuYXR0cmlidXRlcy5tYXAoX2F0dHIgPT4gX2F0dHIubmFtZSkuaW5jbHVkZXMoYXR0ci5uYW1lKSkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgdXBkYXRlQXR0cmlidXRlKG5ld1R5cGU6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIG5ld05hbWU6IHN0cmluZywgbmV3T3B0aW9ucz86IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgYXR0cj86IEZpbGVDbGFzc0F0dHJpYnV0ZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhdHRyID8gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGF0dHIuZmlsZUNsYXNzTmFtZSkhIDogdGhpc1xuICAgICAgICBjb25zdCBmaWxlID0gZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgaWYgKGF0dHIpIHtcbiAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoYXR0ci5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2V0dGluZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld09wdGlvbnMpIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtuZXdOYW1lfTo6ICR7SlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpfWApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgIGlmIChuZXdPcHRpb25zKSBzZXR0aW5nc1tcIm9wdGlvbnNcIl0gPSBuZXdPcHRpb25zO1xuICAgICAgICAgICAgcmVzdWx0ICs9IChgXFxuJHtuZXdOYW1lfTo6ICR7SlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpfWApO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHJlbW92ZUF0dHJpYnV0ZShhdHRyOiBGaWxlQ2xhc3NBdHRyaWJ1dGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICByZXN1bHQuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICBpZiAoIWxpbmUuc3RhcnRzV2l0aChhdHRyLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgIH1cblxuICAgIHN0YXRpYyBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZywgZXhjbHVkZVBhcmVudDogYm9vbGVhbiA9IGZhbHNlKTogRmlsZUNsYXNzIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gbmV3IEZpbGVDbGFzcyhwbHVnaW4sIG5hbWUpO1xuICAgICAgICBmaWxlQ2xhc3MuZ2V0QXR0cmlidXRlcygpXG4gICAgICAgIHJldHVybiBmaWxlQ2xhc3NcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0RmlsZUNsYXNzTmFtZUZyb21QYXRoKHBsdWdpbjogTWV0YWRhdGFNZW51LCBwYXRoOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lUmVnZXggPSBuZXcgUmVnRXhwKGAke3BsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aH0oPzxmaWxlQ2xhc3NOYW1lPi4qKS5tZGApO1xuICAgICAgICByZXR1cm4gcGF0aC5tYXRjaChmaWxlQ2xhc3NOYW1lUmVnZXgpPy5ncm91cHM/LmZpbGVDbGFzc05hbWVcbiAgICB9XG59XG5cblxuZXhwb3J0IHsgRmlsZUNsYXNzIH07IiwgImV4cG9ydCBjb25zdCBjYXBpdGFsaXplID0gKHM6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBzICYmIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSk7XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmNsYXNzIEZpbGVDbGFzc1F1ZXJ5IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgbmFtZTogc3RyaW5nID0gXCJcIixcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgcXVlcnk6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3NOYW1lOiBzdHJpbmcgPSBcIlwiXG4gICAgKSB7IH07XG5cbiAgICAvL0B0cy1pZ25vcmVcbiAgICBwdWJsaWMgZ2V0UmVzdWx0cyhhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKTogYW55IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgYHJldHVybiAke3RoaXMucXVlcnl9YCkpKGFwaSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBXcm9uZyBxdWVyeSBmb3IgZmllbGQgPCR7dGhpcy5uYW1lfT4uIENoZWNrIHlvdXIgc2V0dGluZ3NgKVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHB1YmxpYyBtYXRjaEZpbGUoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcblxuICAgICAgICBjb25zdCBkYXRhdmlldyA9IGFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXdcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5ICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IHRoaXMuZ2V0UmVzdWx0cyhkYXRhdmlldy5hcGkpLnZhbHVlcy5tYXAoKHY6IGFueSkgPT4gdi5maWxlLnBhdGgpIGFzIHN0cmluZ1tdXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVzUGF0aC5pbmNsdWRlcyhmaWxlLnBhdGgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgY29weVByb3BlcnR5KHRhcmdldDogRmlsZUNsYXNzUXVlcnksIHNvdXJjZTogRmlsZUNsYXNzUXVlcnkpIHtcbiAgICAgICAgdGFyZ2V0LmlkID0gc291cmNlLmlkO1xuICAgICAgICB0YXJnZXQubmFtZSA9IHNvdXJjZS5uYW1lO1xuICAgICAgICB0YXJnZXQucXVlcnkgPSBzb3VyY2UucXVlcnk7XG4gICAgICAgIHRhcmdldC5maWxlQ2xhc3NOYW1lID0gc291cmNlLmZpbGVDbGFzc05hbWVcbiAgICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgRmlsZUNsYXNzUXVlcnk7IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgU3RhdHVzIH0gZnJvbSBcInNyYy90eXBlcy9sb29rdXBUeXBlc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZUxvb2t1cHMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHNvdXJjZTogc3RyaW5nID0gXCJcIik6IHZvaWQge1xuICAgIGNvbnN0IGYgPSBwbHVnaW4uZmllbGRJbmRleDtcbiAgICAvL2ZpcnN0IHJlc29sdmUgYWxsIGV4aXN0aW5nIGxvb2t1cCBxdWVyaWVzIGZyb20gdGhlaXIgZGVmaW5pdGlvbnMgaW4gZmlsZUNsYXNzZXMgYW5kIHNldHRpbmdzXG4gICAgY29uc3QgbG9va3VwUXVlcnlSZXN1bHRzOiBNYXA8c3RyaW5nLCBhbnlbXT4gPSBuZXcgTWFwKCk7XG4gICAgWy4uLmYubG9va3VwUXVlcmllc10uZm9yRWFjaCgoW2xvb2t1cE5hbWUsIGZpZWxkXSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeVJlbGF0ZWREVkZpbGVzID0gKG5ldyBGdW5jdGlvbihcImR2XCIsIGByZXR1cm4gJHtmaWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmd9YCkpKGYuZHYuYXBpKS52YWx1ZXMgYXMgQXJyYXk8YW55PjtcbiAgICAgICAgbG9va3VwUXVlcnlSZXN1bHRzLnNldChsb29rdXBOYW1lLCBxdWVyeVJlbGF0ZWREVkZpbGVzKTtcblxuICAgIH0pO1xuICAgIC8vdGhlbiBhc3NpZ24gcmVzdWx0cyB0byBhbGwgZmlsZXMgaGF2aW5nIGltcGxlbWVudGVkIGEgbG9va3VwZmllbGRcbiAgICBbLi4uZi5maWxlc0ZpZWxkc0V4aXN0c10uZm9yRWFjaCgoW2ZpbGVQYXRoLCBmaWVsZHNdKSA9PiB7XG4gICAgICAgIGZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkxvb2t1cCkuZm9yRWFjaChsb29rdXBGaWVsZCA9PiB7XG4gICAgICAgICAgICAvL2ZvciBhbGwgbG9va3VwIGZpZWxkcyBpbiBmaWxlcyB0aGF0IGhhdmUgbG9va3VwZmllbGRzOlxuICAgICAgICAgICAgLy8xLiBnZXQgdGhlIHF1ZXJ5IHJlc3VsdHNcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5UmVsYXRlZERWRmlsZXMgPSBsb29rdXBRdWVyeVJlc3VsdHMuZ2V0KGAke2xvb2t1cEZpZWxkLmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwifV9fXyR7bG9va3VwRmllbGQubmFtZX1gKSB8fCBbXTtcbiAgICAgICAgICAgIC8vMi4gZmlsdGVyIHRob3NlIHJlc3VsdHMgYnkgdGhlaXIgdGFyZ2V0RmllbGQgY29udGVudCBpbmNsdWRpbmcgdGhpcyBmaWxlIC8vXG4gICAgICAgICAgICBjb25zdCBmaWxlUmVsYXRlZERWRmlsZXMgPSBxdWVyeVJlbGF0ZWREVkZpbGVzLmZpbHRlcihkdkZpbGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldFZhbHVlID0gZHZGaWxlW2xvb2t1cEZpZWxkLm9wdGlvbnMudGFyZ2V0RmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0YXJnZXRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFZhbHVlLmZpbHRlcih2ID0+IGYuZHYuYXBpLnZhbHVlLmlzTGluayh2KSkubWFwKHYgPT4gdi5wYXRoKS5pbmNsdWRlcyhmaWxlUGF0aClcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0VmFsdWU/LnBhdGggPT09IGZpbGVQYXRoXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vMy4gYXNzaWduIHRob3NlIHJlc3VsdHMgdG8gZmlsZUxvb2t1cEZpbGVzXG4gICAgICAgICAgICBjb25zdCByZWxhdGVkRmllbGROYW1lID0gYCR7ZmlsZVBhdGh9X19yZWxhdGVkX18ke2xvb2t1cEZpZWxkLmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwifV9fXyR7bG9va3VwRmllbGQubmFtZX1gXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0ZpbGVMb29rdXBGaWVsZHMgPSBmLmZpbGVMb29rdXBGaWxlcy5nZXQocmVsYXRlZEZpZWxkTmFtZSlcbiAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpbGVzLnNldChyZWxhdGVkRmllbGROYW1lLCBmaWxlUmVsYXRlZERWRmlsZXMpXG4gICAgICAgICAgICAvLzQuIHJlc2V0IFByZXZpb3VzIHJlc3VsdHMgY291bnQgdG8gY3VycmVudCB2YWx1ZVxuICAgICAgICAgICAgaWYgKCEoZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLmdldChgJHtmaWxlUGF0aH1fXyR7bG9va3VwRmllbGQubmFtZX1gKSA9PT0gU3RhdHVzLmNoYW5nZWQpKSBmLnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLnNldChyZWxhdGVkRmllbGROYW1lLCAoZXhpc3RpbmdGaWxlTG9va3VwRmllbGRzIHx8IGZpbGVSZWxhdGVkRFZGaWxlcykubGVuZ3RoKVxuICAgICAgICAgICAgLy81LiBjaGFuZ2UgdGhlIHN0YXR1cyBvZiB0aGlzIGxvb2t1cCBmaWVsZFxuICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLnNldChgJHtmaWxlUGF0aH1fXyR7bG9va3VwRmllbGQubmFtZX1gLCBTdGF0dXMuY2hhbmdlZClcbiAgICAgICAgfSlcbiAgICB9KVxuICAgIC8vcmVtb3ZlIG5vbiBleGlzdGluZyBsb29rdXAgZmllbGRzIGZyb20gaW5kZXgsIHNpbmNlIHRob3NlIGluZGV4ZXMgYXJlbid0IGZsdXNoZWQgZWFjaCB0aW1lXG4gICAgZm9yIChsZXQgaWQgb2YgZi5maWxlTG9va3VwRmlsZXMua2V5cygpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoUmVnZXggPSAvKD88ZmlsZVBhdGg+LiopX19yZWxhdGVkX18oPzxmaWxlQ2xhc3NOYW1lPi4qKV9fXyg/PGZpZWxkTmFtZT4uKikvXG4gICAgICAgIGNvbnN0IHsgZmlsZVBhdGgsIGZpbGVDbGFzc05hbWUsIGZpZWxkTmFtZSB9ID0gaWQubWF0Y2gobWF0Y2hSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICBjb25zdCBleGlzdGluZ0xvb2tGaWVsZFdpdGhOYW1lQW5kRmlsZUNsYXNzTmFtZSA9IGYuZmlsZXNGaWVsZHNcbiAgICAgICAgICAgIC5nZXQoZmlsZVBhdGgpPy5maW5kKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgKGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSkgJiZcbiAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgIChmaWVsZC5maWxlQ2xhc3NOYW1lID09PSB1bmRlZmluZWQgJiYgZmlsZUNsYXNzTmFtZSA9PT0gXCJwcmVzZXRGaWVsZFwiKSB8fFxuICAgICAgICAgICAgICAgICAgICAoZmllbGQuZmlsZUNsYXNzTmFtZSA9PT0gZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgIGNvbnN0IGR2UGFnZSA9IGYuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZHZQYWdlID09PSB1bmRlZmluZWQgfHwgZHZQYWdlW2ZpZWxkTmFtZV0gPT09IHVuZGVmaW5lZCB8fCAhZXhpc3RpbmdMb29rRmllbGRXaXRoTmFtZUFuZEZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpbGVzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RWYWx1ZS5kZWxldGUoaWQpO1xuICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRMYXN0T3V0cHV0VHlwZS5kZWxldGUoaWQpO1xuICAgICAgICAgICAgZi5wcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlcy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLmRlbGV0ZShgJHtmaWxlUGF0aH1fXyR7ZmllbGROYW1lfWApXG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwiLi9yZXBsYWNlVmFsdWVzXCI7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuUmVtb3ZlZEZvcm11bGFzRnJvbUluZGV4KFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51XG4pOiB2b2lkIHtcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgZm9yIChsZXQgaWQgb2YgZi5maWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlLmtleXMoKSkge1xuICAgICAgICBjb25zdCBtYXRjaFJlZ2V4ID0gLyg/PGZpbGVQYXRoPi4qKV9fY2FsY3VsYXRlZF9fKD88ZmlsZUNsYXNzTmFtZT4uKilfX18oPzxmaWVsZE5hbWU+LiopL1xuICAgICAgICBjb25zdCB7IGZpbGVQYXRoLCBmaWxlQ2xhc3NOYW1lLCBmaWVsZE5hbWUgfSA9IGlkLm1hdGNoKG1hdGNoUmVnZXgpPy5ncm91cHMgfHwge31cbiAgICAgICAgY29uc3QgZXhpc3RpbmdGb3JtdWxhRmllbGRXaXRoTmFtZUFuZEZpbGVDbGFzc05hbWUgPSBmLmZpbGVzRmllbGRzXG4gICAgICAgICAgICAuZ2V0KGZpbGVQYXRoKT8uZmluZChmaWVsZCA9PlxuICAgICAgICAgICAgICAgIChmaWVsZC5uYW1lID09PSBmaWVsZE5hbWUpICYmXG4gICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAoZmllbGQuZmlsZUNsYXNzTmFtZSA9PT0gdW5kZWZpbmVkICYmIGZpbGVDbGFzc05hbWUgPT09IFwicHJlc2V0RmllbGRcIikgfHxcbiAgICAgICAgICAgICAgICAgICAgKGZpZWxkLmZpbGVDbGFzc05hbWUgPT09IGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICBjb25zdCBkdlBhZ2UgPSBmLmR2LmFwaS5wYWdlKGZpbGVQYXRoKTtcbiAgICAgICAgaWYgKGR2UGFnZSA9PT0gdW5kZWZpbmVkIHx8IGR2UGFnZVtmaWVsZE5hbWVdID09PSB1bmRlZmluZWQgfHwgIWV4aXN0aW5nRm9ybXVsYUZpZWxkV2l0aE5hbWVBbmRGaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBmLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUuZGVsZXRlKGlkKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUZvcm11bGFzKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51XG4pOiBQcm9taXNlPHZvaWQ+IHtcblxuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKVxuICAgIC8vY29uc29sZS5sb2coXCJzdGFydCB1cGRhdGUgZm9ybXVsYXNcIiwgcGx1Z2luLmZpZWxkSW5kZXgubGFzdFJldmlzaW9uLCBcIi0+XCIsIHBsdWdpbi5maWVsZEluZGV4LmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgY29uc3QgZiA9IHBsdWdpbi5maWVsZEluZGV4O1xuICAgIGxldCByZW5kZXJpbmdFcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgLy8xLiBmbGF0dGVuIGFsbCBmaWxlX19mb3JtdWxhRmllbGQgaW4gYSBNYXBcbiAgICBjb25zdCBmaWxlRm9ybXVsYXNGaWVsZHM6IE1hcDxzdHJpbmcsIEZpZWxkPiA9IG5ldyBNYXAoKTtcbiAgICBbLi4uZi5maWxlc0ZpZWxkc0V4aXN0c10uZm9yRWFjaCgoW2ZpbGVQYXRoLCBmaWVsZHNdKSA9PiB7XG4gICAgICAgIGZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkZvcm11bGEpLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgZmlsZUZvcm11bGFzRmllbGRzLnNldChgJHtmaWxlUGF0aH1fX2NhbGN1bGF0ZWRfXyR7ZmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X19fJHtmaWVsZC5uYW1lfWAsIGZpZWxkKVxuICAgICAgICB9KVxuICAgIH0pO1xuICAgIC8vMi4gY2FsY3VsYXRlIGZvcm11bGEgYW5kIHVwZGF0ZSBmaWxlIGlmIHZhbHVlIGhhcyBjaGFuZ2VkXG4gICAgWy4uLmZpbGVGb3JtdWxhc0ZpZWxkc10uZm9yRWFjaChhc3luYyAoW2lkLCBmaWVsZF0pID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2hSZWdleCA9IC8oPzxmaWxlUGF0aD4uKilfX2NhbGN1bGF0ZWRfXyg/PGZpbGVDbGFzc05hbWU+LiopX19fKD88ZmllbGROYW1lPi4qKS9cbiAgICAgICAgY29uc3QgeyBmaWxlUGF0aCwgZmlsZUNsYXNzTmFtZSwgZmllbGROYW1lIH0gPSBpZC5tYXRjaChtYXRjaFJlZ2V4KT8uZ3JvdXBzIHx8IHt9XG4gICAgICAgIGNvbnN0IGR2RmlsZSA9IGYuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpXG4gICAgICAgIGNvbnN0IGN1cnJlbnRkdlZhbHVlID0gZHZGaWxlICYmIGR2RmlsZVtmaWVsZC5uYW1lXVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRkdlZhbHVlID8gY3VycmVudGR2VmFsdWUudG9TdHJpbmcoKSA6IFwiXCJcbiAgICAgICAgZi5maWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlLnNldChpZCwgY3VycmVudFZhbHVlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gKG5ldyBGdW5jdGlvbihcImN1cnJlbnQsIGR2XCIsIGByZXR1cm4gJHtmaWVsZC5vcHRpb25zLmZvcm11bGF9YCkpKGR2RmlsZSwgZi5kdi5hcGkpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBpZiAoKCFjdXJyZW50VmFsdWUgJiYgbmV3VmFsdWUgIT09IFwiXCIpIHx8IGN1cnJlbnRWYWx1ZSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHJlcGxhY2VWYWx1ZXMocGx1Z2luLCBmaWxlUGF0aCwgZmllbGQubmFtZSwgbmV3VmFsdWUpKTtcbiAgICAgICAgICAgICAgICBmLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUuc2V0KGlkLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgaWYgKHJlbmRlcmluZ0Vycm9ycy5pbmNsdWRlcyhmaWVsZC5uYW1lKSkgcmVuZGVyaW5nRXJyb3JzLnB1c2goZmllbGQubmFtZSlcbiAgICAgICAgfVxuICAgIH0pXG4gICAgaWYgKHJlbmRlcmluZ0Vycm9ycy5sZW5ndGgpIG5ldyBOb3RpY2UoYFRob3NlIGZpZWxkcyBoYXZlIGluY29ycmVjdCBvdXRwdXQgcmVuZGVyaW5nIGZ1bmN0aW9uczpcXG4ke3JlbmRlcmluZ0Vycm9ycy5qb2luKFwiLFxcblwiKX1gKTtcbiAgICAvL2NvbnNvbGUubG9nKFwiZmluaXNoZWQgdXBkYXRlIGZvcm11bGFzXCIsIHBsdWdpbi5maWVsZEluZGV4Lmxhc3RSZXZpc2lvbiwgXCItPlwiLCBwbHVnaW4uZmllbGRJbmRleC5kdj8uYXBpLmluZGV4LnJldmlzaW9uLCBgJHsoRGF0ZS5ub3coKSAtIHN0YXJ0KX1tc2ApXG4gICAgLy8zIHJlbW92ZSBub24gZXhpc3RpbmcgZm9ybXVsYSBmaWVsZHMgZnJvbSBpbmRleCwgc2luY2UgdGhvc2UgaW5kZXhlcyBhcmVuJ3QgZmx1c2hlZCBlYWNoIHRpbWVcbiAgICBjbGVhblJlbW92ZWRGb3JtdWxhc0Zyb21JbmRleChwbHVnaW4pO1xufVxuIiwgImltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgVGV4dENvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpZWxkVHlwZVRvb2x0aXAsIEZpZWxkVHlwZSwgRmllbGRUeXBlTGFiZWxNYXBwaW5nLCBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5cbmNsYXNzIEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBuYW1lSW5wdXRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgbmFtZUlucHV0OiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgYXR0ck5hbWU6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgdHlwZVNlbGVjdENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGRNYW5hZ2VyOiBGO1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcblxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgcHJpdmF0ZSBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmluaXRpYWxGaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBpZiAodGhpcy5hdHRyKSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gYXR0ciEuZ2V0RmllbGQoKVxuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgdGhpcy5uYW1lSW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy50eXBlU2VsZWN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci1jb250YWluZXInIH0pO1xuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpXG4gICAgfVxuXG4gICAgYnVpbGROYW1lSW5wdXRDb250YWluZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubmFtZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJOYW1lOiBcIik7XG4gICAgICAgIHRoaXMubmFtZUlucHV0ID0gbmV3IFRleHRDb21wb25lbnQodGhpcy5uYW1lSW5wdXRDb250YWluZXIpO1xuICAgICAgICB0aGlzLmF0dHIgPyB0aGlzLm5hbWVJbnB1dC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm5hbWUpIDogdGhpcy5uYW1lSW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJUeXBlIGEgbmFtZSBmb3IgdGhpcyBhdHRyaWJ1dGVcIik7XG4gICAgICAgIHRoaXMubmFtZUlucHV0LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgdGhpcy5uYW1lSW5wdXQub25DaGFuZ2UodmFsdWUgPT4geyB0aGlzLmZpZWxkLm5hbWUgPSB2YWx1ZTsgdGhpcy5hdHRyTmFtZS5zZXRUZXh0KGA8JHt2YWx1ZX0+YCkgfSk7XG4gICAgICAgIHRoaXMudHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBidWlsZFR5cGVTZWxlY3RDb250YWluZXIoKTogdm9pZCB7XG5cbiAgICAgICAgLy9oZWFkZXIgZm9yIHNlbGVjdFxuICAgICAgICBjb25zdCB0eXBlU2VsZWN0SGVhZGVyID0gdGhpcy50eXBlU2VsZWN0Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBhdHRyTGluZSA9IHR5cGVTZWxlY3RIZWFkZXIuY3JlYXRlRWwoXCJkaXZcIik7XG4gICAgICAgIHRoaXMuYXR0ck5hbWUgPSBhdHRyTGluZS5jcmVhdGVFbChcInN0cm9uZ1wiKTtcbiAgICAgICAgdGhpcy5hdHRyTmFtZS5zZXRUZXh0KGA8JHt0aGlzLmZpZWxkLm5hbWV9PmApO1xuICAgICAgICBhdHRyTGluZS5hcHBlbmQoXCIgZmllbGRzIGluIGZpbGVzIHdpdGg6XCIpO1xuICAgICAgICBTdHJpbmcoYC0tLVxcbiR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9OiAke3RoaXMuZmlsZUNsYXNzLm5hbWV9XFxuLi4uXFxuLS0tYCkuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICB0eXBlU2VsZWN0SGVhZGVyLmNyZWF0ZUVsKFwiZGl2XCIsIFwieWFtbC1tZXRhZGF0YS1tZW51LXJlZFwiKS5zZXRUZXh0KGxpbmUpO1xuICAgICAgICB9KVxuICAgICAgICAvL2Ryb3Bkb3duXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RMYWJlbCA9IHRoaXMudHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWlubGluZS1sYWJlbCcgfSk7XG4gICAgICAgIHR5cGVTZWxlY3RMYWJlbC5zZXRUZXh0KFwid2lsbDogXCIpO1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0RHJvcERvd24gPSB0aGlzLnR5cGVTZWxlY3RDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci10b2dnbGVyJyB9KTtcblxuICAgICAgICBjb25zdCB0eXBlU2VsZWN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHR5cGVTZWxlY3REcm9wRG93bik7XG5cbiAgICAgICAgT2JqZWN0LmtleXMoRmllbGRUeXBlVG9vbHRpcCkuZm9yRWFjaCgoa2V5OiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiB0eXBlU2VsZWN0LmFkZE9wdGlvbihrZXksIEZpZWxkVHlwZVRvb2x0aXBba2V5XSkpXG4gICAgICAgIHR5cGVTZWxlY3Quc2V0VmFsdWUodGhpcy5maWVsZC50eXBlKVxuICAgICAgICB0eXBlU2VsZWN0Lm9uQ2hhbmdlKCh0eXBlTGFiZWw6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHtcblxuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSA9IHRoaXMubmFtZUlucHV0LmdldFZhbHVlKClcbiAgICAgICAgICAgIHRoaXMuZmllbGQudHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1t0eXBlTGFiZWxdO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSAhPT0gdGhpcy5pbml0aWFsRmllbGQudHlwZSAmJlxuICAgICAgICAgICAgICAgICFbdGhpcy5maWVsZC50eXBlLCB0aGlzLmluaXRpYWxGaWVsZC50eXBlXS5ldmVyeShmaWVsZFR5cGUgPT5cbiAgICAgICAgICAgICAgICAgICAgW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyhmaWVsZFR5cGUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3MpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUZpZWxkcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlTmFtZShcbiAgICAgICAgICAgIHRoaXMubmFtZUlucHV0LFxuICAgICAgICAgICAgdGhpcy5uYW1lSW5wdXQuaW5wdXRFbFxuICAgICAgICApICYmXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU9wdGlvbnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVNhdmVCdG4oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZXJyb3IgPSAhdGhpcy52YWxpZGF0ZUZpZWxkcygpO1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkZpeCBlcnJvcnMgYmVmb3JlIHNhdmluZy5cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZSh0aGlzLmZpZWxkLnR5cGUsIHRoaXMuZmllbGQubmFtZSwgdGhpcy5maWVsZC5vcHRpb25zLCB0aGlzLmF0dHIpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlUmVtb3ZlbEJ0bihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgcmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKTtcbiAgICAgICAgcmVtb3ZlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29uZmlybU1vZGFsID0gbmV3IE1vZGFsKHRoaXMucGx1Z2luLmFwcCk7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiUGxlYXNlIGNvbmZpcm1cIik7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwuY29udGVudEVsLmNyZWF0ZURpdigpLnNldFRleHQoYERvIHlvdSByZWFsbHkgd2FudCB0byByZW1vdmUgJHt0aGlzLmF0dHI/Lm5hbWV9IGF0dHJpYnV0ZSBmcm9tICR7dGhpcy5maWxlQ2xhc3MubmFtZX0/YCk7XG4gICAgICAgICAgICBjb25zdCBjb25maXJtRm9vdGVyID0gY29uZmlybU1vZGFsLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29uZmlybUZvb3Rlcik7XG4gICAgICAgICAgICBjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgICAgICBjb25maXJtQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuZmlsZUNsYXNzLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHIpO1xuICAgICAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb25zdCBkaXNtaXNzQnV0dG9uID0gbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGNvbmZpcm1Gb290ZXIpO1xuICAgICAgICAgICAgZGlzbWlzc0J1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgICAgICBkaXNtaXNzQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5vcGVuKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDYW5jZWxCdG4oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIC8vdGl0bGVcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQodGhpcy5hdHRyID8gYE1hbmFnZSAke3RoaXMuYXR0ci5uYW1lfWAgOiBgQ3JlYXRlIGEgbmV3IGF0dHJpYnV0ZSBmb3IgJHt0aGlzLmZpbGVDbGFzcy5uYW1lfWApO1xuXG4gICAgICAgIHRoaXMuYnVpbGROYW1lSW5wdXRDb250YWluZXIoKVxuICAgICAgICB0aGlzLmJ1aWxkVHlwZVNlbGVjdENvbnRhaW5lcigpXG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3MpXG5cbiAgICAgICAgLy8gZm9vdGVyIGJ1dHRvbnNcbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVTYXZlQnRuKGZvb3Rlcik7XG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuY3JlYXRlUmVtb3ZlbEJ0bihmb290ZXIpO1xuICAgICAgICB0aGlzLmNyZWF0ZUNhbmNlbEJ0bihmb290ZXIpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSIsICJpbXBvcnQgeyBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBTdWdnZXN0TW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuaW50ZXJmYWNlIExpbmUge1xuICAgIGxpbmVOdW1iZXI6IG51bWJlclxuICAgIGxpbmVUZXh0OiBzdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgY2hvb3NlU2VjdGlvbk1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPExpbmU+IHtcblxuICAgIHByaXZhdGUgYWRkQXNMaXN0SXRlbTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgYWRkQXNDb21tZW50OiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBhZGRBdEVuZE9mRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIG9uU2VsZWN0OiAobGluZU51bWJlcjogbnVtYmVyLCBpbkZyb250bWF0dGVyOiBib29sZWFuLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4pID0+IHZvaWQsXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3RcbiAgICB9O1xuXG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICBzdXBlci5vbk9wZW4oKTtcbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1pbnB1dC1jb250YWluZXJcIiB9KVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmlucHV0RWwpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZmluZChcIi5wcm9tcHRcIikucHJlcGVuZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgLy8gaW5zZXJ0QXNMaXN0SXRlbVxuICAgICAgICBjb25zdCBhZGRBc0xpc3RJdGVtQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5zZXRJY29uKFwibGlzdFwiKVxuICAgICAgICBhZGRBc0xpc3RJdGVtQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuYWRkQXNMaXN0SXRlbSkge1xuICAgICAgICAgICAgICAgIGFkZEFzTGlzdEl0ZW1CdG4ucmVtb3ZlQ3RhKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRBc0xpc3RJdGVtID0gZmFsc2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5zZXRDdGEoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEFzTGlzdEl0ZW0gPSB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGFkZEFzTGlzdEl0ZW1CdG4uc2V0RGlzYWJsZWQodGhpcy5hZGRBdEVuZE9mRnJvbnRNYXR0ZXIpXG4gICAgICAgIGFkZEFzTGlzdEl0ZW1CdG4uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgZmllbGQgYXMgYSBsaXN0IGl0ZW1cIilcblxuICAgICAgICAvLyBpbnNlcnRBc0NvbW1lbnRJdGVtXG5cbiAgICAgICAgY29uc3QgYWRkQXNDb21tZW50SXRlbUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGFkZEFzQ29tbWVudEl0ZW1CdG4uc2V0SWNvbihcIm1lc3NhZ2Utc3F1YXJlXCIpXG4gICAgICAgIGFkZEFzQ29tbWVudEl0ZW1CdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hZGRBc0NvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICBhZGRBc0NvbW1lbnRJdGVtQnRuLnJlbW92ZUN0YSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQXNDb21tZW50ID0gZmFsc2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5zZXRDdGEoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEFzQ29tbWVudCA9IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5zZXREaXNhYmxlZCh0aGlzLmFkZEF0RW5kT2ZGcm9udE1hdHRlcilcbiAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICBhZGRBc0NvbW1lbnRJdGVtQnRuLnNldFRvb2x0aXAoXCJBZGQgdGhpcyBmaWVsZCBhcyBhIGNvbW1lbnQgaXRlbVwiKVxuXG5cbiAgICAgICAgLy8gaW5zZXJ0QXNDb21tZW50SXRlbVxuXG4gICAgICAgIGNvbnN0IGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0bi5zZXRJY29uKFwibGlzdC1lbmRcIilcbiAgICAgICAgYWRkQXRFbmRPZkZyb250TWF0dGVyQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vblNlbGVjdCgtMiwgdHJ1ZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSlcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgYWRkQXRFbmRPZkZyb250TWF0dGVyQnRuLmJ1dHRvbkVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYnV0dG9uXCIpXG4gICAgICAgIGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0bi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgZmllbGQgYXQgdGhlIGVuZCBvZiB0aGUgZnJvbnRtYXR0ZXJcIilcbiAgICB9XG5cbiAgICBhc3luYyBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxMaW5lW10+IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSlcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IExpbmVbXSA9IFt7XG4gICAgICAgICAgICBsaW5lTnVtYmVyOiAtMSxcbiAgICAgICAgICAgIGxpbmVUZXh0OiBcIi0tLS0tLS0tLS1BZGQgb24gdG9wIG9mIHRoZSBmaWxlLS0tLS0tLS1cIlxuICAgICAgICB9XVxuICAgICAgICBjb250ZW50LnNwbGl0KFwiXFxuXCIpXG4gICAgICAgICAgICAuZm9yRWFjaCgobGluZUNvbnRlbnQsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobGluZUNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lVGV4dDogbGluZUNvbnRlbnQuc3Vic3RyaW5nKDAsIDM3KSArIChsaW5lQ29udGVudC5sZW5ndGggPCAzNyA/IFwiXCIgOiBcIi4uLlwiKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IExpbmUsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtY2hvb3NlLXNlY3Rpb24tbW9kYWwtaXRlbVwiKVxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jaG9vc2Utc2VjdGlvbi1tb2RhbC1saW5lXCIgfSk7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBgJHt2YWx1ZS5saW5lTnVtYmVyICsgMX1gLCBjbHM6IFwibGluZU51bWJlclwiIH0pO1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWUubGluZVRleHQsIGNsczogXCJsaW5lVGV4dFwiIH0pO1xuICAgIH1cblxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBMaW5lLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRoaXMuZmlsZSk/LmZyb250bWF0dGVyXG4gICAgICAgIGNvbnN0IGluRnJvbnRtYXR0ZXIgPSBmcm9udG1hdHRlciAhPT0gdW5kZWZpbmVkICYmIChpdGVtLmxpbmVOdW1iZXIgPD0gZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLmxpbmUpXG4gICAgICAgIGNvbnN0IGFmdGVyID0gaXRlbS5saW5lTnVtYmVyID09IC0xID8gZmFsc2UgOiB0cnVlO1xuICAgICAgICB0aGlzLm9uU2VsZWN0KGl0ZW0ubGluZU51bWJlciA9PSAtMSA/IDAgOiBpdGVtLmxpbmVOdW1iZXIsXG4gICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICB0aGlzLmFkZEFzTGlzdEl0ZW0sXG4gICAgICAgICAgICB0aGlzLmFkZEFzQ29tbWVudClcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgY2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbFwiO1xuaW1wb3J0IHsgc2V0SWNvbiwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZnVuY3Rpb24gYnVpbGRBbmRPcGVuTW9kYWwoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZTogVEZpbGUsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbik6IHZvaWQge1xuICAgIGlmIChhdHRycz8ub3B0aW9ucz8uaW5Gcm9udG1hdHRlciAmJiBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoZmlsZS5wYXRoKT8uZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgY29uc3QgbGluZU51bWJlciA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZShmaWxlLnBhdGgpIS5mcm9udG1hdHRlciEucG9zaXRpb24uZW5kLmxpbmUgLSAxXG4gICAgICAgIEYub3BlbkZpZWxkTW9kYWwocGx1Z2luLCBmaWxlLCBmaWVsZE5hbWUsIFwiXCIsIGxpbmVOdW1iZXIsIHRydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2UpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgbmV3IGNob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgIHBsdWdpbixcbiAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgKSA9PiBGLm9wZW5GaWVsZE1vZGFsKFxuICAgICAgICAgICAgICAgIHBsdWdpbixcbiAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgIGZpZWxkTmFtZSxcbiAgICAgICAgICAgICAgICBcIlwiLFxuICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICApXG4gICAgICAgICkub3BlbigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlRHZGaWVsZChcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBkdjogYW55LFxuICAgIHA6IGFueSxcbiAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbik6IHZvaWQge1xuICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHAuZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBmaWVsZE5hbWUpXG4gICAgaWYgKGZpZWxkPy50eXBlKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0ocGx1Z2luLCBmaWVsZCk7XG4gICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKGR2LCBwLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKGR2LCBwLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpZWxkTW9kaWZpZXIoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZHY6IGFueSxcbiAgICBwOiBhbnksXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbik6IEhUTUxFbGVtZW50IHtcblxuICAgIC8qIGZpZWxkQ29udGFpbmVyKi9cbiAgICBjb25zdCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQgPSBkdi5lbChcImRpdlwiLCBcIlwiKVxuICAgIGZpZWxkQ29udGFpbmVyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtY29udGFpbmVyXCIpXG5cbiAgICAvKiBjcmVhdGUgZmllbGRNb2RpZmllciBkZXBlbmRpbmcgb24gZmlsZUNsYXNzIHR5cGUgb3IgcHJlc2V0IHZhbHVlKi9cblxuICAgIGlmIChwW2ZpZWxkTmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5zaG93QWRkRmllbGQpIHtcbiAgICAgICAgICAgIGNvbnN0IGVtcHR5RmllbGQgPSBkdi5lbChcInNwYW5cIiwgbnVsbCwgYXR0cnMpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZW1wdHlGaWVsZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBhZGRGaWVsZEJ0biA9IGR2LmVsKFwiYnV0dG9uXCIsIGF0dHJzKTtcbiAgICAgICAgICAgIHNldEljb24oYWRkRmllbGRCdG4sIFwicGx1cy13aXRoLWNpcmNsZVwiKVxuICAgICAgICAgICAgYWRkRmllbGRCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgICAgIGFkZEZpZWxkQnRuLmFkZENsYXNzKFwiaXNvbGF0ZWRcIik7XG4gICAgICAgICAgICBhZGRGaWVsZEJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gZmllbGROYW1lKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBhdHRycylcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT4gRi5vcGVuRmllbGRNb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICApLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRGaWVsZEJ0bik7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUR2RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGRDb250YWluZXIsIGZpZWxkTmFtZSwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUR2RmllbGQoZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG59OyAiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWVsZEluZm8ge1xuICAgIHByb3RlY3RlZCB0eXBlPzogRmllbGRUeXBlID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBzb3VyY2VUeXBlPzogXCJmaWxlQ2xhc3NcIiB8IFwic2V0dGluZ3NcIiA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgZmlsZUNsYXNzPzogc3RyaW5nID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHN0cmluZ1tdID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBpc1ZhbGlkPzogYm9vbGVhbiA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgaWdub3JlSW5NZW51OiBib29sZWFuXG4gICAgcHJvdGVjdGVkIHZhbHVlOiBzdHJpbmcgPSBcIlwiO1xuICAgIHByb3RlY3RlZCB2YWx1ZXNMaXN0Tm90ZVBhdGg/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgcHVibGljIHVuaXF1ZTogYm9vbGVhbiA9IHRydWVcblxuICAgIHB1YmxpYyBzZXRJbmZvcyhcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeT86IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgICk6IHZvaWQge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuaWdub3JlSW5NZW51ID0gcGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpO1xuICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgdGhpcy5pc1ZhbGlkID0gZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUodmFsdWUpXG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGZpZWxkLmZpbGVDbGFzc05hbWU7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBmaWVsZC50eXBlO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9IGZpZWxkLmZpbGVDbGFzc05hbWUgPyBcImZpbGVDbGFzc1wiIDogXCJzZXR0aW5nc1wiXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWxlRmllbGRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlT3JmaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcpOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+IHtcbiAgICAvKlxuICAgIHJldHVybnMgYWxsIGZpZWxkcyB3aXRoIHNvdXJjZSwgdHlwZSwgb3B0aW9ucywgaXNWYWxpZCwgaWdub3JlZFxuICAgICovXG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JmaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JmaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPcmZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+ID0ge31cbiAgICBjb25zdCBkdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBnZW51aW5lS2V5cyhkdkZpbGUpLmZvckVhY2goYXN5bmMga2V5ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSBcImZpbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBuZXcgRmllbGRJbmZvO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZEluZm8udW5pcXVlID0gIU9iamVjdC5rZXlzKGZpZWxkcykuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzW2tleV0gPSBmaWVsZEluZm87XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkSW5mby5zZXRJbmZvcyhwbHVnaW4sIGZpbGUsIGtleSwgZHZGaWxlW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpZWxkcztcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwiLi9pbnNlcnRWYWx1ZXNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydE1pc3NpbmdGaWVsZHMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZU9yRmlsZVBhdGg6IHN0cmluZyB8IFRGaWxlLFxuICAgIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPckZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPckZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yRmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBkdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgY29uc3QgZiA9IHBsdWdpbi5maWVsZEluZGV4O1xuICAgICAgICBjb25zdCB0bSA9IHBsdWdpbi5maWxlVGFza01hbmFnZXI7XG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IGYuZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aClcbiAgICAgICAgY29uc3QgY3VycmVudEZpZWxkc05hbWVzID0gZ2VudWluZUtleXMoZHZBcGkucGFnZShmaWxlLnBhdGgpKVxuICAgICAgICBjb25zdCBmaWx0ZXJlZENsYXNzRmllbGRzID0gZmlsZUNsYXNzTmFtZSA/IHBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzRmllbGRzLmdldChmaWxlQ2xhc3NOYW1lKT8uZmlsdGVyKGZpZWxkID0+IGZpZWxkLmZpbGVDbGFzc05hbWUgPT09IGZpbGVDbGFzc05hbWUpIHx8IHVuZGVmaW5lZCA6IHVuZGVmaW5lZFxuICAgICAgICBmaWVsZHM/LmZpbHRlcihmaWVsZCA9PiAhY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkLm5hbWUpKVxuICAgICAgICAgICAgLmZpbHRlcihmaWVsZCA9PiBmaWx0ZXJlZENsYXNzRmllbGRzID8gZmlsdGVyZWRDbGFzc0ZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpIDogdHJ1ZSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGFzeW5jIGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0bS5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyhwbHVnaW4sIGZpbGUucGF0aCwgZmllbGQubmFtZSwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KSB9KVxuICAgICAgICAgICAgfSlcbiAgICB9XG59IiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIlxuaW1wb3J0IHsgZ2V0VmFsdWVzIH0gZnJvbSBcIi4vY29tbWFuZHMvZ2V0VmFsdWVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcIi4vY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcIi4vY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyBmaWVsZE1vZGlmaWVyIH0gZnJvbSBcIi4vY29tbWFuZHMvZmllbGRNb2RpZmllclwiO1xuaW1wb3J0IHsgZmlsZUZpZWxkcywgRmllbGRJbmZvIH0gZnJvbSBcIi4vY29tbWFuZHMvZmlsZUZpZWxkc1wiO1xuaW1wb3J0IHsgaW5zZXJ0TWlzc2luZ0ZpZWxkcyB9IGZyb20gXCIuL2NvbW1hbmRzL2luc2VydE1pc3NpbmdGaWVsZHNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBJTWV0YWRhdGFNZW51QXBpIHtcbiAgICBnZXRWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPjtcbiAgICByZXBsYWNlVmFsdWVzOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBpbnNlcnRWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+XG4gICAgZmlsZUZpZWxkczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PjtcbiAgICBmaWVsZE1vZGlmaWVyOiAoZHY6IGFueSwgcDogYW55LCBmaWVsZE5hbWU6IHN0cmluZywgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0pID0+IEhUTUxFbGVtZW50O1xuICAgIGluc2VydE1pc3NpbmdGaWVsZHM6IChmaWxlT3JGaWxlUGF0aDogc3RyaW5nIHwgVEZpbGUsIGxpbmVOdW1iZXI6IG51bWJlciwgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgYWZ0ZXI6IGJvb2xlYW4sIGFzTGlzdDogYm9vbGVhbiwgYXNDb21tZW50OiBib29sZWFuLCBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+XG59XG5cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YU1lbnVBcGkge1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSkgeyB9XG5cbiAgICBwdWJsaWMgbWFrZSgpOiBJTWV0YWRhdGFNZW51QXBpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFZhbHVlczogdGhpcy5nZXRWYWx1ZXMoKSxcbiAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXM6IHRoaXMucmVwbGFjZVZhbHVlcygpLFxuICAgICAgICAgICAgaW5zZXJ0VmFsdWVzOiB0aGlzLmluc2VydFZhbHVlcygpLFxuICAgICAgICAgICAgZmllbGRNb2RpZmllcjogdGhpcy5maWVsZE1vZGlmaWVyKCksXG4gICAgICAgICAgICBmaWxlRmllbGRzOiB0aGlzLmZpbGVGaWVsZHMoKSxcbiAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHM6IHRoaXMuaW5zZXJ0TWlzc2luZ0ZpZWxkcygpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRWYWx1ZXMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBnZXRWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBhdHRyaWJ1dGUpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXBsYWNlVmFsdWVzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXIucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aCwgYXR0cmlidXRlLCBpbnB1dCkgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGluc2VydFZhbHVlcygpOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbikgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aCwgZmllbGROYW1lLCB2YWx1ZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KSB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgZmllbGRNb2RpZmllcigpOiAoZHY6IGFueSwgcDogYW55LCBmaWVsZE5hbWU6IHN0cmluZywgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0pID0+IEhUTUxFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gZmllbGRNb2RpZmllcih0aGlzLnBsdWdpbiwgZHYsIHAsIGZpZWxkTmFtZSwgYXR0cnMpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWxlRmllbGRzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcpID0+IFByb21pc2U8UmVjb3JkPHN0cmluZywgRmllbGRJbmZvPj4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gZmlsZUZpZWxkcyh0aGlzLnBsdWdpbiwgZmlsZU9yRmlsZVBhdGgpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbnNlcnRNaXNzaW5nRmllbGRzKCk6IChmaWxlT3JGaWxlUGF0aDogc3RyaW5nIHwgVEZpbGUsIGxpbmVOdW1iZXI6IG51bWJlciwgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgYWZ0ZXI6IGJvb2xlYW4sIGFzTGlzdDogYm9vbGVhbiwgYXNDb21tZW50OiBib29sZWFuLCBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChmaWxlT3JGaWxlUGF0aDogc3RyaW5nIHwgVEZpbGUsIGxpbmVOdW1iZXI6IG51bWJlciwgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgYWZ0ZXI6IGJvb2xlYW4sIGFzTGlzdDogYm9vbGVhbiwgYXNDb21tZW50OiBib29sZWFuLCBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nKSA9PiBpbnNlcnRNaXNzaW5nRmllbGRzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aCwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50LCBmaWxlQ2xhc3NOYW1lKVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgRnV6enlNYXRjaCwgRnV6enlTdWdnZXN0TW9kYWwsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuaW50ZXJmYWNlIE9wdGlvbiB7XG4gICAgaWQ6IHN0cmluZyxcbiAgICBhY3Rpb25MYWJlbDogc3RyaW5nLFxuICAgIGFjdGlvbjogYW55LFxuICAgIGljb24/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8T3B0aW9uPiB7XG4gICAgcHVibGljIG9wdGlvbnM6IE9wdGlvbltdID0gW11cblxuICAgIGdldEl0ZW1zKCk6IE9wdGlvbltdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uc1xuICAgIH1cblxuICAgIGdldEl0ZW1UZXh0KGl0ZW06IE9wdGlvbik6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBpdGVtLmFjdGlvbkxhYmVsXG4gICAgfVxuXG4gICAgb25DaG9vc2VJdGVtKGl0ZW06IE9wdGlvbiwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICBpdGVtLmFjdGlvbigpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oaXRlbTogRnV6enlNYXRjaDxPcHRpb24+LCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pdGVtXCIpXG4gICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiIH0pXG4gICAgICAgIGl0ZW0uaXRlbS5pY29uID8gc2V0SWNvbihpY29uQ29udGFpbmVyLCBpdGVtLml0ZW0uaWNvbikgOiBzZXRJY29uKGljb25Db250YWluZXIsIFwicGVuY2lsXCIpXG4gICAgICAgIGNvbnN0IGFjdGlvbkxhYmVsID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWFjdGlvbi1sYWJlbFwiIH0pXG4gICAgICAgIGFjdGlvbkxhYmVsLmlubmVySFRNTCA9IGl0ZW0uaXRlbS5hY3Rpb25MYWJlbFxuICAgIH1cbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0RnJvbnRtYXR0ZXJXaXRoRmllbGRzXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZSB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc0F0dHJpYnV0ZVwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbFwiO1xuaW1wb3J0IGNob29zZVNlY3Rpb25Nb2RhbCBmcm9tIFwic3JjL21vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCIuL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuXG5mdW5jdGlvbiBpc01lbnUobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogbG9jYXRpb24gaXMgTWVudSB7XG4gICAgcmV0dXJuIChsb2NhdGlvbiBhcyBNZW51KS5hZGRJdGVtICE9PSB1bmRlZmluZWQ7XG59O1xuXG5mdW5jdGlvbiBpc0luc2VydEZpZWxkQ29tbWFuZChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpOiBsb2NhdGlvbiBpcyBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHtcbiAgICByZXR1cm4gKGxvY2F0aW9uIGFzIHN0cmluZykgPT09IFwiSW5zZXJ0RmllbGRDb21tYW5kXCI7XG59XG5cbmZ1bmN0aW9uIGlzU3VnZ2VzdChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpOiBsb2NhdGlvbiBpcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwge1xuICAgIHJldHVybiAobG9jYXRpb24gYXMgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKS5nZXRJdGVtcyAhPT0gdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZUNsYXNzT3B0aW9uc0xpc3Qge1xuXG4gICAgLy8gYWRkcyBvcHRpb25zIHRvIGNvbnRleHQgbWVudSBvciB0byBhIGRyb3Bkb3duIG1vZGFsIHRyaWdnZXIgd2l0aCBcIkZpZWxkOiBPcHRpb25zXCIgY29tbWFuZCBpbiBjb21tYW5kIHBhbGxldHRlXG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzcyB8IHVuZGVmaW5lZDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCxcbiAgICAgICAgcHJpdmF0ZSBmcm9tRmlsZT86IFRGaWxlXG4gICAgKSB7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc1BhdGguZ2V0KHRoaXMuZmlsZS5wYXRoKVxuICAgIH07XG5cbiAgICBwdWJsaWMgY3JlYXRlRXh0cmFPcHRpb25MaXN0KG9wZW5BZnRlckNyZWF0ZTogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbWFwV2l0aFRhZ0FjdGlvbiA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRoaXMuZmlsZSk/LmZyb250bWF0dGVyXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoZnJvbnRtYXR0ZXIpLmluY2x1ZGVzKFwibWFwV2l0aFRhZ1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAvL2ZpbGVDbGFzcyBmaWVsZCBpcyBlbXB0eSwgaGFzIGFuIGVtcHR5IGFycmF5IG9mIGlzIGJhZGx5IGZvcm1hdHRlZDogb3ZlcnJpZGUgaXRcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBcIm1hcFdpdGhUYWdcIiwgXCJ0cnVlXCIpXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9mcm9udG1hdHRlciBleGlzdHMgYnV0IGRvZXNuJ3QgY29udGFpbiBmaWxlQ2xhc3M6IGFkZCBpdFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLmxpbmUgLSAxXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBcIm1hcFdpdGhUYWdcIiwgXCJ0cnVlXCIsIGxpbmVOdW1iZXIsIHRydWUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7IFwibWFwV2l0aFRhZ1wiOiBcInRydWVcIiB9XG4gICAgICAgICAgICAgICAgYXdhaXQgaW5zZXJ0RnJvbnRtYXR0ZXJXaXRoRmllbGRzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpZWxkcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7IHRoaXMubG9jYXRpb24uYWRkU2VwYXJhdG9yKCk7IH07XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMuZmlsZUNsYXNzXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWVsZHNOYW1lczogc3RyaW5nW10gPSBbXVxuICAgICAgICBsZXQgYWRkTWlzc2luZ0ZpZWxkc0FjdGlvbiA9ICgpID0+IHsgbmV3IE5vdGljZShcIlNvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgY2hlY2sgeW91ciBmaWxlQ2xhc3MgZGVmaW5pdGlvbnNcIikgfVxuICAgICAgICBpZiAodGhpcy5mcm9tRmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5mcm9tRmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoZHZGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWVsZHNOYW1lcy5wdXNoKC4uLmdlbnVpbmVLZXlzKGR2RmlsZSkpXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IGNob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcm9tRmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICAgICApID0+IGluc2VydE1pc3NpbmdGaWVsZHMoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHZGaWxlLmZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3M/Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkTWlzc2luZ0ZpZWxkc0FjdGlvbiA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG1pc3NpbmdGaWVsZHMgPSBmaWxlQ2xhc3MgJiYgdGhpcy5mcm9tRmlsZSA/XG4gICAgICAgICAgICAhdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmlsZUNsYXNzLm5hbWUpPy5tYXAoZiA9PiBmLm5hbWUpLmV2ZXJ5KGZpZWxkTmFtZSA9PiBjdXJyZW50RmllbGRzTmFtZXMuaW5jbHVkZXMoZmllbGROYW1lKSkgOlxuICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgaWYgKGlzSW5zZXJ0RmllbGRDb21tYW5kKHRoaXMubG9jYXRpb24pICYmIGZpbGVDbGFzcykge1xuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGVDbGFzcyk7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRmllbGRPcHRpb25zKCk7XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmICFmaWxlQ2xhc3MuaXNNYXBwZWRXaXRoVGFnKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBcIm1hcF9maWxlQ2xhc3Nfd2l0aF90YWdcIixcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5NYXAgPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+IHdpdGggdGFnIG9mIHNhbWUgbmFtZTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IG1hcFdpdGhUYWdBY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiaGFzaFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIG1pc3NpbmdGaWVsZHMgJiYgdGhpcy5mcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGBpbnNlcnRfbWlzc2lnX2ZpZWxkc19mcm9tXyR7ZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfXCIpfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+SW5zZXJ0IG1pc3NpbmcgZmllbGRzIGZyb20gPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWRkTWlzc2luZ0ZpZWxkc0FjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJiYXR0ZXJ5LWZ1bGxcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wZW5BZnRlckNyZWF0ZSkgdGhpcy5sb2NhdGlvbi5vcGVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmICFmaWxlQ2xhc3MuaXNNYXBwZWRXaXRoVGFnKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgTWFwICR7ZmlsZUNsYXNzLm5hbWV9IHdpdGggdGFnYCk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcImhhc2hcIik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhtYXBXaXRoVGFnQWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKGBtZXRhZGF0YS1tZW51LWZpbGVjbGFzcy4ke2ZpbGVDbGFzcy5uYW1lfS5maWxlY2xhc3MtZmllbGRzYCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MgJiYgbWlzc2luZ0ZpZWxkcyAmJiB0aGlzLmZyb21GaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYEluc2VydCBtaXNzaW5nIGZpZWxkcyBmcm9tICR7ZmlsZUNsYXNzLm5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcImJhdHRlcnktZnVsbFwiKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFkZE1pc3NpbmdGaWVsZHNBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7ZmlsZUNsYXNzLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5idWlsZEZpZWxkT3B0aW9uc1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZEZpZWxkT3B0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3M/LmF0dHJpYnV0ZXMuZm9yRWFjaCgoYXR0cjogRmlsZUNsYXNzQXR0cmlidXRlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MhLCBhdHRyKVxuICAgICAgICAgICAgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGAke3RoaXMuZmlsZUNsYXNzIS5uYW1lfSAtICR7YXR0ci5uYW1lfWApXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcIndyZW5jaFwiKVxuICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHt0aGlzLmZpbGVDbGFzcyEubmFtZX0uZmlsZWNsYXNzLWZpZWxkc2ApXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke2F0dHIubmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPiR7YXR0ci5uYW1lfTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IG1vZGFsLm9wZW4oKSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJnZWFyXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcyEpO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG4gICAgICAgIGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikgJiYgdGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoXCJBZGQgbmV3IGZpZWxkXCIpXG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKFwicGx1cy1jaXJjbGVcIilcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKVxuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHt0aGlzLmZpbGVDbGFzcyEubmFtZX0uZmlsZWNsYXNzLWZpZWxkc2ApXG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSAmJiB0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBcImFkZF9maWxlQ2xhc3NfYXR0cmlidXRlXCIsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5JbnNlcnQgYW4gYXR0cmlidXRlIGZvciA8Yj4ke3RoaXMuZmlsZUNsYXNzLm5hbWV9PC9iPiBmaWxlQ2xhc3M8L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBcInBsdXMtY2lyY2xlXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuIiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIFBsYXRmb3JtLCByZXF1aXJlQXBpVmVyc2lvbiwgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBPcHRpb25zTGlzdCBmcm9tIFwic3JjL29wdGlvbnMvT3B0aW9uc0xpc3RcIjtcbmltcG9ydCBGaWxlQ2xhc3NPcHRpb25zTGlzdCBmcm9tIFwiLi9GaWxlQ2xhc3NPcHRpb25zTGlzdFwiO1xuaW1wb3J0IHsgZnJvbnRNYXR0ZXJMaW5lRmllbGQsIGdldExpbmVGaWVsZHMgfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwiLi9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBsaW5rQ29udGV4dE1lbnUge1xuXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcblx0XHR0aGlzLmNyZWF0ZUNvbnRleHRNZW51KCk7XG5cdH07XG5cblx0cHJpdmF0ZSBidWlsZE9wdGlvbnMoZmlsZTogVEZpbGUgfCBUQWJzdHJhY3RGaWxlIHwgbnVsbCwgbWVudTogTWVudSwgaW5jbHVkZWRGaWVsZHM/OiBzdHJpbmdbXSk6IHZvaWQge1xuXHRcdGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcblx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG5cdFx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlICYmIHJlcXVpcmVBcGlWZXJzaW9uKFwiMC4xNi4wXCIpKSB7XG5cdFx0XHRcdGlmIChjbGFzc0ZpbGVzUGF0aCAmJiBmaWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpIHtcblx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZmlsZS5wYXRoKVxuXHRcdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7ZmlsZUNsYXNzTmFtZX0uZmlsZWNsYXNzLWZpZWxkc2AsIHsgdGl0bGU6IFwiTWFuYWdlIGZpZWxkc1wiLCBpY29uOiBcIndyZW5jaFwiIH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoXCJtZXRhZGF0YS1tZW51LmN1cnJlbnRfZmllbGRcIiwgeyB0aXRsZTogXCJDdXJyZW50IGZpZWxkXCIsIGljb246IFwicGVuY2lsXCIgfSlcblx0XHRcdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdFx0XHRtZW51LnNldFNlY3Rpb25TdWJtZW51KFwibWV0YWRhdGEtbWVudS5maWVsZHNcIiwgeyB0aXRsZTogXCJNYW5hZ2UgZmllbGRzXCIsIGljb246IFwicGVuY2lsXCIgfSlcblx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQoZmlsZS5wYXRoKSB8fCBbXTtcblx0XHRcdFx0XHRmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG5cdFx0XHRcdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7ZmlsZUNsYXNzLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgLCB7IHRpdGxlOiBgTWFuYWdlICR7ZmlsZUNsYXNzLm5hbWV9IGZpZWxkc2AsIGljb246IFwid3JlbmNoXCIgfSlcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUpIHtcblx0XHRcdFx0Ly9JZiBmaWxlQ2xhc3Ncblx0XHRcdFx0aWYgKGNsYXNzRmlsZXNQYXRoICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc09wdGlvbnNMaXN0ID0gbmV3IEZpbGVDbGFzc09wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlLCBtZW51KVxuXHRcdFx0XHRcdGZpbGVDbGFzc09wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlLCBtZW51LCBpbmNsdWRlZEZpZWxkcyk7XG5cdFx0XHRcdFx0b3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdH07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldEljb24oXCJsaXN0XCIpXG5cdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShcIkZpZWxkIE9wdGlvbnNcIilcblx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsID0gbmV3IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCh0aGlzLnBsdWdpbi5hcHApXG5cdFx0XHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgZmlsZSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTtcblx0XHRcdFx0XHRcdG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29udGV4dE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBhYnN0cmFjdEZpbGUsIHNvdXJjZSkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChhYnN0cmFjdEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuYnVpbGRPcHRpb25zKGZpbGUsIG1lbnUpO1xuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1tZW51JywgKG1lbnUsIGVkaXRvciwgdmlldykgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdGNvbnN0IGluY2x1ZGVkRmllbGRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3LmZpbGUpPy5mcm9udG1hdHRlcjtcblx0XHRcdFx0aWYgKGZyb250bWF0dGVyXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPiBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPCBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRjb25zdCBhdHRyaWJ1dGUgPSBmcm9udE1hdHRlckxpbmVGaWVsZChlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSkpXG5cdFx0XHRcdFx0aWYgKGF0dHJpYnV0ZSkgaW5jbHVkZWRGaWVsZHMucHVzaChhdHRyaWJ1dGUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGdldExpbmVGaWVsZHMoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKS5mb3JFYWNoKGZpZWxkID0+IHtcblx0XHRcdFx0XHRcdGlmIChlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPD0gZmllbGQuaW5kZXggKyBmaWVsZC5sZW5ndGggJiYgZWRpdG9yLmdldEN1cnNvcigpLmNoID49IGZpZWxkLmluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdGluY2x1ZGVkRmllbGRzLnB1c2goZmllbGQuYXR0cmlidXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpbmNsdWRlZEZpZWxkcy5sZW5ndGgpIHtcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhmaWxlLCBtZW51LCBpbmNsdWRlZEZpZWxkcyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMoZmlsZSwgbWVudSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSlcblx0XHQpXG5cdH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIE1lbnUsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydE1pc3NpbmdGaWVsZHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydE1pc3NpbmdGaWVsZHNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBNYW5hZ2VycyBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL01hbmFnZXJzXCI7XG5pbXBvcnQgeyBBZGRGaWxlQ2xhc3NUb0ZpbGVNb2RhbCB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IEFkZE5ld0ZpbGVDbGFzc01vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2FkZE5ld0ZpbGVDbGFzc01vZGFsXCI7XG5pbXBvcnQgSW5wdXRNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvSW5wdXRNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCBjaG9vc2VTZWN0aW9uTW9kYWwgZnJvbSBcIi4uL21vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcIi4vRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmlsZUNsYXNzT3B0aW9uc0xpc3QgZnJvbSBcIi4vRmlsZUNsYXNzT3B0aW9uc0xpc3RcIjtcblxuZnVuY3Rpb24gaXNNZW51KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIpOiBsb2NhdGlvbiBpcyBNZW51IHtcblx0cmV0dXJuIChsb2NhdGlvbiBhcyBNZW51KS5hZGRJdGVtICE9PSB1bmRlZmluZWQ7XG59O1xuXG5mdW5jdGlvbiBpc0luc2VydEZpZWxkQ29tbWFuZChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKTogbG9jYXRpb24gaXMgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB7XG5cdHJldHVybiAobG9jYXRpb24gYXMgc3RyaW5nKSA9PT0gXCJJbnNlcnRGaWVsZENvbW1hbmRcIjtcbn1cblxuZnVuY3Rpb24gaXNTdWdnZXN0KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIpOiBsb2NhdGlvbiBpcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwge1xuXHRyZXR1cm4gKGxvY2F0aW9uIGFzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCkuZ2V0SXRlbXMgIT09IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9wdGlvbnNMaXN0IHtcblxuXHQvLyBhZGRzIG9wdGlvbnMgdG8gY29udGV4dCBtZW51IG9yIHRvIGEgZHJvcGRvd24gbW9kYWwgdHJpZ2dlciB3aXRoIFwiRmllbGQ6IE9wdGlvbnNcIiBjb21tYW5kIGluIGNvbW1hbmQgcGFsbGV0dGVcblx0cGF0aDogc3RyaW5nO1xuXHRhdHRyaWJ1dGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXHRmaWVsZHNGcm9tSW5kZXg6IFJlY29yZDxzdHJpbmcsIEZpZWxkPiA9IHt9O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG5cdFx0cHJpdmF0ZSBmaWxlOiBURmlsZSxcblx0XHRwcml2YXRlIGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIsXG5cdFx0cHJpdmF0ZSBpbmNsdWRlZEZpZWxkcz86IHN0cmluZ1tdXG5cdCkge1xuXHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cdFx0dGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuXHRcdHRoaXMuYXR0cmlidXRlcyA9IHt9O1xuXHRcdHRoaXMuaW5jbHVkZWRGaWVsZHMgPSBpbmNsdWRlZEZpZWxkcyA/IFt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcywgLi4uaW5jbHVkZWRGaWVsZHNdIDogW3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzXTtcblx0XHR0aGlzLmdldEZpZWxkc0Zyb21JbmRleCgpO1xuXHRcdHRoaXMuZ2V0RmllbGRzVmFsdWVzKCk7XG5cdH07XG5cblx0cHJpdmF0ZSBnZXRGaWVsZHNWYWx1ZXMoKTogdm9pZCB7XG5cdFx0Y29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuXHRcdC8vQHRzLWlnbm9yZVxuXHRcdGlmIChkdkFwaSkge1xuXHRcdFx0Y29uc3QgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aClcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGdlbnVpbmVLZXlzKGR2RmlsZSkuZm9yRWFjaChrZXkgPT4gdGhpcy5hZGRBdHRyaWJ1dGUoa2V5LCBkdkZpbGVba2V5XSkpXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHR0aHJvdyAoZXJyb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYWRkQXR0cmlidXRlKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCB7XG5cdFx0Y29uc3QgaW5jbHVkZWRGaWVsZHMgPSB0aGlzLmluY2x1ZGVkRmllbGRzIS5maWx0ZXIoZiA9PiBmICE9PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcylcblx0XHRpZiAoaW5jbHVkZWRGaWVsZHMubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKFxuXHRcdFx0XHR0aGlzLmluY2x1ZGVkRmllbGRzIS5pbmNsdWRlcyhrZXkpXG5cdFx0XHRcdCYmXG5cdFx0XHRcdCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuaW5jbHVkZXMoa2V5KVxuXHRcdFx0KSB7XG5cdFx0XHRcdHRoaXMuYXR0cmlidXRlc1trZXldID0gdmFsdWVcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuaW5jbHVkZXMoa2V5KSkge1xuXHRcdFx0dGhpcy5hdHRyaWJ1dGVzW2tleV0gPSB2YWx1ZVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgZ2V0RmllbGRzRnJvbUluZGV4KCk6IHZvaWQge1xuXHRcdGNvbnN0IGluZGV4ID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleFxuXHRcdGNvbnN0IGZpZWxkcyA9IGluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aClcblx0XHRmaWVsZHM/LmZvckVhY2goZmllbGQgPT4gdGhpcy5maWVsZHNGcm9tSW5kZXhbZmllbGQubmFtZV0gPSBmaWVsZClcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWVsZE5hbWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IGZpZWxkID0gdGhpcy5maWVsZHNGcm9tSW5kZXhbZmllbGROYW1lXVxuXHRcdGlmIChmaWVsZCkge1xuXHRcdFx0Y29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgZmllbGQpO1xuXHRcdFx0KGZpZWxkTWFuYWdlciBhcyBGKS5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmZpbGUsIGZpZWxkLm5hbWUsIHRoaXMuYXR0cmlidXRlc1tmaWVsZC5uYW1lXSlcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgZGVmYXVsdEZpZWxkID0gbmV3IEZpZWxkKGZpZWxkTmFtZSlcblx0XHRcdGRlZmF1bHRGaWVsZC50eXBlID0gRmllbGRUeXBlLklucHV0XG5cdFx0XHRpZiAoZmllbGROYW1lID09PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHR0aGlzLmJ1aWxkRmlsZUNsYXNzRmllbGRPcHRpb25zKGRlZmF1bHRGaWVsZCwgdGhpcy5hdHRyaWJ1dGVzW2ZpZWxkTmFtZV0pXG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMubG9jYXRpb24gPT09IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIpIHtcblx0XHRcdFx0Y29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IE1hbmFnZXJzLklucHV0KHRoaXMucGx1Z2luLCBkZWZhdWx0RmllbGQpIGFzIEZcblx0XHRcdFx0KGZpZWxkTWFuYWdlciBhcyBGKS5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmZpbGUsIGZpZWxkTmFtZSwgdGhpcy5hdHRyaWJ1dGVzW2ZpZWxkTmFtZV0pXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHVibGljIGNyZWF0ZUV4dHJhT3B0aW9uTGlzdChvcGVuQWZ0ZXJDcmVhdGU6IGJvb2xlYW4gPSB0cnVlKTogdm9pZCB7XG5cdFx0Y29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcblx0XHRjb25zdCBsb2NhdGlvbiA9IHRoaXMubG9jYXRpb25cblx0XHRpZiAoaXNNZW51KGxvY2F0aW9uKSkgeyBsb2NhdGlvbi5hZGRTZXBhcmF0b3IoKTsgfTtcblx0XHRpZiAoaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTtcblx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdChsb2NhdGlvbikpIHtcblx0XHRcdHRoaXMuYnVpbGRGaWVsZE9wdGlvbnMoKTtcblx0XHRcdHRoaXMuYWRkRmllbGRBdEN1cnJlbnRQb3NpdGlvbk9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkRmllbGRBdFRoZUVuZE9mRnJvbnRtYXR0ZXJPcHRpb24oKTtcblx0XHRcdGlmIChkdkFwaSkge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50RmllbGRzTmFtZXMgPSBnZW51aW5lS2V5cyhkdkFwaS5wYWdlKHRoaXMuZmlsZS5wYXRoKSlcblx0XHRcdFx0aWYgKCFbLi4udGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdXS5tYXAoZmllbGQgPT4gZmllbGQubmFtZSkuZXZlcnkoZmllbGROYW1lID0+IGN1cnJlbnRGaWVsZHNOYW1lcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkQWxsTWlzc2luZ0ZpZWxkc0F0U2VjdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdXG5cdFx0XHRmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCA9IG5ldyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwodGhpcy5wbHVnaW4uYXBwKVxuXHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBGaWxlQ2xhc3NPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpLCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwsIHRoaXMuZmlsZSk7XG5cdFx0XHRcdG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdChmYWxzZSk7XG5cdFx0XHRcdGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwibWFuYWdlX2ZpbGVDbGFzc19hdHRyaWJ1dGVzXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IGA8c3Bhbj5NYW5hZ2UgPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+IGZpbGVDbGFzcyBmaWVsZHM8L3NwYW4+YCxcblx0XHRcdFx0XHRhY3Rpb246ICgpID0+IHsgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsLm9wZW4oKSB9LFxuXHRcdFx0XHRcdGljb246IFwid3JlbmNoXCJcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0XHR0aGlzLmFkZEZpbGVDbGFzc1RvRmlsZU9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGROZXdGaWxlQ2xhc3NPcHRpb24oKTtcblx0XHRcdGlmIChvcGVuQWZ0ZXJDcmVhdGUpIGxvY2F0aW9uLm9wZW4oKTtcblx0XHR9IGVsc2UgaWYgKGlzTWVudShsb2NhdGlvbikpIHtcblx0XHRcdHRoaXMuYnVpbGRGaWVsZE9wdGlvbnMoKTtcblx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkRmllbGRBdFRoZUVuZE9mRnJvbnRtYXR0ZXJPcHRpb24oKTtcblx0XHRcdGlmIChkdkFwaSkge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50RmllbGRzTmFtZXMgPSBnZW51aW5lS2V5cyhkdkFwaS5wYWdlKHRoaXMuZmlsZS5wYXRoKSlcblx0XHRcdFx0aWYgKCFbLi4udGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdXS5tYXAoZmllbGQgPT4gZmllbGQubmFtZSkuZXZlcnkoZmllbGROYW1lID0+IGN1cnJlbnRGaWVsZHNOYW1lcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkQWxsTWlzc2luZ0ZpZWxkc0F0U2VjdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdXG5cdFx0XHRmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDbGFzc09wdGlvbnNMaXN0ID0gbmV3IEZpbGVDbGFzc09wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCksIGxvY2F0aW9uLCB0aGlzLmZpbGUpXG5cdFx0XHRcdGZpbGVDbGFzc09wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdChmYWxzZSk7XG5cdFx0XHR9KVxuXHRcdFx0dGhpcy5hZGRGaWxlQ2xhc3NUb0ZpbGVPcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkTmV3RmlsZUNsYXNzT3B0aW9uKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBidWlsZEZpbGVDbGFzc0ZpZWxkT3B0aW9ucyhmaWVsZDogRmllbGQsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyBJbnB1dE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpZWxkLCB2YWx1ZSk7XG5cdFx0bW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke2ZpZWxkLm5hbWV9PmApO1xuXHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtmaWVsZC5uYW1lfWApO1xuXHRcdFx0XHRpdGVtLnNldEljb24oXCJ3cmVuY2hcIik7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51XCIpO1xuXHRcdFx0fSlcblx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRpZDogYHVwZGF0ZV8ke2ZpZWxkLm5hbWV9YCxcblx0XHRcdFx0YWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtmaWVsZC5uYW1lfTwvYj48L3NwYW4+YCxcblx0XHRcdFx0YWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG5cdFx0XHRcdGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuSW5wdXRdXG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9XG5cblx0cHJpdmF0ZSBidWlsZEZpZWxkT3B0aW9ucygpOiB2b2lkIHtcblx0XHRPYmplY3Qua2V5cyh0aGlzLmF0dHJpYnV0ZXMpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XG5cdFx0XHRjb25zdCB2YWx1ZSA9IHRoaXMuYXR0cmlidXRlc1trZXldO1xuXHRcdFx0Y29uc3QgZmllbGQgPSB0aGlzLmZpZWxkc0Zyb21JbmRleFtrZXldXG5cblx0XHRcdGlmIChmaWVsZCkge1xuXHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCBmaWVsZCk7XG5cdFx0XHRcdGZpZWxkTWFuYWdlci5hZGRGaWVsZE9wdGlvbihrZXksIHZhbHVlLCB0aGlzLmZpbGUsIHRoaXMubG9jYXRpb24pO1xuXHRcdFx0fSBlbHNlIGlmIChrZXkgIT09IFwiZmlsZVwiICYmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikgfHwgaXNNZW51KHRoaXMubG9jYXRpb24pKSkge1xuXHRcdFx0XHRjb25zdCBkZWZhdWx0RmllbGQgPSBuZXcgRmllbGQoa2V5KVxuXHRcdFx0XHRkZWZhdWx0RmllbGQudHlwZSA9IEZpZWxkVHlwZS5JbnB1dFxuXHRcdFx0XHRpZiAoa2V5ID09PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHRcdHRoaXMuYnVpbGRGaWxlQ2xhc3NGaWVsZE9wdGlvbnMoZGVmYXVsdEZpZWxkLCB2YWx1ZSlcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgTWFuYWdlcnMuSW5wdXQodGhpcy5wbHVnaW4sIGRlZmF1bHRGaWVsZClcblx0XHRcdFx0XHRmaWVsZE1hbmFnZXIuYWRkRmllbGRPcHRpb24oa2V5LCB2YWx1ZSB8fCBcIlwiLCB0aGlzLmZpbGUsIHRoaXMubG9jYXRpb24pXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuXHRcdFx0dGhpcy5wbHVnaW4sXG5cdFx0XHR0aGlzLmZpbGUsXG5cdFx0XHQoXG5cdFx0XHRcdGxpbmVOdW1iZXI6IG51bWJlcixcblx0XHRcdFx0aW5Gcm9udG1hdHRlcjogYm9vbGVhbixcblx0XHRcdFx0YWZ0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdGFzTGlzdDogYm9vbGVhbixcblx0XHRcdFx0YXNDb21tZW50OiBib29sZWFuXG5cdFx0XHQpID0+IEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHR0aGlzLmZpbGUsXG5cdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0XCJcIixcblx0XHRcdFx0bGluZU51bWJlcixcblx0XHRcdFx0aW5Gcm9udG1hdHRlcixcblx0XHRcdFx0YWZ0ZXIsXG5cdFx0XHRcdGFzTGlzdCxcblx0XHRcdFx0YXNDb21tZW50XG5cdFx0XHQpXG5cdFx0KTtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwiZW50ZXJcIik7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgYXQgc2VjdGlvbi4uLlwiKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51XCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0aWQ6IFwiYWRkX2ZpZWxkX2F0X3NlY3Rpb25cIixcblx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGZpZWxkIGF0IHNlY3Rpb24uLi5cIixcblx0XHRcdFx0YWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG5cdFx0XHRcdGljb246IFwiZW50ZXJcIlxuXHRcdFx0fSlcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkQWxsTWlzc2luZ0ZpZWxkc0F0U2VjdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuXHRcdGlmIChkdkFwaSkge1xuXHRcdFx0Y29uc3QgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCk7XG5cdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG5cdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHR0aGlzLmZpbGUsXG5cdFx0XHRcdChcblx0XHRcdFx0XHRsaW5lTnVtYmVyOiBudW1iZXIsXG5cdFx0XHRcdFx0aW5Gcm9udG1hdHRlcjogYm9vbGVhbixcblx0XHRcdFx0XHRhZnRlcjogYm9vbGVhbixcblx0XHRcdFx0XHRhc0xpc3Q6IGJvb2xlYW4sXG5cdFx0XHRcdFx0YXNDb21tZW50OiBib29sZWFuXG5cdFx0XHRcdCkgPT4gaW5zZXJ0TWlzc2luZ0ZpZWxkcyhcblx0XHRcdFx0XHR0aGlzLnBsdWdpbixcblx0XHRcdFx0XHRkdkZpbGUuZmlsZS5wYXRoLFxuXHRcdFx0XHRcdGxpbmVOdW1iZXIsXG5cdFx0XHRcdFx0aW5Gcm9udG1hdHRlcixcblx0XHRcdFx0XHRhZnRlcixcblx0XHRcdFx0XHRhc0xpc3QsXG5cdFx0XHRcdFx0YXNDb21tZW50XG5cdFx0XHRcdClcblx0XHRcdCk7XG5cdFx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImJhdHRlcnktZnVsbFwiKTtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiQWRkIG1pc3NpbmcgZmllbGRzIGF0IHNlY3Rpb24uLi5cIik7XG5cdFx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51XCIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHRpZDogXCJhZGRfbWlzc2luZ19maWVsZHNfYXRfc2VjdGlvblwiLFxuXHRcdFx0XHRcdGFjdGlvbkxhYmVsOiBcIkFkZCBtaXNzaW5nIGZpZWxkcyBhdCBzZWN0aW9uLi4uXCIsXG5cdFx0XHRcdFx0YWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG5cdFx0XHRcdFx0aWNvbjogXCJiYXR0ZXJ5LWZ1bGxcIlxuXHRcdFx0XHR9KVxuXHRcdFx0fTtcblx0XHR9XG5cdH07XG5cblx0cHJpdmF0ZSBhZGRGaWVsZEF0VGhlRW5kT2ZGcm9udG1hdHRlck9wdGlvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUodGhpcy5maWxlLnBhdGgpPy5mcm9udG1hdHRlcikge1xuXHRcdFx0Y29uc3QgbGluZU51bWJlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKHRoaXMuZmlsZS5wYXRoKSEuZnJvbnRtYXR0ZXIhLnBvc2l0aW9uLmVuZC5saW5lIC0gMVxuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldEljb24oXCJwaW5cIik7XG5cdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShcIkFkZCBmaWVsZCBpbiBmcm9udG1hdHRlclwiKTtcblx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soYXN5bmMgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0Ri5vcGVuRmllbGRNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB1bmRlZmluZWQsIFwiXCIsIGxpbmVOdW1iZXIgKyAxLCB0cnVlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnVcIik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBcImFkZF9maWVsZF9pbl9mcm9udG1hdHRlclwiLFxuXHRcdFx0XHRcdGFjdGlvbkxhYmVsOiBcIkFkZCBhIGZpZWxkIGluIGZyb250bWF0dGVyLi4uXCIsXG5cdFx0XHRcdFx0YWN0aW9uOiAoKSA9PiBGLm9wZW5GaWVsZE1vZGFsKFxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyICsgMSwgdHJ1ZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSksXG5cdFx0XHRcdFx0aWNvbjogXCJwaW5cIlxuXHRcdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYWRkRmllbGRBdEN1cnJlbnRQb3NpdGlvbk9wdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG5cdFx0Y29uc3QgbGluZU51bWJlciA9IGN1cnJlbnRWaWV3Py5lZGl0b3IuZ2V0Q3Vyc29yKCkubGluZTtcblx0XHRpZiAobGluZU51bWJlciAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZmlsZS5wYXRoID09IGN1cnJlbnRWaWV3Py5maWxlLnBhdGgpIHtcblx0XHRcdGxldCBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2U7XG5cdFx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpPy5mcm9udG1hdHRlclxuXHRcdFx0aWYgKGZyb250bWF0dGVyKSB7XG5cdFx0XHRcdGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlclxuXHRcdFx0XHRpZiAobGluZU51bWJlciA+PSBzdGFydC5saW5lICYmIGxpbmVOdW1iZXIgPCBlbmQubGluZSkgaW5Gcm9udG1hdHRlciA9IHRydWVcblx0XHRcdH1cblx0XHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGluXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgYXQgY3Vyc29yXCIpO1xuXHRcdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRGLm9wZW5GaWVsZE1vZGFsKFxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB1bmRlZmluZWQsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGZhbHNlLCBmYWxzZSwgZmFsc2UpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzSW5zZXJ0RmllbGRDb21tYW5kKHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcblx0XHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHRpZDogXCJhZGRfZmllbGRfYXRfY3Vyc29yXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGZpZWxkIGF0IGN1cnNvci4uLlwiLFxuXHRcdFx0XHRcdGFjdGlvbjogKCkgPT4gRi5vcGVuRmllbGRNb2RhbChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHVuZGVmaW5lZCwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgZmFsc2UsIGZhbHNlLCBmYWxzZSksXG5cdFx0XHRcdFx0aWNvbjogXCJwaW5cIlxuXHRcdFx0XHR9KVxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFkZEZpbGVDbGFzc1RvRmlsZU9wdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyBBZGRGaWxlQ2xhc3NUb0ZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlKVxuXHRcdGNvbnN0IGFjdGlvbiA9ICgpID0+IG1vZGFsLm9wZW4oKTtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGx1cy1zcXVhcmVcIik7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYEFkZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfSB0byAke3RoaXMuZmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKGFjdGlvbik7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0aWQ6IFwiYWRkX2ZpbGVjbGFzc190b19maWxlXCIsXG5cdFx0XHRcdGFjdGlvbkxhYmVsOiBgQWRkICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9IHRvICR7dGhpcy5maWxlLmJhc2VuYW1lfWAsXG5cdFx0XHRcdGFjdGlvbjogYWN0aW9uLFxuXHRcdFx0XHRpY29uOiBcInBsdXMtc3F1YXJlXCJcblx0XHRcdH0pXG5cdFx0fTtcblx0fVxuXG5cdHByaXZhdGUgYWRkTmV3RmlsZUNsYXNzT3B0aW9uKCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IEFkZE5ld0ZpbGVDbGFzc01vZGFsKHRoaXMucGx1Z2luKTtcblx0XHRjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoKSB7XG5cdFx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImZpbGUtcGx1cy0yXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYEFkZCBhIG5ldyAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfWApXG5cdFx0XHRcdFx0aXRlbS5vbkNsaWNrKGFjdGlvbik7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS1maWxlY2xhc3NcIik7XG5cdFx0XHRcdH0pXG5cdFx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwiYWRkX25ld19maWxlY2xhc3NcIixcblx0XHRcdFx0XHRhY3Rpb25MYWJlbDogYEFkZCBhIG5ldyAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfWAsXG5cdFx0XHRcdFx0YWN0aW9uOiBhY3Rpb24sXG5cdFx0XHRcdFx0aWNvbjogXCJmaWxlLXBsdXMtMlwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuIiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgTW9kYWwsIFRleHRDb21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9jcmVhdGVGaWxlQ2xhc3NcIjtcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZGROZXdGaWxlQ2xhc3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiQWRkIGEgbmV3IGZpbGVDbGFzc1wiKTtcbiAgICAgICAgdGhpcy5idWlsZEFkZEZpbGVDbGFzc0Zvcm0oKTtcbiAgICB9XG5cbiAgICBidWlsZEFkZEZpbGVDbGFzc0Zvcm0oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc2VzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIVxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe30pO1xuXG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dENvbnRhaW5lciA9IG5hbWVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtaW5wdXRcIiB9KTtcbiAgICAgICAgbmFtZUlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IGAke2ZpbGVDbGFzc0FsaWFzfSBuYW1lYCB9KVxuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChuYW1lSW5wdXRDb250YWluZXIpO1xuICAgICAgICBjb25zdCBuYW1lRXJyb3JDb250YWluZXIgPSBuYW1lQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlLWVycm9yLWZpZWxkXCIsIHRleHQ6IGBUaGlzICR7ZmlsZUNsYXNzQWxpYXN9IGZpbGUgYWxyZWFkeSBleGlzdHNgIH0pO1xuXG4gICAgICAgIGNvbnN0IG1hcFdpdGhUYWdUb2dnbGVDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVyLXdpdGgtbGFiZWxcIiB9KTtcbiAgICAgICAgbWFwV2l0aFRhZ1RvZ2dsZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVyLWxhYmVsXCIsIHRleHQ6IGBNYXAgdGhpcyAke2ZpbGVDbGFzc0FsaWFzfSBmaWxlIHdpdGggdGhlIHRhZyBvZiBzYW1lIG5hbWVgIH0pXG4gICAgICAgIGNvbnN0IG1hcFdpdGhUYWdUb2dnbGVyID0gbmV3IFRvZ2dsZUNvbXBvbmVudChtYXBXaXRoVGFnVG9nZ2xlQ29udGFpbmVyKVxuICAgICAgICBtYXBXaXRoVGFnVG9nZ2xlci5zZXRWYWx1ZShmYWxzZSk7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgIC8vYWN0aW9uc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYWN0aW9ucy1zcGFjZXJcIiB9KSAvLyBzcGFjZXJcbiAgICAgICAgY29uc3Qgc2F2ZUJ0bkNvbnRhaW5lciA9IGFjdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KHt9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoc2F2ZUJ0bkNvbnRhaW5lcik7XG4gICAgICAgIHNhdmVCdG4uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgIHNhdmVCdG4uc2V0SWNvbihcImZpbGUtcGx1cy0yXCIpO1xuXG4gICAgICAgIG5hbWVFcnJvckNvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgIG5hbWVJbnB1dC5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XG4gICAgICAgICAgICBuYW1lRXJyb3JDb250YWluZXIuaGlkZSgpO1xuICAgICAgICAgICAgc2F2ZUJ0bi5zZXREaXNhYmxlZChmYWxzZSlcbiAgICAgICAgICAgIHNhdmVCdG4uc2V0Q3RhKClcbiAgICAgICAgICAgIGlmIChhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMoYCR7ZmlsZUNsYXNzZXNQYXRofSR7dmFsdWV9Lm1kYCkpIHtcbiAgICAgICAgICAgICAgICBuYW1lRXJyb3JDb250YWluZXIuc2hvdygpO1xuICAgICAgICAgICAgICAgIHNhdmVCdG4uc2V0RGlzYWJsZWQodHJ1ZSlcbiAgICAgICAgICAgICAgICBzYXZlQnRuLnJlbW92ZUN0YSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBzYXZlQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCBuYW1lSW5wdXQuZ2V0VmFsdWUoKSwgbWFwV2l0aFRhZ1RvZ2dsZXIuZ2V0VmFsdWUoKSk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZywgbWFwV2l0aFRhZzogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBpZiAoY2xhc3NGaWxlc1BhdGgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtYXBXaXRoVGFnID8gXCItLS1cXG5tYXBXaXRoVGFnOiB0cnVlXFxuLS0tXFxuXCIgOiBcIlwiXG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmNyZWF0ZShgJHtjbGFzc0ZpbGVzUGF0aH0ke25hbWV9Lm1kYCwgY29udGVudClcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IChlcnJvcilcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnkgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnlcIjtcblxuZXhwb3J0IGludGVyZmFjZSBNZXRhZGF0YU1lbnVTZXR0aW5ncyB7XG5cdHByZXNldEZpZWxkczogQXJyYXk8RmllbGQ+O1xuXHRmaWxlQ2xhc3NRdWVyaWVzOiBBcnJheTxGaWxlQ2xhc3NRdWVyeT47XG5cdGRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51OiBib29sZWFuO1xuXHRnbG9iYWxseUlnbm9yZWRGaWVsZHM6IEFycmF5PHN0cmluZz47XG5cdGNsYXNzRmlsZXNQYXRoOiBzdHJpbmcgfCBudWxsO1xuXHRpc0F1dG9zdWdnZXN0RW5hYmxlZDogYm9vbGVhbjtcblx0ZmlsZUNsYXNzQWxpYXM6IHN0cmluZztcblx0c2V0dGluZ3NWZXJzaW9uPzogbnVtYmVyO1xuXHRnbG9iYWxGaWxlQ2xhc3M/OiBzdHJpbmc7XG5cdGZpcnN0RGF5T2ZXZWVrOiBudW1iZXI7XG5cdGVuYWJsZUxpbmtzOiBib29sZWFuO1xuXHRlbmFibGVUYWJIZWFkZXI6IGJvb2xlYW47XG5cdGVuYWJsZUVkaXRvcjogYm9vbGVhbjtcblx0ZW5hYmxlQmFja2xpbmtzOiBib29sZWFuO1xuXHRlbmFibGVTdGFycmVkOiBib29sZWFuO1xuXHRlbmFibGVGaWxlRXhwbG9yZXI6IGJvb2xlYW47XG5cdGVuYWJsZVNlYXJjaDogYm9vbGVhbjtcblx0YnV0dG9uSWNvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWV0YWRhdGFNZW51U2V0dGluZ3MgPSB7XG5cdHByZXNldEZpZWxkczogW10sXG5cdGZpbGVDbGFzc1F1ZXJpZXM6IFtdLFxuXHRkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudTogdHJ1ZSxcblx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzOiBbXSxcblx0Y2xhc3NGaWxlc1BhdGg6IG51bGwsXG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiB0cnVlLFxuXHRmaWxlQ2xhc3NBbGlhczogXCJmaWxlQ2xhc3NcIixcblx0c2V0dGluZ3NWZXJzaW9uOiB1bmRlZmluZWQsXG5cdGdsb2JhbEZpbGVDbGFzczogdW5kZWZpbmVkLFxuXHRmaXJzdERheU9mV2VlazogMSxcblx0ZW5hYmxlTGlua3M6IHRydWUsXG5cdGVuYWJsZVRhYkhlYWRlcjogdHJ1ZSxcblx0ZW5hYmxlRWRpdG9yOiB0cnVlLFxuXHRlbmFibGVCYWNrbGlua3M6IHRydWUsXG5cdGVuYWJsZVN0YXJyZWQ6IHRydWUsXG5cdGVuYWJsZUZpbGVFeHBsb3JlcjogdHJ1ZSxcblx0ZW5hYmxlU2VhcmNoOiB0cnVlLFxuXHRidXR0b25JY29uOiBcImNsaXBib2FyZC1saXN0XCJcbn07IiwgImltcG9ydCB7IFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIEJ1dHRvbkNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50LCBNb2RhbCwgRHJvcGRvd25Db21wb25lbnQsIG1vbWVudCwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nXCI7XG5pbXBvcnQgeyBGb2xkZXJTdWdnZXN0IH0gZnJvbSBcInNyYy9zdWdnZXN0ZXIvRm9sZGVyU3VnZ2VzdGVyXCI7XG5pbXBvcnQgeyBGaWxlU3VnZ2VzdCB9IGZyb20gXCJzcmMvc3VnZ2VzdGVyL0ZpbGVTdWdnZXN0ZXJcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCBmcm9tIFwiLi9GaWxlQ2xhc3NRdWVyeVNldHRpbmdNb2RhbFwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZyBmcm9tIFwiLi9GaWxlQ2xhc3NRdWVyeVNldHRpbmdcIjtcblxuY2xhc3MgU2V0dGluZ3NNaWdyYXRpb25Db25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcblx0XHRwcml2YXRlIHRhYjogTWV0YWRhdGFNZW51U2V0dGluZ1RhYlxuXHQpIHtcblx0XHRzdXBlcihwbHVnaW4uYXBwKTtcblx0fTtcblxuXHRvbk9wZW4oKTogdm9pZCB7XG5cblx0XHR0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkNvbmZpcm1cIik7XG5cdFx0Y29uc3QgYm9keSA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7XG5cdFx0XHRjbHM6IFwibW9kYWwtdGV4dC1kYW5nZXJcIlxuXHRcdH0pO1xuXHRcdGJvZHkuc2V0VGV4dChcIlRoaXMgd2lsbCBlcmFzZSBjdXJyZW50IHNldHRpbmdzLiBBcmUgeW91IHN1cmU/XCIpO1xuXHRcdGNvbnN0IGNvbmZpcm1CdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHRoaXMuY29udGVudEVsKTtcblx0XHRjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja1wiKTtcblx0XHRjb25maXJtQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRpZiAodGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5oYXNPd25Qcm9wZXJ0eShcInN1cGVyY2hhcmdlZC1saW5rcy1vYnNpZGlhblwiKSkge1xuXHRcdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdFx0bGV0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcInN1cGVyY2hhcmdlZC1saW5rcy1vYnNpZGlhblwiXS5zZXR0aW5ncztcblx0XHRcdFx0Ly9kZWVwIGNvcHlpbmcgcHJlc2V0RmllbGRzIGluIGluaXRpYWxQcm9wZXJ0eVxuXHRcdFx0XHR0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcyA9IFtdO1xuXHRcdFx0XHRzZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaCgocHJvcDogRmllbGQpID0+IHtcblx0XHRcdFx0XHRjb25zdCBmaWVsZCA9IG5ldyBGaWVsZCgpO1xuXHRcdFx0XHRcdE9iamVjdC5hc3NpZ24oZmllbGQsIHByb3ApO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2goZmllbGQpO1xuXHRcdFx0XHR9KVxuXG5cdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9O1xuXG5cdG9uQ2xvc2UoKTogdm9pZCB7XG5cdFx0dGhpcy50YWIuZGlzcGxheSgpO1xuXHR9O1xufTtcblxuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1ldGFkYXRhTWVudVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fTtcblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdEdsb2JhbCBTZXR0aW5ncyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0Y29uc3QgZ2xvYmFsU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jylcblx0XHRnbG9iYWxTZXR0aW5ncy5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdHbG9iYWwgc2V0dGluZ3MnLCBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyXCIgfSk7XG5cdFx0Z2xvYmFsU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJHbG9iYWwgc2V0dGluZ3MgdG8gYXBwbHkgdG8geW91ciB3aG9sZSB2YXVsdFwiXG5cdFx0fSlcblxuXHRcdC8qIE1hbmFnZSBtZW51IG9wdGlvbnMgZGlzcGxheSovXG5cdFx0bmV3IFNldHRpbmcoZ2xvYmFsU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkRpc3BsYXkgZmllbGQgb3B0aW9ucyBpbiBjb250ZXh0IG1lbnVcIilcblx0XHRcdC5zZXREZXNjKFwiQ2hvb3NlIHRvIHNob3cgb3IgaGlkZSBmaWVsZHMgb3B0aW9ucyBpbiB0aGUgY29udGV4dCBtZW51IG9mIGEgbGluayBvciBhIGZpbGVcIilcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZTogVG9nZ2xlQ29tcG9uZW50KSA9PiB7XG5cdFx0XHRcdHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSlcblx0XHRcdFx0dG9nZ2xlLm9uQ2hhbmdlKGFzeW5jIHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSA9IHZhbHVlXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHQvKiBFeGNsdWRlIEZpZWxkcyBmcm9tIGNvbnRleHQgbWVudSovXG5cdFx0bmV3IFNldHRpbmcoZ2xvYmFsU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnR2xvYmFsbHkgaWdub3JlZCBmaWVsZHMnKVxuXHRcdFx0LnNldERlc2MoJ0ZpZWxkcyB0byBiZSBpZ25vcmVkIGJ5IHRoZSBwbHVnaW4gd2hlbiBhZGRpbmcgb3B0aW9ucyB0byB0aGUgY29udGV4dCBtZW51Jylcblx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBmaWVsZHMgYXMgc3RyaW5nLCBjb21tYSBzZXBhcmF0ZWQnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuam9pbignLCAnKSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChpdGVtID0+IGl0ZW0udHJpbSgpKTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwucm93cyA9IDY7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5jb2xzID0gMjU7XG5cdFx0XHR9KTtcblxuXG5cdFx0LyogRmlyc3QgZGF5IG9mIHdlZWsgKGZvciBEYXRlIEZpZWxkcyovXG5cdFx0bmV3IFNldHRpbmcoZ2xvYmFsU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnRmlyc3QgZGF5IG9mIHdlZWsnKVxuXHRcdFx0LnNldERlc2MoJ0ZvciBkYXRlIGZpZWxkcywgd2hpY2ggZGF5IHRoZSBkYXRlIHBpY2tlclxcJ3Mgd2VlayBzaG91bGQgc3RhcnQgd2l0aCcpXG5cdFx0XHQuYWRkRHJvcGRvd24oKGNiOiBEcm9wZG93bkNvbXBvbmVudCkgPT4ge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuXHRcdFx0XHRcdGNiLmFkZE9wdGlvbihpLnRvU3RyaW5nKCksIG1vbWVudCgpLmRheShpKS5mb3JtYXQoXCJkZGRkXCIpKVxuXHRcdFx0XHR9XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0RGF5T2ZXZWVrLnRvU3RyaW5nKCkgfHwgXCIxXCIpXG5cdFx0XHRcdGNiLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0RGF5T2ZXZWVrID0gcGFyc2VJbnQodmFsdWUpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNYW5hZ2luZyBwcmVkZWZpbmVkIG9wdGlvbnMgZm9yIHByb3BlcnRpZXMgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIEFkZCBuZXcgcHJvcGVydHkgZm9yIHdoaWNoIHdlIHdhbnQgdG8gcHJlc2V0IG9wdGlvbnMqL1xuXHRcdGNvbnN0IHByZXNldEZpZWxkc1NldHRpbmdzID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0Y29uc3QgcHJlc2V0RmllbGRzU2V0dGluZ0hlYWRlckNvbnRhaW5lciA9IHByZXNldEZpZWxkc1NldHRpbmdzLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWhlYWRlci1jb250YWluZXJcIiB9KTtcblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lciA9IHByZXNldEZpZWxkc1NldHRpbmdIZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyLXRleHQtY29udGFpbmVyXCIgfSk7XG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ0hlYWRlclRleHRDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnUHJlc2V0IEZpZWxkcyBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1kZXNjXCIsXG5cdFx0XHR0ZXh0OiBcIk1hbmFnZSBnbG9iYWxseSBwcmVkZWZpbmVkIHR5cGUgYW5kIG9wdGlvbnMgZm9yIGEgZmllbGQgdGhyb3VnaG91dCB5b3VyIHdob2xlIHZhdWx0XCJcblx0XHR9KTtcblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b25Db250YWluZXIgPSBwcmVzZXRGaWVsZHNTZXR0aW5nSGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNldHRpbmctaXRlbS1jb250cm9sXCIgfSk7XG5cdFx0Y29uc3QgcHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uID0gcHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuXHRcdHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbi5hZGRDbGFzcyhcInNldHRpbmctaXRlbS1jb250cm9sXCIpO1xuXG5cdFx0Y29uc3QgcHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXIgPSBwcmVzZXRGaWVsZHNTZXR0aW5ncy5jcmVhdGVFbChcImRpdlwiKTtcblx0XHRuZXcgU2V0dGluZyhwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKFwiQWRkIE5ldyBGaWVsZCBTZXR0aW5nXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkFkZCBhIG5ldyBGcm9udG1hdHRlciBwcm9wZXJ0eSBmb3Igd2hpY2ggeW91IHdhbnQgcHJlc2V0IG9wdGlvbnMuXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBidXR0b25cblx0XHRcdFx0XHQuc2V0VG9vbHRpcChcIkFkZCBOZXcgUHJvcGVydHkgTWFuYWdlclwiKVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiK1wiKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBtb2RhbCA9IG5ldyBGaWVsZFNldHRpbmdzTW9kYWwodGhpcy5wbHVnaW4sIHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyKTtcblx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogTWFuYWdlZCBwcm9wZXJ0aWVzIHRoYXQgY3VycmVudGx5IGhhdmUgcHJlc2V0IG9wdGlvbnMgKi9cblx0XHR0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBuZXcgRmllbGQoKTtcblx0XHRcdE9iamVjdC5hc3NpZ24ocHJvcGVydHksIHByb3ApO1xuXHRcdFx0bmV3IEZpZWxkU2V0dGluZyhwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lciwgcHJvcGVydHksIHRoaXMucGx1Z2luKTtcblx0XHR9KTtcblxuXHRcdHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSA/XG5cdFx0XHRzZXRJY29uKHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtdXAtYXJyb3ctZ2x5cGhcIikgOlxuXHRcdFx0c2V0SWNvbihwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24sIFwiZG91YmxlLWRvd24tYXJyb3ctZ2x5cGhcIik7XG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG5cdFx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lci5pc1Nob3duKCkgP1xuXHRcdFx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lci5oaWRlKCkgOlxuXHRcdFx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lci5zaG93KCk7XG5cdFx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lci5pc1Nob3duKCkgP1xuXHRcdFx0XHRzZXRJY29uKHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtdXAtYXJyb3ctZ2x5cGhcIikgOlxuXHRcdFx0XHRzZXRJY29uKHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtZG93bi1hcnJvdy1nbHlwaFwiKTtcblx0XHR9XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1hbmFnaW5nIGZpbGVDbGFzcyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cblx0XHQvKiBTZXQgY2xhc3NGaWxlcyBQYXRoKi9cblx0XHRjb25zdCBjbGFzc0ZpbGVzU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiKVxuXHRcdGNvbnN0IGNsYXNzRmlsZXNTZXR0aW5nc0hlYWRlckNvbnRhaW5lciA9IGNsYXNzRmlsZXNTZXR0aW5ncy5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXItY29udGFpbmVyXCIgfSk7XG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzSGVhZGVyVGV4dENvbnRhaW5lciA9IGNsYXNzRmlsZXNTZXR0aW5nc0hlYWRlckNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXItdGV4dC1jb250YWluZXJcIiB9KTtcblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NIZWFkZXJUZXh0Q29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0ZpbGVDbGFzcyBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NIZWFkZXJUZXh0Q29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uIG1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWRlc2NcIixcblx0XHRcdHRleHQ6IFwiTWFuYWdlIGZpbGVDbGFzcyBmb2xkZXIgYW5kIGFsaWFzLiBcIiArXG5cdFx0XHRcdFwiV2hlbiBhIG5vdGUgaGFzIGEgZmlsZUNsYXNzIGRlZmluZWQsIGZpbGVDbGFzcyBmaWVsZCBwcm9wZXJ0aWVzIHdpbGwgb3ZlcnJpZGUgZ2xvYmFsIHByZXNldCBmaWVsZHMgc2V0dGluZ3MgZm9yIHRoZSBzYW1lIGZpZWxkIG5hbWVcIlxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbkNvbnRhaW5lciA9IGNsYXNzRmlsZXNTZXR0aW5nc0hlYWRlckNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJzZXR0aW5nLWl0ZW0tY29udHJvbFwiIH0pO1xuXHRcdGNvbnN0IGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24gPSBjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuXG5cdFx0Y2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbi5hZGRDbGFzcyhcInNldHRpbmctaXRlbS1jb250cm9sXCIpO1xuXHRcdGNvbnN0IGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lciA9IGNsYXNzRmlsZXNTZXR0aW5ncy5jcmVhdGVFbChcImRpdlwiKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdjbGFzcyBGaWxlcyBwYXRoJylcblx0XHRcdC5zZXREZXNjKCdQYXRoIHRvIHRoZSBmaWxlcyBjb250YWluaW5nIHRoZSBhdXRob3JpemVkIGZpZWxkcyBmb3IgYSB0eXBlIG9mIG5vdGUnKVxuXHRcdFx0LmFkZFNlYXJjaCgoY2ZzKSA9PiB7XG5cdFx0XHRcdG5ldyBGb2xkZXJTdWdnZXN0KHRoaXMucGx1Z2luLCBjZnMuaW5wdXRFbCk7XG5cdFx0XHRcdGNmcy5zZXRQbGFjZWhvbGRlcihcIkZvbGRlclwiKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCB8fCBcIlwiKVxuXHRcdFx0XHRcdC5vbkNoYW5nZSgobmV3X2ZvbGRlcikgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgbmV3UGF0aCA9IG5ld19mb2xkZXIuZW5kc1dpdGgoXCIvXCIpIHx8ICFuZXdfZm9sZGVyID8gbmV3X2ZvbGRlciA6IG5ld19mb2xkZXIgKyBcIi9cIjtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoID0gbmV3UGF0aCB8fCBudWxsO1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0Y2ZzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLWZpbGVDbGFzcy1zZWFyY2hcIilcblx0XHRcdH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ2ZpbGVDbGFzcyBmaWVsZCBhbGlhcycpXG5cdFx0XHQuc2V0RGVzYygnQ2hvb3NlIGFub3RoZXIgbmFtZSBmb3IgZmlsZUNsYXNzIGZpZWxkIGluIGZyb250bWF0dGVyIChleGFtcGxlOiBDYXRlZ29yeSwgdHlwZSwgLi4uJylcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMgPSB2YWx1ZSB8fCBcImZpbGVDbGFzc1wiO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFxuXG5cdFx0LyogU2V0IGdsb2JhbCBmaWxlQ2xhc3MqL1xuXHRcdG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdnbG9iYWwgZmlsZUNsYXNzJylcblx0XHRcdC5zZXREZXNjKCdDaG9vc2Ugb25lIGZpbGVDbGFzcyB0byBiZSBhcHBsaWNhYmxlIHRvIGFsbCBmaWxlcyAoZXZlbiBpdCBpcyBub3QgcHJlc2VudCBhcyBhIGZpbGVDbGFzcyBhdHRyaWJ1dGUgaW4gdGhlaXIgZnJvbnRtYXR0ZXIpLiBUaGlzIHdpbGwgb3ZlcnJpZGUgdGhlIHByZXNldCBGaWVsZHMgZGVmaW5lZCBhYm92ZScpXG5cdFx0XHQuYWRkU2VhcmNoKChjZnMpID0+IHtcblx0XHRcdFx0bmV3IEZpbGVTdWdnZXN0KFxuXHRcdFx0XHRcdGNmcy5pbnB1dEVsLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIHx8IFwiXCJcblx0XHRcdFx0KTtcblx0XHRcdFx0Y2ZzLnNldFBsYWNlaG9sZGVyKFwiR2xvYmFsIGZpbGVDbGFzc1wiKVxuXHRcdFx0XHRjZnMuc2V0VmFsdWUoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzID9cblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoICsgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzICsgXCIubWRcIiA6XG5cdFx0XHRcdFx0XHRcIlwiXG5cdFx0XHRcdClcblx0XHRcdFx0XHQub25DaGFuZ2UoKG5ld1BhdGgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyA9IG5ld1BhdGggP1xuXHRcdFx0XHRcdFx0XHRuZXdQYXRoLnNwbGl0KCdcXFxcJykucG9wKCkhLnNwbGl0KCcvJykucG9wKCk/LnJlcGxhY2UoXCIubWRcIiwgXCJcIikgOlxuXHRcdFx0XHRcdFx0XHRcIlwiO1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0Y2ZzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLWZpbGVDbGFzcy1zZWFyY2hcIilcblx0XHRcdH0pXG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1hbmFnaW5nIGV4dHJhIGJ1dHRvbiBkaXNwbGF5IG9wdGlvbnNcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0Y29uc3QgbWV0YWRhdGFNZW51QnRuU2V0dGluZ3MgPSBjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIilcblx0XHRtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncy5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdTaG93IGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtOicsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KVxuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIk1ldGFkYXRhIE1lbnUgYnV0dG9uIGljb25cIilcblx0XHRcdC5zZXREZXNjKFwibmFtZSBvZiB0aGUgZGVmYXVsdCBpY29uIHdoZW4gbm90IGRlZmluZWQgaW4gZmlsZUNsYXNzXCIpXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmJ1dHRvbkljb24pXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYnV0dG9uSWNvbiA9IHZhbHVlIHx8IFwiY2xpcGJvYXJkLWxpc3RcIjtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSlcblxuXHRcdG5ldyBTZXR0aW5nKG1ldGFkYXRhTWVudUJ0blNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJSZWFkaW5nIG1vZGUgbGlua3NcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBhZnRlciBhIGxpbmsgaW4gcmVhZGluZyBtb2RlXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTGlua3MpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTGlua3MgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiTGl2ZSBwcmV2aWV3IG1vZGVcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBhZnRlciBhIGxpbmsgaW4gbGl2ZSBwcmV2aWV3XCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRWRpdG9yKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUVkaXRvciA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSlcblxuXHRcdG5ldyBTZXR0aW5nKG1ldGFkYXRhTWVudUJ0blNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJUYWIgaGVhZGVyXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgYW4gZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IGZvcm0gaW4gdGhlIHRhYiBoZWFkZXJcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVUYWJIZWFkZXIpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlVGFiSGVhZGVyID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkJhY2tsaW5rc1wiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IGFuIGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtIGluIHRoZSBiYWNrbGlua3MgcGFuZWxcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVCYWNrbGlua3MpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlQmFja2xpbmtzID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIlNlYXJjaFwiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IGFuIGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtIGluIHRoZSBzZWFyY2ggcGFuZWxcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTZWFyY2gpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU2VhcmNoID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkZpbGUgZXhwbG9yZXJcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBpbiB0aGUgZmlsZSBleHBsb3JlclwiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZpbGVFeHBsb3Jlcik7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGaWxlRXhwbG9yZXIgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiU3RhcnJlZFwiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IGFuIGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtIGluIHRoZSBzdGFycmVkIHBhbmVsXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU3RhcnJlZCk7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTdGFycmVkID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNYW5hZ2luZyBwcmVkZWZpbmVkIGZpbGVDbGFzcyBmb3IgcXVlcnkncyBtYXRjaGluZyBmaWxlcyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0LyogQWRkIG5ldyBxdWVyeSBmb3Igd2hpY2ggbWF0Y2hpbmcgZmlsZXMgd2lsbCBiZSBhcHBsaWVkIHRoZSBmaWxlQ2xhc3MqL1xuXHRcdGNvbnN0IHF1ZXJ5RmlsZUNsYXNzU2V0dGluZ3MgPSBjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIilcblx0XHRxdWVyeUZpbGVDbGFzc1NldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1F1ZXJ5IGJhc2VkIEZpbGVDbGFzcyBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRxdWVyeUZpbGVDbGFzc1NldHRpbmdzLmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uIG1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWRlc2NcIixcblx0XHRcdHRleHQ6IFwiTWFuYWdlIGdsb2JhbGx5IHByZWRlZmluZWQgdHlwZSBhbmQgb3B0aW9ucyBmb3IgYSBmaWVsZCBtYXRjaGluZyB0aGlzIHF1ZXJ5XCJcblx0XHR9KVxuXHRcdG5ldyBTZXR0aW5nKHF1ZXJ5RmlsZUNsYXNzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkFkZCBOZXcgUXVlcnkgZm9yIGZpbGVDbGFzc1wiKVxuXHRcdFx0LnNldERlc2MoXCJBZGQgYSBuZXcgcXVlcnkgYW5kIGEgRmlsZUNsYXNzIHRoYXQgd2lsbCBhcHBseSB0byBmaWxlcyBtYXRjaGluZyB0aGlzIHF1ZXJ5LlwiKVxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldFRvb2x0aXAoXCJBZGQgTmV3IFByb3BlcnR5IE1hbmFnZXJcIilcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIitcIilcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRsZXQgbW9kYWwgPSBuZXcgRmlsZUNsYXNzUXVlcnlTZXR0aW5nc01vZGFsKHRoaXMucGx1Z2luLCBxdWVyeUZpbGVDbGFzc1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogTWFuYWdlZCBwcm9wZXJ0aWVzIHRoYXQgY3VycmVudGx5IGhhdmUgcHJlc2V0IG9wdGlvbnMgKi9cblx0XHR0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllc1xuXHRcdFx0LmZvckVhY2gocXVlcnkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NRdWVyeSA9IG5ldyBGaWxlQ2xhc3NRdWVyeSgpO1xuXHRcdFx0XHRPYmplY3QuYXNzaWduKGZpbGVDbGFzc1F1ZXJ5LCBxdWVyeSk7XG5cdFx0XHRcdG5ldyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcocXVlcnlGaWxlQ2xhc3NTZXR0aW5ncywgZmlsZUNsYXNzUXVlcnksIHRoaXMucGx1Z2luKTtcblx0XHRcdH0pO1xuXG5cdFx0Y2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSA/XG5cdFx0XHRzZXRJY29uKGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24sIFwiZG91YmxlLXVwLWFycm93LWdseXBoXCIpIDpcblx0XHRcdHNldEljb24oY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtZG93bi1hcnJvdy1nbHlwaFwiKTtcblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG5cdFx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXIuaXNTaG93bigpID9cblx0XHRcdFx0Y2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyLmhpZGUoKSA6XG5cdFx0XHRcdGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lci5zaG93KCk7XG5cdFx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXIuaXNTaG93bigpID9cblx0XHRcdFx0c2V0SWNvbihjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLCBcImRvdWJsZS11cC1hcnJvdy1nbHlwaFwiKSA6XG5cdFx0XHRcdHNldEljb24oY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtZG93bi1hcnJvdy1nbHlwaFwiKTtcblx0XHR9XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1pZ3JhdGlvbiBzZXR0aW5ncyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0Y29uc3QgbWlncmF0ZVNldHRpbmdzID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIilcblx0XHRtaWdyYXRlU2V0dGluZ3MuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnTWlncmF0ZScgfSk7XG5cblx0XHQvKiBBZGQgbmV3IHByb3BlcnR5IGZvciB3aGljaCB3ZSB3YW50IHRvIHByZXNldCBvcHRpb25zKi9cblx0XHRuZXcgU2V0dGluZyhtaWdyYXRlU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkNvcHkgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3MgcGx1Z2luXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkNvcHkgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3MgcGx1Z2luXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBidXR0b25cblx0XHRcdFx0XHQuc2V0VG9vbHRpcChcIkdldCBzZXR0aW5ncyBmcm9tIHN1cGVyY2hhcmdlZCBsaW5rc1wiKVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiQ29weVwiKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBtb2RhbCA9IG5ldyBTZXR0aW5nc01pZ3JhdGlvbkNvbmZpcm1Nb2RhbCh0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fTtcbn07XG4iLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcblxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEFic3RyYWN0RmlsZSwgVEZvbGRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgVGV4dElucHV0U3VnZ2VzdCB9IGZyb20gXCIuL3N1Z2dlc3RcIjtcblxuZXhwb3J0IGNsYXNzIEZvbGRlclN1Z2dlc3QgZXh0ZW5kcyBUZXh0SW5wdXRTdWdnZXN0PFRGb2xkZXI+IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwdWJsaWMgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnRcbiAgICApIHtcbiAgICAgICAgc3VwZXIoaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHI6IHN0cmluZyk6IFRGb2xkZXJbXSB7XG4gICAgICAgIGNvbnN0IGFic3RyYWN0RmlsZXMgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKTtcbiAgICAgICAgY29uc3QgZm9sZGVyczogVEZvbGRlcltdID0gW107XG4gICAgICAgIGNvbnN0IGxvd2VyQ2FzZUlucHV0U3RyID0gaW5wdXRTdHIudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBhYnN0cmFjdEZpbGVzLmZvckVhY2goKGZvbGRlcjogVEFic3RyYWN0RmlsZSkgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIgJiZcbiAgICAgICAgICAgICAgICBmb2xkZXIucGF0aC50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKGxvd2VyQ2FzZUlucHV0U3RyKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZm9sZGVycy5wdXNoKGZvbGRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb2xkZXJzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZvbGRlciwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLnNldFRleHQoZmlsZS5wYXRoKTtcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKGZpbGU6IFRGb2xkZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gZmlsZS5wYXRoO1xuICAgICAgICB0aGlzLmlucHV0RWwudHJpZ2dlcihcImlucHV0XCIpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBNb2RhbCwgU2V0dGluZywgVGV4dEFyZWFDb21wb25lbnQsIFRleHRDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5XCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NRdWVyeVNldHRpbmdzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZmlsZUNsYXNzUXVlcnk6IEZpbGVDbGFzc1F1ZXJ5O1xuICAgIHByaXZhdGUgaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5OiBGaWxlQ2xhc3NRdWVyeTtcbiAgICBwcml2YXRlIG5ldzogYm9vbGVhbiA9IHRydWU7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBwYXJlbnRTZXR0aW5nQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBwYXJlbnRTZXR0aW5nPzogRmlsZUNsYXNzUXVlcnlTZXR0aW5nLFxuICAgICAgICBmaWxlQ2xhc3NRdWVyeT86IEZpbGVDbGFzc1F1ZXJ5XG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSA9IG5ldyBGaWxlQ2xhc3NRdWVyeSgpO1xuICAgICAgICBpZiAoZmlsZUNsYXNzUXVlcnkpIHtcbiAgICAgICAgICAgIHRoaXMubmV3ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gZmlsZUNsYXNzUXVlcnk7XG4gICAgICAgICAgICBGaWxlQ2xhc3NRdWVyeS5jb3B5UHJvcGVydHkodGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnksIHRoaXMuZmlsZUNsYXNzUXVlcnkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgbmV3SWQgPSAxO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQocHJvcC5pZCkgJiYgcGFyc2VJbnQocHJvcC5pZCkgPj0gbmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SWQgPSBwYXJzZUludChwcm9wLmlkKSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NRdWVyeSA9IG5ldyBGaWxlQ2xhc3NRdWVyeSgpO1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NRdWVyeS5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeS5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzUXVlcnkubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IGEgZmlsZUNsYXNzIGFuZCBhZGQgYW4gYXBwbGljYWJsZSBxdWVyeWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSAke3RoaXMuZmlsZUNsYXNzUXVlcnkubmFtZX0gc2V0dGluZ3NgKTtcbiAgICAgICAgfTtcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVGb3JtKCk7XG4gICAgfTtcblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWxlQ2xhc3NRdWVyeSwgdGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICBpZiAoIXRoaXMubmV3ICYmIHRoaXMucGFyZW50U2V0dGluZykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnRTZXR0aW5nLnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2F2ZWQpIHtcbiAgICAgICAgICAgIG5ldyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcodGhpcy5wYXJlbnRTZXR0aW5nQ29udGFpbmVyLCB0aGlzLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLnBsdWdpbik7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlbmFtZUlucHV0Q29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogVGV4dENvbXBvbmVudCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5TmFtZUNvbnRhaW5lckxhYmVsID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoKTtcbiAgICAgICAgZmlsZUNsYXNzUXVlcnlOYW1lQ29udGFpbmVyTGFiZWwuc2V0VGV4dChgRmlsZUNsYXNzIFF1ZXJ5IE5hbWU6YCk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmZpbGVDbGFzc1F1ZXJ5Lm5hbWU7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKG5hbWUpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIk5hbWUgb2YgdGhpcyBmaWxlQ2xhc3MgcXVlcnlcIik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkubmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSBvcHRpb25zIGZvciAke3RoaXMuZmlsZUNsYXNzUXVlcnkubmFtZX1gKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lckxhYmVsID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoKTtcbiAgICAgICAgRmlsZUNsYXNzU2VsZWN0b3JDb250YWluZXJMYWJlbC5zZXRUZXh0KGBGaWxlY2xhc3M6YCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChwYXJlbnROb2RlKTtcbiAgICAgICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcihmID0+IGNsYXNzRmlsZXNQYXRoICYmIGYucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSk7XG4gICAgICAgIHNlbGVjdC5hZGRPcHRpb24oXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIsIFwiLS1TZWxlY3QgYSBmaWxlQ2xhc3MtLVwiKVxuICAgICAgICBmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzLnBhdGgpO1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHNlbGVjdC5hZGRPcHRpb24oZmlsZUNsYXNzTmFtZSwgZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHNlbGVjdC5zZXRWYWx1ZSh0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT0gXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgPSB2YWx1ZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgPSBcIlwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVRdWVyeUlucHV0Q29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5Q29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBxdWVyeUNvbnRhaW5lckxhYmVsLnNldFRleHQoXCJkYXRhdmlld0pTIHF1ZXJ5OlwiKVxuICAgICAgICBjb25zdCBxdWVyeVN0cmluZ0lucHV0ID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBxdWVyeVN0cmluZ0lucHV0LnNldFZhbHVlKHRoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnkpO1xuICAgICAgICBxdWVyeVN0cmluZ0lucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnkgPSB2YWx1ZSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZUZvcm0oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGRpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1kaXZcIiB9KTtcbiAgICAgICAgY29uc3QgbWFpbkRpdiA9IGRpdi5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1wcm9tcHQtZm9ybVwiIH0pO1xuXG4gICAgICAgIC8qIFNlY3Rpb25zICovXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihuYW1lQ29udGFpbmVyKTtcbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NTZWxlY3RDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpXG5cbiAgICAgICAgLyogZm9vdGVyIGJ1dHRvbnMqL1xuICAgICAgICBjb25zdCBmb290ZXJFbCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBmb290ZXJCdXR0b25zID0gbmV3IFNldHRpbmcoZm9vdGVyRWwpO1xuICAgICAgICBmb290ZXJCdXR0b25zLmFkZEJ1dHRvbigoYikgPT4gdGhpcy5jcmVhdGVTYXZlQnV0dG9uKGIpKTtcbiAgICAgICAgZm9vdGVyQnV0dG9ucy5hZGRFeHRyYUJ1dHRvbigoYikgPT4gdGhpcy5jcmVhdGVDYW5jZWxCdXR0b24oYikpO1xuXG4gICAgICAgIC8qIGluaXQgc3RhdGUgKi9cbiAgICAgICAgdGhpcy5jcmVhdGVGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lcihmaWxlQ2xhc3NTZWxlY3RDb250YWluZXIpXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVRdWVyeUlucHV0Q29udGFpbmVyKGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVTYXZlQnV0dG9uKGI6IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCB7XG4gICAgICAgIGIuc2V0VG9vbHRpcChcIlNhdmVcIik7XG4gICAgICAgIGIuc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgYi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgJiYgdGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lICYmIHRoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSA9IHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLmZpbHRlcihwID0+IHAuaWQgPT0gdGhpcy5maWxlQ2xhc3NRdWVyeS5pZClbMF07XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eShjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMucHVzaCh0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnRTZXR0aW5nKSBGaWxlQ2xhc3NRdWVyeS5jb3B5UHJvcGVydHkodGhpcy5wYXJlbnRTZXR0aW5nLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmc/LnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihiOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCk6IEV4dHJhQnV0dG9uQ29tcG9uZW50IHtcbiAgICAgICAgYi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ2FuY2VsXCIpXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8qIHJlc2V0IG9wdGlvbnMgZnJvbSBzZXR0aW5ncyAqL1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGI7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCBmcm9tIFwiLi9GaWxlQ2xhc3NRdWVyeVNldHRpbmdNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcgZXh0ZW5kcyBTZXR0aW5nIHtcbiAgICBwdWJsaWMgZmlsZUNsYXNzUXVlcnk6IEZpbGVDbGFzc1F1ZXJ5O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcm9wZXJ0eTogRmlsZUNsYXNzUXVlcnksXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbiAgICApIHtcbiAgICAgICAgc3VwZXIoY29udGFpbmVyRWwpO1xuICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gcHJvcGVydHk7XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGRNb3ZlVXBCdXR0b24oKTtcbiAgICB9O1xuXG4gICAgcHVibGljIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG5cbiAgICAgICAgdGhpcy5pbmZvRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB0aGlzLmluZm9FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtXCIpXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyID0gdGhpcy5pbmZvRWwuY3JlYXRlRGl2KCk7XG5cbiAgICAgICAgY29uc3QgbmFtZUNvbnRhaW5lciA9IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW0tbmFtZVwiKVxuICAgICAgICBuYW1lQ29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7dGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lfTwvc3Ryb25nPmBcblxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lQ29udGFpbmVyID0gZmlsZUNsYXNzUXVlcnlDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIilcbiAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHNwYW4+RmlsZUNsYXNzPC9zcGFuPiA6ICR7dGhpcy5maWxlQ2xhc3NRdWVyeS5maWxlQ2xhc3NOYW1lfWBcblxuICAgICAgICBjb25zdCBxdWVyeUNvbnRhaW5lciA9IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHF1ZXJ5Q29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Bhbj5RdWVyeTwvc3Bhbj4gOiAke3RoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnl9YFxuXG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRWRpdFwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5jb250YWluZXJFbCwgdGhpcywgdGhpcy5maWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRGVsZXRlQnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkRlbGV0ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkgPSB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5maW5kKHAgPT4gcC5pZCA9PSB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5yZW1vdmUoY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdFbC5wYXJlbnRFbGVtZW50Py5yZW1vdmVDaGlsZCh0aGlzLnNldHRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGRNb3ZlVXBCdXR0b24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJ1cC1jaGV2cm9uLWdseXBoXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJNb3ZlIHVwIChsb3dlciBwcmlvcml0eSlcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlQ2xhc3NRdWVyeUluZGV4ID0gdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMubWFwKGZjcSA9PiBmY3EuaWQpLmluZGV4T2YodGhpcy5maWxlQ2xhc3NRdWVyeS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmlsZUNsYXNzUXVlcnlJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuaW5zZXJ0QmVmb3JlKHRoaXMuc2V0dGluZ0VsLCB0aGlzLnNldHRpbmdFbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLnNwbGljZShjdXJyZW50RmlsZUNsYXNzUXVlcnlJbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5zcGxpY2UoY3VycmVudEZpbGVDbGFzc1F1ZXJ5SW5kZXggLSAxLCAwLCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vZmllbGRzL0ZpZWxkXCJcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiXG5pbXBvcnQgKiBhcyBzZWxlY3RWYWx1ZXNTb3VyY2UgZnJvbSBcIi4uL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzXCJcblxuaW50ZXJmYWNlIFYxRmllbGQgZXh0ZW5kcyBGaWVsZCB7XG4gICAgaXNNdWx0aT86IGJvb2xlYW4sXG4gICAgaXNDeWNsZT86IGJvb2xlYW4sXG4gICAgaXNCb29sZWFuPzogYm9vbGVhbixcbiAgICB2YWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG59XG5cbmludGVyZmFjZSBWMkZpZWxkIGV4dGVuZHMgRmllbGQge1xuICAgIHZhbHVlc0xpc3ROb3RlUGF0aD86IHN0cmluZ1xufVxuXG5leHBvcnQgY29uc3QgbWlncmF0ZVNldHRpbmdzVjF0b1YyID0gYXN5bmMgKHBsdWdpbjogTWV0YWRhdGFNZW51KSA9PiB7XG4gICAgY29uc3QgcHJlc2V0RmllbGRzID0gcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkc1xuICAgIHByZXNldEZpZWxkcy5mb3JFYWNoKChwOiBWMUZpZWxkKSA9PiB7XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMocCkuY29udGFpbnMoXCJ0eXBlXCIpKSB7XG4gICAgICAgICAgICBpZiAocC5pc011bHRpKSBwLnR5cGUgPSBGaWVsZFR5cGUuTXVsdGlcbiAgICAgICAgICAgIGVsc2UgaWYgKHAuaXNDeWNsZSkgcC50eXBlID0gRmllbGRUeXBlLkN5Y2xlXG4gICAgICAgICAgICBlbHNlIGlmIChwLmlzQm9vbGVhbikgcC50eXBlID0gRmllbGRUeXBlLkJvb2xlYW5cbiAgICAgICAgICAgIGVsc2UgaWYgKHAub3B0aW9ucyAmJiBPYmplY3Qua2V5cyhwLm9wdGlvbnMpLmxlbmd0aCA+IDApIHAudHlwZSA9IEZpZWxkVHlwZS5TZWxlY3RcbiAgICAgICAgICAgIGVsc2UgcC50eXBlID0gRmllbGRUeXBlLklucHV0XG4gICAgICAgIH1cbiAgICAgICAgLy9lcmFzZSBpc011bHRpLCBpc0N5Y2xlLCBpc0Jvb2xlYW4gaWYgZXhpc3RzXG4gICAgICAgIGRlbGV0ZSBwLmlzTXVsdGk7XG4gICAgICAgIGRlbGV0ZSBwLmlzQ3ljbGU7XG4gICAgICAgIGRlbGV0ZSBwLmlzQm9vbGVhblxuICAgICAgICAvL3JlbmFtZSBcInZhbHVlc1wiIGluIFwib3B0aW9uXCJcbiAgICAgICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocCwgXCJ2YWx1ZXNcIikgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHAsIFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocCwgXCJ2YWx1ZXNcIikhKTtcbiAgICAgICAgICAgIGRlbGV0ZSBwW1widmFsdWVzXCJdO1xuICAgICAgICB9XG4gICAgfSlcbiAgICBwbHVnaW4uc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID0gMlxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShwbHVnaW4uc2V0dGluZ3MpXG4gICAgY29uc29sZS5sb2coXCJNZXRhZGF0YSBtZW51IHNldHRpbmdzIG1pZ3JhdGVkIHRvIHZlcnNpb24gMlwiKVxufVxuXG5leHBvcnQgY29uc3QgbWlncmF0ZVNldHRpbmdzVjJ0b1YzID0gYXN5bmMgKHBsdWdpbjogTWV0YWRhdGFNZW51KSA9PiB7XG4gICAgY29uc3QgcHJlc2V0RmllbGRzID0gcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkc1xuICAgIHByZXNldEZpZWxkcy5mb3JFYWNoKChwOiBWMkZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChbRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLk11bHRpXS5pbmNsdWRlcyhwLnR5cGUpKSB7XG4gICAgICAgICAgICAvL1N0ZXAwOiBtb2RpZnkgb3B0aW9ucyBmb3IgU2VsZWN0IGFuZCBNdWx0aVNlbGVjdFxuICAgICAgICAgICAgY29uc3QgY3VycmVudE9wdGlvbktleXMgPSBPYmplY3Qua2V5cyhwLm9wdGlvbnMpO1xuICAgICAgICAgICAgcC5vcHRpb25zLnZhbHVlc0xpc3QgPSB7fVxuICAgICAgICAgICAgY3VycmVudE9wdGlvbktleXMuZm9yRWFjaChrZXkgPT4gcC5vcHRpb25zLnZhbHVlc0xpc3Rba2V5XSA9IHAub3B0aW9uc1trZXldKVxuICAgICAgICAgICAgLy9TdGVwMTogc2V0IHRoZSB2YWx1ZXNTb3VyY2VUeXBlXG4gICAgICAgICAgICBpZiAocC52YWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RUeXBlID0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICAgICAgICAgIHAub3B0aW9ucy5zb3VyY2VUeXBlID0gc2VsZWN0VHlwZTtcbiAgICAgICAgICAgICAgICBwLm9wdGlvbnNbc2VsZWN0VmFsdWVzU291cmNlLktleVtzZWxlY3RUeXBlXV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHAub3B0aW9ucy5zb3VyY2VUeXBlID0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9TdGVwMjogbW92ZSB2YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgIHAub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGggPSBwLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICAgICAgLy9TdGVwMzogZGVsZXRlIGxlZ2FjeSBvcHRpb25zXG4gICAgICAgICAgICBjdXJyZW50T3B0aW9uS2V5cy5mb3JFYWNoKGtleSA9PiBkZWxldGUgcC5vcHRpb25zW2tleV0pXG4gICAgICAgICAgICAvL1N0ZXA0OiBwb3B1bGF0ZSB2YWx1ZXNGcm9tRFZRdWVyeSBvcHRpb24gd2l0aCBlbXB0eSBzdHJpbmdcbiAgICAgICAgICAgIHAub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeSA9IFwiXCJcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgcC52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICB9KVxuICAgIHBsdWdpbi5zZXR0aW5ncy5zZXR0aW5nc1ZlcnNpb24gPSAzXG4gICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKHBsdWdpbi5zZXR0aW5ncylcbiAgICBjb25zb2xlLmxvZyhcIk1ldGFkYXRhIG1lbnUgc2V0dGluZ3MgbWlncmF0ZWQgdG8gdmVyc2lvbiAzXCIpXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7XG4gICAgRWRpdG9yLFxuICAgIEVkaXRvclBvc2l0aW9uLFxuICAgIEVkaXRvclN1Z2dlc3QsXG4gICAgRWRpdG9yU3VnZ2VzdENvbnRleHQsXG4gICAgRWRpdG9yU3VnZ2VzdFRyaWdnZXJJbmZvLFxuICAgIE1hcmtkb3duVmlldyxcbiAgICBURmlsZSxcbiAgICBwYXJzZVlhbWwsXG4gICAgTm90aWNlLFxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBnZW5lcmljRmllbGRSZWdleCwgZ2V0TGluZUZpZWxkcywgZW5jb2RlTGluayB9IGZyb20gXCIuLi91dGlscy9wYXJzZXJcIjtcbmltcG9ydCBGaWxlRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9GaWxlRmllbGRcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5cbmludGVyZmFjZSBJVmFsdWVDb21wbGV0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFsdWVTdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxJVmFsdWVDb21wbGV0aW9uPiB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGluRnVsbExpbmU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGluU2VudGVuY2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGRpZFNlbGVjdDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZmllbGQ/OiBGaWVsZDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5zZXRJbnN0cnVjdGlvbnMoW3sgY29tbWFuZDogXCJTaGlmdFwiLCBwdXJwb3NlOiBcInB1dCBhIHNwYWNlIGFmdGVyOjpcIiB9XSk7XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtcIlNoaWZ0XCJdLCBcIkVudGVyXCIsIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMudXNlU2VsZWN0ZWRJdGVtKGV2dCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBvblRyaWdnZXIoXG4gICAgICAgIGN1cnNvcjogRWRpdG9yUG9zaXRpb24sXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLFxuICAgICAgICBmaWxlOiBURmlsZVxuICAgICk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB8IG51bGwge1xuICAgICAgICBpZiAodGhpcy5kaWRTZWxlY3QpIHtcbiAgICAgICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gZmFsc2VcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5pc0F1dG9zdWdnZXN0RW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICAgICAgY29uc3QgZnVsbExpbmUgPSBlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSlcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gISFmcm9udG1hdHRlciAmJlxuICAgICAgICAgICAgZnJvbnRtYXR0ZXIucG9zaXRpb24uc3RhcnQubGluZSA8IGN1cnNvci5saW5lICYmXG4gICAgICAgICAgICBjdXJzb3IubGluZSA8IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lXG4gICAgICAgIGlmICh0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9Oig/PHZhbHVlcz4uKilgLCBcInVcIik7XG4gICAgICAgICAgICBpZiAoIXJlZ2V4LnRlc3QoZnVsbExpbmUpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIGlmIChnZXRMaW5lRmllbGRzKGZ1bGxMaW5lKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDogY3Vyc29yLFxuICAgICAgICAgICAgZW5kOiBjdXJzb3IsXG4gICAgICAgICAgICBxdWVyeTogZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpLFxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGZpbHRlck9wdGlvbiA9IChmaXJzdFZhbHVlczogc3RyaW5nW10gfCB1bmRlZmluZWQsIGxhc3RWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkLCBvcHRpb246IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gIWZpcnN0VmFsdWVzIHx8XG4gICAgICAgICAgICAhZmlyc3RWYWx1ZXM/LmNvbnRhaW5zKGVuY29kZUxpbmsob3B0aW9uKSkgJiYgKCFsYXN0VmFsdWUgfHxcbiAgICAgICAgICAgICAgICAhIWxhc3RWYWx1ZSAmJiBlbmNvZGVMaW5rKG9wdGlvbikuaW5jbHVkZXMobGFzdFZhbHVlKSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEFsaWFzKHRGaWxlOiBURmlsZSk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZD8ub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKHRGaWxlLnBhdGgpKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGlhc1xuICAgIH1cblxuICAgIGFzeW5jIGdldFN1Z2dlc3Rpb25zKGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0KTogUHJvbWlzZTxJVmFsdWVDb21wbGV0aW9uW10+IHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCB0aGlzLmdldFZhbHVlU3VnZ2VzdGlvbnMoY29udGV4dCk7XG4gICAgICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcblxuICAgIGFzeW5jIGdldFZhbHVlU3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBQcm9taXNlPElWYWx1ZUNvbXBsZXRpb25bXT4ge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gY29udGV4dC5zdGFydC5saW5lO1xuICAgICAgICBjb25zdCBtYXRjaEZpZWxkOiB7IGF0dHJpYnV0ZT86IHN0cmluZywgdmFsdWVzPzogc3RyaW5nIH0gPSB7IGF0dHJpYnV0ZTogdW5kZWZpbmVkLCB2YWx1ZXM6IFwiXCIgfVxuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoIXRoaXMuaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgY29uc3QgbGluZUZpZWxkcyA9IGdldExpbmVGaWVsZHMoZW5jb2RlTGluayhjb250ZXh0LmVkaXRvci5nZXRMaW5lKGxpbmVOdW1iZXIpKSk7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvbnRleHQuZWRpdG9yLmdldEN1cnNvcigpLmNoXG4gICAgICAgICAgICBjb25zdCBhY3RpdmVMaW5lRmllbGQgPSBsaW5lRmllbGRzLmZpbmQobGluZUZpZWxkID0+IGxpbmVGaWVsZC5pbmRleCA8PSBwb3NpdGlvbiAmJiBsaW5lRmllbGQuaW5kZXggKyBsaW5lRmllbGQubGVuZ3RoID49IHBvc2l0aW9uKVxuICAgICAgICAgICAgaWYgKGFjdGl2ZUxpbmVGaWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5TZW50ZW5jZSA9IGFjdGl2ZUxpbmVGaWVsZC5pbmRleCA+IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbkZ1bGxMaW5lID0gYWN0aXZlTGluZUZpZWxkLmluZGV4ID09PSAwO1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQuYXR0cmlidXRlID0gYWN0aXZlTGluZUZpZWxkLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLnZhbHVlcyA9IGFjdGl2ZUxpbmVGaWVsZC52YWx1ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTooPzx2YWx1ZXM+LispP2AsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4UmVzdWx0ID0gY29udGV4dC5lZGl0b3IuZ2V0UmFuZ2UoeyBsaW5lOiBsaW5lTnVtYmVyLCBjaDogMCB9LCBjb250ZXh0LmVuZCkubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHJlZ2V4UmVzdWx0Py5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLmF0dHJpYnV0ZSA9IHJlZ2V4UmVzdWx0Lmdyb3Vwcy5hdHRyaWJ1dGU7XG4gICAgICAgICAgICAgICAgbWF0Y2hGaWVsZC52YWx1ZXMgPSByZWdleFJlc3VsdC5ncm91cHMudmFsdWVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaEZpZWxkLmF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGROYW1lID0gbWF0Y2hGaWVsZC5hdHRyaWJ1dGU7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoY29udGV4dC5maWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpO1xuICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdCA9IG1hdGNoRmllbGQudmFsdWVzPy5yZXBsYWNlKC9eXFxbfF5cXHNcXFt8XlxcKHxeXFxzXFwoLywgJycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXSR8XFwpJC8sICcnKVxuICAgICAgICAgICAgICAgIC5zcGxpdChcIixcIikubWFwKG8gPT4gZW5jb2RlTGluayhvLnRyaW0oKSkpXG4gICAgICAgICAgICBjb25zdCBsYXN0VmFsdWUgPSB2YWx1ZXNMaXN0Py5sYXN0KClcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0VmFsdWVzID0gdmFsdWVzTGlzdD8uc2xpY2UoMCwgLTEpXG4gICAgICAgICAgICAvL3RhZ3Mgc3BlY2lmaWMgY2FzZVxuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJ0YWdzXCIgJiYgdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldFRhZ3MoKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0ID0+IGxhc3RWYWx1ZSA/IHQuY29udGFpbnMobGFzdFZhbHVlKSA6IHQpXG4gICAgICAgICAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gT2JqZWN0KHsgdmFsdWU6IHRhZy5yZXBsYWNlKC9eIy8sIFwiXCIpIH0pKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQgJiYgW0ZpZWxkVHlwZS5DeWNsZSwgRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0XS5jb250YWlucyh0aGlzLmZpZWxkLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIChmaWVsZE1hbmFnZXIgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZClcbiAgICAgICAgICAgICAgICAgICAgLmdldE9wdGlvbnNMaXN0KGR2QXBpLnBhZ2UodGhpcy5jb250ZXh0Py5maWxlLnBhdGgpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pKVxuICAgICAgICAgICAgICAgICAgICAubWFwKF92YWx1ZSA9PiBPYmplY3QoeyB2YWx1ZTogX3ZhbHVlIH0pKVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkICYmIFtGaWVsZFR5cGUuRmlsZSwgRmllbGRUeXBlLk11bHRpRmlsZV0uaW5jbHVkZXModGhpcy5maWVsZC50eXBlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvcnRpbmdNZXRob2QgPSBuZXcgRnVuY3Rpb24oXCJhXCIsIFwiYlwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmd9YCkgfHwgZnVuY3Rpb24gKGE6IFRGaWxlLCBiOiBURmlsZSkgeyByZXR1cm4gYS5iYXNlbmFtZSA8IGIuYmFzZW5hbWUgPyAtMSA6IDEgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlcjogRmlsZUZpZWxkID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gZmllbGRNYW5hZ2VyLmdldEZpbGVzKHRoaXMuY29udGV4dD8uZmlsZSkuc29ydChzb3J0aW5nTWV0aG9kIGFzIChhOiBURmlsZSwgYjogVEZpbGUpID0+IG51bWJlcik7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobGFzdFZhbHVlKSB8fCB0aGlzLmdldEFsaWFzKGYpPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxhc3RWYWx1ZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QoeyB2YWx1ZTogRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCBjb250ZXh0LmZpbGUsIGYuYmFzZW5hbWUsIHRoaXMuZ2V0QWxpYXMoZikpIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFsaWFzOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQ/Lm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKGYucGF0aCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QoeyB2YWx1ZTogRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCBjb250ZXh0LmZpbGUsIGYuYmFzZW5hbWUsIGFsaWFzKSB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IElWYWx1ZUNvbXBsZXRpb24sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBbcmF3VmFsdWUsIGFsaWFzXSA9IHN1Z2dlc3Rpb24udmFsdWUucmVwbGFjZSgvXlxcW1xcWy8sIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvLCBcIlwiKS5zcGxpdChcInxcIilcbiAgICAgICAgY29uc3QgdGFyZ2V0RmlsZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHJhd1ZhbHVlLCB0aGlzLmNvbnRleHQhLmZpbGUucGF0aClcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZyAmJiB0YXJnZXRGaWxlKSB7XG4gICAgICAgICAgICBpZiAoYWxpYXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc3VnZ2VzdGVyLWl0ZW0td2l0aC1hbGlhc1wiIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWxhYmVsXCIgfSlcbiAgICAgICAgICAgICAgICBsYWJlbC5zZXRUZXh0KGFsaWFzKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWZpbGVwYXRoXCIgfSlcbiAgICAgICAgICAgICAgICBmaWxlUGF0aC5zZXRUZXh0KHJhd1ZhbHVlKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbC5zZXRUZXh0KG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh0YXJnZXRGaWxlLnBhdGgpKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLnNldFRleHQocmF3VmFsdWUpXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBJVmFsdWVDb21wbGV0aW9uLCBldmVudDogS2V5Ym9hcmRFdmVudCB8IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUxpbmUgPSBlZGl0b3IuZ2V0TGluZSh0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUpO1xuXG4gICAgICAgIGlmICh0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIC8vZm9ybWF0IGxpc3QgaWYgaW4gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhcnNlZEZpZWxkOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBzdHJpbmdbXSB8IG51bGw+ID0gcGFyc2VZYW1sKGFjdGl2ZUxpbmUpXG4gICAgICAgICAgICAgICAgbGV0IFthdHRyLCBwYXN0VmFsdWVzXSA9IE9iamVjdC5lbnRyaWVzKHBhcnNlZEZpZWxkKVswXVxuICAgICAgICAgICAgICAgIGxldCBuZXdGaWVsZDogc3RyaW5nXG4gICAgICAgICAgICAgICAgaWYgKCFwYXN0VmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBcIiArIHN1Z2dlc3Rpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcGFzdFZhbHVlcyA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogXCIgKyBzdWdnZXN0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIHBhc3RWYWx1ZXMuc3BsaXQoXCIsXCIpLm1hcChvID0+IG8udHJpbSgpKS5zbGljZSgwLCAtMSkuam9pbignLCAnKSArIFwiLCBcIiArIHN1Z2dlc3Rpb24udmFsdWUgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTGluZS5lbmRzV2l0aChcIixdXCIpIHx8IGFjdGl2ZUxpbmUuZW5kc1dpdGgoXCIsIF1cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFsdWUgY2FuIGJlIGRpcmVjdGx5IGFkZGVkIHNpbmNlIHBhcnNlWWFtbCB3b250IGNyZWF0ZSBhbiBlbXB0eSBsYXN0IGl0ZW0gaW4gcGFzdFZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzLCBzdWdnZXN0aW9uLnZhbHVlXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgaGF2ZSB0eXBlZCBzb21ldGhpbmcgdGhhdCB3ZSBhaHZlIHRvIHJlbW92ZSB0byByZXBsYWNlIHdpdGggc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBbLi4ucGFzdFZhbHVlcy5zbGljZSgwLCAtMSksIHN1Z2dlc3Rpb24udmFsdWVdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXNdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0ZpZWxkLCB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBhY3RpdmVMaW5lLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSB8fCB0eXBlb2YgcGFzdFZhbHVlcyA9PT0gJ3N0cmluZycgJiYgcGFzdFZhbHVlcy5jb250YWlucyhcIixcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5ld0ZpZWxkLmxlbmd0aCAtIDEgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV3RmllbGQubGVuZ3RoIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRnJvbnRtYXR0ZXIgd3JvbmdseSBmb3JtYXR0ZWRcIiwgMjAwMClcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmluRnVsbExpbmUpIHtcbiAgICAgICAgICAgIGxldCBjbGVhbmVkTGluZSA9IGFjdGl2ZUxpbmVcbiAgICAgICAgICAgIHdoaWxlICghWycsJywgJzonXS5jb250YWlucyhjbGVhbmVkTGluZS5jaGFyQXQoY2xlYW5lZExpbmUubGVuZ3RoIC0gMSkpKSB7XG4gICAgICAgICAgICAgICAgY2xlYW5lZExpbmUgPSBjbGVhbmVkTGluZS5zbGljZSgwLCAtMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7Y2xlYW5lZExpbmV9JHtldmVudC5zaGlmdEtleSA/IFwiIFwiIDogXCJcIn1gICsgc3VnZ2VzdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgdGhpcy5jb250ZXh0IS5lbmQpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5TZW50ZW5jZSkge1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLmNvbnRleHQ/LmVkaXRvci5nZXRDdXJzb3IoKS5jaCB8fCAwXG4gICAgICAgICAgICBsZXQgYmVmb3JlQ3Vyc29yID0gYWN0aXZlTGluZS5zbGljZSgwLCBwb3NpdGlvbilcbiAgICAgICAgICAgIGxldCBhZnRlckN1cnNvciA9IGFjdGl2ZUxpbmUuc2xpY2UocG9zaXRpb24pXG4gICAgICAgICAgICBsZXQgc2VwYXJhdG9yUG9zID0gcG9zaXRpb247XG4gICAgICAgICAgICBsZXQgY3VycmVudFZhbHVlTGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHdoaWxlICghYmVmb3JlQ3Vyc29yLmVuZHNXaXRoKFwiOjpcIikgJiYgIWJlZm9yZUN1cnNvci5lbmRzV2l0aChcIixcIikgJiYgYmVmb3JlQ3Vyc29yLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNlcGFyYXRvclBvcyA9IHNlcGFyYXRvclBvcyAtIDE7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlTGVuZ3RoID0gY3VycmVudFZhbHVlTGVuZ3RoICsgMVxuICAgICAgICAgICAgICAgIGJlZm9yZUN1cnNvciA9IGJlZm9yZUN1cnNvci5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgbmV4dEJyYWNrZXRQb3MgPSBwb3NpdGlvbjtcbiAgICAgICAgICAgIHdoaWxlICghZW5jb2RlTGluayhhZnRlckN1cnNvcikubWF0Y2goXCIoXFxcXF18XFxcXCkpLipcIikgJiYgYWZ0ZXJDdXJzb3IubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgbmV4dEJyYWNrZXRQb3MgPSBuZXh0QnJhY2tldFBvcyArIDE7XG4gICAgICAgICAgICAgICAgYWZ0ZXJDdXJzb3IgPSBhZnRlckN1cnNvci5zbGljZShuZXh0QnJhY2tldFBvcyAtIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoXG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IHNlcGFyYXRvclBvcyB9LFxuICAgICAgICAgICAgICAgIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV4dEJyYWNrZXRQb3MgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5leHRCcmFja2V0UG9zIC0gY3VycmVudFZhbHVlTGVuZ3RoICsgc3VnZ2VzdGlvbi52YWx1ZS5sZW5ndGggfSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpZFNlbGVjdCA9IHRydWVcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgfTtcbn07IiwgImltcG9ydCB7IENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcblxuXG5leHBvcnQgY2xhc3MgVGFzayB7XG4gICAgcHVibGljIHN0YXR1czogXCJwZW5kaW5nXCIgfCBcIm9uZ29pbmdcIiB8IFwiZG9uZVwiO1xuICAgIHB1YmxpYyBpZDogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGZuOiAoKSA9PiBhbnkpIHtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBcInBlbmRpbmdcIlxuICAgICAgICB0aGlzLmlkID0gdXVpZHY0KClcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGaWxlVGFza01hbmFnZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgcHVibGljIHF1ZXVlOiBNYXA8c3RyaW5nLCBUYXNrPjtcbiAgICBwdWJsaWMgYnVzeTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHVibGljIGNhY2hlVmVyc2lvbjogc3RyaW5nLCBwdWJsaWMgb25DaGFuZ2U6ICgpID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICBhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ3Jlc29sdmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm9ic2lkaWFuIHJlc29sdmVkXCIpO1xuICAgICAgICAgICAgdGhpcy5idXN5ID0gZmFsc2U7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVOZXh0KCk7XG4gICAgICAgIH0pKVxuICAgIH1cblxuXG4gICAgcHVibGljIGFzeW5jIHB1c2hUYXNrKGZuOiAoKSA9PiBhbnkpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IG5ldyBUYXNrKGZuKTtcbiAgICAgICAgdGhpcy5xdWV1ZS5zZXQodGFzay5pZCwgdGFzayk7XG4gICAgICAgIGlmICghdGhpcy5idXN5KSBhd2FpdCB0aGlzLmV4ZWN1dGVOZXh0KCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGV4ZWN1dGVOZXh0KCkge1xuICAgICAgICBjb25zdCBbZmlyc3RUYXNrSW5RdWV1ZUlkLCBmaXJzdFRhc2tJblF1ZXVlXSA9IFsuLi50aGlzLnF1ZXVlXVswXSB8fCBbdW5kZWZpbmVkLCB1bmRlZmluZWRdXG4gICAgICAgIGlmIChmaXJzdFRhc2tJblF1ZXVlICYmICF0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLmJ1c3kgPSB0cnVlO1xuICAgICAgICAgICAgZmlyc3RUYXNrSW5RdWV1ZS5zdGF0dXMgPSBcIm9uZ29pbmdcIlxuICAgICAgICAgICAgYXdhaXQgZmlyc3RUYXNrSW5RdWV1ZS5mbigpXG4gICAgICAgICAgICBmaXJzdFRhc2tJblF1ZXVlLnN0YXR1cyA9IFwiZG9uZVwiXG4gICAgICAgICAgICB0aGlzLnF1ZXVlLmRlbGV0ZShmaXJzdFRhc2tJblF1ZXVlSWQpXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiZG9uZTogXCIsIGZpcnN0VGFza0luUXVldWVJZClcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJyZW1haW5pbmdcIiwgWy4uLnRoaXMucXVldWVdLmxlbmd0aClcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50KSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGB3YWl0IC4uLiAke3RoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmluUHJvZ3Jlc3NUYXNrQ291bnR9IHRhc2tzIGluIHByb2dyZXNzYClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJub3RoaW5nIGVsc2UgdG8gZG9cIilcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi5cbiAgICBnZXRSYW5kb21WYWx1ZXMgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuXG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCAiaW1wb3J0IHZhbGlkYXRlIGZyb20gJy4vdmFsaWRhdGUuanMnO1xuLyoqXG4gKiBDb252ZXJ0IGFycmF5IG9mIDE2IGJ5dGUgdmFsdWVzIHRvIFVVSUQgc3RyaW5nIGZvcm1hdCBvZiB0aGUgZm9ybTpcbiAqIFhYWFhYWFhYLVhYWFgtWFhYWC1YWFhYLVhYWFhYWFhYWFhYWFxuICovXG5cbmNvbnN0IGJ5dGVUb0hleCA9IFtdO1xuXG5mb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gIGJ5dGVUb0hleC5wdXNoKChpICsgMHgxMDApLnRvU3RyaW5nKDE2KS5zbGljZSgxKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyIsICJjb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xuZXhwb3J0IGRlZmF1bHQge1xuICByYW5kb21VVUlEXG59OyIsICJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiLCAiaW1wb3J0IHsgQXBwLCBnZXRMaW5rcGF0aCwgTGlua0NhY2hlLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBNYXJrZG93blZpZXcsIFRGaWxlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tcG9uZW50IGZyb20gXCIuLi9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyRXh0cmFBdHRyaWJ1dGVzKGxpbms6IEhUTUxFbGVtZW50KSB7XG4gICAgT2JqZWN0LnZhbHVlcyhsaW5rLmF0dHJpYnV0ZXMpLmZvckVhY2goYXR0ciA9PiB7XG4gICAgICAgIGlmIChhdHRyLm5hbWUuaW5jbHVkZXMoXCJmaWxlY2xhc3MtbmFtZVwiKSkge1xuICAgICAgICAgICAgbGluay5yZW1vdmVBdHRyaWJ1dGUoYXR0ci5uYW1lKVxuICAgICAgICAgICAgY29uc3QgZWwgPSBsaW5rLm5leHRFbGVtZW50U2libGluZ1xuICAgICAgICAgICAgaWYgKGVsPy5oYXNDbGFzcyhcImZpbGVjbGFzcy1pY29uXCIpKSB7XG4gICAgICAgICAgICAgICAgZWwucmVtb3ZlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIHNldExpbmtNZXRhZGF0YUZvcm1CdXR0b24ocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxpbms6IEhUTUxFbGVtZW50LCBkZXN0TmFtZTogc3RyaW5nLCB2aWV3VHlwZU5hbWU6IHN0cmluZyB8IG51bGwsIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpIHtcbiAgICBzd2l0Y2ggKHZpZXdUeXBlTmFtZSkge1xuICAgICAgICBjYXNlIFwiYS5pbnRlcm5hbC1saW5rXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpbmtzKSByZXR1cm47IGJyZWFrO1xuICAgICAgICBjYXNlIFwidGFiSGVhZGVyXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZVRhYkhlYWRlcikgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcInN0YXJyZWRcIjogaWYgKCFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlU3RhcnJlZCkgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcImZpbGUtZXhwbG9yZXJcIjogaWYgKCFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRmlsZUV4cGxvcmVyKSByZXR1cm47IGJyZWFrO1xuICAgICAgICBjYXNlIFwiYmFja2xpbmtcIjogaWYgKCFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlQmFja2xpbmtzKSByZXR1cm47IGJyZWFrO1xuICAgICAgICBjYXNlIFwic2VhcmNoXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZVNlYXJjaCkgcmV0dXJuOyBicmVhaztcbiAgICAgICAgZGVmYXVsdDogcmV0dXJuO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZm9yIChjb25zdCBhIG9mIGxpbmsuYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYS5uYW1lLmluY2x1ZGVzKFwiZmlsZWNsYXNzLW5hbWVcIikgJiYgKGEubmFtZSAhPT0gZmlsZUNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgIGxpbmsucmVtb3ZlQXR0cmlidXRlKGEubmFtZSk7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGxpbmsubmV4dEVsZW1lbnRTaWJsaW5nXG4gICAgICAgICAgICBpZiAoZWw/Lmhhc0NsYXNzKFwiZmlsZWNsYXNzLWljb25cIikpIHtcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgY29uc3QgaWNvbiA9IGZpbGVDbGFzcy5nZXRJY29uKClcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKFwiZmlsZWNsYXNzLW5hbWVcIiwgZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGNvbnN0IGVsID0gbGluay5uZXh0RWxlbWVudFNpYmxpbmdcbiAgICAgICAgICAgIGlmICghZWw/Lmhhc0NsYXNzKFwiZmlsZWNsYXNzLWljb25cIikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXRhZGF0YU1lbnVCdG4gPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5jb250YWluZXJFbC5jcmVhdGVFbCgnYScsIHsgY2xzOiBcImZpbGVjbGFzcy1pY29uXCIgfSlcbiAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGFNZW51QnRuKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldEljb24obWV0YWRhdGFNZW51QnRuLCBpY29uIHx8IHBsdWdpbi5zZXR0aW5ncy5idXR0b25JY29uKVxuICAgICAgICAgICAgICAgICAgICBsaW5rLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZShtZXRhZGF0YU1lbnVCdG4sIGxpbmsubmV4dFNpYmxpbmcpXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhTWVudUJ0bi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7ZGVzdE5hbWV9Lm1kYClcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVGaWVsZHNDb21wb25lbnQgPSBuZXcgTm90ZUZpZWxkc0NvbXBvbmVudChwbHVnaW4sIFwiMVwiLCAoKSA9PiB7IH0sIGZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmFkZENoaWxkKG5vdGVGaWVsZHNDb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUxpbmtNZXRhZGF0YU1lbnVGb3JtQnV0dG9uKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbGluazogSFRNTEVsZW1lbnQsIHZpZXdUeXBlTmFtZTogc3RyaW5nIHwgbnVsbCwgc291cmNlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBsaW5rSHJlZiA9IGxpbmsuZ2V0QXR0cmlidXRlKCdocmVmJyk/LnNwbGl0KCcjJylbMF07XG4gICAgY29uc3QgZGVzdCA9IGxpbmtIcmVmICYmIGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGxpbmtIcmVmLCBzb3VyY2UpO1xuXG4gICAgaWYgKGRlc3QpIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZGVzdC5wYXRoKT8ubGFzdCgpXG4gICAgICAgIHNldExpbmtNZXRhZGF0YUZvcm1CdXR0b24ocGx1Z2luLCBsaW5rLCBkZXN0LnBhdGgucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIiksIHZpZXdUeXBlTmFtZSwgZmlsZUNsYXNzTmFtZSk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbGluazogSFRNTEVsZW1lbnQsIHZpZXdUeXBlTmFtZTogc3RyaW5nIHwgbnVsbCwgc291cmNlTmFtZTogc3RyaW5nLCBfbGlua05hbWU/OiBzdHJpbmcpIHtcbiAgICBjb25zdCBsaW5rTmFtZSA9IF9saW5rTmFtZSB8fCBsaW5rLnRleHRDb250ZW50XG4gICAgY29uc3QgZGVzdCA9IGxpbmtOYW1lICYmIGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGdldExpbmtwYXRoKGxpbmtOYW1lKSwgc291cmNlTmFtZSlcbiAgICBpZiAoZGVzdCkge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLmdldChkZXN0LnBhdGgpPy5sYXN0KClcbiAgICAgICAgc2V0TGlua01ldGFkYXRhRm9ybUJ1dHRvbihwbHVnaW4sIGxpbmssIGRlc3QucGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSwgdmlld1R5cGVOYW1lLCBmaWxlQ2xhc3NOYW1lKTtcbiAgICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUVsTGlua3MoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCkge1xuICAgIGNvbnN0IGxpbmtzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnYS5pbnRlcm5hbC1saW5rJyk7XG4gICAgY29uc3Qgc291cmNlID0gY3R4LnNvdXJjZVBhdGgucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIik7XG4gICAgbGlua3MuZm9yRWFjaCgobGluazogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgdXBkYXRlTGlua01ldGFkYXRhTWVudUZvcm1CdXR0b24oYXBwLCBwbHVnaW4sIGxpbmssICdhLmludGVybmFsLWxpbmsnLCBzb3VyY2UpXG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVWaXNpYmxlTGlua3MoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3Qgc2V0dGluZ3MgPSBwbHVnaW4uc2V0dGluZ3M7XG4gICAgYXBwLndvcmtzcGFjZS5pdGVyYXRlUm9vdExlYXZlcygobGVhZikgPT4ge1xuICAgICAgICBpZiAobGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ICYmIGxlYWYudmlldy5maWxlKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlOiBURmlsZSA9IGxlYWYudmlldy5maWxlO1xuICAgICAgICAgICAgY29uc3QgY2FjaGVkRmlsZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5wYXRoLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpXG4gICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbnN0IHRhYkhlYWRlcjogSFRNTEVsZW1lbnQgPSBsZWFmLnRhYkhlYWRlcklubmVyVGl0bGVFbDtcbiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5lbmFibGVUYWJIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAvLyBTdXBlcmNoYXJnZSB0YWIgaGVhZGVyc1xuICAgICAgICAgICAgICAgIHVwZGF0ZURpdkV4dHJhQXR0cmlidXRlcyhhcHAsIHBsdWdpbiwgdGFiSGVhZGVyLCAndGFiSGVhZGVyJywgZmlsZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xlYXJFeHRyYUF0dHJpYnV0ZXModGFiSGVhZGVyKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZiAoY2FjaGVkRmlsZT8ubGlua3MgJiYgc2V0dGluZ3MuZW5hYmxlTGlua3MpIHtcbiAgICAgICAgICAgICAgICBjYWNoZWRGaWxlLmxpbmtzLmZvckVhY2goKGxpbms6IExpbmtDYWNoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXN0ID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGluay5saW5rLCBmaWxlTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGRlc3QucGF0aCk/Lmxhc3QoKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRlcm5hbExpbmtzID0gbGVhZi52aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoYGEuaW50ZXJuYWwtbGlua1tocmVmPVwiJHtsaW5rLmxpbmt9XCJdYClcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVybmFsTGlua3MuZm9yRWFjaCgoaW50ZXJuYWxMaW5rOiBIVE1MRWxlbWVudCkgPT4gc2V0TGlua01ldGFkYXRhRm9ybUJ1dHRvbihwbHVnaW4sIGludGVybmFsTGluaywgZmlsZU5hbWUsIGBhLmludGVybmFsLWxpbmtgLCBmaWxlQ2xhc3NOYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIENvbXBvbmVudCwgTW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWxcIjtcbmltcG9ydCBDaG9vc2VTZWN0aW9uTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCJcbmltcG9ydCAqIGFzIEZpZWxkVHlwZSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIlxuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWVsZE9wdGlvbnMge1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHsgfVxuXG4gICAgcHVibGljIGFkZE9wdGlvbihpY29uOiBzdHJpbmcsIG9uY2xpY2s6ICgpID0+IHt9IHwgdm9pZCwgdG9vbHRpcD86IHN0cmluZywgY2xhc3NOYW1lPzogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkT3B0aW9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZC1pdGVtIGZpZWxkLW9wdGlvblwiIH0pXG4gICAgICAgIGNvbnN0IGZpZWxkT3B0aW9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZE9wdGlvbkNvbnRhaW5lcilcbiAgICAgICAgZmllbGRPcHRpb24uc2V0SWNvbihpY29uKVxuICAgICAgICBpZiAoY2xhc3NOYW1lKSBmaWVsZE9wdGlvbi5idXR0b25FbC5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICBmaWVsZE9wdGlvbi5vbkNsaWNrKCgpID0+IG9uY2xpY2soKSlcbiAgICAgICAgaWYgKHRvb2x0aXApIGZpZWxkT3B0aW9uLnNldFRvb2x0aXAodG9vbHRpcCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRmllbGRzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIGR2QXBpPzogYW55XG4gICAgcHVibGljIGZpZWxkczogRmllbGRbXVxuICAgIHB1YmxpYyBmaWVsZENvbnRhaW5lcnM6IEhUTUxEaXZFbGVtZW50W10gPSBbXTtcbiAgICBwcml2YXRlIG1heE9wdGlvbnM6IG51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBtaXNzaW5nRmllbGRzOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmR2QXBpID0gcGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaTtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHMoKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZHMtbW9kYWxcIilcbiAgICB9XG5cbiAgICAvL29rXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgRmllbGRzIG9mICR7dGhpcy5maWxlLmJhc2VuYW1lfS4ke3RoaXMuZmlsZS5leHRlbnNpb259YClcbiAgICAgICAgdGhpcy5idWlsZEZpZWxkc0NvbnRhaW5lcigpO1xuICAgIH07XG5cbiAgICAvL29rXG4gICAgZ2V0RmllbGRzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXTtcbiAgICB9XG5cbiAgICAvL1xuICAgIGJ1aWxkRmllbGRDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmllbGQ6IEZpZWxkLCB2YWx1ZT86IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGTVtmaWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgZmllbGQpXG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW5vdGUtZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgZmllbGROYW1lQ29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogYCR7ZmllbGQubmFtZX1gLCBjbHM6IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkLWl0ZW0gZmllbGQtbmFtZVwiIH0pO1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBmaWVsZC5maWxlQ2xhc3NOYW1lID8gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpZWxkLmZpbGVDbGFzc05hbWUpIDogdW5kZWZpbmVkXG4gICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIGZpZWxkTmFtZUNvbnRhaW5lci5hZGRDbGFzcyhgZmlsZUNsYXNzRmllbGRfXyR7ZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfX19cIil9YClcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWVsZFNldHRpbmdDb250YWluZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkLWl0ZW0gZmllbGQtc2V0dGluZ1wiIH0pO1xuICAgICAgICBjb25zdCBmaWVsZFNldHRpbmdCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkU2V0dGluZ0NvbnRhaW5lcik7XG4gICAgICAgIGZpZWxkU2V0dGluZ0J0bi5zZXRJY29uKFwiZ2VhclwiKVxuICAgICAgICBmaWVsZFNldHRpbmdCdG4uc2V0VG9vbHRpcChgJHtmaWVsZC5maWxlQ2xhc3NOYW1lID8gZmllbGQuZmlsZUNsYXNzTmFtZSArIFwiID4gXCIgOiBcIlByZXNldCBGaWVsZCA+IFwifSAke2ZpZWxkLm5hbWV9IHNldHRpbmdzYClcbiAgICAgICAgZmllbGRTZXR0aW5nQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgX2ZpbGVDbGFzcyA9IGZpZWxkLmZpbGVDbGFzc05hbWUgPyB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmllbGQuZmlsZUNsYXNzTmFtZSkgOiB1bmRlZmluZWRcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IF9maWxlQ2xhc3M/LmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIubmFtZSA9PT0gZmllbGQubmFtZSlcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUgJiYgX2ZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBfZmlsZUNsYXNzLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgZmlsZUNsYXNzQXR0cmlidXRlTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBmaWVsZFR5cGVDb250YWluZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBtZXRhZGF0YS1tZW51LW5vdGUtZmllbGQtaXRlbSBmaWVsZC10eXBlLWNvbnRhaW5lcmAgfSk7XG4gICAgICAgIGZpZWxkVHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBmaWVsZC50eXBlLCBjbHM6IGBmaWVsZC10eXBlICR7RmllbGRUeXBlLkZpZWxkQmFja2dyb3VuZENvbG9yQ2xhc3NbZmllbGQudHlwZV19YCB9KVxuICAgICAgICBjb25zdCBmaWVsZFZhbHVlQ29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCA/IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkLWl0ZW0gZmllbGQtdmFsdWVcIiA6IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkLWl0ZW0gZmllbGQtdmFsdWUgZW1wdHlmaWVsZFwiXG4gICAgICAgIH0pXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgZmllbGRWYWx1ZUNvbnRhaW5lci5zZXRUZXh0KGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5GaWVsZFR5cGUuTG9va3VwID8gXCItLS1hdXRvLS0tXCIgOiBcIjxlbXB0eT5cIik7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5taXNzaW5nRmllbGRzID0gdHJ1ZVxuICAgICAgICAgICAgZmllbGRWYWx1ZUNvbnRhaW5lci5zZXRUZXh0KFwiPG1pc3Npbmc+XCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmRpc3BsYXlWYWx1ZShmaWVsZFZhbHVlQ29udGFpbmVyLCB0aGlzLmZpbGUsIGZpZWxkLm5hbWUsICgpID0+IHsgdGhpcy5jbG9zZSgpIH0pXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmllbGRPcHRpb25zID0gbmV3IEZpZWxkT3B0aW9ucyhmaWVsZENvbnRhaW5lcilcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZpZWxkTWFuYWdlci5hZGRGaWVsZE9wdGlvbihmaWVsZC5uYW1lLCB2YWx1ZSwgdGhpcy5maWxlLCBmaWVsZE9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGRCdG5Db250YWluZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkLWl0ZW0gZmllbGQtb3B0aW9uXCIgfSlcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZEJ0bkNvbnRhaW5lcilcbiAgICAgICAgICAgIGZpZWxkQnRuLnNldEljb24oXCJsaXN0LXBsdXNcIilcbiAgICAgICAgICAgIGZpZWxkQnRuLnNldFRvb2x0aXAoXCJBZGQgZmllbGQgYXQgc2VjdGlvblwiKVxuICAgICAgICAgICAgZmllbGRCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICkgPT4gRmllbGRNYW5hZ2VyLm9wZW5GaWVsZE1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnRcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICkub3BlbigpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvcHRpb25zQ291bnQgPSBmaWVsZENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLmZpZWxkLW9wdGlvblwiKS5sZW5ndGhcbiAgICAgICAgaWYgKHRoaXMubWF4T3B0aW9ucyA8IG9wdGlvbnNDb3VudCkgdGhpcy5tYXhPcHRpb25zID0gb3B0aW9uc0NvdW50XG5cbiAgICAgICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG4gICAgfVxuXG4gICAgb3Blbkluc2VydE1pc3NpbmdGaWVsZHNGb3JGaWxlQ2xhc3NNb2RhbChmaWxlQ2xhc3M6IEZpbGVDbGFzcyk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpO1xuICAgICAgICAgICAgaWYgKGR2RmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICkgPT4gaW5zZXJ0TWlzc2luZ0ZpZWxkcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHZGaWxlLmZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3MubmFtZVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1pc3NpbmdGaWVsZHNGb3JGaWxlQ2xhc3MoZmlsZUNsYXNzOiBGaWxlQ2xhc3MpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY3VycmVudEZpZWxkc05hbWVzOiBzdHJpbmdbXSA9IFtdXG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCk7XG4gICAgICAgICAgICBpZiAoZHZGaWxlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudEZpZWxkc05hbWVzLnB1c2goLi4uZ2VudWluZUtleXMoZHZGaWxlKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzID0gZmlsZUNsYXNzICYmIHRoaXMuZmlsZSA/XG4gICAgICAgICAgICAhdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmlsZUNsYXNzLm5hbWUpPy5tYXAoZiA9PiBmLm5hbWUpLmV2ZXJ5KGZpZWxkTmFtZSA9PiBjdXJyZW50RmllbGRzTmFtZXMuaW5jbHVkZXMoZmllbGROYW1lKSkgOlxuICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgcmV0dXJuIG1pc3NpbmdGaWVsZHNcbiAgICB9XG5cbiAgICBidWlsZEZpbGVDbGFzc01hbmFnZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NNYW5hZ2VyQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW5vdGUtZmllbGRzLWluaGVyaXRhbmNlLW1hbmFnZXItY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgIGNvbnN0IF9hbmNlc3RvcnMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldChmaWxlQ2xhc3MubmFtZSkgfHwgW107XG4gICAgICAgICAgICBjb25zdCBhbmNlc3RvcnMgPSBbLi4uX2FuY2VzdG9yc10ucmV2ZXJzZSgpO1xuICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2goZmlsZUNsYXNzLm5hbWUpO1xuICAgICAgICAgICAgYW5jZXN0b3JzLmZvckVhY2goKGZpbGVDbGFzc05hbWUsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBfZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgaWYgKF9maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzT3B0aW9uc0NvbnRhaW5lciA9IGZpbGVDbGFzc01hbmFnZXJDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZHMtZmlsZUNsYXNzLW1hbmFnZXItY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZUNvbnRhaW5lciA9IGZpbGVDbGFzc09wdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZHMtZmlsZUNsYXNzLW1hbmFnZXItbmFtZVwiLCB0ZXh0OiBfZmlsZUNsYXNzLm5hbWUgfSlcbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lci5zZXRBdHRyKFwiaWRcIiwgYGZpbGVDbGFzc19fJHtfZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfX19cIil9YClcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5taXNzaW5nRmllbGRzRm9yRmlsZUNsYXNzKF9maWxlQ2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NJbnNlcnRNaXNzaW5nRmllbGRzQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWxlQ2xhc3NPcHRpb25zQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzSW5zZXJ0TWlzc2luZ0ZpZWxkc0J0bi5zZXRJY29uKFwiYmF0dGVyeS1mdWxsXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NJbnNlcnRNaXNzaW5nRmllbGRzQnRuLnNldFRvb2x0aXAoYEluc2VydCBtaXNzaW5nIGZpZWxkcyBmb3IgJHtfZmlsZUNsYXNzLm5hbWV9YClcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0luc2VydE1pc3NpbmdGaWVsZHNCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuSW5zZXJ0TWlzc2luZ0ZpZWxkc0ZvckZpbGVDbGFzc01vZGFsKF9maWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQWRkQXR0cmlidXRlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWxlQ2xhc3NPcHRpb25zQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NBZGRBdHRyaWJ1dGVCdG4uc2V0SWNvbihcInBsdXMtY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0FkZEF0dHJpYnV0ZUJ0bi5zZXRUb29sdGlwKGBBZGQgZmllbGQgZGVmaW5pdGlvbiBpbiAke19maWxlQ2xhc3MubmFtZX1gKVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NBZGRBdHRyaWJ1dGVCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgX2ZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IGFuY2VzdG9ycy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NNYW5hZ2VyQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiPlwiLCBjbHM6IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkcy1maWxlQ2xhc3MtbWFuYWdlci1zZXBhcmF0b3JcIiB9KVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzRmllbHNDb250YWluZXJzID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsKGBbY2xhc3MqPVwiZmlsZUNsYXNzRmllbGRfXyR7ZmlsZUNsYXNzTmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKX1cIl1gKVxuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NGaWVsc0NvbnRhaW5lcnMuZm9yRWFjaChmaWVsZE5hbWVDb250YWluZXIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgKGZpZWxkTmFtZUNvbnRhaW5lciBhcyBIVE1MRGl2RWxlbWVudCkub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lcj8uYWRkQ2xhc3MoXCJhY3RpdmVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIChmaWVsZE5hbWVDb250YWluZXIgYXMgSFRNTERpdkVsZW1lbnQpLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lcj8ucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbChgLm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZC1pdGVtLmZpZWxkLW5hbWUuZmlsZUNsYXNzRmllbGRfXyR7ZmlsZUNsYXNzTmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKX1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGNvbnQgPT4geyBjb250LmFkZENsYXNzKFwiYWN0aXZlXCIpIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKGAubWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkLWl0ZW0uZmllbGQtbmFtZS5maWxlQ2xhc3NGaWVsZF9fJHtmaWxlQ2xhc3NOYW1lLnJlcGxhY2UoXCIvXCIsIFwiX19fXCIpfWApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvckVhY2goY29udCA9PiB7IGNvbnQucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIikgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZm9ybWF0T3B0aW9uc0NvbHVtbnMoZmllbGRzQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICAvL2NyZWF0ZSBlbXB0eSBjZWxscyBmb3IgZmllbGQgd2l0aCBsZXNzIG9wdGlvbnMgc28gdGhhdCBvcHRpb25zIGFyZSByaWdodCBhbGlnbmVkIGluIHRoZSB0YWJsZVxuICAgICAgICBjb25zdCBmaWVsZENvbnRhaW5lcnMgPSBmaWVsZHNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZC1jb250YWluZXInKVxuICAgICAgICBmaWVsZENvbnRhaW5lcnMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0gZmllbGQucXVlcnlTZWxlY3RvckFsbCgnLmZpZWxkLW9wdGlvbicpXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGggPCB0aGlzLm1heE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBvcHRpb25zWzBdPy5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1heE9wdGlvbnMgLSBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbXB0eUNlbGwgPSBwYXJlbnQuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZC1pdGVtIGZpZWxkLW9wdGlvblwiIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zWzBdLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZShlbXB0eUNlbGwsIG9wdGlvbnNbMF0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgYnVpbGRGaWVsZHNDb250YWluZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWlzc2luZ0ZpZWxkcyA9IGZhbHNlXG4gICAgICAgIHRoaXMuY29udGVudEVsLnJlcGxhY2VDaGlsZHJlbigpO1xuICAgICAgICB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbCgnaHInKVxuICAgICAgICBjb25zdCBmaWVsZHNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1ub3RlLWZpZWxkcy1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5maWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZHZBcGkgPyB0aGlzLmR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpW2ZpZWxkLm5hbWVdIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB0aGlzLmZpZWxkQ29udGFpbmVycy5wdXNoKHRoaXMuYnVpbGRGaWVsZENvbnRhaW5lcihmaWVsZHNDb250YWluZXIsIGZpZWxkLCB2YWx1ZSkpXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuZm9ybWF0T3B0aW9uc0NvbHVtbnMoZmllbGRzQ29udGFpbmVyKTtcbiAgICAgICAgaWYgKHRoaXMubWlzc2luZ0ZpZWxkcykge1xuICAgICAgICAgICAgY29uc3QgaW5zZXJ0TWlzc2luZ0ZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW5vdGUtZmllbGRzLWNvbnRhaW5lciBtZXRhZGF0YS1tZW51LW5vdGUtZmllbGQtaW5zZXJ0LWFsbC1maWVsZHNcIiB9KTtcbiAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHNDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJJbnNlcnQgbWlzc2luZyBmaWVsZHNcIiB9KTtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydE1pc3NpbmdGaWVsZHNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGluc2VydE1pc3NpbmdGaWVsZHNDb250YWluZXIpXG4gICAgICAgICAgICBpbnNlcnRNaXNzaW5nRmllbGRzQnRuLnNldEljb24oXCJiYXR0ZXJ5LWZ1bGxcIilcbiAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHNCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gdGhpcy5kdkFwaT8ucGFnZSh0aGlzLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICBpZiAoZHZGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBDaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICAgICApID0+IGluc2VydE1pc3NpbmdGaWVsZHMoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHZGaWxlLmZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKCdocicpXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc01hbmFnZXJzQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbm90ZS1maWVsZHMtY29udGFpbmVyXCIgfSlcbiAgICAgICAgdGhpcy5idWlsZEZpbGVDbGFzc01hbmFnZXIoZmlsZUNsYXNzTWFuYWdlcnNDb250YWluZXIpXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3RlRmllbGRzQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIHByaXZhdGUgZmllbGRzTW9kYWw6IEZpZWxkc01vZGFsO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHVibGljIGNhY2hlVmVyc2lvbjogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgb25DaGFuZ2U6ICgpID0+IHZvaWQsXG4gICAgICAgIHB1YmxpYyBmaWxlOiBURmlsZVxuICAgICkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmZpZWxkc01vZGFsID0gbmV3IEZpZWxkc01vZGFsKHRoaXMucGx1Z2luLCBmaWxlKVxuICAgICAgICB0aGlzLmZpZWxkc01vZGFsLm9uQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5yZW1vdmVDaGlsZCh0aGlzKVxuICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25sb2FkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdkYXRhdmlldzptZXRhZGF0YS1jaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkc01vZGFsLmdldEZpZWxkcygpO1xuICAgICAgICAgICAgdGhpcy5maWVsZHNNb2RhbC5idWlsZEZpZWxkc0NvbnRhaW5lcigpO1xuICAgICAgICB9KSlcbiAgICAgICAgdGhpcy5maWVsZHNNb2RhbC5vcGVuKClcbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgZWRpdG9yVmlld0ZpZWxkLCBNYXJrZG93blZpZXcsIHNldEljb24sIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBEZWNvcmF0aW9uLCBEZWNvcmF0aW9uU2V0LCBFZGl0b3JWaWV3LCBWaWV3UGx1Z2luLCBWaWV3VXBkYXRlLCBXaWRnZXRUeXBlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFJhbmdlU2V0QnVpbGRlciB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgc3ludGF4VHJlZSB9IGZyb20gXCJAY29kZW1pcnJvci9sYW5ndWFnZVwiO1xuaW1wb3J0IHsgdG9rZW5DbGFzc05vZGVQcm9wIH0gZnJvbSBcIkBjb2RlbWlycm9yL2xhbmd1YWdlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgTm90ZUZpZWxkc0NvbXBvbmVudCBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRDTVZpZXdQbHVnaW4ocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICAvLyBJbXBsZW1lbnRzIHRoZSBsaXZlIHByZXZpZXcgc3VwZXJjaGFyZ2luZ1xuICAgIC8vIENvZGUgc3RydWN0dXJlIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9ub3RoaW5naXNsb3N0L29ic2lkaWFuLWNtNi1hdHRyaWJ1dGVzL2Jsb2IvNzQzZDcxYjBhYTYxNjQwNzE0OWEwYjZlYTVmZmVhMjhlMjE1NDE1OC9zcmMvbWFpbi50c1xuICAgIC8vIENvZGUgaGVscCBjcmVkaXRzIHRvIEBOb3RoaW5nSXNMb3N0ISBUaGV5IGhhdmUgYmVlbiBhIGdyZWF0IGhlbHAgZ2V0dGluZyB0aGlzIHRvIHdvcmsgcHJvcGVybHkuXG4gICAgY2xhc3MgSGVhZGVyV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG4gICAgICAgIGZpbGVDbGFzc05hbWU/OiBzdHJpbmdcbiAgICAgICAgYWZ0ZXI6IGJvb2xlYW5cbiAgICAgICAgZGVzdE5hbWU6IHN0cmluZ1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKGZpbGVDbGFzc05hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgYWZ0ZXI6IGJvb2xlYW4sIGRlc3ROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc05hbWUgPSBmaWxlQ2xhc3NOYW1lXG4gICAgICAgICAgICB0aGlzLmFmdGVyID0gYWZ0ZXJcbiAgICAgICAgICAgIHRoaXMuZGVzdE5hbWUgPSBkZXN0TmFtZVxuICAgICAgICB9XG5cbiAgICAgICAgdG9ET00oKSB7XG4gICAgICAgICAgICBsZXQgbWV0YWRhdGFNZW51QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YU1lbnVCdG4uc2V0QXR0cihcImZpbGVjbGFzcy1uYW1lXCIsIHRoaXMuZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGFNZW51QnRuLmFkZENsYXNzKCdmaWxlY2xhc3MtaWNvbicpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQodGhpcy5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbiA9IGZpbGVDbGFzcy5nZXRJY29uKCk7XG4gICAgICAgICAgICAgICAgICAgIHNldEljb24obWV0YWRhdGFNZW51QnRuLCBpY29uIHx8IHNldHRpbmdzLmJ1dHRvbkljb24pXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhTWVudUJ0bi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7dGhpcy5kZXN0TmFtZX0ubWRgKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZUZpZWxkc0NvbXBvbmVudCA9IG5ldyBOb3RlRmllbGRzQ29tcG9uZW50KHBsdWdpbiwgXCIxXCIsICgpID0+IHsgfSwgZmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQobm90ZUZpZWxkc0NvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgYSBuYWl2ZSBicmVhZCBjcnVtYlxuICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhTWVudUJ0bjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlnbm9yZUV2ZW50KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXR0aW5ncyA9IHBsdWdpbi5zZXR0aW5ncztcbiAgICBjb25zdCB2aWV3UGx1Z2luID0gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG4gICAgICAgIGNsYXNzIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zOiBEZWNvcmF0aW9uU2V0O1xuXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuYnVpbGREZWNvcmF0aW9ucyh2aWV3KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModXBkYXRlLnZpZXcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnVpbGREZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KSB7XG4gICAgICAgICAgICAgICAgbGV0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5lbmFibGVFZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG1kVmlldyA9IHZpZXcuc3RhdGUuZmllbGQoZWRpdG9yVmlld0ZpZWxkKSBhcyBNYXJrZG93blZpZXc7XG4gICAgICAgICAgICAgICAgbGV0IGxhc3RBdHRyaWJ1dGVzID0ge307XG4gICAgICAgICAgICAgICAgbGV0IGljb25EZWNvQWZ0ZXI6IERlY29yYXRpb24gfCBudWxsID0gbnVsbDtcbiAgICAgICAgICAgICAgICBsZXQgaWNvbkRlY29BZnRlcldoZXJlOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGxldCBtZEFsaWFzRnJvbTogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgbGV0IG1kQWxpYXNUbzogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgICAgICAgICAgICAgICAgICBzeW50YXhUcmVlKHZpZXcuc3RhdGUpLml0ZXJhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW50ZXI6IChub2RlKSA9PiB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuUHJvcHMgPSBub2RlLnR5cGUucHJvcCh0b2tlbkNsYXNzTm9kZVByb3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlblByb3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BzID0gbmV3IFNldCh0b2tlblByb3BzLnNwbGl0KFwiIFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTGluayA9IHByb3BzLmhhcyhcImhtZC1pbnRlcm5hbC1saW5rXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0FsaWFzID0gcHJvcHMuaGFzKFwibGluay1hbGlhc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNQaXBlID0gcHJvcHMuaGFzKFwibGluay1hbGlhcy1waXBlXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSAnYWxpYXMnIG9mIHRoZSBtZCBsaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTURMaW5rID0gcHJvcHMuaGFzKCdsaW5rJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSAnaW50ZXJuYWwgbGluaycgb2YgdGhlIG1kIGxpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNNRFVybCA9IHByb3BzLmhhcygndXJsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTURGb3JtYXR0aW5nID0gcHJvcHMuaGFzKCdmb3JtYXR0aW5nLWxpbmsnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNRExpbmsgJiYgIWlzTURGb3JtYXR0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMaW5rOiBUaGUgJ2FsaWFzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVVJMOiBUaGUgaW50ZXJuYWwgbGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWRBbGlhc0Zyb20gPSBub2RlLmZyb207XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZEFsaWFzVG8gPSBub2RlLnRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1BpcGUgJiYgIWlzQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uRGVjb0FmdGVyICYmIGljb25EZWNvQWZ0ZXJXaGVyZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKGljb25EZWNvQWZ0ZXJXaGVyZSwgaWNvbkRlY29BZnRlcldoZXJlLCBpY29uRGVjb0FmdGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyV2hlcmUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0xpbmsgJiYgIWlzQWxpYXMgJiYgIWlzUGlwZSB8fCBpc01EVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGlua1RleHQgPSB2aWV3LnN0YXRlLmRvYy5zbGljZVN0cmluZyhub2RlLmZyb20sIG5vZGUudG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua1RleHQgPSBsaW5rVGV4dC5zcGxpdChcIiNcIilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rVGV4dCwgbWRWaWV3LmZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTURVcmwgJiYgIWZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGVjb2RlVVJJQ29tcG9uZW50KGxpbmtUZXh0KSkgYXMgVEZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZmlsZS5wYXRoKT8ubGFzdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHsgXCJmaWxlY2xhc3MtbmFtZVwiOiBmaWxlQ2xhc3NOYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlY28gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImZpbGVjbGFzcy10ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpY29uRGVjb0JlZm9yZSA9IERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldDogbmV3IEhlYWRlcldpZGdldChmaWxlQ2xhc3NOYW1lLCBmYWxzZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyID0gRGVjb3JhdGlvbi53aWRnZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBuZXcgSGVhZGVyV2lkZ2V0KGZpbGVDbGFzc05hbWUsIHRydWUsIGZpbGUucGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc01EVXJsICYmIG1kQWxpYXNGcm9tICYmIG1kQWxpYXNUbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgcmV0cm9hY3RpdmVseSB0byB0aGUgYWxpYXMgZm91bmQgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVjbyA9IERlY29yYXRpb24ubWFyayh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJmaWxlY2xhc3MtdGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYnVpbGRlci5hZGQobWRBbGlhc0Zyb20sIG1kQWxpYXNGcm9tLCBpY29uRGVjb0JlZm9yZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChtZEFsaWFzRnJvbSwgbWRBbGlhc1RvLCBkZWNvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uRGVjb0FmdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobWRBbGlhc1RvLCBtZEFsaWFzVG8sIGljb25EZWNvQWZ0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25EZWNvQWZ0ZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25EZWNvQWZ0ZXJXaGVyZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWRBbGlhc0Zyb20gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1kQWxpYXNUbyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChub2RlLmZyb20sIG5vZGUuZnJvbSwgaWNvbkRlY29CZWZvcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS5mcm9tLCBub2RlLnRvLCBkZWNvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyV2hlcmUgPSBub2RlLnRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0xpbmsgJiYgaXNBbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlY28gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGxhc3RBdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImZpbGVjbGFzcy10ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS5mcm9tLCBub2RlLnRvLCBkZWNvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uRGVjb0FmdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS50bywgbm9kZS50bywgaWNvbkRlY29BZnRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlcldoZXJlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgZGVjb3JhdGlvbnM6IHYgPT4gdi5kZWNvcmF0aW9uc1xuICAgICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gdmlld1BsdWdpbjtcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdCQUE4RTs7O0FDQzlFLHdCQUF3RDs7O0FDQXhELHVCQUEyRjs7O0FDQTNGLHVCQUFvQzs7O0FDQXBDLHNCQUFvQztBQUVwQyxxQ0FDSSxRQUNBLGdCQUNBLFFBQ2E7QUFBQTtBQVBqQjtBQVFJLFFBQUk7QUFDSixRQUFJLDBCQUEwQix1QkFBTztBQUNqQyxhQUFPO0FBQUEsSUFDWCxPQUFPO0FBQ0gsWUFBTSxRQUFRLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixjQUFjO0FBQ25FLFVBQUksaUJBQWlCLHlCQUFTLE1BQU0sYUFBYSxNQUFNO0FBQ25ELGVBQU87QUFBQSxNQUNYLE9BQU87QUFDSCxjQUFNLE1BQU0sMENBQTBDO0FBQUEsTUFDMUQ7QUFBQSxJQUNKO0FBQ0EsVUFBTSxV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
